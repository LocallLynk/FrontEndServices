{"version":3,"file":"ej2-image-editor.min.js","sources":["../../src/image-editor/action/crop.js","../../src/image-editor/action/draw.js","../../src/image-editor/action/export.js","../../src/image-editor/action/filter.js","../../src/image-editor/action/freehand-draw.js","../../src/image-editor/action/selection.js","../../src/image-editor/action/shape.js","../../src/image-editor/action/transform.js","../../src/image-editor/action/undo-redo.js","../../src/image-editor/base/image-editor.js","../../src/image-editor/base/enum.js","../../src/image-editor/renderer/toolbar.js"],"sourcesContent":["import { Browser, extend, isNullOrUndefined } from '@syncfusion/ej2-base';\nvar Crop = /** @class */ (function () {\n    function Crop(parent) {\n        this.croppedDegree = 0; // Specifies the degree when crop is performed\n        this.cropDestPoints = { startX: 0, startY: 0, width: 0, height: 0 }; // To redraw old image when navigate to crop tab\n        this.tempFlipPanPoint = { x: 0, y: 0 };\n        this.isPreventScaling = false;\n        this.isInitCrop = false;\n        this.isTransformCrop = false;\n        this.parent = parent;\n        this.addEventListener();\n    }\n    Crop.prototype.destroy = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.removeEventListener();\n    };\n    Crop.prototype.addEventListener = function () {\n        this.parent.on('crop', this.cropping, this);\n        this.parent.on('destroyed', this.destroy, this);\n    };\n    Crop.prototype.removeEventListener = function () {\n        this.parent.off('crop', this.cropping);\n        this.parent.off('destroyed', this.destroy);\n    };\n    Crop.prototype.cropping = function (args) {\n        this.updateCropPvtVar();\n        switch (args.prop) {\n            case 'cropCircle':\n                this.cropCircle(args.value['context'], args.value['isSave'], args.value['isFlip']);\n                break;\n            case 'setCurrSelPoints':\n                this.setCurrSelPoints(args.value['isSetDimension']);\n                break;\n            case 'updateRotatePan':\n                this.updateRotatePan();\n                break;\n            case 'crop':\n                this.crop(args.value['obj']);\n                break;\n            case 'calcRatio':\n                this.calcRatio(args.value['obj'], args.value['dimension']);\n                break;\n            case 'getCurrFlipState':\n                this.getCurrFlipState(args.value['panObj']);\n                break;\n            case 'getPreviousCropCurrentObj':\n                args.value['obj']['prevObj'] = this.prevCropCurrObj;\n                break;\n            case 'setPreviousCropCurrentObj':\n                this.prevCropCurrObj = args.value['obj'];\n                break;\n            case 'setCropDestPoints':\n                this.cropDestPoints = args.value['point'];\n                break;\n            case 'getTempFlipPanPoint':\n                args.value['obj']['point'] = this.tempFlipPanPoint;\n                break;\n            case 'setTempFlipPanPoint':\n                if (isNullOrUndefined(args.value['isAdd'])) {\n                    this.tempFlipPanPoint = args.value['point'];\n                }\n                else {\n                    this.tempFlipPanPoint.x += args.value['point'].x;\n                    this.tempFlipPanPoint.y += args.value['point'].y;\n                }\n                break;\n            case 'getPreventScaling':\n                args.value['obj']['bool'] = this.isPreventScaling;\n                break;\n            case 'adjustStraightenForShapes':\n                this.adjustStraightenForShapes(args.value['type'], args.value['isInitialRotated']);\n                break;\n            case 'resizeWrapper':\n                this.resizeWrapper();\n                break;\n            case 'setTransformCrop':\n                this.isTransformCrop = args.value['bool'];\n                break;\n            case 'setInitCrop':\n                this.isInitCrop = args.value['bool'];\n                break;\n            case 'resetZoom':\n                this.resetZoom();\n                break;\n            case 'revertTransform':\n                this.revertTransform(args.value['type'], args.value['coll']);\n                break;\n            case 'reset':\n                this.reset();\n                break;\n        }\n    };\n    Crop.prototype.getModuleName = function () {\n        return 'crop';\n    };\n    Crop.prototype.updateCropPvtVar = function () {\n        var parent = this.parent;\n        if (parent.lowerCanvas) {\n            this.lowerContext = parent.lowerCanvas.getContext('2d');\n        }\n        if (parent.upperCanvas) {\n            this.upperContext = parent.upperCanvas.getContext('2d');\n        }\n    };\n    Crop.prototype.reset = function () {\n        this.prevCropCurrObj = null;\n        this.croppedDegree = 0;\n        this.cropDestPoints = { startX: 0, startY: 0, width: 0, height: 0 };\n        this.tempFlipPanPoint = { x: 0, y: 0 };\n        this.isPreventScaling = false;\n        this.isInitCrop = false;\n        this.isTransformCrop = false;\n    };\n    Crop.prototype.cropImg = function (isRotateCrop) {\n        var parent = this.parent;\n        var isNullCrop = isNullOrUndefined(isRotateCrop);\n        var resizeIcon = parent.element.querySelector('#' + parent.element.id + '_nonaspectratio');\n        var actPoint = parent.activeObj.activePoint;\n        var img = parent.img;\n        var isRotated = false;\n        for (var i = 0, len = parent.rotateFlipColl.length; i < len; i++) {\n            var currentValue = parent.rotateFlipColl[i];\n            if (currentValue === 90 || currentValue === -90) {\n                isRotated = true;\n            }\n        }\n        parent.notify('draw', { prop: 'setImageEdited', onPropertyChange: false });\n        if (isNullCrop || resizeIcon) {\n            this.croppedDegree = parent.transform.degree;\n        }\n        if (isNullCrop && (parent.transform.degree !== 0) || isRotated) {\n            this.updateCropObj();\n            var point = { startX: img.destLeft, startY: img.destTop, width: img.destWidth, height: img.destHeight };\n            parent.notify('transform', { prop: 'setCurrDestinationPoint', onPropertyChange: false, value: { point: point } });\n            this.rotateCrop();\n        }\n        else if (isNullCrop && parent.transform.currFlipState !== '') {\n            this.updateCropObj();\n            var point = { startX: img.destLeft, startY: img.destTop, width: img.destWidth, height: img.destHeight };\n            parent.notify('transform', { prop: 'setCurrDestinationPoint', onPropertyChange: false, value: { point: point } });\n            this.flipCrop();\n        }\n        else {\n            this.adjustStraightenForShapes('initial', false);\n            parent.notify('draw', { prop: 'setTempZoomFactor', onPropertyChange: false, value: { tempZoomFactor: parent.transform.zoomFactor } });\n            var ratio = this.calcRatio();\n            if (isNullCrop || !isRotateCrop) { // isRotateCrop is NULL or False\n                this.updateCropObj();\n                parent.notify('draw', { prop: 'resetPanPoints', onPropertyChange: false });\n                parent.notify('shape', { prop: 'updImgRatioForActObj', onPropertyChange: false });\n                var point = { startX: img.destLeft, startY: img.destTop, width: img.destWidth, height: img.destHeight };\n                parent.notify('transform', { prop: 'setCurrDestinationPoint', onPropertyChange: false, value: { point: point } });\n                parent.currSelectionPoint = extend({}, parent.activeObj, {}, true);\n                this.cropDestPoints = { startX: img.destLeft, startY: img.destTop, width: img.destWidth, height: img.destHeight };\n            }\n            var obj = { width: 0, height: 0 };\n            parent.notify('transform', { prop: 'calcMaxDimension', onPropertyChange: false, value: { width: actPoint.width * ratio.width,\n                    height: actPoint.height * ratio.height, obj: obj, isImgShape: null } });\n            var maxDimension = obj;\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n            parent.img = { srcLeft: (actPoint.startX * ratio.width) - (img.destLeft * ratio.width),\n                srcTop: (actPoint.startY * ratio.height) - (img.destTop * ratio.height),\n                srcWidth: (actPoint.width * ratio.width), srcHeight: (actPoint.height * ratio.height),\n                destLeft: (parent.lowerCanvas.clientWidth - maxDimension.width) / 2,\n                destTop: (parent.lowerCanvas.clientHeight - maxDimension.height + 1) / 2,\n                destWidth: maxDimension.width, destHeight: maxDimension.height };\n            var temp = this.lowerContext.filter;\n            parent.notify('draw', { prop: 'drawImage', onPropertyChange: false });\n            this.lowerContext.filter = 'none';\n            var activeObj = extend({}, parent.activeObj, {}, true);\n            this.cropObjColl();\n            parent.transform.straighten = 0;\n            parent.activeObj = activeObj;\n            this.cropFreehandDrawColl();\n            parent.shapeColl = [];\n            parent.notify('shape', { prop: 'updateShapeColl', onPropertyChange: false });\n            parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n                value: { ctx: this.lowerContext, shape: 'zoom', pen: 'zoom', isPreventApply: null } });\n            parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n            parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.upperContext } });\n            if (parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle') {\n                this.cropCircle(this.lowerContext);\n            }\n            else {\n                parent.isCircleCrop = false;\n            }\n            this.lowerContext.filter = temp;\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            parent.currObjType.isCustomCrop = false;\n            parent.pan(false);\n            parent.transform.defaultZoomFactor = 0;\n        }\n    };\n    Crop.prototype.adjustStraightenForShapes = function (type, isInitialRotated) {\n        var parent = this.parent;\n        var center = {\n            x: parent.img.destLeft + parent.img.destWidth / 2,\n            y: parent.img.destTop + parent.img.destHeight / 2\n        };\n        for (var _i = 0, _a = parent.objColl; _i < _a.length; _i++) {\n            var obj = _a[_i];\n            if (['rectangle', 'ellipse', 'text', 'image', 'redact'].indexOf(obj.shape) !== -1) {\n                if (isInitialRotated || obj.rotatedAngle !== 0) {\n                    var _b = obj.activePoint, startX = _b.startX, startY = _b.startY, width = _b.width, height = _b.height;\n                    var angle = type === 'initial' ? obj.rotatedAngle : -obj.rotatedAngle;\n                    var diffX = startX + width / 2 - center.x;\n                    var diffY = startY + height / 2 - center.y;\n                    var cosAngle = Math.cos(angle);\n                    var sinAngle = Math.sin(angle);\n                    var centerX = cosAngle * diffX - sinAngle * diffY + center.x;\n                    var centerY = sinAngle * diffX + cosAngle * diffY + center.y;\n                    var diffXUpdated = centerX - startX - width / 2;\n                    var diffYUpdated = centerY - startY - height / 2;\n                    obj.activePoint.startX += diffXUpdated;\n                    obj.activePoint.startY += diffYUpdated;\n                    obj.activePoint.endX += diffXUpdated;\n                    obj.activePoint.endY += diffYUpdated;\n                }\n            }\n        }\n    };\n    Crop.prototype.updateCropObj = function () {\n        this.parent.afterCropActions = [];\n        var object = { currObj: {} };\n        this.parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        var obj = object['currObj'];\n        obj.straighten = this.parent.transform.straighten;\n        this.parent.cropObj = extend({}, obj, {}, true);\n    };\n    Crop.prototype.rotateCrop = function () {\n        var parent = this.parent;\n        var flipState = this.getCurrFlipState();\n        var shape = parent.activeObj.shape || '';\n        parent.notify('shape', { prop: 'updImgRatioForActObj', onPropertyChange: false });\n        parent.currSelectionPoint = extend({}, parent.activeObj, {}, true);\n        parent.objColl.push(parent.activeObj);\n        parent.activeObj = extend({}, parent.objColl[parent.objColl.length - 1], {}, true);\n        var activeObj = extend({}, parent.objColl[parent.objColl.length - 1], {}, true);\n        var tempCurrSelObj = extend({}, parent.currSelectionPoint, {}, true);\n        var preventSelObj = { bool: null };\n        parent.notify('transform', { prop: 'getPreventSelect', onPropertyChange: false, value: { obj: preventSelObj } });\n        parent.notify('transform', { prop: 'setPreventSelect', onPropertyChange: false, value: { bool: true } });\n        var coll = extend([], parent.rotateFlipColl, [], true);\n        this.panToSelRangle(true);\n        activeObj = extend({}, parent.objColl[parent.objColl.length - 1], {}, true);\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: activeObj } });\n        parent.objColl.pop();\n        parent.notify('shape', { prop: 'updImgRatioForActObj', onPropertyChange: false });\n        parent.objColl.push(parent.activeObj);\n        // For reverse straightening\n        var straighten = parent.transform.straighten;\n        if (straighten !== 0) {\n            parent.transform.straighten = 0;\n            parent.straightenBaseImageCanvas();\n            parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n                value: { ctx: this.lowerContext, shape: 'zoom', pen: 'zoom', isPreventApply: null } });\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: false } });\n        }\n        this.resetZoom();\n        var afterCropActions = extend([], parent.afterCropActions, [], true);\n        this.revertTransform('initial', coll);\n        // Perform straighten\n        if (straighten !== 0) {\n            parent.transform.straighten = (flipState === 'horizontal' || flipState === 'vertical') ? -straighten : straighten;\n            parent.straightenBaseImageCanvas();\n            parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n                value: { ctx: this.lowerContext, shape: 'zoom', pen: 'zoom', isPreventApply: null } });\n            parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: false } });\n            parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n                value: { ctx: this.lowerContext, shape: 'zoom', pen: 'zoom', isPreventApply: null } });\n        }\n        activeObj = extend({}, parent.objColl[parent.objColl.length - 1], {}, true);\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: activeObj } });\n        parent.objColl.pop();\n        parent.transform.degree = 0;\n        // Checking for selection inside image\n        var object = { isIntersect: null };\n        parent.notify('draw', { prop: 'updateImgCanvasPoints', onPropertyChange: false });\n        parent.notify('draw', { prop: 'isLinesIntersect', onPropertyChange: false, value: { obj: object } });\n        var count = 0;\n        while (straighten !== 0 && object['isIntersect']) {\n            count++;\n            if (count === 50) {\n                break;\n            }\n            parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                value: { zoomFactor: 0.025, zoomPoint: null }, isResize: null });\n            parent.notify('draw', { prop: 'updateImgCanvasPoints', onPropertyChange: false });\n            parent.notify('draw', { prop: 'isLinesIntersect', onPropertyChange: false, value: { obj: object } });\n        }\n        this.cropImg(true);\n        this.revertTransform('reverse', coll);\n        parent.afterCropActions = afterCropActions;\n        parent.currSelectionPoint = tempCurrSelObj;\n        parent.notify('transform', { prop: 'setPreventSelect', onPropertyChange: false, value: { bool: preventSelObj['bool'] } });\n        parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n        parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.upperContext } });\n        if (shape === 'crop-circle') {\n            this.cropCircle(this.lowerContext);\n        }\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        parent.notify('draw', { prop: 'resetPanPoints', onPropertyChange: false });\n    };\n    Crop.prototype.revertTransform = function (type, coll) {\n        var parent = this.parent;\n        var obj = { isRotate: false };\n        if (type === 'initial') {\n            for (var i = coll.length - 1; i >= 0; i--) {\n                var value = coll[i];\n                switch (value) {\n                    case 90:\n                        parent.notify('transform', { prop: 'rotate', value: { degree: -90, obj: obj } });\n                        break;\n                    case -90:\n                        parent.notify('transform', { prop: 'rotate', value: { degree: 90, obj: obj } });\n                        break;\n                    default:\n                        parent.notify('transform', { prop: 'flipImage', value: { direction: parent.toPascalCase(value.toString()) } });\n                        break;\n                }\n            }\n        }\n        else {\n            this.updateFlipState();\n            for (var i = 0, len = coll.length; i < len; i++) {\n                var value = coll[i];\n                switch (value) {\n                    case 90:\n                        parent.notify('transform', { prop: 'rotate', value: { degree: 90, obj: obj } });\n                        break;\n                    case -90:\n                        parent.notify('transform', { prop: 'rotate', value: { degree: -90, obj: obj } });\n                        break;\n                    default:\n                        parent.notify('transform', { prop: 'flipImage', value: { direction: parent.toPascalCase(value.toString()) } });\n                        break;\n                }\n            }\n        }\n    };\n    Crop.prototype.updateFlipState = function () {\n        var parent = this.parent;\n        var objColl = parent.objColl;\n        for (var i = 0, len = objColl.length; i < len; i++) {\n            objColl[i].shapeFlip = '';\n        }\n        // eslint-disable-next-line\n        var pointColl = parent.pointColl;\n        for (var i = 0; i < parent.freehandCounter; i++) {\n            pointColl[i].shapeFlip = '';\n        }\n    };\n    Crop.prototype.resetZoom = function () {\n        var parent = this.parent;\n        if (parent.transform.zoomFactor > 0) {\n            var zoomFactor = parent.transform.zoomFactor;\n            var isUndoRedo = parent.isUndoRedo;\n            parent.setProperties({ zoomSettings: { zoomFactor: (zoomFactor * 10) } }, true);\n            parent.notify('transform', { prop: 'setPreviousZoomValue', onPropertyChange: false,\n                value: { previousZoomValue: parent.zoomSettings.zoomFactor } });\n            for (var i = 0; i < (zoomFactor * 10); i++) {\n                parent.isUndoRedo = true;\n                parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                    value: { zoomFactor: -0.1, zoomPoint: null }, isResize: null });\n            }\n            parent.isUndoRedo = isUndoRedo;\n            parent.notify('draw', { prop: 'resetPanPoints', onPropertyChange: false });\n        }\n    };\n    Crop.prototype.flipCrop = function () {\n        var parent = this.parent;\n        parent.notify('transform', { prop: 'setReverseFlip', onPropertyChange: false, value: { isReverseFlip: true } });\n        parent.panPoint.totalPannedPoint.x += this.tempFlipPanPoint.x;\n        parent.panPoint.totalPannedPoint.y += this.tempFlipPanPoint.y;\n        var tempCurrFlipState = parent.transform.currFlipState;\n        var obj = { flipColl: null };\n        parent.notify('transform', { prop: 'getFlipColl', onPropertyChange: false, value: { obj: obj } });\n        var tempFlipColl = obj['flipColl'];\n        parent.notify('transform', { prop: 'setFlipColl', onPropertyChange: false, value: { flipColl: [] } });\n        parent.notify('shape', { prop: 'updImgRatioForActObj', onPropertyChange: false });\n        parent.objColl.push(parent.activeObj);\n        if (parent.transform.degree === 0) {\n            var panX = -parent.cropObj.totalPannedPoint.x;\n            var panY = -parent.cropObj.totalPannedPoint.y;\n            parent.img.destLeft += panX;\n            parent.img.destTop += panY;\n            parent.notify('transform', { prop: 'drawPannImage', value: { point: { x: panX, y: panY } } });\n            parent.activeObj = extend({}, parent.objColl[parent.objColl.length - 1], {}, true);\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: parent.activeObj } });\n            parent.objColl.pop();\n            parent.notify('shape', { prop: 'updImgRatioForActObj', onPropertyChange: false });\n            parent.objColl.push(parent.activeObj);\n        }\n        this.resetZoom();\n        parent.currSelectionPoint = extend({}, parent.objColl[parent.objColl.length - 1], {}, true);\n        this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        var temp = this.lowerContext.filter;\n        parent.notify('draw', { prop: 'drawImage', onPropertyChange: false });\n        this.updateFlipState();\n        parent.notify('shape', { prop: 'redrawObj', onPropertyChange: false, value: { degree: this.getCurrFlipState() } });\n        parent.notify('freehand-draw', { prop: 'flipFHDColl', onPropertyChange: false,\n            value: { value: this.getCurrFlipState() } });\n        parent.activeObj = extend({}, parent.objColl[parent.objColl.length - 1], {}, true);\n        parent.objColl.pop();\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate' } });\n        this.cropImg(true);\n        parent.notify('transform', { prop: 'setReverseRotate', onPropertyChange: false, value: { bool: true } });\n        this.lowerContext.setTransform(1, 0, 0, 1, 0, 0);\n        parent.notify('draw', { prop: 'setDestPoints', onPropertyChange: false });\n        parent.notify('draw', { prop: 'currTransState', onPropertyChange: false,\n            value: { type: 'initial', isPreventDestination: null, context: null, isPreventCircleCrop: null } });\n        parent.notify('draw', { prop: 'drawImage', onPropertyChange: false });\n        this.lowerContext.filter = temp;\n        parent.notify('draw', { prop: 'setRotateZoom', onPropertyChange: false, value: { isRotateZoom: false } });\n        parent.notify('draw', { prop: 'currTransState', onPropertyChange: false,\n            value: { type: 'reverse', isPreventDestination: null, context: null, isPreventCircleCrop: null } });\n        parent.transform.currFlipState = tempCurrFlipState;\n        parent.notify('transform', { prop: 'setFlipColl', onPropertyChange: false, value: { flipColl: tempFlipColl } });\n        this.lowerContext.filter = 'none';\n        this.updateFlipState();\n        parent.notify('shape', { prop: 'redrawObj', onPropertyChange: false, value: { degree: this.getCurrFlipState() } });\n        parent.notify('freehand-draw', { prop: 'flipFHDColl', onPropertyChange: false,\n            value: { value: this.getCurrFlipState() } });\n        parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n            value: { ctx: this.lowerContext, shape: 'zoom', pen: 'zoom', isPreventApply: null } });\n        this.lowerContext.filter = temp;\n        if ((parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle') || parent.isCircleCrop) {\n            this.cropCircle(this.lowerContext);\n        }\n        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n        parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.upperContext } });\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        parent.notify('transform', { prop: 'setReverseFlip', onPropertyChange: false, value: { isReverseFlip: false } });\n        parent.notify('draw', { prop: 'resetPanPoints', onPropertyChange: false });\n        this.tempFlipPanPoint = { x: 0, y: 0 };\n    };\n    Crop.prototype.cropObjColl = function () {\n        var parent = this.parent;\n        var point;\n        var shape;\n        var obj;\n        if (parent.objColl.length > 0) {\n            for (var i = 0, len = parent.objColl.length; i < len; i++) {\n                obj = parent.objColl[i];\n                point = obj.activePoint;\n                var _a = parent.activeObj.activePoint, startX = _a.startX, startY = _a.startY, width = _a.width, height = _a.height;\n                shape = obj.shape;\n                obj.imageRatio = { startX: ((point.startX - startX) / width),\n                    startY: ((point.startY - startY) / height),\n                    endX: ((point.endX - startX) / width), endY: ((point.endY - startY) / height),\n                    width: width / point.width, height: height / point.height };\n                var degree = void 0;\n                var size = void 0;\n                switch (shape) {\n                    case 'text':\n                        degree = (obj.shapeDegree === 0) ? parent.transform.degree : parent.transform.degree - obj.shapeDegree;\n                        size = (degree === 0 || Math.abs(degree) === 180) ? point.width : point.height;\n                        obj.textSettings.fontRatio = size / obj.textSettings.fontSize;\n                        break;\n                    case 'line':\n                    case 'arrow':\n                        this.cropPointCollection(i);\n                        if (shape === 'arrow') {\n                            parent.notify('shape', { prop: 'updateArrowRatio', onPropertyChange: false, value: { obj: obj } });\n                        }\n                        break;\n                    case 'path':\n                        this.cropPointCollection(i);\n                        break;\n                }\n            }\n        }\n    };\n    Crop.prototype.cropPointCollection = function (i) {\n        var parent = this.parent;\n        var shape = parent.objColl[i].shape;\n        var x;\n        var y;\n        var width;\n        var height;\n        var point = parent.activeObj.activePoint;\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        if (shape === 'path') {\n            x = point.startX;\n            y = point.startY;\n            width = point.width;\n            height = point.height;\n        }\n        else {\n            x = destLeft;\n            y = destTop;\n            width = destWidth;\n            height = destHeight;\n        }\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        var pointColl = parent.objColl[i].pointColl;\n        for (var n = 0, len = pointColl.length; n < len; n++) {\n            pointColl[n].ratioX = (pointColl[n].x - x) / width;\n            pointColl[n].ratioY = (pointColl[n].y - y) / height;\n        }\n    };\n    Crop.prototype.cropFreehandDrawColl = function () {\n        var parent = this.parent;\n        var _a = parent.activeObj.activePoint, startX = _a.startX, startY = _a.startY, width = _a.width, height = _a.height;\n        for (var n = 0; n < parent.freehandCounter; n++) {\n            parent.points = extend([], parent.pointColl[n].points, []);\n            parent.notify('freehand-draw', { prop: 'setPointCounter', onPropertyChange: false, value: { value: 0 } });\n            var len = parent.points.length;\n            for (var l = 0; l < len; l++) {\n                parent.points[l].ratioX = (parent.points[l].x - startX) / width;\n                parent.points[l].ratioY = (parent.points[l].y - startY) / height;\n            }\n        }\n        parent.notify('freehand-draw', { prop: 'updateCropPtsForSel', onPropertyChange: false });\n    };\n    Crop.prototype.resetAnnotations = function () {\n        var parent = this.parent;\n        parent.objColl = [];\n        parent.pointColl = [];\n        parent.freehandCounter = 0;\n        parent.notify('freehand-draw', { prop: 'resetStraightenPoint' });\n    };\n    Crop.prototype.setCurrSelPoints = function (isSetDimension) {\n        var parent = this.parent;\n        parent.allowDownScale = false;\n        var destPoint = this.cropDestPoints;\n        var filter = this.lowerContext.filter;\n        var isCropTab = parent.isCropTab;\n        parent.img = { srcLeft: 0, srcTop: 0, srcWidth: parent.baseImgCanvas.width, srcHeight: parent.baseImgCanvas.height,\n            destLeft: destPoint.startX, destTop: destPoint.startY, destWidth: destPoint.width, destHeight: destPoint.height };\n        var img = parent.img;\n        var currSelPoint = parent.currSelectionPoint;\n        this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        if (isSetDimension) {\n            parent.notify('draw', { prop: 'setDestPoints', onPropertyChange: false });\n        }\n        parent.notify('draw', { prop: 'currTransState', onPropertyChange: false,\n            value: { type: 'initial', isPreventDestination: null, context: null, isPreventCircleCrop: null } });\n        if (this.croppedDegree === 0 && parent.transform.degree === 0 && currSelPoint\n            && currSelPoint.shape !== 'crop-circle' && currSelPoint.shape !== 'crop-square') {\n            img.destLeft = destPoint.startX;\n            img.destTop = destPoint.startY;\n            img.destWidth = destPoint.width;\n            img.destHeight = destPoint.height;\n        }\n        if (parent.transform.degree === 0) {\n            img.destLeft += parent.panPoint.totalPannedInternalPoint.x;\n            img.destTop += parent.panPoint.totalPannedInternalPoint.y;\n        }\n        parent.notify('draw', { prop: 'drawImage', onPropertyChange: false });\n        this.lowerContext.filter = filter;\n        parent.notify('draw', { prop: 'currTransState', onPropertyChange: false,\n            value: { type: 'reverse', isPreventDestination: null, context: null, isPreventCircleCrop: true } });\n        var cropObjColl = extend([], parent.objColl, null, true);\n        var cropPointColl = extend([], parent.pointColl, null, true);\n        var straightenObj = { straightenPoint: null };\n        parent.notify('freehand-draw', { prop: 'getStraightenPoint', onPropertyChange: false,\n            value: { obj: straightenObj } });\n        this.resetAnnotations();\n        if (isNullOrUndefined(parent.activeObj.shape) && parent.cropObj.activeObj.shape) {\n            parent.activeObj = extend({}, parent.cropObj.activeObj, null, true);\n        }\n        this.panToSelRangle();\n        parent.isCropTab = isCropTab;\n        parent.objColl = cropObjColl;\n        parent.pointColl = cropPointColl;\n        parent.freehandCounter = parent.pointColl.length;\n        if (straightenObj['straightenPoint']['x'] && straightenObj['straightenPoint']['y']) {\n            parent.notify('freehand-draw', { prop: 'setStraightenPoint', onPropertyChange: false,\n                value: { x: straightenObj['straightenPoint']['x'], y: straightenObj['straightenPoint']['y'],\n                    ratioX: straightenObj['straightenPoint']['ratioX'], ratioY: straightenObj['straightenPoint']['ratioY'] } });\n        }\n        if (parent.cropObj.activeObj.shape) {\n            var destPoints = { startX: img.destLeft, startY: img.destTop, width: img.destWidth, height: img.destHeight };\n            if (currSelPoint && currSelPoint.activePoint) {\n                var _a = currSelPoint.activePoint, startX = _a.startX, startY = _a.startY, width = _a.width, height = _a.height;\n                img.destLeft = startX;\n                img.destTop = startY;\n                img.destWidth = width;\n                img.destHeight = height;\n            }\n            parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n                value: { ctx: this.lowerContext, shape: 'zoom', pen: 'zoom', isPreventApply: null } });\n            img.destLeft = destPoints.startX;\n            img.destTop = destPoints.startY;\n            img.destWidth = destPoints.width;\n            img.destHeight = destPoints.height;\n            parent.notify('freehand-draw', { prop: 'updateFHDColl', onPropertyChange: false });\n            cropObjColl = extend([], parent.objColl, null, true);\n            cropPointColl = extend([], parent.pointColl, null, true);\n            parent.notify('freehand-draw', { prop: 'getStraightenPoint', onPropertyChange: false, value: { obj: straightenObj } });\n            this.resetAnnotations();\n            var object = { selPointColl: null };\n            parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false, value: { obj: object } });\n            var cropSelPointColl = object['selPointColl'];\n            parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false, value: { obj: { selPointColl: [] } } });\n            parent.cropObj.filter = this.lowerContext.filter;\n            var actObj = extend({}, parent.currSelectionPoint, null, true);\n            parent.notify('draw', { prop: 'setCurrentObj', onPropertyChange: false, value: { obj: null } });\n            parent.activeObj = extend({}, actObj, null, true);\n            var activeObj = extend({}, parent.activeObj, null, true);\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            parent.currSelectionPoint = null;\n            parent.isCircleCrop = false;\n            if (parent.transform.degree !== 0) {\n                if (isNullOrUndefined(parent.activeObj.shape) && parent.cropObj.activeObj.shape) {\n                    parent.activeObj = extend({}, parent.cropObj.activeObj, null, true);\n                }\n                parent.notify('transform', { prop: 'drawPannedImage', value: { xDiff: 0, yDiff: 0 } });\n                parent.panPoint.currentPannedPoint = { x: 0, y: 0 };\n            }\n            parent.objColl = cropObjColl;\n            parent.pointColl = cropPointColl;\n            parent.freehandCounter = parent.pointColl.length;\n            if (straightenObj['straightenPoint']['x'] && straightenObj['straightenPoint']['y']) {\n                parent.notify('freehand-draw', { prop: 'setStraightenPoint', onPropertyChange: false,\n                    value: { x: straightenObj['straightenPoint']['x'], y: straightenObj['straightenPoint']['y'],\n                        ratioX: straightenObj['straightenPoint']['ratioX'], ratioY: straightenObj['straightenPoint']['ratioY'] } });\n            }\n            parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false,\n                value: { obj: { selPointColl: cropSelPointColl } } });\n            parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n                value: { ctx: this.lowerContext, shape: 'iterate', pen: 'iterate', isPreventApply: null } });\n            this.adjustStraightenForShapes('reverse', false);\n            parent.notify('freehand-draw', { prop: 'updateFHDColl', onPropertyChange: false, value: { isPreventApply: true } });\n            parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n                value: { ctx: this.lowerContext, shape: 'zoom', pen: 'zoom', isPreventApply: null } });\n            if (parent.transform.degree === 0) {\n                parent.notify('transform', { prop: 'drawPannImage', onPropertyChange: false,\n                    value: { point: { x: 0, y: 0 } } });\n            }\n            else {\n                if (isNullOrUndefined(parent.activeObj.shape) && parent.cropObj.activeObj.shape) {\n                    parent.activeObj = extend({}, parent.cropObj.activeObj, null, true);\n                }\n                parent.notify('transform', { prop: 'drawPannedImage', value: { xDiff: 0, yDiff: 0 } });\n                parent.panPoint.currentPannedPoint = { x: 0, y: 0 };\n            }\n            parent.activeObj = activeObj;\n            parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate' } });\n            parent.notify('transform', { prop: 'setTempPanMove', onPropertyChange: false,\n                value: { point: null } });\n            if (!this.isInitCrop && parent.transform.degree === 0 && parent.cropObj.currFlipState !== '' &&\n                parent.cropObj.cropZoom !== 0) {\n                this.isInitCrop = true;\n                var obj = { activeObj: null };\n                parent.notify('draw', { prop: 'getStraightenActObj', onPropertyChange: false, value: { obj: obj } });\n                parent.notify('draw', { prop: 'performCancel', value: { isContextualToolbar: null } });\n                parent.notify('draw', { prop: 'setStraightenActObj', onPropertyChange: false, value: { activeObj: obj['activeObj'] } });\n                parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'croptransform',\n                        isApplyBtn: false, isCropping: null, isZooming: null, cType: null } });\n            }\n            else {\n                this.isInitCrop = false;\n            }\n        }\n        else {\n            this.adjustStraightenForShapes('reverse', true);\n            parent.notify('freehand-draw', { prop: 'updateFHDColl', onPropertyChange: false, value: { isPreventApply: true } });\n            var temp = this.lowerContext.filter;\n            this.lowerContext.filter = 'none';\n            parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n                value: { ctx: this.lowerContext, shape: 'iterate', pen: 'iterate', isPreventApply: null } });\n            this.lowerContext.filter = temp;\n            parent.currSelectionPoint = null;\n        }\n        if (document.querySelector('.e-ie-straighten-value-span')) {\n            document.querySelector('.e-ie-straighten-value-span').innerHTML = parent.transform.straighten.toString() + '&#176';\n        }\n    };\n    Crop.prototype.panToSelRangle = function (isReverse) {\n        var parent = this.parent;\n        var pannedPoint = parent.cropObj.totalPannedClientPoint;\n        var panX = parent.transform.degree !== 0 ? isReverse ? -pannedPoint.x : pannedPoint.x : 0;\n        var panY = parent.transform.degree !== 0 ? isReverse ? -pannedPoint.y : pannedPoint.y : 0;\n        if (parent.transform.degree !== 0) {\n            parent.panPoint.currentPannedPoint = { x: panX, y: panY };\n            parent.notify('transform', { prop: 'drawPannedImage', value: { xDiff: panX, yDiff: panY } });\n            parent.panPoint.currentPannedPoint = { x: 0, y: 0 };\n        }\n    };\n    Crop.prototype.cropCircle = function (context, isSave, isFlip) {\n        var parent = this.parent;\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        if (isFlip && parent.transform.currFlipState !== '') {\n            parent.notify('draw', { prop: 'setTransform', onPropertyChange: false,\n                value: { context: context, value: parent.transform.currFlipState, isReverse: null } });\n        }\n        var temp = context.filter;\n        context.filter = 'none';\n        context.globalCompositeOperation = 'destination-in';\n        context.beginPath();\n        var centerX = isNullOrUndefined(isSave) ? destLeft + (destWidth / 2) : context.canvas.width / 2;\n        var centerY = isNullOrUndefined(isSave) ? destTop + (destHeight / 2) : context.canvas.height / 2;\n        var radius = isSave ? context.canvas.width / 2 : destWidth / 2;\n        context.arc(centerX, centerY, radius, 0, Math.PI * 2);\n        context.closePath();\n        context.fill();\n        context.restore();\n        context.globalCompositeOperation = 'source-over';\n        parent.currObjType.isActiveObj = parent.isCircleCrop = true;\n        context.filter = temp;\n        if (isFlip && parent.transform.currFlipState !== '') {\n            parent.notify('draw', { prop: 'setTransform', onPropertyChange: false,\n                value: { context: context, value: parent.transform.currFlipState, isReverse: null } });\n        }\n    };\n    Crop.prototype.getCurrCropState = function () {\n        var parent = this.parent;\n        var flipState = '';\n        var obj = { flipColl: null };\n        parent.notify('transform', { prop: 'getFlipColl', onPropertyChange: false, value: { obj: obj } });\n        flipState = this.getCurrFlipState();\n        if (parent.transform.degree === -90 || parent.transform.degree === -270) {\n            if (flipState === 'horizontal') {\n                flipState = 'vertical';\n            }\n            else if (flipState === 'vertical') {\n                flipState = 'horizontal';\n            }\n        }\n        if (flipState === '') {\n            flipState = obj['flipColl'].length > 1 ? this.getCurrFlipState() : parent.transform.currFlipState;\n        }\n        return flipState;\n    };\n    Crop.prototype.updateRotatePan = function () {\n        var parent = this.parent;\n        if (isNullOrUndefined(parent.panPoint.currentPannedPoint)) {\n            return;\n        }\n        var panRegion = '';\n        var degree = parent.transform.degree;\n        var _a = parent.panPoint.currentPannedPoint, x = _a.x, y = _a.y;\n        if (parent.rotateFlipColl.length > 0 && typeof (parent.rotateFlipColl[0]) === 'number'\n            && degree < 0) {\n            panRegion = this.getCurrCropState();\n        }\n        else {\n            panRegion = this.getCurrFlipState();\n        }\n        if (degree % 90 === 0 && degree % 180 !== 0) {\n            if (degree === 90 || (degree === -90 && (panRegion === 'horizontal' || panRegion === 'vertical'))\n                || (degree === -270 && (panRegion === '' || panRegion === 'verticalHorizontal'\n                    || panRegion === 'horizontalVertical'))) {\n                if (panRegion === 'horizontal' || panRegion === '') {\n                    parent.img.destLeft += y;\n                }\n                else {\n                    parent.img.destLeft -= y;\n                }\n                if (panRegion === '' || panRegion === 'vertical') {\n                    parent.img.destTop -= x;\n                }\n                else {\n                    parent.img.destTop += x;\n                }\n            }\n            else if (degree === 270 || (degree === -270 && (panRegion === 'horizontal' || panRegion === 'vertical'))\n                || (degree === -90 && (panRegion === '' || panRegion === 'verticalHorizontal'\n                    || panRegion === 'horizontalVertical'))) {\n                if (panRegion === '' || panRegion === 'horizontal') {\n                    parent.img.destLeft -= y;\n                }\n                else {\n                    parent.img.destLeft += y;\n                }\n                if (panRegion === '' || panRegion === 'vertical') {\n                    parent.img.destTop += x;\n                }\n                else {\n                    parent.img.destTop -= x;\n                }\n            }\n        }\n        else {\n            if (degree === 180 || degree === -180) {\n                if (panRegion === '' || panRegion === 'vertical') {\n                    parent.img.destLeft -= x;\n                }\n                else {\n                    parent.img.destLeft += x;\n                }\n                if (panRegion === '' || panRegion === 'horizontal') {\n                    parent.img.destTop -= y;\n                }\n                else {\n                    parent.img.destTop += y;\n                }\n            }\n        }\n    };\n    Crop.prototype.crop = function (obj) {\n        var parent = this.parent;\n        var _a = parent.activeObj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY;\n        if (!parent.disabled && parent.isImageLoaded) {\n            var object = { isCropToolbar: parent.isCropToolbar };\n            if (parent.currObjType.isUndoAction && !object['isCropToolbar']) {\n                parent.notify('undo-redo', { prop: 'refreshUrc', value: { bool: null } });\n            }\n            var transitionArgs = { cancel: false, startPoint: { x: startX, y: startY },\n                endPoint: { x: endX, y: endY }, preventScaling: false };\n            if (!object['isCropToolbar']) {\n                parent.trigger('cropping', transitionArgs);\n                parent.editCompleteArgs = transitionArgs;\n            }\n            this.cropEvent(transitionArgs, obj, object);\n        }\n    };\n    Crop.prototype.cropEvent = function (transitionArgs, obj, object) {\n        var parent = this.parent;\n        var splitWords;\n        if (!transitionArgs.cancel) {\n            splitWords = parent.activeObj.shape ? parent.activeObj.shape.split('-') : [];\n            if (!parent.disabled && parent.activeObj.horTopLine && (parent.currObjType.isCustomCrop || (splitWords.length > 0 &&\n                splitWords[0] === 'crop'))) {\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                obj.isCrop = true;\n                var prevCropObj = extend({}, parent.cropObj, {}, true);\n                var prevObj = extend({}, this.prevCropCurrObj, {}, true);\n                if (transitionArgs.preventScaling) {\n                    this.isPreventScaling = true;\n                }\n                else {\n                    this.isPreventScaling = false;\n                }\n                this.cropImg();\n                if (this.isPreventScaling) {\n                    parent.aspectWidth = parent.img.destWidth;\n                    parent.aspectHeight = parent.img.destHeight;\n                }\n                parent.notify('freehand-draw', { prop: 'resetStraightenPoint' });\n                parent.isCropTab = false;\n                parent.transform.zoomFactor = 0;\n                parent.setProperties({ zoomSettings: { zoomFactor: 1 } }, true);\n                parent.notify('transform', { prop: 'setPreviousZoomValue', onPropertyChange: false,\n                    value: { previousZoomValue: parent.zoomSettings.zoomFactor } });\n                if (!Browser.isDevice) {\n                    this.updateUndoRedoColl(prevObj, prevCropObj, object);\n                }\n                parent.notify('transform', { prop: 'setCropDimension', onPropertyChange: false,\n                    value: { width: parent.cropObj.destPoints.width, height: parent.cropObj.destPoints.height } });\n                var aspectIcon = parent.element.querySelector('#' + parent.element.id + '_aspectratio');\n                var nonAspectIcon = parent.element.querySelector('#' + parent.element.id + '_nonaspectratio');\n                parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: false } });\n                if (!object['isCropToolbar'] && (isNullOrUndefined(aspectIcon) && isNullOrUndefined(nonAspectIcon))) {\n                    parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'main',\n                            isApplyBtn: false, isCropping: false, isZooming: null, cType: null } });\n                }\n                this.resizeWrapper();\n                if (Browser.isDevice) {\n                    this.updateUndoRedoColl(prevObj, prevCropObj, object);\n                }\n            }\n        }\n    };\n    Crop.prototype.updateUndoRedoColl = function (prevObj, prevCropObj, object) {\n        var parent = this.parent;\n        var currSelPtObj = { prevCurrSelectionPoint: parent.prevCurrSelectionPoint };\n        prevObj.currSelectionPoint = extend({}, currSelPtObj['prevCurrSelectionPoint'], {}, true);\n        parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n            value: { operation: 'crop', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                previousCropObj: prevCropObj, previousText: null,\n                currentText: null, previousFilter: null, isCircleCrop: parent.isCircleCrop } });\n        if (!object['isCropToolbar']) {\n            parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n        }\n    };\n    Crop.prototype.resizeWrapper = function () {\n        var parent = this.parent;\n        if (Browser.isDevice) {\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            var elem = parent.element;\n            var ctxToolbar = elem.querySelector('#' + elem.id + '_contextualToolbarArea');\n            if (ctxToolbar && ctxToolbar.style.position === '' && !this.isTransformCrop) {\n                ctxToolbar.style.position = 'absolute';\n                parent.isStraightening = false;\n                parent.update();\n                parent.notify('filter', { prop: 'setAdjustmentValue', value: { adjustmentValue: parent.canvasFilter } });\n            }\n        }\n    };\n    Crop.prototype.calcRatio = function (obj, dimension) {\n        var parent = this.parent;\n        var degree = parent.transform.degree;\n        var _a = parent.img, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        var _b = dimension || parent.baseImgCanvas, width = _b.width, height = _b.height;\n        var widthRatio = (degree === 0 || degree % 180 === 0) ? width / destWidth : height / destWidth;\n        var heightRatio = (degree === 0 || degree % 180 === 0) ? height / destHeight : width / destHeight;\n        if (obj) {\n            obj['width'] = widthRatio;\n            obj['height'] = heightRatio;\n        }\n        return { width: widthRatio, height: heightRatio };\n    };\n    Crop.prototype.getCurrFlipState = function (panObj) {\n        var parent = this.parent;\n        var obj = { panRegion: '' };\n        var object = { collection: parent.rotateFlipColl };\n        parent.notify('shape', { prop: 'alignRotateFlipColl', onPropertyChange: false,\n            value: { collection: parent.rotateFlipColl, isRotateFlipCollection: true, obj: object } });\n        parent.rotateFlipColl = object['collection'];\n        for (var i = 0, len = parent.rotateFlipColl.length; i < len; i++) {\n            parent.notify('transform', { prop: 'setCurrPanRegion', onPropertyChange: false,\n                value: { region: obj['panRegion'], type: parent.rotateFlipColl[i], obj: obj } });\n        }\n        if (panObj) {\n            panObj['panRegion'] = obj['panRegion'];\n        }\n        return obj['panRegion'];\n    };\n    return Crop;\n}());\nexport { Crop };\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\n/* eslint-disable no-constant-condition */\n/* eslint-disable radix */\nimport { extend, isNullOrUndefined, Browser, getComponent } from '@syncfusion/ej2-base';\nimport { Dialog, hideSpinner, showSpinner } from '@syncfusion/ej2-popups';\nvar Draw = /** @class */ (function () {\n    function Draw(parent) {\n        this.isInitialLoading = false; // Specifies whether image is loaded for the first time or not (for applying initial filter)\n        this.fileName = '';\n        this.isErrorImage = false;\n        this.isShapeTextInserted = false;\n        this.isRotateZoom = false; // To restore zoomed image on selection crop selection\n        this.tempStrokeSettings = { strokeColor: '#fff', fillColor: '', strokeWidth: null, outlineColor: '', radius: null, outlineWidth: null }; // restore stroke settings on cancel\n        this.tempTextSettings = { text: 'Enter Text', fontFamily: '', fontSize: null, fontRatio: null, bold: false, italic: false, underline: false }; // restore text settings on cancel\n        this.tempAdjValue = ''; // for temp internal slider value\n        this.tempFilter = ''; // restore filter style on cancel\n        this.tempUndoRedoStep = 0;\n        this.tempFreehandCounter = 0;\n        this.tempCurrFhdIndex = 0;\n        this.tempZoomFactor = null; // Restore zoom factor on cancel\n        this.isCancelAction = false;\n        this.rotatedFlipCropSel = false;\n        this.zoomCrop = { width: 0, height: 0 };\n        this.isImageEdited = false;\n        this.isFileChanged = false;\n        this.isNewPath = false;\n        this.isResizeSelect = false;\n        this.arrowDimension = { bar: { width: 10, height: 32, ratioX: null, ratioY: null },\n            arrow: { width: 24, height: 24, ratioX: null, ratioY: null }, arrowSolid: { width: 32, height: 32, ratioX: null, ratioY: null },\n            circle: { width: 10, height: 10, ratioX: null, ratioY: null }, square: { width: 20, height: 20, ratioX: null, ratioY: null } };\n        this.origDim = { width: 0, height: 0 };\n        this.isImageApply = false;\n        this.imgCanvasPoints = [];\n        this.isCropSelect = false;\n        this.isDownScale = false;\n        this.preventStraightening = false;\n        this.tempObjColl = [];\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        this.tempPointColl = {};\n        this.imageBackgroundColor = '';\n        this.allowRedactStraighten = true;\n        this.parent = parent;\n        this.addEventListener();\n    }\n    Draw.prototype.destroy = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.removeEventListener();\n    };\n    Draw.prototype.addEventListener = function () {\n        this.parent.on('draw', this.draw, this);\n        this.parent.on('destroyed', this.destroy, this);\n    };\n    Draw.prototype.removeEventListener = function () {\n        this.parent.off('draw', this.draw);\n        this.parent.off('destroyed', this.destroy);\n    };\n    Draw.prototype.draw = function (args) {\n        this.updatePrivateVariables();\n        switch (args.prop) {\n            case 'drawObject':\n                this.drawObject(args.value['canvas'], args.value['obj'], args.value['isCropRatio'], args.value['points'], args.value['isPreventDrag'], args.value['saveContext'], args.value['isPreventSelection']);\n                break;\n            case 'updateActiveObject':\n                this.updateActiveObject(args.value['actPoint'], args.value['obj'], args.value['isMouseMove'], args.value['x'], args.value['y']);\n                break;\n            case 'clearOuterCanvas':\n                this.clearOuterCanvas(args.value['context']);\n                break;\n            case 'setDestPoints':\n                this.setDestPoints();\n                break;\n            case 'updateCurrTransState':\n                this.updateCurrTransState(args.value['type'], args.value['isPreventDestination'], args.value['isRotatePan']);\n                break;\n            case 'currTransState':\n                this.currTransState(args.value['type'], args.value['isPreventDestination'], args.value['context'], args.value['isPreventCircleCrop']);\n                break;\n            case 'setTransform':\n                this.setTransform(args.value['context'], args.value['value'], args.value['isReverse']);\n                break;\n            case 'render-image':\n                this.renderImage(args.value['isMouseWheel'], args.value['isPreventClearRect'], args.value['isFrame'], args.value['isStraighten']);\n                break;\n            case 'draw-image-to-canvas':\n                this.drawImgToCanvas(args.value['dimension']);\n                break;\n            case 'update-canvas':\n                this.updateCanvas();\n                break;\n            case 'performCancel':\n                this.performCancel(args.value['isContextualToolbar'], args.value['isUndoRedo'], args.value['isFinalCancel']);\n                break;\n            case 'updateFlipPan':\n                this.updateFlipPan(args.value['tempSelectionObj']);\n                break;\n            case 'select':\n                this.select(args.value['type'], args.value['startX'], args.value['startY'], args.value['width'], args.value['height']);\n                break;\n            case 'callUpdateCurrTransState':\n                this.callUpdateCurrTransState();\n                break;\n            case 'resetPanPoints':\n                this.resetPanPoints();\n                break;\n            case 'setClientTransDim':\n                this.setClientTransDim(args.value['isPreventDimension']);\n                break;\n            case 'redrawImgWithObj':\n                this.redrawImgWithObj();\n                break;\n            case 'setCurrentObj':\n                this.setCurrentObj(args.value['obj'], args.value['isUndoRedo'], args.value['isCircleCrop']);\n                break;\n            case 'performPointZoom':\n                this.performPointZoom(args.value['x'], args.value['y'], args.value['type'], args.value['isResize']);\n                break;\n            case 'open':\n                this.open(args.value['data']);\n                break;\n            case 'isInitialLoading':\n                this.isInitialLoading = args.value['isInitialLoading'];\n                break;\n            case 'isInitialLoaded':\n                this.getInitialLoaded(args.value['object']);\n                break;\n            case 'fileSelect':\n                this.fileSelect(args.value['inputElement'], args.value['args']);\n                break;\n            case 'getFileName':\n                args.value['obj']['fileName'] = this.fileName;\n                args.value['obj']['fileType'] = this.fileType;\n                break;\n            case 'getErrorImage':\n                args.value['obj']['isErrorImage'] = this.isErrorImage;\n                break;\n            case 'getInitialZoomValue':\n                args.value['obj']['initialZoomValue'] = this.initZoomValue;\n                break;\n            case 'setShapeTextInsert':\n                this.isShapeTextInserted = args.value['bool'];\n                break;\n            case 'resetCurrentSelectionPoint':\n                this.currSelPoint = null;\n                break;\n            case 'setRotateZoom':\n                this.isRotateZoom = args.value['isRotateZoom'];\n                break;\n            case 'setTempStrokeSettings':\n                this.tempStrokeSettings = args.value['tempStrokeSettings'];\n                break;\n            case 'setTempTextSettings':\n                this.tempTextSettings = args.value['tempTextSettings'];\n                break;\n            case 'setTempAdjustmentValue':\n                this.tempAdjValue = args.value['tempAdjustmentValue'];\n                break;\n            case 'getTempAdjustmentValue':\n                args.value['obj']['value'] = this.tempAdjValue;\n                break;\n            case 'setTempFilter':\n                this.tempFilter = args.value['tempFilter'];\n                break;\n            case 'setTempUndoRedoStep':\n                this.tempUndoRedoStep = args.value['tempUndoRedoStep'];\n                break;\n            case 'setTempFreehandCounter':\n                this.tempFreehandCounter = args.value['tempFreehandCounter'];\n                break;\n            case 'setTempCurrentFreehandDrawIndex':\n                this.tempCurrFhdIndex = args.value['tempCurrentFreehandDrawIndex'];\n                break;\n            case 'setTempZoomFactor':\n                this.tempZoomFactor = args.value['tempZoomFactor'];\n                break;\n            case 'setCancelAction':\n                this.isCancelAction = args.value['bool'];\n                break;\n            case 'getRotatedFlipCropSelection':\n                args.value['bool']['isSelected'] = this.rotatedFlipCropSel;\n                break;\n            case 'getPrevActObj':\n                args.value['obj']['prevActObj'] = this.prevActObj;\n                break;\n            case 'setPrevActObj':\n                this.prevActObj = args.value['prevActObj'];\n                break;\n            case 'setZoomCropWidth':\n                this.zoomCrop.width = args.value['width'];\n                this.zoomCrop.height = args.value['height'];\n                break;\n            case 'setImageEdited':\n                this.isImageEdited = true;\n                break;\n            case 'reset':\n                this.reset();\n                break;\n            case 'setNewPath':\n                this.isNewPath = args.value['bool'];\n                break;\n            case 'getNewPath':\n                args.value['obj']['isNewPath'] = this.isNewPath;\n                break;\n            case 'getArrowDimension':\n                args.value['obj']['arrowDimension'] = extend({}, this.arrowDimension, {}, true);\n                break;\n            case 'setArrowDimension':\n                this.arrowDimension = args.value['arrowDimension'];\n                break;\n            case 'moveToSelectionRange':\n                this.moveToSelectionRange(args.value['type'], args.value['activeObj']);\n                break;\n            case 'setResizeSelect':\n                this.isResizeSelect = args.value['bool'];\n                break;\n            case 'applyFrame':\n                this.applyFrame(args.value['ctx'], args.value['frame'], args.value['preventImg']);\n                break;\n            case 'drawImage':\n                this.drawImage();\n                break;\n            case 'downScaleImgCanvas':\n                this.downScaleImgCanvas(args.value['ctx'], args.value['isImgAnnotation'], args.value['isHFlip'], args.value['isVFlip']);\n                break;\n            case 'downScale':\n                this.downScale(args.value['canvas'], args.value['width'], args.value['height']);\n                break;\n            case 'resetFrameZoom':\n                this.resetFrameZoom(args.value['isOk']);\n                break;\n            case 'triggerFrameChange':\n                args.value['obj']['frameChangeEventArgs'] = this.triggerFrameChange(args.value['prevFrameSettings']);\n                break;\n            case 'setImageApply':\n                this.isImageApply = args.value['bool'];\n                break;\n            case 'zoomToSel':\n                this.zoomToSel(args.value['activeObj'], args.value['isToolbar']);\n                break;\n            case 'getStraightenActObj':\n                args.value['obj']['activeObj'] = this.straightenActObj;\n                break;\n            case 'setStraightenActObj':\n                this.straightenActObj = args.value['activeObj'];\n                break;\n            case 'updateImgCanvasPoints':\n                this.updateImgCanvasPoints();\n                break;\n            case 'isLinesIntersect':\n                args.value['obj']['isIntersect'] = this.isLinesIntersect(args.value['obj']);\n                break;\n            case 'getImageCanvasPoints':\n                args.value['obj']['points'] = this.imgCanvasPoints;\n                break;\n            case 'setDestForStraighten':\n                this.setDestForStraighten();\n                break;\n            case 'setTempDestForStraighten':\n                this.tempStraightenDestPoints = extend({}, this.straightenDestPoints, {}, true);\n                break;\n            case 'getStraightenInitZoom':\n                args.value['obj']['zoomFactor'] = this.straightenInitZoom;\n                break;\n            case 'setStraightenInitZoom':\n                this.straightenInitZoom = args.value['zoomFactor'];\n                break;\n            case 'isPointsInsideImg':\n                args.value['obj']['bool'] = this.checkPointPosition(args.value['x'], args.value['y'], this.imgCanvasPoints[0].x, this.imgCanvasPoints[0].y, this.imgCanvasPoints[1].x, this.imgCanvasPoints[1].y, this.imgCanvasPoints[2].x, this.imgCanvasPoints[2].y, this.imgCanvasPoints[3].x, this.imgCanvasPoints[3].y) !== 'inside';\n                break;\n            case 'setIsCropSelect':\n                this.isCropSelect = args.value['bool'];\n                break;\n            case 'updateCropSelection':\n                this.updateCropSelection();\n                break;\n            case 'updateCropSelObj':\n                this.updateCropSelObj();\n                break;\n            case 'redrawDownScale':\n                this.redrawDownScale();\n                break;\n            case 'updateFinetune':\n                this.updateFinetune();\n                break;\n            case 'isSelOutsideImg':\n                args.value['obj']['bool'] = this.isSelOutsideImg();\n                break;\n            case 'resetStraightenDestPoints':\n                this.straightenDestPoints = null;\n                break;\n            case 'checkPointPosition':\n                args.value['obj']['position'] = this.checkPointPosition(args.value['obj']['x'], args.value['obj']['y'], args.value['obj']['x1'], args.value['obj']['y1'], args.value['obj']['x2'], args.value['obj']['y2'], args.value['obj']['x3'], args.value['obj']['y3'], args.value['obj']['x4'], args.value['obj']['y4']);\n                break;\n            case 'updateTempObjColl':\n                this.tempObjColl = extend([], this.parent.objColl, [], true);\n                break;\n            case 'resetTempObjColl':\n                this.tempObjColl = null;\n                break;\n            case 'updateTempPointColl':\n                this.tempPointColl = extend({}, this.parent.pointColl, {}, true);\n                break;\n            case 'resetTempPointColl':\n                this.tempPointColl = {};\n                break;\n            case 'showDialogPopup':\n                this.showDialogPopup();\n                break;\n            case 'imageBackgroundColor':\n                this.imageBackgroundColor = args.value['color'];\n                break;\n            case 'getImageBackgroundColor':\n                args.value['obj']['color'] = this.imageBackgroundColor;\n                break;\n            case 'setTempStrokeWidth':\n                this.tempStrokeWidth = args.value['strokeWidth'];\n                break;\n        }\n    };\n    Draw.prototype.getModuleName = function () {\n        return 'draw';\n    };\n    Draw.prototype.updatePrivateVariables = function () {\n        var parent = this.parent;\n        if (parent.lowerCanvas) {\n            this.lowerContext = parent.lowerCanvas.getContext('2d');\n        }\n        if (parent.upperCanvas) {\n            this.upperContext = parent.upperCanvas.getContext('2d');\n        }\n        if (isNullOrUndefined(this.tempZoomFactor)) {\n            this.tempZoomFactor = parent.transform.zoomFactor;\n        }\n        if (this.tempTextSettings.fontFamily === '') {\n            this.tempTextSettings.fontFamily = parent.fontFamily.default;\n        }\n    };\n    Draw.prototype.reset = function () {\n        this.isInitialLoading = this.isErrorImage = this.isNewPath = this.isResizeSelect = false;\n        this.isShapeTextInserted = false;\n        this.isImageApply = false;\n        this.initZoomValue = null;\n        this.tempFilter = '';\n        this.origDim = { width: 0, height: 0 };\n        this.currSelPoint = null;\n        this.isRotateZoom = false;\n        this.tempAdjValue = '';\n        this.tempStrokeSettings = { strokeColor: '#fff', fillColor: '', strokeWidth: null, radius: null, outlineColor: '', outlineWidth: null };\n        this.tempTextSettings =\n            { text: 'Enter Text', fontFamily: this.parent.fontFamily.default, fontSize: null, fontRatio: null, bold: false, italic: false, underline: false };\n        this.tempUndoRedoStep = this.tempFreehandCounter = this.tempCurrFhdIndex = 0;\n        this.tempZoomFactor = null;\n        this.isCancelAction = false;\n        this.rotatedFlipCropSel = false;\n        this.prevActObj = null;\n        this.tempStraightenDestPoints = null;\n        this.arrowDimension = { bar: { width: 10, height: 32, ratioX: null, ratioY: null },\n            arrow: { width: 24, height: 24, ratioX: null, ratioY: null }, arrowSolid: { width: 32, height: 32, ratioX: null, ratioY: null },\n            circle: { width: 10, height: 10, ratioX: null, ratioY: null }, square: { width: 20, height: 20, ratioX: null, ratioY: null } };\n        this.straightenActObj = null;\n        this.imgCanvasPoints = [];\n        this.straightenInitZoom = null;\n        this.allowRedactStraighten = true;\n        this.tempObjColl = [];\n        this.tempPointColl = {};\n        this.imageBackgroundColor = '';\n        this.tempStrokeWidth = null;\n        this.straightenDestPoints = null;\n        this.isCropSelect = this.isDownScale = this.preventStraightening = false;\n    };\n    Draw.prototype.redrawDownScale = function () {\n        var parent = this.parent;\n        if (parent.transform.zoomFactor && parent.transform.zoomFactor < 0) {\n            var activeObj = extend({}, parent.activeObj, {}, true);\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            this.isDownScale = true;\n            this.renderImage();\n            this.isDownScale = false;\n            if (activeObj.shape) {\n                this.drawObject('duplicate', activeObj);\n            }\n        }\n    };\n    Draw.prototype.updateFinetune = function () {\n        var parent = this.parent;\n        if (parent.transform.zoomFactor && parent.transform.zoomFactor < 0) {\n            var filter = this.lowerContext.filter;\n            this.lowerContext.filter = 'none';\n            parent.notify('draw', { prop: 'redrawDownScale' });\n            var inMemoryContext = parent.inMemoryCanvas.getContext('2d');\n            var ctx = this.lowerContext;\n            var imageData = ctx.getImageData(0, 0, ctx.canvas.width, ctx.canvas.height);\n            parent.inMemoryCanvas.width = imageData.width;\n            parent.inMemoryCanvas.height = imageData.height;\n            inMemoryContext.putImageData(imageData, 0, 0);\n            this.lowerContext.filter = filter;\n            parent.notify('draw', { prop: 'redrawDownScale' });\n        }\n    };\n    Draw.prototype.drawImage = function () {\n        this.applyFrame(this.lowerContext, this.parent.frameObj.type);\n    };\n    Draw.prototype.drawObject = function (canvas, obj, isCropRatio, points, isPreventDrag, saveContext, isPreventSelection) {\n        var parent = this.parent;\n        var actObj = parent.activeObj;\n        var actPoint = parent.activeObj.activePoint;\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        var canvasDraw;\n        canvas = canvas.toLowerCase();\n        if (canvas === 'original') {\n            canvasDraw = this.lowerContext;\n        }\n        else if (canvas === 'duplicate') {\n            canvasDraw = this.upperContext;\n        }\n        else if (saveContext) {\n            canvasDraw = saveContext;\n        }\n        if (!isPreventDrag && actObj.shape) {\n            this.setDragLimit();\n        }\n        if (parent.currObjType.shape) {\n            var splitWords = parent.currObjType.shape.split('-');\n            if (splitWords[0].toLowerCase() === 'crop' && isCropRatio) {\n                this.drawCropRatio();\n            }\n        }\n        actObj = parent.activeObj;\n        actPoint = parent.activeObj.activePoint;\n        if (isNullOrUndefined(actObj.strokeSettings)) {\n            var obj_1 = { strokeSettings: {} };\n            parent.notify('shape', { prop: 'getStrokeSettings', onPropertyChange: false, value: { obj: obj_1 } });\n            actObj.strokeSettings = obj_1['strokeSettings'];\n        }\n        if (isNullOrUndefined(actObj.strokeSettings.strokeWidth)) {\n            actObj.strokeSettings.strokeWidth = 2;\n        }\n        if (obj) {\n            parent.activeObj = extend({}, obj, {}, true);\n        }\n        if (points && points.startX && points.startY && points.endX && points.endY && points.width && points.height) {\n            actPoint.startX = points.startX;\n            actPoint.startY = points.startY;\n            actPoint.endX = points.endX;\n            actPoint.endY = points.endY;\n            actPoint.width = points.width;\n            actPoint.height = points.height;\n        }\n        this.updateActiveObject();\n        actObj = parent.activeObj;\n        actPoint = parent.activeObj.activePoint;\n        if (isNullOrUndefined(actPoint.startX) && isNullOrUndefined(actPoint.startY)) {\n            return;\n        }\n        if (parent.currObjType.isText) {\n            var obj_2 = { keyHistory: '' };\n            parent.notify('shape', { prop: 'getKeyHistory', onPropertyChange: false, value: { obj: obj_2 } });\n            actObj.keyHistory = obj_2['keyHistory'];\n        }\n        var isCrop = false;\n        if (canvas !== 'original') {\n            var splitWords = void 0;\n            if (actObj.shape) {\n                splitWords = actObj.shape.split('-');\n                if (splitWords[0] === 'crop') {\n                    isCrop = true;\n                }\n            }\n            if (isCrop) {\n                if (points && points.startX && points.startY && points.endX && points.endY && points.width && points.height) {\n                    actPoint.startX = points.startX;\n                    actPoint.startY = points.startY;\n                    actPoint.endX = points.endX;\n                    actPoint.endY = points.endY;\n                    actPoint.width = points.width;\n                    actPoint.height = points.height;\n                }\n                else {\n                    actPoint = actObj.activePoint;\n                }\n                this.upperContext.fillStyle = 'rgb(0, 0, 0, 0.25)';\n                this.upperContext.fillRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n                this.upperContext.clearRect(actPoint.startX, actPoint.startY, actPoint.width, actPoint.height);\n            }\n            if (isNullOrUndefined(isPreventSelection) && (canvasDraw === this.lowerContext || canvasDraw === this.upperContext)) {\n                this.rotateContext('initial', canvasDraw);\n                this.drawOuterSelection(canvasDraw);\n                this.rotateContext('reverse', canvasDraw);\n            }\n        }\n        parent.currObjType.isActiveObj = true;\n        var object = { keyHistory: '' };\n        parent.notify('shape', { prop: 'getKeyHistory', onPropertyChange: false, value: { obj: object } });\n        if (obj) {\n            this.drawShapeObj(canvas, obj.shape, saveContext, isPreventSelection);\n        }\n        else if (object['keyHistory'] !== '' && parent.currObjType.isText) {\n            this.drawShapeObj(canvas, 'text', saveContext, isPreventSelection);\n        }\n        else if (actObj.shape) {\n            this.drawShapeObj(canvas, actObj.shape, saveContext, isPreventSelection);\n        }\n        else {\n            this.drawShapeObj(canvas, undefined, saveContext, isPreventSelection);\n        }\n        if (canvas === 'duplicate' && isCrop && actObj.shape !== 'crop-circle' && parent.frameObj.type !== 'none') {\n            this.applyFrame(this.upperContext, parent.frameObj.type);\n            this.drawCornerCircles(this.upperContext);\n        }\n    };\n    Draw.prototype.rotateContext = function (type, ctx) {\n        var parent = this.parent;\n        var _a = parent.activeObj, shape = _a.shape, rotatedAngle = _a.rotatedAngle;\n        var _b = parent.img, destLeft = _b.destLeft, destTop = _b.destTop, destWidth = _b.destWidth, destHeight = _b.destHeight;\n        var _c = parent.activeObj.activePoint, startX = _c.startX, startY = _c.startY, width = _c.width, height = _c.height;\n        if (shape === 'line' || shape === 'arrow') {\n            return;\n        }\n        var rotationAngle = (type === 'initial') ? rotatedAngle : -rotatedAngle;\n        var translateX;\n        var translateY;\n        if (parent.transform.straighten === 0 && !parent.isCropTab) {\n            translateX = startX + (width / 2);\n            translateY = startY + (height / 2);\n        }\n        else {\n            translateX = destLeft + (destWidth / 2);\n            translateY = destTop + (destHeight / 2);\n        }\n        ctx.translate(translateX, translateY);\n        ctx.rotate(rotationAngle);\n        ctx.translate(-translateX, -translateY);\n    };\n    Draw.prototype.setDragLimit = function () {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var _a = parent.activeObj, shape = _a.shape, rotatedAngle = _a.rotatedAngle;\n        if (actPoint && shape !== 'image' && shape !== 'line' && rotatedAngle === 0 && parent.activeObj.preventShapeDragOut) {\n            var _b = parent.img, destLeft = _b.destLeft, destTop = _b.destTop, destWidth = _b.destWidth, destHeight = _b.destHeight;\n            if (actPoint.startX < destLeft) {\n                actPoint.startX = destLeft;\n                actPoint.endX = Math.min(actPoint.startX + actPoint.width, destLeft + destWidth);\n            }\n            else if (actPoint.endX > destLeft + destWidth) {\n                actPoint.endX = destLeft + destWidth;\n                actPoint.startX = Math.max(actPoint.endX - actPoint.width, destLeft);\n            }\n            if (actPoint.startY < destTop) {\n                actPoint.startY = destTop;\n            }\n            else if (actPoint.endY > destTop + destHeight) {\n                actPoint.endY = destTop + destHeight;\n                actPoint.startY = Math.max(actPoint.endY - actPoint.height, destTop);\n            }\n            parent.activeObj = this.updateWidthHeight(parent.activeObj);\n        }\n    };\n    Draw.prototype.drawCropRatio = function () {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var x;\n        var y;\n        var width;\n        var height;\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        if (parent.transform.zoomFactor > 0 && this.currSelPoint) {\n            var activeObj = extend({}, parent.activeObj, {}, true);\n            this.drawCustomSelection('crop-custom', null, null, null, null);\n            if (parent.transform.straighten !== 0) {\n                actPoint = parent.activeObj.activePoint;\n            }\n            if (parent.transform.degree % 90 === 0 && parent.transform.degree % 180 !== 0) {\n                width = actPoint.width < actPoint.height ? actPoint.width : actPoint.height;\n                height = width;\n            }\n            else {\n                width = actPoint.width;\n                height = actPoint.height;\n            }\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            parent.activeObj = activeObj;\n            parent.currObjType.shape = activeObj.shape;\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            parent.currObjType.isCustomCrop = false;\n        }\n        else {\n            width = destWidth;\n            height = destHeight;\n            if (destLeft < 0) {\n                width += destLeft;\n            }\n            if (destTop < 0) {\n                height += destTop;\n            }\n            if (destLeft + destWidth > parent.lowerCanvas.width) {\n                width -= (destLeft + destWidth - parent.lowerCanvas.width);\n            }\n            if (destTop + destHeight > parent.lowerCanvas.height) {\n                height -= (destTop + destHeight - parent.lowerCanvas.height);\n            }\n        }\n        switch (parent.currObjType.shape.toLowerCase()) {\n            case 'crop-square':\n            case 'crop-circle':\n                parent.notify('selection', { prop: 'setDragDirection', onPropertyChange: false, value: { width: width, height: height } });\n                actPoint = parent.activeObj.activePoint;\n                if (parent.lowerCanvas.width < (actPoint.endX - actPoint.startX)) {\n                    actPoint.startX = 7.5;\n                    actPoint.endX = parent.lowerCanvas.width - 7.5;\n                }\n                if (parent.lowerCanvas.height < (actPoint.endY - actPoint.startY)) {\n                    actPoint.startY = 7.5;\n                    actPoint.endY = parent.lowerCanvas.height - 7.5;\n                }\n                if (width === destWidth && height === destHeight) {\n                    actPoint.startX += destLeft;\n                    actPoint.startY += destTop;\n                    actPoint.endX += destLeft;\n                    actPoint.endY += destTop;\n                }\n                if (parent.lowerCanvas.width > parent.lowerCanvas.height) {\n                    actPoint.height = actPoint.endY - actPoint.startY;\n                    actPoint.width = actPoint.height;\n                    actPoint.endX = actPoint.startX + actPoint.width;\n                }\n                else {\n                    actPoint.width = actPoint.endX - actPoint.startX;\n                    actPoint.height = actPoint.width;\n                    actPoint.endY = actPoint.startY + actPoint.height;\n                }\n                break;\n            case 'crop-3:2':\n                x = 3;\n                y = 2;\n                break;\n            case 'crop-4:3':\n                x = 4;\n                y = 3;\n                break;\n            case 'crop-5:4':\n                x = 5;\n                y = 4;\n                break;\n            case 'crop-7:5':\n                x = 7;\n                y = 5;\n                break;\n            case 'crop-16:9':\n                x = 16;\n                y = 9;\n                break;\n            case 'crop-2:3':\n                x = 2;\n                y = 3;\n                break;\n            case 'crop-3:4':\n                x = 3;\n                y = 4;\n                break;\n            case 'crop-4:5':\n                x = 4;\n                y = 5;\n                break;\n            case 'crop-5:7':\n                x = 5;\n                y = 7;\n                break;\n            case 'crop-9:16':\n                x = 9;\n                y = 16;\n                break;\n            default:\n                x = parseInt(parent.currObjType.shape.toLowerCase().split('crop-')[1].split(':')[0]);\n                y = parseInt(parent.currObjType.shape.toLowerCase().split('crop-')[1].split(':')[1]);\n                break;\n        }\n        if (x !== undefined && y !== undefined) {\n            parent.notify('selection', { prop: 'calcShapeRatio', onPropertyChange: false,\n                value: { x: x, y: y, imgWidth: width, imgHeight: height } });\n            if (width === destWidth && height === destHeight) {\n                this.updatePoints();\n            }\n            actPoint = parent.activeObj.activePoint;\n        }\n        if (actPoint.startX < destLeft) {\n            var diff = (destLeft - actPoint.startX) + 7.5;\n            actPoint.startX += diff;\n            actPoint.endX += diff;\n        }\n        if (actPoint.startY < destTop) {\n            var diff = (destTop - actPoint.startY) + 7.5;\n            actPoint.startY += diff;\n            actPoint.endY += diff;\n        }\n        parent.activeObj = this.updateWidthHeight(parent.activeObj);\n        this.adjToCenter();\n        this.enlargeToImg();\n        if (parent.transform.straighten !== 0) {\n            this.adjToStraighten();\n            this.updateActiveObject(parent.activeObj.activePoint, parent.activeObj);\n        }\n        var object = { isIntersect: null, arr: null };\n        var count = 0;\n        actPoint = parent.activeObj.activePoint;\n        if (parent.transform.straighten !== 0) {\n            while (this.isLinesIntersect(object) && count < 100) {\n                count++;\n                var diff = (actPoint.width * 1) / 100;\n                actPoint.startX += diff;\n                actPoint.endX -= diff;\n                diff = (actPoint.height * 1) / 100;\n                actPoint.startY += diff;\n                actPoint.endY -= diff;\n                actPoint.width = actPoint.endX - actPoint.startX;\n                actPoint.height = actPoint.endY - actPoint.startY;\n                this.updateActiveObject(actPoint, parent.activeObj);\n            }\n        }\n        this.straightenInitZoom = parent.transform.zoomFactor;\n        this.straightenActObj = extend({}, parent.activeObj, {}, true);\n        parent.notify('draw', { prop: 'resetStraightenDestPoints' });\n        parent.notify('draw', { prop: 'setDestForStraighten' });\n    };\n    Draw.prototype.adjToCenter = function () {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        var diffX = ((parent.lowerCanvas.width) / 2) - (actPoint.endX - actPoint.width / 2);\n        var diffY = ((parent.lowerCanvas.height) / 2) - (actPoint.endY - actPoint.height / 2);\n        actPoint.startX += diffX;\n        actPoint.endX += diffX;\n        actPoint.startY += diffY;\n        actPoint.endY += diffY;\n        if (actPoint.startX < (destLeft >= 7.5 ? destLeft : 7.5)) {\n            var diff = ((destLeft >= 7.5 ? destLeft : 0) - actPoint.startX);\n            actPoint.startX += diff;\n            actPoint.endX += diff;\n        }\n        else if (actPoint.endX > destLeft + destWidth) {\n            var diff = (actPoint.endX - (destLeft + destWidth));\n            actPoint.startX -= diff;\n            actPoint.endX -= diff;\n        }\n        if (actPoint.startY < (destTop >= 7.5 ? destTop : 7.5)) {\n            var diff = ((destTop >= 7.5 ? destTop : 0) - actPoint.startY);\n            actPoint.startY += diff;\n            actPoint.endY += diff;\n        }\n        else if (actPoint.endY > destTop + destHeight) {\n            var diff = (actPoint.endY - (destTop + destHeight));\n            actPoint.startY -= diff;\n            actPoint.endY -= diff;\n        }\n    };\n    Draw.prototype.enlargeToImg = function () {\n        var parent = this.parent;\n        if (parent.transform.straighten === 0) {\n            return;\n        }\n        if (parent.transform.degree % 90 === 0 && parent.transform.degree % 180 !== 0) {\n            var actPoint = parent.activeObj.activePoint;\n            var tempActPoint = extend({}, actPoint, {}, true);\n            var count = 0;\n            while (true) {\n                // Increase width and height by 5% from center to enlarge the crop selection\n                count++;\n                var diff = (actPoint.width * 5) / 100;\n                actPoint.startX -= diff;\n                actPoint.endX += diff;\n                diff = (actPoint.height * 5) / 100;\n                actPoint.startY -= diff;\n                actPoint.endY += diff;\n                actPoint.width = actPoint.endX - actPoint.startX;\n                actPoint.height = actPoint.endY - actPoint.startY;\n                this.updateActiveObject(actPoint, parent.activeObj);\n                var object = { isIntersect: null, arr: null };\n                this.updateImgCanvasPoints();\n                this.isLinesIntersect(object);\n                if (object['arr'][0] || object['arr'][1] || object['arr'][2] || object['arr'][3] ||\n                    actPoint.startX < 7.5 || actPoint.startY < 7.5 || count === 100) {\n                    actPoint = extend({}, tempActPoint, {}, true);\n                    diff = (actPoint.width * 1) / 100;\n                    actPoint.startX += diff;\n                    actPoint.endX -= diff;\n                    diff = (actPoint.height * 1) / 100;\n                    actPoint.startY += diff;\n                    actPoint.endY -= diff;\n                    actPoint.width = actPoint.endX - actPoint.startX;\n                    actPoint.height = actPoint.endY - actPoint.startY;\n                    this.updateActiveObject(actPoint, parent.activeObj);\n                    break;\n                }\n                tempActPoint = extend({}, actPoint, {}, true);\n            }\n        }\n    };\n    Draw.prototype.updateActiveObject = function (actPoint, obj, isMouseMove, x, y) {\n        var parent = this.parent;\n        actPoint = actPoint ? actPoint : extend({}, parent.activeObj.activePoint, {}, true);\n        obj = obj ? obj : extend({}, parent.activeObj, {}, true);\n        actPoint.width = actPoint.endX - actPoint.startX;\n        actPoint.height = actPoint.endY - actPoint.startY;\n        var startX = actPoint.startX, startY = actPoint.startY, endX = actPoint.endX, endY = actPoint.endY, width = actPoint.width, height = actPoint.height;\n        x = x ? x : 0;\n        y = y ? y : 0;\n        var horCircleWidth = width / 2;\n        var verCircleHeight = height / 2;\n        var radius = 7.5;\n        obj.horTopLine = { startX: startX + x, startY: startY - y,\n            endX: endX + x, endY: endY + y };\n        obj.horBottomLine = { startX: startX - x, startY: endY - y,\n            endX: endX - x, endY: endY + y };\n        obj.verLeftLine = { startX: startX + x, startY: startY - y,\n            endX: startX - y, endY: endY - y };\n        obj.verRightLine = { startX: endX + x, startY: startY + y,\n            endX: endX - x, endY: endY + y };\n        obj.topLeftCircle = { startX: startX, startY: startY,\n            radius: obj.horTopLine.endX ? (radius) : 0 };\n        obj.topCenterCircle = { startX: startX + horCircleWidth, startY: startY,\n            radius: obj.horTopLine.endX ? (radius) : 0 };\n        obj.topRightCircle = { startX: endX, startY: startY,\n            radius: obj.horTopLine.endX ? (radius) : 0 };\n        obj.centerLeftCircle = { startX: startX, startY: startY + verCircleHeight,\n            radius: obj.horTopLine.endX ? (radius) : 0 };\n        obj.centerRightCircle = { startX: endX, startY: startY + verCircleHeight,\n            radius: obj.horTopLine.endX ? (radius) : 0 };\n        obj.bottomLeftCircle = { startX: startX, startY: endY,\n            radius: obj.horTopLine.endX ? (radius) : 0 };\n        obj.bottomCenterCircle = { startX: startX + horCircleWidth, startY: endY,\n            radius: obj.horTopLine.endX ? (radius) : 0 };\n        obj.bottomRightCircle = { startX: endX, startY: endY,\n            radius: obj.horTopLine.endX ? (radius) : 0 };\n        if (obj.rotatedAngle === 0) {\n            obj.rotationCirclePoint = { x: obj.bottomCenterCircle.startX,\n                y: obj.bottomCenterCircle.startY + 25 };\n            obj.rotationCirclePoint.ratioX = (obj.rotationCirclePoint.x - parent.img.destLeft) / parent.img.destWidth;\n            obj.rotationCirclePoint.ratioY = (obj.rotationCirclePoint.y - parent.img.destTop) / parent.img.destHeight;\n        }\n        obj.activePoint = actPoint;\n        if (isNullOrUndefined(isMouseMove)) {\n            parent.activeObj = extend({}, obj, {}, true);\n        }\n    };\n    Draw.prototype.drawOuterSelection = function (canvasDraw, isCropCircle) {\n        var splitWords;\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var actObj = parent.activeObj;\n        canvasDraw.lineWidth = (0.5);\n        var tempObj = extend({}, actObj, {}, true);\n        if (actObj.shape) {\n            splitWords = actObj.shape.split('-');\n        }\n        if (((splitWords && splitWords[0] === 'crop') || actObj.shape === undefined) && !isCropCircle) {\n            this.upperContext.fillStyle = 'rgb(0, 0, 0, 0.25)';\n            this.upperContext.fillRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n            this.upperContext.clearRect(actPoint.startX, actPoint.startY, actPoint.width, actPoint.height);\n        }\n        canvasDraw.strokeStyle = parent.themeColl[parent.theme]['primaryColor'];\n        canvasDraw.fillStyle = parent.themeColl[parent.theme]['secondaryColor'];\n        var degree;\n        if (tempObj.shapeDegree === 0) {\n            degree = parent.transform.degree;\n        }\n        else {\n            degree = parent.transform.degree - tempObj.shapeDegree;\n        }\n        if (degree < 0) {\n            degree = 360 + degree;\n        }\n        if (actObj.shape === 'arrow' || actObj.shape === 'line') {\n            canvasDraw.beginPath();\n            canvasDraw.moveTo(actPoint.startX, actPoint.startY);\n            canvasDraw.lineTo(actPoint.endX, actPoint.endY);\n            canvasDraw.stroke();\n        }\n        else if (actObj.shape === 'path') {\n            canvasDraw.beginPath();\n            var activeObj = extend({}, parent.activeObj, {}, true);\n            if (activeObj.pointColl[0]) {\n                canvasDraw.moveTo(activeObj.pointColl[0].x, activeObj.pointColl[0].y);\n                if (activeObj.pointColl.length > 1) {\n                    for (var i = 1, len = activeObj.pointColl.length; i < len; i++) {\n                        actPoint.endX = activeObj.pointColl[i].x;\n                        actPoint.endY = activeObj.pointColl[i].y;\n                        canvasDraw.lineTo(actPoint.endX, actPoint.endY);\n                    }\n                }\n            }\n            var obj = { shape: null };\n            parent.notify('selection', { prop: 'getCurrentDrawingShape', value: { obj: obj } });\n            if (obj['shape'] === 'path') {\n                parent.activeObj = actObj = activeObj;\n            }\n            canvasDraw.lineTo(actPoint.endX, actPoint.endY);\n            canvasDraw.stroke();\n        }\n        else {\n            this.drawCornerCircles(canvasDraw);\n        }\n        if (parent.selectionSettings.showCircle && (splitWords === undefined || splitWords[0] !== 'crop')) {\n            var strokeColor = canvasDraw.strokeStyle;\n            var fillColor = canvasDraw.fillStyle;\n            canvasDraw.strokeStyle = parent.selectionSettings.strokeColor;\n            canvasDraw.fillStyle = parent.selectionSettings.fillColor;\n            if (actObj.shape === 'text') {\n                canvasDraw.lineWidth *= 2;\n                canvasDraw.beginPath();\n                this.drawRotationArcLine(canvasDraw);\n                canvasDraw.lineTo(actObj.rotationCirclePoint.x, actObj.rotationCirclePoint.y);\n                canvasDraw.stroke();\n                canvasDraw.fill();\n                canvasDraw.closePath();\n                canvasDraw.beginPath();\n                canvasDraw.moveTo(actObj.rotationCirclePoint.x, actObj.rotationCirclePoint.y);\n                canvasDraw.arc(actObj.rotationCirclePoint.x, actObj.rotationCirclePoint.y, actObj.bottomCenterCircle.radius, 0, 2 * Math.PI);\n                canvasDraw.stroke();\n                canvasDraw.fill();\n                canvasDraw.closePath();\n                canvasDraw.lineWidth /= 2;\n            }\n            else {\n                if (parent.activeObj.shape !== 'redact') {\n                    this.drawCenterCircles(canvasDraw);\n                }\n            }\n            canvasDraw.strokeStyle = strokeColor;\n            canvasDraw.fillStyle = fillColor;\n        }\n        tempObj.rotationCircleLine = actObj.rotationCircleLine;\n        parent.activeObj = extend({}, tempObj, {}, true);\n    };\n    Draw.prototype.drawArrowHead = function (canvasDraw, isStartHead) {\n        var headType = isStartHead ? this.parent.activeObj.start : this.parent.activeObj.end;\n        switch (headType) {\n            case 'arrowSolid':\n                // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n                isStartHead ? this.arrowSolid(canvasDraw, true) : this.arrowSolid(canvasDraw, false);\n                break;\n            case 'arrow':\n                // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n                isStartHead ? this.arrow(canvasDraw, true) : this.arrow(canvasDraw, false);\n                break;\n            case 'circleSolid':\n                // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n                isStartHead ? this.arrowCircleSolid(canvasDraw, true) : this.arrowCircleSolid(canvasDraw, false);\n                break;\n            case 'circle':\n                // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n                isStartHead ? this.arrowCircle(canvasDraw, true) : this.arrowCircle(canvasDraw, false);\n                break;\n            case 'bar':\n                // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n                isStartHead ? this.arrowBar(canvasDraw, true) : this.arrowBar(canvasDraw, false);\n                break;\n            case 'square':\n            case 'squareSolid':\n                // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n                isStartHead ? this.arrowSquareStart(canvasDraw) : this.arrowSquareEnd(canvasDraw);\n                break;\n        }\n    };\n    Draw.prototype.drawShapeObj = function (canvas, shape, saveContext, isPreventSelection) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var actObj = parent.activeObj;\n        var _a = actObj.strokeSettings, strokeColor = _a.strokeColor, fillColor = _a.fillColor, strokeWidth = _a.strokeWidth;\n        var currentShape = shape !== undefined ? shape : parent.currObjType.shape;\n        parent.currObjType.shape = currentShape;\n        var canvasDraw;\n        if (canvas.toLowerCase() === 'original') {\n            canvasDraw = this.lowerContext;\n        }\n        else if (canvas.toLowerCase() === 'duplicate') {\n            canvasDraw = this.upperContext;\n        }\n        else if (saveContext) {\n            canvasDraw = saveContext;\n        }\n        var shapeType = parent.currObjType.shape.toLowerCase();\n        var shapeColl = ['rectangle', 'ellipse', 'line', 'arrow', 'path', 'image', 'redact'];\n        if (shapeColl.indexOf(shapeType) !== -1) {\n            actObj.shape = parent.currObjType.shape;\n        }\n        canvasDraw.strokeStyle = strokeColor;\n        if (shape === 'text' || shape === 'freehanddraw') {\n            canvasDraw.fillStyle = strokeColor;\n        }\n        else {\n            canvasDraw.fillStyle = fillColor;\n        }\n        var horLineWidth = actPoint.width / 3;\n        var verLineHeight = actPoint.height / 3;\n        var selectionWidth = actPoint.endX - actPoint.startX;\n        var selectionHeight = actPoint.endY - actPoint.startY;\n        this.rotateContext('initial', canvasDraw);\n        var degree;\n        var tempFillStyle = canvasDraw.fillStyle;\n        var activeObj;\n        switch (parent.currObjType.shape.toLowerCase()) {\n            case 'rectangle':\n                this.drawSquareLines(canvasDraw);\n                if (isNullOrUndefined(isPreventSelection) && canvasDraw === this.upperContext) {\n                    this.drawOuterSelection(canvasDraw);\n                }\n                break;\n            case 'redact':\n                this.drawRedact(canvasDraw, actObj);\n                if (isNullOrUndefined(isPreventSelection) && canvasDraw === this.upperContext) {\n                    this.drawOuterSelection(canvasDraw);\n                }\n                parent.currObjType.isRedact = true;\n                break;\n            case 'ellipse':\n                selectionWidth = Math.abs(selectionWidth);\n                selectionHeight = Math.abs(selectionHeight);\n                canvasDraw.beginPath();\n                canvasDraw.ellipse(actPoint.startX + (selectionWidth / 2), actPoint.startY + (selectionHeight / 2), selectionWidth / 2, selectionHeight / 2, 0, 0, 2 * Math.PI, false);\n                if (fillColor !== '') {\n                    canvasDraw.fillStyle = fillColor;\n                    canvasDraw.fill();\n                }\n                canvasDraw.ellipse(actPoint.startX + (selectionWidth / 2), actPoint.startY + (selectionHeight / 2), Math.abs((selectionWidth / 2) - (strokeWidth)), Math.abs((selectionHeight / 2) - (strokeWidth)), 0, 0, 2 * Math.PI, false);\n                canvasDraw.fillStyle = strokeColor;\n                canvasDraw.fill('evenodd');\n                canvasDraw.closePath();\n                if (isNullOrUndefined(isPreventSelection) && canvasDraw === this.upperContext) {\n                    this.drawOuterSelection(canvasDraw);\n                }\n                break;\n            case 'crop-circle':\n                this.shapeCircle(canvasDraw, selectionWidth, selectionHeight);\n                break;\n            case 'line':\n                this.shapeLine(canvasDraw, actPoint.startX, actPoint.startY, actPoint.endX, actPoint.endY);\n                if (isNullOrUndefined(isPreventSelection) && canvasDraw === this.upperContext) {\n                    this.drawOuterSelection(canvasDraw);\n                }\n                break;\n            case 'arrow':\n                if (actObj.shapeDegree === 0) {\n                    degree = parent.transform.degree;\n                }\n                else {\n                    degree = parent.transform.degree - actObj.shapeDegree;\n                }\n                if (degree < 0) {\n                    degree = 360 + degree;\n                }\n                canvasDraw.fillStyle = canvasDraw.strokeStyle;\n                if (isNullOrUndefined(actObj.triangleDirection)) {\n                    actObj.triangleDirection = 'right';\n                }\n                if (isNullOrUndefined(actObj.start)) {\n                    actObj.start = 'none';\n                }\n                if (isNullOrUndefined(actObj.end)) {\n                    actObj.end = 'arrowSolid';\n                }\n                this.drawArrowHead(canvasDraw, true);\n                this.drawArrowHead(canvasDraw, false);\n                if (actObj.end === 'none' && actObj.start !== 'circle' && actObj.start !== 'square') {\n                    this.shapeLine(canvasDraw, actPoint.startX, actPoint.startY, actPoint.endX, actPoint.endY);\n                }\n                canvasDraw.fillStyle = tempFillStyle;\n                if (isNullOrUndefined(isPreventSelection) && canvasDraw === this.upperContext) {\n                    this.drawOuterSelection(canvasDraw);\n                }\n                break;\n            case 'path':\n                activeObj = extend({}, parent.activeObj, {}, true);\n                if (activeObj.pointColl.length > 1) {\n                    var obj = { shape: null };\n                    parent.notify('selection', { prop: 'getCurrentDrawingShape', value: { obj: obj } });\n                    if (obj['shape'] === 'path' && parent.isShapeDrawing) {\n                        var nextPoint = { x: 0, y: 0 };\n                        for (var i = 0, len = activeObj.pointColl.length; i < len; i++) {\n                            if (isNullOrUndefined(activeObj.pointColl[i + 1])) {\n                                nextPoint.x = activeObj.activePoint.endX;\n                                nextPoint.y = activeObj.activePoint.endY;\n                            }\n                            else {\n                                nextPoint.x = activeObj.pointColl[i + 1].x;\n                                nextPoint.y = activeObj.pointColl[i + 1].y;\n                            }\n                            actPoint.startX = activeObj.pointColl[i].x;\n                            actPoint.startY = activeObj.pointColl[i].y;\n                            actPoint.endX = nextPoint.x;\n                            actPoint.endY = nextPoint.y;\n                            parent.activeObj = this.updateWidthHeight(parent.activeObj);\n                            this.shapeLine(canvasDraw, actPoint.startX, actPoint.startY, actPoint.endX, actPoint.endY);\n                            if (Browser.isDevice) {\n                                activeObj.activePoint.endX = nextPoint.x;\n                                activeObj.activePoint.endY = nextPoint.y;\n                            }\n                        }\n                    }\n                    else {\n                        for (var i = 1, len = activeObj.pointColl.length; i < len; i++) {\n                            actPoint.startX = activeObj.pointColl[i - 1].x;\n                            actPoint.startY = activeObj.pointColl[i - 1].y;\n                            actPoint.endX = activeObj.pointColl[i].x;\n                            actPoint.endY = activeObj.pointColl[i].y;\n                            parent.activeObj = this.updateWidthHeight(parent.activeObj);\n                            this.shapeLine(canvasDraw, actPoint.startX, actPoint.startY, actPoint.endX, actPoint.endY);\n                        }\n                    }\n                    parent.activeObj = actObj = activeObj;\n                }\n                else {\n                    this.shapeLine(canvasDraw, actPoint.startX, actPoint.startY, actPoint.endX, actPoint.endY);\n                }\n                if (canvasDraw === this.upperContext) {\n                    this.drawOuterSelection(canvasDraw);\n                }\n                break;\n            case 'text':\n                this.shapeText(canvasDraw);\n                break;\n            case 'image':\n                this.shapeImage(canvasDraw);\n                if (isNullOrUndefined(isPreventSelection) && canvasDraw === this.upperContext) {\n                    this.drawOuterSelection(canvasDraw);\n                }\n                break;\n            case 'crop-square':\n            case 'crop-3:4':\n            case 'crop-4:3':\n            case 'crop-6:9':\n            case 'crop-9:6':\n            case 'crop-9:16':\n            case 'crop-16:9':\n                if (canvasDraw === this.lowerContext) {\n                    canvasDraw = this.upperContext;\n                }\n                this.drawSelection(horLineWidth, verLineHeight);\n                parent.currObjType.shape = '';\n                break;\n            default:\n                this.drawSelection(horLineWidth, verLineHeight);\n                break;\n        }\n        this.rotateContext('reverse', canvasDraw);\n    };\n    Draw.prototype.updatePoints = function () {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop;\n        actPoint.startX += destLeft;\n        actPoint.startY += destTop;\n        actPoint.endX += destLeft;\n        actPoint.endY += destTop;\n        parent.activeObj = this.updateWidthHeight(parent.activeObj);\n    };\n    Draw.prototype.updateWidthHeight = function (obj) {\n        var _a = obj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY;\n        obj.activePoint.width = endX - startX;\n        obj.activePoint.height = endY - startY;\n        return obj;\n    };\n    Draw.prototype.drawCornerCircles = function (canvasDraw) {\n        var parent = this.parent;\n        var tempObj = parent.activeObj;\n        canvasDraw.beginPath();\n        canvasDraw.rect(tempObj.activePoint.startX, tempObj.activePoint.startY, tempObj.activePoint.width, tempObj.activePoint.height);\n        canvasDraw.stroke();\n        canvasDraw.closePath();\n        if (parent.selectionSettings.showCircle) {\n            var strokeColor = canvasDraw.strokeStyle;\n            var fillColor = canvasDraw.fillStyle;\n            canvasDraw.strokeStyle = parent.selectionSettings.strokeColor;\n            canvasDraw.fillStyle = parent.selectionSettings.fillColor;\n            canvasDraw.lineWidth *= 2;\n            canvasDraw.beginPath();\n            canvasDraw.moveTo(tempObj.topLeftCircle.startX, tempObj.topLeftCircle.startY);\n            canvasDraw.arc(tempObj.topLeftCircle.startX, tempObj.topLeftCircle.startY, tempObj.topLeftCircle.radius, 0, 2 * Math.PI);\n            canvasDraw.moveTo(tempObj.topRightCircle.startX, tempObj.topRightCircle.startY);\n            canvasDraw.arc(tempObj.topRightCircle.startX, tempObj.topRightCircle.startY, tempObj.topRightCircle.radius, 0, 2 * Math.PI);\n            canvasDraw.moveTo(tempObj.bottomLeftCircle.startX, tempObj.bottomLeftCircle.startY);\n            canvasDraw.arc(tempObj.bottomLeftCircle.startX, tempObj.bottomLeftCircle.startY, tempObj.bottomLeftCircle.radius, 0, 2 * Math.PI);\n            canvasDraw.moveTo(tempObj.bottomRightCircle.startX, tempObj.bottomRightCircle.startY);\n            canvasDraw.arc(tempObj.bottomRightCircle.startX, tempObj.bottomRightCircle.startY, tempObj.bottomRightCircle.radius, 0, 2 * Math.PI);\n            canvasDraw.stroke();\n            canvasDraw.fill();\n            canvasDraw.closePath();\n            canvasDraw.lineWidth /= 2;\n            canvasDraw.strokeStyle = strokeColor;\n            canvasDraw.fillStyle = fillColor;\n        }\n    };\n    Draw.prototype.drawCenterCircles = function (canvasDraw) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var actObj = parent.activeObj;\n        canvasDraw.lineWidth *= 2;\n        canvasDraw.beginPath();\n        if (actObj.shape === 'arrow' || actObj.shape === 'line') {\n            canvasDraw.moveTo(actPoint.startX, actPoint.startY);\n            canvasDraw.arc(actPoint.startX, actPoint.startY, actObj.topCenterCircle.radius, 0, 2 * Math.PI);\n            canvasDraw.moveTo(actPoint.endX, actPoint.endY);\n            canvasDraw.arc(actPoint.endX, actPoint.endY, actObj.bottomCenterCircle.radius, 0, 2 * Math.PI);\n        }\n        else if (actObj.shape === 'path') {\n            var activeObj = extend({}, parent.activeObj, {}, true);\n            if (activeObj.pointColl.length > 1) {\n                for (var i = 1, len = activeObj.pointColl.length; i < len; i++) {\n                    actPoint.startX = activeObj.pointColl[i - 1].x;\n                    actPoint.startY = activeObj.pointColl[i - 1].y;\n                    actPoint.endX = activeObj.pointColl[i].x;\n                    actPoint.endY = activeObj.pointColl[i].y;\n                    canvasDraw.moveTo(actPoint.startX, actPoint.startY);\n                    canvasDraw.arc(actPoint.startX, actPoint.startY, actObj.topCenterCircle.radius, 0, 2 * Math.PI);\n                    canvasDraw.moveTo(actPoint.endX, actPoint.endY);\n                    canvasDraw.arc(actPoint.endX, actPoint.endY, actObj.bottomCenterCircle.radius, 0, 2 * Math.PI);\n                }\n            }\n            var obj = { shape: null };\n            parent.notify('selection', { prop: 'getCurrentDrawingShape', value: { obj: obj } });\n            if (obj['shape'] === 'path') {\n                parent.activeObj = actObj = activeObj;\n            }\n            canvasDraw.moveTo(actPoint.startX, actPoint.startY);\n            canvasDraw.arc(actPoint.startX, actPoint.startY, actObj.topCenterCircle.radius, 0, 2 * Math.PI);\n            canvasDraw.moveTo(actPoint.endX, actPoint.endY);\n            canvasDraw.arc(actPoint.endX, actPoint.endY, actObj.bottomCenterCircle.radius, 0, 2 * Math.PI);\n        }\n        else {\n            this.drawRotationArcLine(canvasDraw);\n            canvasDraw.lineTo(actObj.rotationCirclePoint.x, actObj.rotationCirclePoint.y);\n        }\n        canvasDraw.stroke();\n        canvasDraw.fill();\n        canvasDraw.closePath();\n        if (actObj.shape !== 'arrow' && actObj.shape !== 'line' && actObj.shape !== 'path') {\n            canvasDraw.beginPath();\n            canvasDraw.moveTo(actObj.rotationCirclePoint.x, actObj.rotationCirclePoint.y);\n            canvasDraw.arc(actObj.rotationCirclePoint.x, actObj.rotationCirclePoint.y, actObj.bottomCenterCircle.radius, 0, 2 * Math.PI);\n            canvasDraw.stroke();\n            canvasDraw.fill();\n            canvasDraw.closePath();\n        }\n        canvasDraw.lineWidth /= 2;\n    };\n    Draw.prototype.drawRotationArcLine = function (canvasDraw) {\n        var parent = this.parent;\n        var actObj = parent.activeObj;\n        if (isNullOrUndefined(actObj.rotationCircleLine)) {\n            actObj.rotationCircleLine = 22.5;\n        }\n        var degree;\n        var isHorizontalflip = false;\n        var isVerticalflip = false;\n        if (actObj.shapeDegree === 0) {\n            degree = parent.transform.degree;\n        }\n        else {\n            degree = parent.transform.degree - actObj.shapeDegree;\n        }\n        if (degree < 0) {\n            degree = 360 + degree;\n        }\n        if (actObj.flipObjColl) {\n            for (var i = 0, len = actObj.flipObjColl.length; i < len; i++) {\n                var flipStr = actObj.flipObjColl[i].toLowerCase();\n                if (flipStr === 'horizontal') {\n                    isHorizontalflip = true;\n                }\n                else if (flipStr === 'vertical') {\n                    isVerticalflip = true;\n                }\n            }\n        }\n        switch (degree) {\n            case 0:\n            case 360:\n                if (isVerticalflip) {\n                    actObj.rotationCirclePoint = { x: actObj.topCenterCircle.startX,\n                        y: actObj.topCenterCircle.startY - actObj.rotationCircleLine };\n                    canvasDraw.moveTo(actObj.rotationCirclePoint.x, actObj.rotationCirclePoint.y + actObj.rotationCircleLine);\n                }\n                else {\n                    actObj.rotationCirclePoint = { x: actObj.bottomCenterCircle.startX,\n                        y: actObj.bottomCenterCircle.startY + actObj.rotationCircleLine };\n                    canvasDraw.moveTo(actObj.rotationCirclePoint.x, actObj.rotationCirclePoint.y - actObj.rotationCircleLine);\n                }\n                break;\n            case 90:\n            case -270:\n                if (isHorizontalflip) {\n                    actObj.rotationCirclePoint = { x: actObj.centerRightCircle.startX +\n                            actObj.rotationCircleLine, y: actObj.centerLeftCircle.startY };\n                    canvasDraw.moveTo(actObj.rotationCirclePoint.x - actObj.rotationCircleLine, actObj.rotationCirclePoint.y);\n                }\n                else {\n                    actObj.rotationCirclePoint = { x: actObj.centerLeftCircle.startX -\n                            actObj.rotationCircleLine, y: actObj.centerLeftCircle.startY };\n                    canvasDraw.moveTo(actObj.rotationCirclePoint.x + actObj.rotationCircleLine, actObj.rotationCirclePoint.y);\n                }\n                break;\n            case 180:\n            case -180:\n                if (isVerticalflip) {\n                    actObj.rotationCirclePoint = { x: actObj.bottomCenterCircle.startX,\n                        y: actObj.bottomCenterCircle.startY + actObj.rotationCircleLine };\n                    canvasDraw.moveTo(actObj.rotationCirclePoint.x, actObj.rotationCirclePoint.y - actObj.rotationCircleLine);\n                }\n                else {\n                    actObj.rotationCirclePoint = { x: actObj.topCenterCircle.startX,\n                        y: actObj.topCenterCircle.startY - actObj.rotationCircleLine };\n                    canvasDraw.moveTo(actObj.rotationCirclePoint.x, actObj.rotationCirclePoint.y + actObj.rotationCircleLine);\n                }\n                break;\n            case 270:\n            case -90:\n                if (isHorizontalflip) {\n                    actObj.rotationCirclePoint = { x: actObj.centerLeftCircle.startX -\n                            actObj.rotationCircleLine, y: actObj.centerLeftCircle.startY };\n                    canvasDraw.moveTo(actObj.rotationCirclePoint.x + actObj.rotationCircleLine, actObj.rotationCirclePoint.y);\n                }\n                else {\n                    actObj.rotationCirclePoint = { x: actObj.centerRightCircle.startX +\n                            actObj.rotationCircleLine, y: actObj.centerLeftCircle.startY };\n                    canvasDraw.moveTo(actObj.rotationCirclePoint.x - actObj.rotationCircleLine, actObj.rotationCirclePoint.y);\n                }\n                break;\n        }\n    };\n    Draw.prototype.drawSquareLines = function (canvasDraw) {\n        var splitWords;\n        var parent = this.parent;\n        var actObj = parent.activeObj;\n        var _a = actObj.activePoint, startX = _a.startX, startY = _a.startY, width = _a.width, height = _a.height;\n        var _b = actObj.strokeSettings, fillColor = _b.fillColor, strokeColor = _b.strokeColor, strokeWidth = _b.strokeWidth, radius = _b.radius;\n        if (actObj.shape) {\n            splitWords = actObj.shape.split('-');\n        }\n        if (splitWords[0] === 'crop') {\n            canvasDraw.strokeStyle = '#fff';\n        }\n        else {\n            canvasDraw.strokeStyle = strokeColor;\n        }\n        canvasDraw.beginPath();\n        var obj = { width: 0, height: 0 };\n        var ratio = { width: 1, height: 1 };\n        parent.notify('crop', { prop: 'calcRatio', onPropertyChange: false,\n            value: { obj: obj, dimension: { width: canvasDraw.canvas.width, height: canvasDraw.canvas.height } } });\n        ratio = obj;\n        var isTempCanvas = canvasDraw.canvas.id === parent.element.id + '_tempCanvas';\n        var zoomFactor = parent.transform.zoomFactor;\n        var baseRadius = isTempCanvas ? radius * 10 * ((ratio.width + ratio.height) / 2) : radius * 10;\n        var adjustedRadius = baseRadius + (baseRadius * zoomFactor);\n        if (radius !== null) {\n            if (parent.isSafari) {\n                this.drawRoundedRect(canvasDraw, startX, startY, width, height, adjustedRadius);\n            }\n            else {\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                canvasDraw.roundRect(startX, startY, width, height, adjustedRadius);\n            }\n        }\n        else {\n            canvasDraw.rect(startX, startY, width, height);\n        }\n        if (fillColor !== '') {\n            canvasDraw.fillStyle = fillColor;\n            canvasDraw.fill();\n        }\n        if (radius !== null) {\n            if (parent.isSafari) {\n                this.drawRoundedRect(canvasDraw, startX + strokeWidth, startY + strokeWidth, width - (2 * strokeWidth), height - (2 * strokeWidth), adjustedRadius);\n            }\n            else {\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                canvasDraw.roundRect(startX + strokeWidth, startY + strokeWidth, width - (2 * strokeWidth), height - (2 * strokeWidth), adjustedRadius);\n            }\n        }\n        else {\n            canvasDraw.rect(startX + strokeWidth, startY + strokeWidth, width - (2 * strokeWidth), height - (2 * strokeWidth));\n        }\n        canvasDraw.fillStyle = strokeColor;\n        canvasDraw.fill('evenodd');\n        canvasDraw.closePath();\n    };\n    Draw.prototype.drawRoundedRect = function (canvasDraw, startX, startY, width, height, radius) {\n        var rectRadius = Math.max(0, Math.min(radius, width / 2, height / 2));\n        canvasDraw.moveTo(startX + rectRadius, startY);\n        canvasDraw.arcTo(startX + width, startY, startX + width, startY + height, rectRadius);\n        canvasDraw.arcTo(startX + width, startY + height, startY, startY + height, rectRadius);\n        canvasDraw.arcTo(startX, startY + height, startX, startY, rectRadius);\n        canvasDraw.arcTo(startX, startY, startX + width, startY, rectRadius);\n        canvasDraw.closePath();\n    };\n    Draw.prototype.drawSelection = function (horLineWidth, verLineHeight) {\n        var parent = this.parent;\n        var actObj = parent.activeObj;\n        var _a = actObj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY;\n        this.upperContext.strokeStyle = parent.themeColl[parent.theme]['primaryColor'];\n        this.upperContext.beginPath();\n        actObj.horTopInnerLine = { startX: startX, startY: startY +\n                verLineHeight, endX: endX, endY: endY + verLineHeight };\n        actObj.horBottomInnerLine = { startX: startX, startY: startY + (2 * verLineHeight), endX: endX, endY: endY + (2 * verLineHeight) };\n        actObj.verLeftInnerLine = { startX: startX + horLineWidth,\n            startY: startY, endX: startX + horLineWidth, endY: endY };\n        actObj.verRightInnerLine = { startX: startX + (2 * horLineWidth),\n            startY: startY, endX: startX + (2 * horLineWidth), endY: endY };\n        this.upperContext.moveTo(actObj.horTopInnerLine.startX, actObj.horTopInnerLine.startY);\n        this.upperContext.lineTo(actObj.horTopInnerLine.endX, actObj.horTopInnerLine.startY);\n        this.upperContext.moveTo(actObj.horBottomInnerLine.startX, actObj.horBottomInnerLine.startY);\n        this.upperContext.lineTo(actObj.horBottomInnerLine.endX, actObj.horBottomInnerLine.startY);\n        this.upperContext.moveTo(actObj.verLeftInnerLine.startX, actObj.verLeftInnerLine.startY);\n        this.upperContext.lineTo(actObj.verLeftInnerLine.endX, actObj.verLeftInnerLine.endY);\n        this.upperContext.moveTo(actObj.verRightInnerLine.startX, actObj.verRightInnerLine.startY);\n        this.upperContext.lineTo(actObj.verRightInnerLine.endX, actObj.verRightInnerLine.endY);\n        this.upperContext.stroke();\n        this.upperContext.closePath();\n    };\n    Draw.prototype.shapeCircle = function (canvasDraw, selectionWidth, selectionHeight) {\n        var parent = this.parent;\n        var _a = parent.activeObj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY, width = _a.width;\n        canvasDraw.strokeStyle = parent.themeColl[parent.theme]['primaryColor'];\n        canvasDraw.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        canvasDraw.fillStyle = 'rgb(0, 0, 0, 0.25)';\n        canvasDraw.fillRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        var tempWidth = canvasDraw.lineWidth;\n        canvasDraw.lineWidth = (2);\n        canvasDraw.beginPath();\n        canvasDraw.ellipse(parent.activeObj.horTopLine.startX + (selectionWidth / 2), parent.activeObj.horTopLine.startY\n            + (selectionHeight / 2), selectionWidth / 2, selectionHeight / 2, 0, 0, 2 * Math.PI, false);\n        canvasDraw.stroke();\n        canvasDraw.closePath();\n        canvasDraw.save();\n        canvasDraw.beginPath();\n        canvasDraw.arc(((endX - startX) / 2) + startX, ((endY - startY) / 2) + startY, (width / 2), 0, Math.PI * 2);\n        canvasDraw.closePath();\n        canvasDraw.clip();\n        canvasDraw.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        canvasDraw.restore();\n        canvasDraw.lineWidth = tempWidth;\n        this.drawOuterSelection(canvasDraw, true);\n        parent.currObjType.shape = '';\n    };\n    Draw.prototype.shapeLine = function (canvasDraw, x1, y1, x2, y2) {\n        var tempLineWidth = canvasDraw.lineWidth;\n        canvasDraw.lineWidth = (this.parent.activeObj.strokeSettings.strokeWidth);\n        canvasDraw.beginPath();\n        canvasDraw.moveTo(x1, y1);\n        canvasDraw.lineTo(x2, y2);\n        canvasDraw.stroke();\n        canvasDraw.lineWidth = tempLineWidth;\n    };\n    Draw.prototype.manipulateSaveCtx = function (canvasDraw, x, y) {\n        if (canvasDraw !== this.lowerContext && canvasDraw !== this.upperContext) {\n            var obj = { width: 0, height: 0 };\n            this.parent.notify('crop', { prop: 'calcRatio', onPropertyChange: false,\n                value: { obj: obj, dimension: { width: canvasDraw.canvas.width, height: canvasDraw.canvas.height } } });\n            var ratio = obj;\n            if (x) {\n                x *= (ratio.width);\n            }\n            if (y) {\n                y *= (ratio.height);\n            }\n        }\n        return { x: x, y: y };\n    };\n    Draw.prototype.arrow = function (canvasDraw, start) {\n        var parent = this.parent;\n        var actObj = parent.activeObj;\n        var _a = actObj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY;\n        var strWidth = actObj.strokeSettings.strokeWidth;\n        canvasDraw.lineWidth = strWidth;\n        var x = this.arrowDimension['arrow']['width'];\n        var y = this.arrowDimension['arrow']['height'];\n        var point = this.manipulateSaveCtx(canvasDraw, x, y);\n        x = point.x + strWidth;\n        y = point.y + strWidth;\n        this.dx = endX - startX;\n        this.dy = endY - startY;\n        canvasDraw.fillStyle = actObj.strokeSettings.strokeColor;\n        var angle = Math.atan2(this.dy, this.dx);\n        var isStartArrow = actObj.start === 'arrow';\n        var isEndArrow = actObj.end === 'arrow';\n        var isEndCircleOrSquare = actObj.end === 'circle' || actObj.end === 'square';\n        var isStartCircleOrSquare = actObj.start === 'circle' || actObj.start === 'square';\n        if ((start && actObj.triangleDirection === 'left' || actObj.triangleDirection === 'right') &&\n            ((isStartArrow && actObj.end === 'none') || (isStartArrow && !isEndCircleOrSquare && !isStartCircleOrSquare)) ||\n            (!start && (isEndArrow && actObj.start === 'none' || !isStartArrow && !isEndCircleOrSquare && !isStartCircleOrSquare))) {\n            this.shapeLine(canvasDraw, startX, startY, endX, endY);\n        }\n        if ((start && actObj.triangleDirection === 'left') || (!start && actObj.triangleDirection === 'right')) {\n            canvasDraw.translate(endX, endY);\n            canvasDraw.rotate(angle);\n            this.shapeLine(canvasDraw, 0, 0, -x, y / 2);\n            this.shapeLine(canvasDraw, 0, 0, -x, -y / 2);\n            canvasDraw.rotate(-angle);\n            canvasDraw.translate(-endX, -endY);\n        }\n        else if ((start && actObj.triangleDirection === 'right') || (!start && actObj.triangleDirection === 'left')) {\n            canvasDraw.translate(startX, startY);\n            canvasDraw.rotate(angle);\n            this.shapeLine(canvasDraw, 0, 0, x, y / 2);\n            this.shapeLine(canvasDraw, 0, 0, x, -y / 2);\n            canvasDraw.rotate(-angle);\n            canvasDraw.translate(-startX, -startY);\n        }\n    };\n    Draw.prototype.arrowSolid = function (canvasDraw, start) {\n        var parent = this.parent;\n        var actObj = parent.activeObj;\n        var strWidth = actObj.strokeSettings.strokeWidth;\n        var _a = actObj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY;\n        var x = this.arrowDimension['arrowSolid']['width'];\n        var y = this.arrowDimension['arrowSolid']['height'];\n        var point = this.manipulateSaveCtx(canvasDraw, x, y);\n        x = point.x + strWidth;\n        y = point.y + strWidth;\n        this.dx = endX - startX;\n        this.dy = endY - startY;\n        var angle = Math.atan2(this.dy, this.dx);\n        var isStartArrowSolid = actObj.start === 'arrowSolid';\n        var isEndArrowSolid = actObj.end === 'arrowSolid';\n        var isStartCircleOrSquare = actObj.start === 'circle' || actObj.start === 'square';\n        var isEndCircleOrSquare = actObj.end === 'circle' || actObj.end === 'square';\n        if ((start && (isStartArrowSolid && actObj.end === 'none') || (isStartArrowSolid && !isEndCircleOrSquare && !isStartCircleOrSquare)) ||\n            (!start && (isEndArrowSolid && actObj.start === 'none' || !isStartArrowSolid && !isEndCircleOrSquare && !isStartCircleOrSquare))) {\n            this.shapeLine(canvasDraw, startX, startY, endX, endY);\n        }\n        if ((start && actObj.triangleDirection === 'left') || (!start && actObj.triangleDirection === 'right')) {\n            canvasDraw.translate(endX, endY);\n            canvasDraw.rotate(angle);\n            canvasDraw.beginPath();\n            canvasDraw.moveTo(strWidth, 0);\n            canvasDraw.lineTo(-x + y / 2, y / 2);\n            canvasDraw.lineTo(-x + y / 2, -y / 2);\n            canvasDraw.closePath();\n            canvasDraw.fill();\n            canvasDraw.rotate(-angle);\n            canvasDraw.translate(-endX, -endY);\n            actObj.rotatedAngle = angle;\n        }\n        else if ((start && actObj.triangleDirection === 'right') || (!start && actObj.triangleDirection === 'left')) {\n            canvasDraw.translate(startX, startY);\n            canvasDraw.rotate(angle);\n            canvasDraw.beginPath();\n            canvasDraw.moveTo(0 - strWidth, 0);\n            canvasDraw.lineTo(x - y / 2, y / 2);\n            canvasDraw.lineTo(x - y / 2, -y / 2);\n            canvasDraw.closePath();\n            canvasDraw.fill();\n            canvasDraw.rotate(-angle);\n            canvasDraw.translate(-startX, -startY);\n            actObj.rotatedAngle = angle;\n        }\n    };\n    Draw.prototype.arrowSquareStart = function (canvasDraw) {\n        var parent = this.parent;\n        var actObj = parent.activeObj;\n        var strWidth = actObj.strokeSettings.strokeWidth;\n        var _a = actObj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY;\n        var isStartSquare = actObj.start === 'square';\n        var isEndCircle = actObj.end === 'circle';\n        var isStartSquareSolid = actObj.start === 'squareSolid';\n        var isEndCircleSolid = actObj.end === 'circleSolid';\n        if ((isStartSquare && actObj.end === 'none') || (isStartSquare && !isEndCircle && actObj.start !== 'square') ||\n            (isStartSquareSolid && isEndCircleSolid)) {\n            this.shapeLine(canvasDraw, startX, startY, endX, endY);\n        }\n        canvasDraw.lineWidth = (strWidth);\n        canvasDraw.beginPath();\n        canvasDraw.fillStyle = actObj.strokeSettings.strokeColor;\n        var x = this.arrowDimension['square']['width'];\n        var y = this.arrowDimension['square']['height'];\n        var point = this.manipulateSaveCtx(canvasDraw, x, y);\n        x = point.x + strWidth;\n        y = point.y + strWidth;\n        this.dx = endX - startX;\n        this.dy = endY - startY;\n        var angle = Math.atan2(this.dy, this.dx);\n        if (actObj.triangleDirection === 'left') {\n            canvasDraw.translate(endX, endY);\n            canvasDraw.rotate(angle);\n            if (actObj.start === 'squareSolid') {\n                canvasDraw.fillRect(-x + y / 2, -y / 2, x, y);\n            }\n            canvasDraw.strokeRect(-x + y / 2, -y / 2, x, y);\n            canvasDraw.rotate(-angle);\n            canvasDraw.translate(-endX, -endY);\n            this.squareStartIntersectX1 = endX - (y / 2) * Math.cos(angle);\n            this.squareStartIntersectY1 = endY - (y / 2) * Math.sin(angle);\n            if (actObj.start === 'square' && actObj.end !== 'square' && actObj.end !== 'circle') {\n                this.shapeLine(canvasDraw, startX, startY, this.squareStartIntersectX1, this.squareStartIntersectY1);\n            }\n            else if (actObj.start === 'square' && actObj.end === 'circle') {\n                this.shapeLine(canvasDraw, this.endCircleIntersectX1, this.endCircleIntersectY1, this.squareStartIntersectX1, this.squareStartIntersectY1);\n            }\n            else if (actObj.start === 'squareSolid' && actObj.end === 'squareSolid') {\n                this.shapeLine(canvasDraw, startX, startY, endX, endY);\n            }\n        }\n        else if (actObj.triangleDirection === 'right') {\n            canvasDraw.lineWidth = (strWidth);\n            canvasDraw.fillStyle = actObj.strokeSettings.strokeColor;\n            if (actObj.start === 'squareSolid' && actObj.end === 'squareSolid') {\n                this.shapeLine(canvasDraw, startX, startY, endX, endY);\n            }\n            canvasDraw.translate(startX, startY);\n            canvasDraw.rotate(angle);\n            if (actObj.start === 'squareSolid') {\n                canvasDraw.fillRect(y / 2 - x, -y / 2, x, y);\n            }\n            canvasDraw.strokeRect(y / 2 - x, -y / 2, x, y);\n            canvasDraw.rotate(-angle);\n            canvasDraw.translate(-startX, -startY);\n            actObj.rotatedAngle = angle;\n            this.squareStartIntersectX1 = startX + (y / 2) * Math.cos(angle);\n            this.squareStartIntersectY1 = startY + (y / 2) * Math.sin(angle);\n            if (actObj.start === 'square' && actObj.end !== 'square' && actObj.end !== 'circle') {\n                this.shapeLine(canvasDraw, endX, endY, this.squareStartIntersectX1, this.squareStartIntersectY1);\n            }\n            if (actObj.start === 'square' && actObj.end === 'circle') {\n                this.shapeLine(canvasDraw, this.endCircleIntersectX1, this.endCircleIntersectY1, this.squareStartIntersectX1, this.squareStartIntersectY1);\n            }\n        }\n    };\n    Draw.prototype.arrowSquareEnd = function (canvasDraw) {\n        var parent = this.parent;\n        var actObj = parent.activeObj;\n        var _a = actObj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY;\n        var strWidth = actObj.strokeSettings.strokeWidth;\n        var x = this.arrowDimension['square']['width'];\n        var y = this.arrowDimension['square']['height'];\n        var point = this.manipulateSaveCtx(canvasDraw, x, y);\n        x = point.x + strWidth;\n        y = point.y + strWidth;\n        this.dx = endX - startX;\n        this.dy = endY - startY;\n        var angle = Math.atan2(this.dy, this.dx);\n        canvasDraw.lineWidth = (strWidth);\n        if (actObj.triangleDirection === 'right') {\n            canvasDraw.fillStyle = actObj.strokeSettings.strokeColor;\n            if (actObj.end === 'squareSolid' && actObj.start === 'none') {\n                this.shapeLine(canvasDraw, startX, startY, endX, endY);\n            }\n            canvasDraw.translate(endX, endY);\n            canvasDraw.rotate(angle);\n            if (actObj.end === 'squareSolid') {\n                canvasDraw.fillRect(-x + y / 2, -y / 2, x, y);\n            }\n            canvasDraw.strokeRect(-x + y / 2, -y / 2, x, y);\n            canvasDraw.rotate(-angle);\n            canvasDraw.translate(-endX, -endY);\n            actObj.rotatedAngle = angle;\n            this.squareEndIntersectX1 = endX - (y / 2) * Math.cos(angle);\n            this.squareEndIntersectY1 = endY - (y / 2) * Math.sin(angle);\n            if (actObj.end === 'square' && actObj.start !== 'square' && actObj.start !== 'circle') {\n                this.shapeLine(canvasDraw, startX, startY, this.squareEndIntersectX1, this.squareEndIntersectY1);\n            }\n            else if (actObj.start === 'circle' && actObj.end === 'square') {\n                this.shapeLine(canvasDraw, this.squareEndIntersectX1, this.squareEndIntersectY1, this.startCircleIntersectX1, this.startCircleIntersectY1);\n            }\n            else if (actObj.start === 'square' && actObj.end === 'square') {\n                this.shapeLine(canvasDraw, this.squareEndIntersectX1, this.squareEndIntersectY1, this.squareStartIntersectX1, this.squareStartIntersectY1);\n            }\n        }\n        else if (actObj.triangleDirection === 'left') {\n            canvasDraw.translate(startX, startY);\n            canvasDraw.rotate(angle);\n            if (actObj.end === 'squareSolid') {\n                canvasDraw.fillRect(y / 2 - x, -y / 2, x, y);\n            }\n            canvasDraw.strokeRect(y / 2 - x, -y / 2, x, y);\n            canvasDraw.rotate(-angle);\n            canvasDraw.translate(-startX, -startY);\n            actObj.rotatedAngle = angle;\n            this.squareEndIntersectX1 = startX + (y / 2) * Math.cos(angle);\n            this.squareEndIntersectY1 = startY + (y / 2) * Math.sin(angle);\n            if (actObj.end === 'square' && actObj.start !== 'square' && actObj.start !== 'circle') {\n                this.shapeLine(canvasDraw, endX, endY, this.squareEndIntersectX1, this.squareEndIntersectY1);\n            }\n            else if (actObj.start === 'circle' && actObj.end === 'square') {\n                this.shapeLine(canvasDraw, this.squareEndIntersectX1, this.squareEndIntersectY1, this.startCircleIntersectX1, this.startCircleIntersectY1);\n            }\n            else if (actObj.start === 'square' && actObj.end === 'square') {\n                this.shapeLine(canvasDraw, this.squareEndIntersectX1, this.squareEndIntersectY1, this.squareStartIntersectX1, this.squareStartIntersectY1);\n            }\n            else if (actObj.end === 'squareSolid' && actObj.start === 'none') {\n                this.shapeLine(canvasDraw, startX, startY, endX, endY);\n            }\n        }\n    };\n    Draw.prototype.arrowCircle = function (canvasDraw, start) {\n        var parent = this.parent;\n        var actObj = parent.activeObj;\n        var _a = actObj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY;\n        var strWidth = actObj.strokeSettings.strokeWidth;\n        if ((start && actObj.triangleDirection === 'left') ||\n            (!start && actObj.triangleDirection === 'right')) {\n            canvasDraw.lineWidth = strWidth;\n            var circleRadius = this.arrowDimension['circle']['width'];\n            var point = this.manipulateSaveCtx(canvasDraw, circleRadius, null);\n            circleRadius = point.x + strWidth;\n            canvasDraw.beginPath();\n            canvasDraw.arc(endX, endY, circleRadius, 0, 2 * Math.PI);\n            canvasDraw.stroke();\n            canvasDraw.closePath();\n            this.dx = endX - startX;\n            this.dy = endY - startY;\n            var a = this.dx * this.dx + this.dy * this.dy;\n            var b = 2 * (this.dx * (startX - endX) + this.dy * (startY - endY));\n            var c = (startX - endX) * (startX - endX) + (startY - endY) *\n                (startY - endY) - circleRadius * circleRadius;\n            var intersect = b * b - 4 * a * c;\n            if (intersect >= 0) {\n                canvasDraw.fillStyle = actObj.strokeSettings.strokeColor;\n                var t2 = (-b - Math.sqrt(intersect)) / (2 * a);\n                var intersectionX1 = startX + this.dx * t2;\n                var intersectionY1 = startY + this.dy * t2;\n                if (start) {\n                    this.startCircleIntersectX1 = intersectionX1;\n                    this.startCircleIntersectY1 = intersectionY1;\n                    this.endCircleIntersectX1 = endX - this.dx * t2;\n                    this.endCircleIntersectY1 = endY - this.dy * t2;\n                    canvasDraw.beginPath();\n                    canvasDraw.fill();\n                    canvasDraw.beginPath();\n                    if (actObj.start === 'circle' && actObj.end === 'circle') {\n                        this.shapeLine(canvasDraw, this.startCircleIntersectX1, this.startCircleIntersectY1, this.endCircleIntersectX1, this.endCircleIntersectY1);\n                    }\n                    else if (actObj.start === 'circle' && actObj.end !== 'circle' && actObj.end !== 'square') {\n                        this.shapeLine(canvasDraw, startX, startY, this.startCircleIntersectX1, this.startCircleIntersectY1);\n                    }\n                    canvasDraw.stroke();\n                    canvasDraw.closePath();\n                }\n                else {\n                    this.endCircleIntersectX1 = intersectionX1;\n                    this.endCircleIntersectY1 = intersectionY1;\n                    if (actObj.end === 'circle' && (actObj.start !== 'circle' && actObj.start !== 'square')) {\n                        this.shapeLine(canvasDraw, startX, startY, this.endCircleIntersectX1, this.endCircleIntersectY1);\n                    }\n                }\n            }\n            var angle = Math.atan2(this.dy, this.dx);\n            parent.activeObj.rotatedAngle = angle;\n        }\n        else if ((start && actObj.triangleDirection === 'right') ||\n            (!start && actObj.triangleDirection === 'left')) {\n            canvasDraw.lineWidth = strWidth;\n            var circleRadius = this.arrowDimension['circle']['width'];\n            var point = this.manipulateSaveCtx(canvasDraw, circleRadius, null);\n            circleRadius = point.x + strWidth;\n            canvasDraw.beginPath();\n            canvasDraw.arc(startX, startY, circleRadius, 0, 2 * Math.PI);\n            canvasDraw.stroke();\n            canvasDraw.closePath();\n            this.dx = startX - endX;\n            this.dy = startY - endY;\n            var a = this.dx * this.dx + this.dy * this.dy;\n            var b = 2 * (this.dx * (endX - startX) + this.dy * (endY - startY));\n            var c = (endX - startX) * (endX - startX) + (endY - startY) *\n                (endY - startY) - circleRadius * circleRadius;\n            var intersect = b * b - 4 * a * c;\n            if (intersect >= 0) {\n                canvasDraw.fillStyle = actObj.strokeSettings.strokeColor;\n                var t2 = (-b - Math.sqrt(intersect)) / (2 * a);\n                var intersectionX1 = endX + this.dx * t2;\n                var intersectionY1 = endY + this.dy * t2;\n                if (start) {\n                    this.startCircleIntersectX1 = intersectionX1;\n                    this.startCircleIntersectY1 = intersectionY1;\n                    this.endCircleIntersectX1 = startX - this.dx * t2;\n                    this.endCircleIntersectY1 = startY - this.dy * t2;\n                    if (actObj.start === 'circle' && actObj.end === 'circle') {\n                        this.shapeLine(canvasDraw, this.endCircleIntersectX1, this.endCircleIntersectY1, this.startCircleIntersectX1, this.startCircleIntersectY1);\n                    }\n                    else if (actObj.start === 'circle' && actObj.end !== 'circle' && actObj.end !== 'square') {\n                        this.shapeLine(canvasDraw, endX, endY, this.startCircleIntersectX1, this.startCircleIntersectY1);\n                    }\n                }\n                else {\n                    this.endCircleIntersectX1 = intersectionX1;\n                    this.endCircleIntersectY1 = intersectionY1;\n                    canvasDraw.beginPath();\n                    canvasDraw.fill();\n                    canvasDraw.beginPath();\n                    if (actObj.end === 'circle' && (actObj.start !== 'circle' && actObj.start !== 'square')) {\n                        this.shapeLine(canvasDraw, endX, endY, this.endCircleIntersectX1, this.endCircleIntersectY1);\n                    }\n                }\n            }\n            var angle = Math.atan2(this.dy, this.dx);\n            parent.activeObj.rotatedAngle = angle;\n        }\n    };\n    Draw.prototype.arrowCircleSolid = function (canvasDraw, start) {\n        var parent = this.parent;\n        var actObj = parent.activeObj;\n        var _a = actObj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY;\n        var isStartCircleSolid = actObj.start === 'circleSolid';\n        var strWidth = actObj.strokeSettings.strokeWidth;\n        if ((start && actObj.triangleDirection === 'left') || (!start && actObj.triangleDirection === 'right')) {\n            canvasDraw.lineWidth = strWidth;\n            canvasDraw.beginPath();\n            canvasDraw.fillStyle = actObj.strokeSettings.strokeColor;\n            if ((start && (isStartCircleSolid && actObj.end === 'none') ||\n                (isStartCircleSolid && actObj.end !== 'circle' && actObj.end !== 'square')) ||\n                (!start && (actObj.end === 'circleSolid' && actObj.start === 'none'))) {\n                this.shapeLine(canvasDraw, startX, startY, endX, endY);\n            }\n            var circleRadius = this.arrowDimension['circle']['width'];\n            var point = this.manipulateSaveCtx(canvasDraw, circleRadius, null);\n            circleRadius = point.x + strWidth;\n            this.dx = endX - startX;\n            this.dy = endY - startY;\n            canvasDraw.save();\n            canvasDraw.beginPath();\n            canvasDraw.arc(endX, endY, circleRadius, 0, 2 * Math.PI);\n            canvasDraw.stroke();\n            canvasDraw.fill();\n            canvasDraw.closePath();\n            actObj.rotatedAngle = Math.atan2(this.dy, this.dx);\n        }\n        else if ((start && actObj.triangleDirection === 'right') || (!start && actObj.triangleDirection === 'left')) {\n            canvasDraw.lineWidth = strWidth;\n            canvasDraw.beginPath();\n            canvasDraw.fillStyle = actObj.strokeSettings.strokeColor;\n            if ((start && (isStartCircleSolid && actObj.end === 'none') ||\n                (isStartCircleSolid && actObj.end !== 'circle' && actObj.end !== 'square')) ||\n                !start && (actObj.end === 'circleSolid' && actObj.start === 'none')) {\n                this.shapeLine(canvasDraw, startX, startY, endX, endY);\n            }\n            var circleRadius = this.arrowDimension['circle']['width'];\n            var point = this.manipulateSaveCtx(canvasDraw, circleRadius, null);\n            circleRadius = point.x + strWidth;\n            this.dx = endX - startX;\n            this.dy = endY - startY;\n            canvasDraw.save();\n            canvasDraw.beginPath();\n            canvasDraw.arc(startX, startY, circleRadius, 0, 2 * Math.PI);\n            canvasDraw.stroke();\n            canvasDraw.fill();\n            canvasDraw.closePath();\n            actObj.rotatedAngle = Math.atan2(this.dy, this.dx);\n        }\n    };\n    Draw.prototype.arrowBar = function (canvasDraw, start) {\n        var parent = this.parent;\n        var actObj = parent.activeObj;\n        var _a = actObj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY;\n        var strWidth = actObj.strokeSettings.strokeWidth;\n        if ((start && actObj.triangleDirection === 'left') || (!start && actObj.triangleDirection === 'right')) {\n            canvasDraw.lineWidth = strWidth;\n            canvasDraw.beginPath();\n            canvasDraw.fillStyle = actObj.strokeSettings.strokeColor;\n            if ((start && (actObj.start === 'bar' && actObj.end === 'none') ||\n                (actObj.start === 'bar' && (actObj.end !== 'circle' && actObj.end !== 'square'))) ||\n                (!start && ((actObj.end === 'bar' && actObj.start === 'none') ||\n                    (actObj.end === 'bar' && (actObj.start !== 'circle' && actObj.start !== 'square'))))) {\n                this.shapeLine(canvasDraw, startX, startY, endX, endY);\n            }\n            var x = this.arrowDimension['bar']['width'];\n            var y = this.arrowDimension['bar']['height'];\n            var point = this.manipulateSaveCtx(canvasDraw, x, y);\n            x = point.x + strWidth;\n            y = point.y + strWidth;\n            this.dx = endX - startX;\n            this.dy = endY - startY;\n            var angle = Math.atan2(this.dy, this.dx);\n            canvasDraw.translate(endX, endY);\n            canvasDraw.rotate(angle);\n            canvasDraw.fillRect(-x + y / 4, -y / 2, x, y);\n            canvasDraw.rotate(-angle);\n            canvasDraw.translate(-endX, -endY);\n            actObj.rotatedAngle = angle;\n        }\n        else if ((start && actObj.triangleDirection === 'right') || (!start && actObj.triangleDirection === 'left')) {\n            canvasDraw.lineWidth = strWidth;\n            canvasDraw.beginPath();\n            canvasDraw.fillStyle = actObj.strokeSettings.strokeColor;\n            if ((start && (actObj.start === 'bar' && actObj.end === 'none')\n                || (actObj.start === 'bar' && (actObj.end !== 'circle' && actObj.end !== 'square'))) ||\n                (!start && (actObj.end === 'bar' && actObj.start === 'none'))) {\n                this.shapeLine(canvasDraw, startX, startY, endX, endY);\n            }\n            var x = this.arrowDimension['bar']['width'];\n            var y = this.arrowDimension['bar']['height'];\n            var point = this.manipulateSaveCtx(canvasDraw, x, y);\n            x = point.x + strWidth;\n            y = point.y + strWidth;\n            this.dx = endX - startX;\n            this.dy = endY - startY;\n            var angle = Math.atan2(this.dy, this.dx);\n            canvasDraw.translate(startX, startY);\n            canvasDraw.rotate(angle);\n            canvasDraw.fillRect(y / 4 - x, -y / 2, x, y);\n            canvasDraw.rotate(-angle);\n            canvasDraw.translate(-startX, -startY);\n            parent.activeObj.rotatedAngle = angle;\n        }\n    };\n    Draw.prototype.shapeImage = function (canvasDraw) {\n        var parent = this.parent;\n        var actObj = parent.activeObj;\n        var _a = actObj.activePoint, startX = _a.startX, startY = _a.startY, width = _a.width, height = _a.height;\n        var ctx = actObj.imageCanvas.getContext('2d');\n        if (canvasDraw === this.lowerContext && this.isImageApply) {\n            var dimObj = { width: 0, height: 0 };\n            parent.notify('transform', { prop: 'calcMaxDimension', onPropertyChange: false, value: { width: actObj\n                        .imageElement.width, height: actObj.imageElement.height, obj: dimObj, isImgShape: null } });\n            if (width < (dimObj['width'] / 5) || height < (dimObj['height'] / 5)) {\n                ctx.clearRect(0, 0, actObj.imageCanvas.width, actObj.imageCanvas.height);\n                parent.notify('selection', { prop: 'applyTransformToImg', onPropertyChange: false, value: { ctx: ctx } });\n                parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate' } });\n                this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                parent.notify('selection', { prop: 'setImageClarity', onPropertyChange: false, value: { bool: false } });\n                this.isImageApply = false;\n            }\n        }\n        var imgPoint = { startX: 0, startY: 0, width: 0, height: 0 };\n        imgPoint.width = width;\n        imgPoint.height = height;\n        if (actObj.flipObjColl.length === 4) {\n            actObj.flipObjColl = [];\n            actObj.shapeFlip = '';\n        }\n        imgPoint.startX = ((width - imgPoint.width) / 2) + startX;\n        imgPoint.startY = ((height - imgPoint.height) / 2) + startY;\n        var temp = canvasDraw.globalAlpha;\n        canvasDraw.globalAlpha = actObj.opacity;\n        if (actObj.rotateFlipColl && actObj.rotateFlipColl.length > 0) {\n            this.rotateImage(canvasDraw);\n        }\n        else {\n            canvasDraw.drawImage(actObj.imageCanvas, imgPoint.startX, imgPoint.startY, imgPoint.width, imgPoint.height);\n        }\n        canvasDraw.globalAlpha = temp;\n        parent.currObjType.isText = false;\n    };\n    Draw.prototype.shapeText = function (canvasDraw) {\n        var parent = this.parent;\n        var filter = canvasDraw.filter;\n        var actObj = parent.activeObj;\n        var _a = actObj.activePoint, startX = _a.startX, startY = _a.startY, width = _a.width, height = _a.height;\n        var rows = actObj.keyHistory.split('\\n');\n        var _b = actObj.textSettings, fontFamily = _b.fontFamily, bold = _b.bold, italic = _b.italic;\n        var fontSize = actObj.textSettings.fontSize;\n        var lHeight = fontSize + fontSize * 0.25;\n        var lineHeight = ((lHeight * rows.length) - (fontSize * rows.length)) / rows.length;\n        canvasDraw.filter = 'none';\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        var tempFill = canvasDraw.fillStyle;\n        if (actObj.strokeSettings.fillColor !== '') {\n            canvasDraw.fillStyle = actObj.strokeSettings.fillColor;\n            canvasDraw.fillRect(actObj.activePoint.startX, actObj.activePoint.startY, actObj.activePoint.width, actObj.activePoint.height);\n        }\n        canvasDraw.fillStyle = tempFill;\n        for (var i = 0; i < rows.length; i++) {\n            var text = rows[i];\n            var yPoint = ((i + 1) * fontSize * 0.85) + (i * lineHeight);\n            if (parent.transform.degree === -360) {\n                parent.transform.degree = 0;\n            }\n            if (parent.transform.degree === 0 || parent.transform.degree === 180) {\n                if (fontSize > height) {\n                    fontSize = actObj.textSettings.fontSize = height - (height * 0.1);\n                }\n            }\n            else {\n                if (fontSize > width) {\n                    fontSize = actObj.textSettings.fontSize = width - (width * 0.1);\n                }\n            }\n            canvasDraw.strokeStyle = actObj.strokeSettings.outlineColor;\n            canvasDraw.fillStyle = actObj.strokeSettings.strokeColor;\n            var tempWidth = canvasDraw.lineWidth;\n            var obj = { width: 0, height: 0 };\n            var ratio = { width: 1, height: 1 };\n            parent.notify('crop', { prop: 'calcRatio', onPropertyChange: false,\n                value: { obj: obj, dimension: { width: canvasDraw.canvas.width, height: canvasDraw.canvas.height } } });\n            ratio = obj;\n            var isTempCanvas = canvasDraw.canvas.id === parent.element.id + '_tempCanvas';\n            var baseWidth = Math.max(1, actObj.strokeSettings.outlineWidth / 2);\n            if (/^#([0-9A-Fa-f]{3}|[0-9A-Fa-f]{6}|[0-9A-Fa-f]{8})$|^[a-zA-Z]+$/.test(actObj.strokeSettings.outlineColor)) {\n                canvasDraw.lineWidth = baseWidth * ((isTempCanvas ? Math.floor((fontSize - 1) / 60) :\n                    Math.floor((fontSize - 1) / 16)) * 0.5 + 0.5);\n                if (isTempCanvas) {\n                    canvasDraw.lineWidth *= ((ratio.width + ratio.height) / 2);\n                    if (parent.transform.degree !== 0) {\n                        canvasDraw.lineWidth /= 1.8;\n                    }\n                }\n            }\n            else {\n                canvasDraw.lineWidth = 0;\n            }\n            var textStyle = '';\n            if (bold) {\n                textStyle = 'bold ';\n            }\n            if (italic) {\n                textStyle = 'italic ';\n            }\n            if (bold && italic) {\n                textStyle = 'italic bold ';\n            }\n            canvasDraw.font = textStyle + fontSize + 'px' + ' ' + fontFamily;\n            if (actObj.flipObjColl.length === 4) {\n                actObj.flipObjColl = [];\n                actObj.shapeFlip = '';\n            }\n            if (actObj.rotateFlipColl && actObj.rotateFlipColl.length > 0) {\n                this.rotateText(canvasDraw);\n            }\n            else {\n                canvasDraw.strokeText(text, startX + fontSize * 0.1, startY + yPoint);\n                canvasDraw.fillText(text, startX + fontSize * 0.1, startY + yPoint);\n            }\n            canvasDraw.lineWidth = tempWidth;\n        }\n        canvasDraw.filter = filter;\n        parent.currObjType.isText = false;\n        if (this.upperContext === canvasDraw) {\n            this.drawOuterSelection(canvasDraw);\n        }\n    };\n    Draw.prototype.updateActPoint = function (degree, canvasDraw) {\n        var parent = this.parent;\n        var actObj = parent.activeObj;\n        var actPoint = actObj.activePoint;\n        if (degree.toLowerCase() === 'horizontal') {\n            if (actPoint.startX <= canvasDraw.canvas.width / 2) {\n                actPoint.startX = canvasDraw.canvas.width / 2 + ((canvasDraw.canvas.width / 2) - actPoint.endX);\n                actPoint.endX = actPoint.startX + actPoint.width;\n                this.updateActiveObject(actPoint, actObj);\n                parent.activeObj = actObj;\n            }\n            else if (actPoint.startX >= canvasDraw.canvas.width / 2) {\n                actPoint.startX = canvasDraw.canvas.width - actPoint.endX;\n                actPoint.endX = actPoint.startX + actPoint.width;\n                this.updateActiveObject(actPoint, actObj);\n                parent.activeObj = actObj;\n            }\n        }\n        else if (degree.toLowerCase() === 'vertical') {\n            if (actPoint.startY <= canvasDraw.canvas.height / 2) {\n                actPoint.startY = canvasDraw.canvas.height / 2 + ((canvasDraw.canvas.height / 2) - actPoint.endY);\n                actPoint.endY = actPoint.startY + actPoint.height;\n                this.updateActiveObject(actPoint, actObj);\n                parent.activeObj = actObj;\n            }\n            else if (actPoint.startY >= canvasDraw.canvas.height / 2) {\n                actPoint.startY = canvasDraw.canvas.height - actPoint.endY;\n                actPoint.endY = actPoint.startY + actPoint.height;\n                this.updateActiveObject(actPoint, actObj);\n                parent.activeObj = actObj;\n            }\n        }\n        return actPoint;\n    };\n    Draw.prototype.rotateImage = function (canvasDraw) {\n        var parent = this.parent;\n        var degree;\n        var actObj = parent.activeObj;\n        var tempActiveObj = extend({}, parent.activeObj, null, true);\n        if (actObj.shapeDegree === 0) {\n            degree = parent.transform.degree;\n        }\n        else {\n            degree = parent.transform.degree - actObj.shapeDegree;\n        }\n        if (degree === -450) {\n            degree = -90;\n        }\n        if (degree < 0) {\n            degree = 360 + degree;\n        }\n        var imgPoint = { startX: 0, startY: 0, width: 0, height: 0 };\n        imgPoint.width = degree % 90 === 0 && degree % 180 !== 0 ? actObj.activePoint.height : actObj.activePoint.width;\n        imgPoint.height = degree % 90 === 0 && degree % 180 !== 0 ? actObj.activePoint.width :\n            actObj.activePoint.height;\n        imgPoint.startX = actObj.activePoint.startX;\n        imgPoint.startY = actObj.activePoint.startY;\n        var startX = imgPoint.startX;\n        var startY = imgPoint.startY;\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var tempDegree;\n        var tempColl = [];\n        canvasDraw.save();\n        for (var i = 0, len = actObj.rotateFlipColl.length; i < len; i++) {\n            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n            var coll = actObj.rotateFlipColl[i];\n            tempColl.push(coll);\n            if (typeof (coll) === 'number') {\n                tempDegree = coll;\n                if (tempDegree === -450) {\n                    tempDegree = -90;\n                }\n                if (tempDegree < 0) {\n                    tempDegree = 360 + tempDegree;\n                }\n                imgPoint.width = tempDegree % 90 === 0 && tempDegree % 180 !== 0 ? actObj.activePoint.height : actObj.activePoint.width;\n                imgPoint.height = tempDegree % 90 === 0 && tempDegree % 180 !== 0 ? actObj.activePoint.width :\n                    actObj.activePoint.height;\n                canvasDraw.translate(canvasDraw.canvas.width / 2, canvasDraw.canvas.height / 2);\n                canvasDraw.rotate(Math.PI / 180 * coll);\n                canvasDraw.translate(-canvasDraw.canvas.height / 2, -canvasDraw.canvas.width / 2);\n                if ((tempDegree % 90 === 0 && tempDegree % 270 !== 0) || tempDegree === 0) {\n                    startY = canvasDraw.canvas.width - (actObj.activePoint.startX + actObj.activePoint.width);\n                    startY += ((actObj.activePoint.width - imgPoint.height) / 2);\n                    startX = imgPoint.startY;\n                }\n                else if (tempDegree % 270 === 0) {\n                    startX = canvasDraw.canvas.height - (actObj.activePoint.startY + actObj.activePoint.height);\n                    startX += ((actObj.activePoint.height - imgPoint.width) / 2);\n                    startY = imgPoint.startX;\n                }\n                imgPoint.startX = startX;\n                imgPoint.startY = startY;\n                actObj.activePoint.startX = startX;\n                actObj.activePoint.startY = startY;\n                actObj.activePoint.endX = actObj.activePoint.startX + imgPoint.width;\n                actObj.activePoint.endY = actObj.activePoint.startY + imgPoint.height;\n                actObj = this.updateWidthHeight(actObj);\n            }\n            else {\n                if (coll === 'horizontal' && degree % 90 === 0 && degree % 180 !== 0) {\n                    coll = 'vertical';\n                }\n                else if (coll === 'vertical' && degree % 90 === 0 && degree % 180 !== 0) {\n                    coll = 'horizontal';\n                }\n                if (coll === 'horizontal') {\n                    canvasDraw.translate(canvasDraw.canvas.width, 0);\n                    canvasDraw.scale(-1, 1);\n                    actObj.activePoint = this.updateActPoint('horizontal', canvasDraw);\n                }\n                else if (coll === 'vertical') {\n                    canvasDraw.translate(0, canvasDraw.canvas.height);\n                    canvasDraw.scale(1, -1);\n                    actObj.activePoint = this.updateActPoint('vertical', canvasDraw);\n                }\n                imgPoint.startX = actObj.activePoint.startX;\n                imgPoint.startY = actObj.activePoint.startY;\n            }\n            imgPoint.startX = actObj.activePoint.startX;\n            imgPoint.startY = actObj.activePoint.startY;\n            startX = imgPoint.startX;\n            startY = imgPoint.startY;\n        }\n        if (actObj.rotatedAngle !== 0) {\n            parent.notify('shape', { prop: 'setPointCollForShapeRotation', onPropertyChange: false, value: { obj: actObj } });\n        }\n        canvasDraw.drawImage(actObj.imageCanvas, imgPoint.startX, imgPoint.startY, imgPoint.width, imgPoint.height);\n        canvasDraw.restore();\n        parent.activeObj = tempActiveObj;\n        if (parent.transform.degree === 360 || parent.transform.degree === -360) {\n            parent.transform.degree = 0;\n        }\n    };\n    Draw.prototype.rotateText = function (canvasDraw) {\n        var parent = this.parent;\n        var degree;\n        var actObj = parent.activeObj;\n        var tempActiveObj = extend({}, parent.activeObj, null, true);\n        var actPoint = parent.activeObj.activePoint;\n        if (actObj.shapeDegree === 0) {\n            degree = parent.transform.degree;\n        }\n        else {\n            degree = parent.transform.degree - actObj.shapeDegree;\n        }\n        if (degree === -450) {\n            degree = -90;\n        }\n        if (degree < 0) {\n            degree = 360 + degree;\n        }\n        var imgPoint = { startX: 0, startY: 0, width: 0, height: 0 };\n        imgPoint.width = degree % 90 === 0 && degree % 180 !== 0 ? actPoint.height : actPoint.width;\n        imgPoint.height = degree % 90 === 0 && degree % 180 !== 0 ? actPoint.width : actPoint.height;\n        imgPoint.startX = actPoint.startX;\n        imgPoint.startY = actPoint.startY;\n        var startX = imgPoint.startX;\n        var startY = imgPoint.startY;\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var tempDegree;\n        var tempColl = [];\n        canvasDraw.save();\n        for (var i = 0, len = actObj.rotateFlipColl.length; i < len; i++) {\n            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n            var coll = actObj.rotateFlipColl[i];\n            tempColl.push(coll);\n            if (typeof (coll) === 'number') {\n                tempDegree = coll;\n                if (tempDegree === -450) {\n                    tempDegree = -90;\n                }\n                if (tempDegree < 0) {\n                    tempDegree = 360 + tempDegree;\n                }\n                imgPoint.width = tempDegree % 90 === 0 && tempDegree % 180 !== 0 ? actPoint.height : actPoint.width;\n                imgPoint.height = tempDegree % 90 === 0 && tempDegree % 180 !== 0 ? actPoint.width : actPoint.height;\n                canvasDraw.translate(canvasDraw.canvas.width / 2, canvasDraw.canvas.height / 2);\n                canvasDraw.rotate(Math.PI / 180 * coll);\n                canvasDraw.translate(-canvasDraw.canvas.height / 2, -canvasDraw.canvas.width / 2);\n                if ((tempDegree % 90 === 0 && tempDegree % 270 !== 0) || tempDegree === 0) {\n                    startY = (canvasDraw.canvas.width - actPoint.endX);\n                    startX = actPoint.startY;\n                }\n                else if (tempDegree % 270 === 0) {\n                    startX = canvasDraw.canvas.height - actPoint.endY;\n                    startY = actPoint.startX;\n                }\n                imgPoint.startX = startX;\n                imgPoint.startY = startY;\n                actPoint.startX = startX;\n                actPoint.startY = startY;\n                actPoint.endX = actPoint.startX + imgPoint.width;\n                actPoint.endY = actPoint.startY + imgPoint.height;\n                actObj = this.updateWidthHeight(actObj);\n            }\n            else {\n                if (coll === 'horizontal' && degree % 90 === 0 && degree % 180 !== 0) {\n                    coll = 'vertical';\n                }\n                else if (coll === 'vertical' && degree % 90 === 0 && degree % 180 !== 0) {\n                    coll = 'horizontal';\n                }\n                if (coll === 'horizontal') {\n                    canvasDraw.translate(canvasDraw.canvas.width, 0);\n                    canvasDraw.scale(-1, 1);\n                }\n                else if (coll === 'vertical') {\n                    canvasDraw.translate(0, canvasDraw.canvas.height);\n                    canvasDraw.scale(1, -1);\n                }\n                actObj.activePoint = actPoint = this.updateActPoint(coll, canvasDraw);\n                imgPoint.startX = actPoint.startX;\n                imgPoint.startY = actPoint.startY;\n            }\n            imgPoint.startX = actPoint.startX;\n            imgPoint.startY = actPoint.startY;\n            startX = imgPoint.startX;\n            startY = imgPoint.startY;\n        }\n        if (actObj.rotatedAngle !== 0) {\n            parent.notify('shape', { prop: 'setPointCollForShapeRotation', onPropertyChange: false, value: { obj: actObj } });\n        }\n        startY += actObj.textSettings.fontSize * 0.4;\n        this.textFlipDegree(canvasDraw, startX, startY);\n        canvasDraw.restore();\n        parent.activeObj = tempActiveObj;\n        if (parent.transform.degree === 360 || parent.transform.degree === -360) {\n            parent.transform.degree = 0;\n        }\n    };\n    Draw.prototype.textFlipDegree = function (canvasDraw, startX, startY) {\n        var parent = this.parent;\n        var actObj = parent.activeObj;\n        var rows = actObj.keyHistory.split('\\n');\n        var fontSize = actObj.textSettings.fontSize;\n        var lineHeight = ((fontSize * rows.length) - (fontSize * rows.length)) / rows.length;\n        var yPoint = (fontSize * 0.85) + lineHeight;\n        for (var i = 0, len = rows.length; i < len; i++) {\n            var text = rows[i];\n            if (i > 0) {\n                if (i === 1) {\n                    yPoint -= (fontSize * 0.85);\n                }\n                yPoint += fontSize + fontSize * 0.15;\n            }\n            canvasDraw.strokeText(text, startX + fontSize * 0.15, startY +\n                yPoint + (i > 0 ? fontSize * 0.25 : -fontSize * 0.35));\n            canvasDraw.fillText(text, startX + fontSize * 0.15, startY +\n                yPoint + (i > 0 ? fontSize * 0.25 : -fontSize * 0.35));\n        }\n    };\n    Draw.prototype.clearOuterCanvas = function (context) {\n        var parent = this.parent;\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        var left = destLeft > 0 ? destLeft : 0;\n        var top = destTop > 0 ? destTop : 0;\n        context.clearRect(0, 0, left, parent.lowerCanvas.height);\n        context.clearRect(destLeft + destWidth, 0, parent.lowerCanvas.width - (destLeft + destWidth), parent.lowerCanvas.height);\n        context.clearRect(0, 0, parent.lowerCanvas.width, top);\n        context.clearRect(0, destTop + destHeight, parent.lowerCanvas.width, parent.lowerCanvas.height - (destTop + destHeight));\n        if (parent.transform.currFlipState !== '') {\n            parent.img.destLeft = destLeft;\n            parent.img.destTop = destTop;\n        }\n    };\n    Draw.prototype.setDestPoints = function () {\n        var maxDimension;\n        var parent = this.parent;\n        var _a = parent.transform, degree = _a.degree, zoomFactor = _a.zoomFactor;\n        if (degree % 90 === 0 && degree % 180 !== 0) {\n            var obj = { width: 0, height: 0 };\n            parent.notify('transform', { prop: 'calcMaxDimension', onPropertyChange: false,\n                value: { width: parent.img.srcHeight, height: parent.img.srcWidth, obj: obj, isImgShape: null } });\n            maxDimension = obj;\n            if (this.isRotateZoom) {\n                maxDimension.width += (maxDimension.width * zoomFactor);\n                maxDimension.height += (maxDimension.height * zoomFactor);\n                parent.img.destWidth = maxDimension.height;\n                parent.img.destHeight = maxDimension.width;\n            }\n            parent.img.destLeft = (parent.lowerCanvas.clientWidth - maxDimension.height) / 2;\n            parent.img.destTop = (parent.lowerCanvas.clientHeight - maxDimension.width) / 2;\n            parent.img.destWidth = maxDimension.height;\n            parent.img.destHeight = maxDimension.width;\n        }\n        else {\n            var obj = { width: 0, height: 0 };\n            parent.notify('transform', { prop: 'calcMaxDimension', onPropertyChange: false,\n                value: { width: parent.img.srcWidth, height: parent.img.srcHeight, obj: obj, isImgShape: null } });\n            maxDimension = obj;\n            if (this.isRotateZoom) {\n                maxDimension.width += (maxDimension.width * zoomFactor);\n                maxDimension.height += (maxDimension.height * zoomFactor);\n                parent.img.destWidth = maxDimension.width;\n                parent.img.destHeight = maxDimension.height;\n            }\n            parent.img.destLeft = (parent.lowerCanvas.clientWidth - maxDimension.width) / 2;\n            if (degree === 0) {\n                parent.img.destTop = (parent.lowerCanvas.clientHeight - maxDimension.height + 1) / 2;\n            }\n            else {\n                parent.img.destTop = (parent.lowerCanvas.clientHeight - maxDimension.height) / 2;\n            }\n            parent.img.destWidth = maxDimension.width;\n            parent.img.destHeight = maxDimension.height;\n        }\n    };\n    Draw.prototype.updateCurrTransState = function (type, isPreventDestination, isRotatePan, isStraighten) {\n        var parent = this.parent;\n        var destLeft = parent.img.destLeft;\n        var destTop = parent.img.destTop;\n        if (type === 'initial') {\n            this.lowerContext.setTransform(1, 0, 0, 1, 0, 0);\n            if (isNullOrUndefined(isPreventDestination)) {\n                this.setDestPoints();\n            }\n        }\n        if (parent.isCircleCrop || (parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle')) {\n            this.currTransState(type, true, null, isRotatePan);\n            if (parent.transform.degree === 0 && parent.transform.currFlipState === '' && parent.transform.straighten === 0 &&\n                isNullOrUndefined(isStraighten)) {\n                parent.img.destLeft = destLeft;\n                parent.img.destTop = destTop;\n            }\n            if (isRotatePan) {\n                parent.img.destLeft += parent.panPoint.totalPannedClientPoint.x;\n                parent.img.destTop +=\n                    parent.panPoint.totalPannedClientPoint.y;\n            }\n            parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                value: { context: this.lowerContext, isSave: null, isFlip: null } });\n            if (isRotatePan) {\n                parent.img.destLeft -= parent.panPoint.totalPannedClientPoint.x;\n                parent.img.destTop -=\n                    parent.panPoint.totalPannedClientPoint.y;\n            }\n        }\n        else {\n            this.currTransState(type, null, null, isRotatePan);\n            if (parent.transform.degree === 0 && parent.transform.currFlipState === '' && parent.transform.straighten === 0 &&\n                isNullOrUndefined(isStraighten)) {\n                parent.img.destLeft = destLeft;\n                parent.img.destTop = destTop;\n            }\n        }\n    };\n    Draw.prototype.currTransState = function (type, isPreventDimension, context, isPreventCircleCrop) {\n        var parent = this.parent;\n        context = context ? context : this.lowerContext;\n        if (type === 'initial') {\n            this.setTransformColl(context, type);\n        }\n        else if (type === 'reverse') {\n            this.setTransformColl(context, type);\n            this.setClientTransDim(isPreventDimension);\n            if (parent.isCircleCrop || (parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle'\n                && isNullOrUndefined(isPreventCircleCrop))) {\n                if (isPreventCircleCrop) {\n                    parent.img.destLeft += parent.panPoint.totalPannedClientPoint.x;\n                    parent.img.destTop += parent.panPoint.totalPannedClientPoint.y;\n                }\n                parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                    value: { context: this.lowerContext, isSave: null, isFlip: null } });\n                if (isPreventCircleCrop) {\n                    parent.img.destLeft -= parent.panPoint.totalPannedClientPoint.x;\n                    parent.img.destTop -= parent.panPoint.totalPannedClientPoint.y;\n                }\n            }\n        }\n    };\n    Draw.prototype.setTransformColl = function (context, type) {\n        var parent = this.parent;\n        if (type === 'initial') {\n            for (var i = 0, len = parent.rotateFlipColl.length; i < len; i++) {\n                this.setTransform(context, parent.rotateFlipColl[i]);\n            }\n        }\n        else if (type === 'reverse') {\n            for (var i = parent.rotateFlipColl.length - 1; i >= 0; i--) {\n                this.setTransform(context, parent.rotateFlipColl[i], true);\n            }\n        }\n    };\n    Draw.prototype.setTransform = function (context, value, isReverse) {\n        var parent = this.parent;\n        if (isReverse && value === 90) {\n            value = -90;\n        }\n        else if (isReverse && value === -90) {\n            value = 90;\n        }\n        if (value === 'horizontal' && parent.transform.degree % 90 === 0 && parent.transform.degree % 180 !== 0) {\n            value = 'vertical';\n        }\n        else if (value === 'vertical' && parent.transform.degree % 90 === 0 && parent.transform.degree % 180 !== 0) {\n            value = 'horizontal';\n        }\n        parent.notify('transform', { prop: 'setReverseRotate', onPropertyChange: false, value: { bool: true } });\n        parent.notify('transform', { prop: 'setReverseFlip', onPropertyChange: false, value: { isReverseFlip: true } });\n        if (isNullOrUndefined(isReverse)) {\n            context.clearRect(0, 0, context.canvas.width, context.canvas.height);\n        }\n        switch (value) {\n            case 90:\n            case -90:\n                context.translate(context.canvas.width / 2, context.canvas.height / 2);\n                context.rotate(Math.PI / 180 * value);\n                context.translate(-context.canvas.width / 2, -context.canvas.height / 2);\n                break;\n            case 'horizontal':\n                context.translate(context.canvas.width, 0);\n                context.scale(-1, 1);\n                break;\n            case 'vertical':\n                context.translate(0, context.canvas.height);\n                context.scale(1, -1);\n                break;\n        }\n        parent.notify('transform', { prop: 'setReverseRotate', onPropertyChange: false, value: { bool: false } });\n        parent.notify('transform', { prop: 'setReverseFlip', onPropertyChange: false, value: { isReverseFlip: false } });\n    };\n    Draw.prototype.drawImgToCanvas = function (maxDimension) {\n        var parent = this.parent;\n        this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        parent.img.destWidth = maxDimension.width;\n        parent.img.destHeight = maxDimension.height;\n        if (this.isInitialLoading) {\n            parent.notify('filter', { prop: 'initFilter', onPropertyChange: false });\n            this.isInitialLoading = false;\n        }\n        var temp = this.lowerContext.filter;\n        this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        this.drawImage();\n        if ((parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle') || parent.isCircleCrop) {\n            parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                value: { context: this.lowerContext, isSave: null, isFlip: null } });\n        }\n        this.lowerContext.filter = temp;\n    };\n    Draw.prototype.renderImage = function (isMouseWheel, isPreventClearRect, isFrame, isStraighten) {\n        var parent = this.parent;\n        parent.notify('shape', { prop: 'applyActObj', onPropertyChange: false, value: { isMouseDown: null } });\n        if (isNullOrUndefined(isPreventClearRect)) {\n            this.upperContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n            this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        }\n        if (isMouseWheel) {\n            this.setTransformColl(this.lowerContext, 'initial');\n        }\n        else {\n            if (parent.transform.zoomFactor !== 0) {\n                this.isRotateZoom = true;\n            }\n            this.updateCurrTransState('initial', null, null, isStraighten);\n        }\n        parent.notify('transform', { prop: 'setDestPointsForFlipState', onPropertyChange: false });\n        this.drawImage();\n        parent.notify('transform', { prop: 'setDestPointsForFlipState', onPropertyChange: false });\n        if (isMouseWheel) {\n            this.setTransformColl(this.lowerContext, 'reverse');\n        }\n        else {\n            this.updateCurrTransState('reverse', null, null, isStraighten);\n            this.isRotateZoom = false;\n        }\n        if (isFrame) {\n            parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n                value: { ctx: this.lowerContext, shape: 'zoom', pen: 'zoom', isPreventApply: null } });\n        }\n        else {\n            parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n                value: { ctx: this.lowerContext, shape: 'iterate', pen: 'iterate', isPreventApply: null } });\n        }\n        this.clearOuterCanvas(this.lowerContext);\n        if (parent.isCircleCrop || (parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle')) {\n            parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                value: { context: this.lowerContext, isSave: null, isFlip: null } });\n        }\n    };\n    Draw.prototype.imageOnLoad = function (src) {\n        var _this = this;\n        var parent = this.parent;\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        var proxy = this;\n        parent.baseImg.src = src;\n        parent.baseImg.onload = function () {\n            parent.imgSrc = src;\n            if (!parent.isUndoRedo) {\n                parent.notify('filter', { prop: 'update-finetunes', onPropertyChange: false });\n            }\n            proxy.lowerContext.drawImage(parent.baseImg, 0, 0, proxy.parent.lowerCanvas.width, proxy.parent.lowerCanvas.height);\n            var isCropped = false;\n            var isSameDimension = false;\n            if (parent.isImageUpdated) {\n                var _a = parent.img, srcWidth = _a.srcWidth, srcHeight = _a.srcHeight;\n                var _b = parent.baseImgCanvas, width = _b.width, height = _b.height;\n                isCropped = srcWidth !== width || srcHeight !== height;\n                isSameDimension = parent.baseImg.width === width && parent.baseImg.height === height;\n            }\n            hideSpinner(parent.element);\n            parent.element.style.opacity = '1';\n            proxy.updateBaseImgCanvas();\n            var fileOpened = { fileName: _this.fileName, fileType: _this.fileType, isValidImage: true };\n            proxy.updateCanvas(isCropped, isSameDimension);\n            if (parent.currObjType.isUndoZoom) {\n                parent.currObjType.isUndoZoom = false;\n                proxy.parent.lowerCanvas.style.display = 'block';\n            }\n            parent.isUndoRedo = _this.isErrorImage = false;\n            if (Browser.isDevice) {\n                parent.notify('toolbar', { prop: 'destroy-top-toolbar', onPropertyChange: false });\n                parent.notify('toolbar', { prop: 'destroy-bottom-toolbar', onPropertyChange: false });\n                var eventargs = { isApplyBtn: false, isDevice: Browser.isDevice, isOkBtn: null,\n                    isResize: null, isFrame: null, isMainToolbar: true };\n                parent.notify('toolbar', { prop: 'init-main-toolbar', onPropertyChange: false, value: eventargs });\n                parent.notify('toolbar', { prop: 'create-bottom-toolbar', onPropertyChange: false });\n            }\n            else {\n                parent.notify('toolbar', { prop: 'destroy-top-toolbar', onPropertyChange: false });\n                var eventargs = { isApplyBtn: false, isDevice: false, isOkBtn: null };\n                parent.notify('toolbar', { prop: 'init-main-toolbar', onPropertyChange: false, value: eventargs });\n            }\n            if (parent.isImageLoaded && parent.element.style.opacity !== '0.5') {\n                parent.trigger('fileOpened', fileOpened);\n                var action = { action: 'file-open', actionEventArgs: fileOpened };\n                parent.triggerEditCompleteEvent(action);\n            }\n        };\n        parent.baseImg.onerror = function () {\n            hideSpinner(parent.element);\n            proxy.isErrorImage = true;\n            proxy.errorLoading();\n        };\n    };\n    Draw.prototype.errorLoading = function () {\n        var parent = this.parent;\n        var fileOpened = { fileName: null, fileType: null, isValidImage: false };\n        parent.trigger('fileOpened', fileOpened);\n    };\n    Draw.prototype.updateBaseImgCanvas = function () {\n        var parent = this.parent;\n        parent.baseImgCanvas.width = parent.baseImg.width;\n        parent.baseImgCanvas.height = parent.baseImg.height;\n        parent.baseImgCanvas.getContext('2d').drawImage(parent.baseImg, 0, 0);\n    };\n    Draw.prototype.updateCanvas = function (isCropped, isSameDimension) {\n        var parent = this.parent;\n        if (!parent.isImageUpdated || !isCropped) {\n            parent.img.srcWidth = parent.baseImgCanvas.width;\n            parent.img.srcHeight = parent.baseImgCanvas.height;\n        }\n        else if (!isSameDimension && isCropped) {\n            parent.img.srcLeft = 0;\n            parent.img.srcTop = 0;\n            parent.img.srcWidth = parent.baseImgCanvas.width;\n            parent.img.srcHeight = parent.baseImgCanvas.height;\n            parent.currSelectionPoint = null;\n            parent.cropObj = { cropZoom: 0, defaultZoom: 0, totalPannedPoint: { x: 0, y: 0 }, totalPannedClientPoint: { x: 0, y: 0 },\n                totalPannedInternalPoint: { x: 0, y: 0 }, tempFlipPanPoint: { x: 0, y: 0 }, activeObj: {}, rotateFlipColl: [],\n                degree: 0, currFlipState: '', straighten: 0, destPoints: { startX: 0, startY: 0, width: 0, height: 0 },\n                srcPoints: { startX: 0, startY: 0, width: 0, height: 0 }, filter: '', isBrightAdjust: false,\n                zoomFactor: 0, previousZoomValue: 0, aspectWidth: null, aspectHeight: null, frame: 'none', straightenZoom: 0,\n                adjustmentLevel: { brightness: 0, contrast: 0, hue: 0, opacity: 100, saturation: 0, blur: 0,\n                    exposure: 0, transparency: 100, sharpen: false, bw: false }, currentFilter: '' };\n        }\n        var obj = { width: 0, height: 0 };\n        parent.notify('transform', { prop: 'calcMaxDimension', onPropertyChange: false,\n            value: { width: parent.img.srcWidth, height: parent.img.srcHeight, obj: obj, isImgShape: null } });\n        var maxDimension = obj;\n        parent.img.destLeft = (parent.lowerCanvas.clientWidth - maxDimension.width) / 2;\n        parent.img.destTop = (parent.lowerCanvas.clientHeight - maxDimension.height + 1) / 2;\n        this.drawImgToCanvas(maxDimension);\n        this.origDim.width = parent.img.destWidth;\n        this.origDim.height = parent.img.destHeight;\n        this.zoomCrop.width = parent.img.destWidth;\n        this.zoomCrop.height = parent.img.destHeight;\n        parent.notify('transform', { prop: 'setCropDimension', onPropertyChange: false,\n            value: { width: parent.img.destWidth, height: parent.img.destHeight } });\n        var point = { startX: parent.img.destLeft, startY: parent.img.destTop, width: parent.img.destWidth,\n            height: parent.img.destHeight };\n        parent.notify('crop', { prop: 'setCropDestPoints', onPropertyChange: false, value: { point: point } });\n        var temp = this.lowerContext.filter;\n        this.lowerContext.filter = 'none';\n        parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n            value: { ctx: this.lowerContext, shape: 'iterate', pen: 'zoom', isPreventApply: null } });\n        this.lowerContext.filter = temp;\n        if (parent.img.destWidth > 0 && parent.img.destHeight > 0) {\n            parent.isImageLoaded = true;\n        }\n        if (parent.isUndoRedo) {\n            if (parent.transform.currFlipState !== '') {\n                parent.notify('transform', { prop: 'flipImage', onPropertyChange: false,\n                    value: { direction: parent.toPascalCase(parent.transform.currFlipState) } });\n            }\n        }\n        if (parent.disabled) {\n            parent.element.setAttribute('class', 'e-disabled');\n        }\n        if (parent.zoomSettings.zoomFactor !== 1 || parent.zoomSettings.zoomPoint) {\n            parent.zoom(parent.zoomSettings.zoomFactor, parent.zoomSettings.zoomPoint);\n        }\n        if (isNullOrUndefined(this.initZoomValue)) {\n            this.initZoomValue = parent.zoomSettings.zoomFactor;\n        }\n        this.isImageEdited = false;\n    };\n    Draw.prototype.resetFrameZoom = function (isOk) {\n        var parent = this.parent;\n        if (!isNullOrUndefined(parent.tempFrameZoomLevel)) {\n            var temp = parent.tempFrameZoomLevel;\n            parent.tempFrameZoomLevel = null;\n            parent.notify('transform', { prop: 'resetZoom', onPropertyChange: false });\n            parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                value: { zoomFactor: temp, zoomPoint: null, isResize: true } });\n            var obj = parent.cancelCropSelection;\n            if (isOk && obj) {\n                obj.previousObj.frameObj = extend({}, parent.frameObj, null, true);\n                obj.currentObj.frameObj = extend({}, parent.frameObj, null, true);\n                obj.previousObj.frame = obj.currentObj.frame = parent.frameObj.type;\n            }\n            this.updateCropSelObj();\n            parent.cancelCropSelection = null;\n        }\n    };\n    Draw.prototype.performCancel = function (isContextualToolbar, isUndoRedo, isFinalCancel) {\n        var parent = this.parent;\n        if (isFinalCancel) {\n            parent.noPushUndo = false;\n        }\n        var straightenObj = { bool: parent.isStraightening };\n        isContextualToolbar = isContextualToolbar ? isContextualToolbar : false;\n        var obj = { bool: false };\n        parent.allowDownScale = true;\n        parent.notify('selection', { prop: 'getFreehandDrawEditing', onPropertyChange: false, value: { obj: obj } });\n        if (isNullOrUndefined(isUndoRedo) && JSON.stringify(parent.frameObj) !== JSON.stringify(parent.tempFrameObj)) {\n            extend(parent.frameObj, parent.tempFrameObj);\n            this.renderImage(null, null, true);\n        }\n        this.resetFrameZoom(false);\n        var editCompleteArgs = { action: '' };\n        if (obj['bool']) {\n            editCompleteArgs['action'] = 'freehand-draw';\n            parent.notify('freehand-draw', { prop: 'cancelFhd', onPropertyChange: false });\n            parent.notify('toolbar', { prop: 'destroy-qa-toolbar', onPropertyChange: false });\n            parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n        }\n        else if (parent.textArea.style.display === 'block' || parent.textArea.style.display === 'inline-block') {\n            editCompleteArgs['action'] = 'text-editing';\n            parent.textArea.style.display = 'none';\n            parent.textArea.value = '';\n            parent.textArea.style.transform = '';\n            if (this.prevActObj) {\n                parent.activeObj = this.prevActObj;\n                this.prevActObj = null;\n            }\n            else {\n                parent.activeObj.strokeSettings = this.tempStrokeSettings;\n                parent.activeObj.textSettings = this.tempTextSettings;\n            }\n            parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'cancel' } });\n            if (this.isShapeTextInserted) {\n                parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            }\n            parent.notify('shape', { prop: 'applyActObj', onPropertyChange: false, value: { isMouseDown: true } });\n            parent.notify('toolbar', { prop: 'refresh-main-toolbar', onPropertyChange: false });\n            parent.notify('selection', { prop: 'setTempActObj', onPropertyChange: false, value: { obj: parent.activeObj } });\n            if (parent.drawingShape) {\n                parent.enableShapeDrawing(parent.toPascalCase(parent.drawingShape), true);\n            }\n        }\n        else if ((!parent.activeObj.shape || parent.activeObj.shape !== 'redact') && (((!Browser.isDevice || (Browser.isDevice && !straightenObj['bool'])) &&\n            document.querySelector('#' + parent.element.id + '_sliderWrapper')) || parent.currObjType.isFiltered)) {\n            editCompleteArgs['action'] = parent.isFinetuneBtnClick ? 'fine-tune' : 'filter';\n            this.lowerContext.filter = this.tempAdjValue;\n            parent.canvasFilter = this.tempAdjValue;\n            parent.notify('filter', { prop: 'setAdjustmentValue', onPropertyChange: false, value: { adjustmentValue: this.tempAdjValue } });\n            parent.initialAdjustmentValue = this.tempAdjValue;\n            if (this.lowerContext.filter.split(' ').length > 1 &&\n                this.lowerContext.filter.split(' ')[0].split('(')[1].split(')')[0] === '1') {\n                parent.notify('filter', { prop: 'setBrightnessAdjusted', onPropertyChange: false, value: { isBrightnessAdjusted: false } });\n            }\n            parent.currentFilter = this.tempFilter;\n            parent.notify('filter', { prop: 'setBevelFilter', onPropertyChange: false, value: { bevelFilter: this.lowerContext.filter } });\n            this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n            this.redrawImgWithObj();\n            parent.currObjType.isFiltered = false;\n            var obj_3 = { tempAdjustmentLevel: null };\n            parent.notify('filter', { prop: 'getTempAdjustmentLevel', onPropertyChange: false, value: { obj: obj_3 } });\n            parent.notify('filter', { prop: 'setAdjustmentLevel', onPropertyChange: false,\n                value: { adjustmentLevel: extend({}, obj_3['tempAdjustmentLevel'], {}, true) } });\n            parent.notify('undo-redo', { prop: 'setUndoRedoStep', onPropertyChange: false, value: { step: this.tempUndoRedoStep } });\n            parent.upperCanvas.style.cursor = parent.cursor = 'default';\n            parent.currObjType.isCustomCrop = false;\n            this.tempStrokeSettings = { strokeColor: '#fff', fillColor: '', strokeWidth: null, radius: null, outlineColor: '', outlineWidth: null };\n            this.clearOuterCanvas(this.lowerContext);\n            if ((parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle') || parent.isCircleCrop) {\n                parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                    value: { context: this.lowerContext, isSave: null, isFlip: null } });\n            }\n            var eventargs = { type: 'main', isApplyBtn: null, isCropping: null, isZooming: null };\n            parent.element.querySelector('.e-contextual-toolbar-wrapper').classList.add('e-hide');\n            parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: eventargs });\n            if (parent.activeObj.shape && parent.activeObj.shape === 'image') {\n                parent.notify('toolbar', { prop: 'destroy-qa-toolbar', onPropertyChange: false });\n            }\n            parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'cancel' } });\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            if (parent.drawingShape) {\n                parent.drawingShape = null;\n                parent.notify('selection', { prop: 'setCurrentDrawingShape', onPropertyChange: false, value: { value: '' } });\n            }\n        }\n        else {\n            if ((!parent.activeObj.shape || parent.activeObj.shape !== 'redact') && isContextualToolbar && (!Browser.isDevice || (Browser.isDevice && !straightenObj['bool']))) {\n                var eventargs = { type: 'main', isApplyBtn: null, isCropping: null, isZooming: null };\n                parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: eventargs });\n            }\n            else {\n                this.cancelItems(editCompleteArgs);\n                if (parent.transform.zoomFactor > 0) {\n                    parent.togglePan = true;\n                    parent.notify('selection', { prop: 'setDragCanvas', value: { bool: true } });\n                }\n                else {\n                    parent.togglePan = false;\n                    parent.notify('selection', { prop: 'setDragCanvas', value: { bool: false } });\n                }\n            }\n        }\n        this.isShapeTextInserted = false;\n        this.isNewPath = false;\n        parent.notify('toolbar', { prop: 'refresh-dropdown-btn', value: { isDisabled: false } });\n        parent.notify('toolbar', { prop: 'setCurrentToolbar', value: { type: 'main' } });\n        if (isFinalCancel) {\n            parent.noPushUndo = false;\n        }\n        parent.drawingShape = null;\n        parent.notify('draw', { prop: 'resetTempObjColl' });\n        parent.notify('draw', { prop: 'resetTempPointColl' });\n        parent.isMaskImage = parent.isFinetuneBtnClick = false;\n        var actionArgs = { action: 'cancel', actionEventArgs: editCompleteArgs };\n        parent.triggerEditCompleteEvent(actionArgs);\n    };\n    Draw.prototype.cancelItems = function (editCompleteArgs) {\n        var parent = this.parent;\n        var isCropSelection = false;\n        var id = parent.element.id;\n        var ascpectIcon = parent.element.querySelector('#' + id + '_aspectratio');\n        var nonAspectIcon = parent.element.querySelector('#' + id + '_nonaspectratio');\n        var splitWords;\n        var shapes = ['rectangle', 'ellipse', 'line', 'arrow', 'path', 'image', 'redact'];\n        if (parent.activeObj.shape !== undefined) {\n            splitWords = parent.activeObj.shape.split('-');\n        }\n        if (splitWords === undefined && parent.currObjType.isCustomCrop) {\n            isCropSelection = true;\n        }\n        else if (splitWords !== undefined && splitWords[0] === 'crop') {\n            isCropSelection = true;\n        }\n        if (isCropSelection && parent.isCropTab) {\n            parent.isCropTab = false;\n            parent.transform.zoomFactor = parent.transform.defaultZoomFactor;\n        }\n        if (parent.isResize) {\n            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n            if (ascpectIcon || nonAspectIcon || parent.currentToolbar === 'resize-toolbar') {\n                editCompleteArgs['action'] = 'resize';\n                var obj = { width: null, height: null };\n                parent.notify('selection', { prop: 'getNumTextValue', onPropertyChange: false, value: { obj: obj } });\n                var point = { x: obj['width'], y: obj['height'] };\n                var aspectRatioElement = parent.element.querySelector('#' + parent.element.id + '_aspectratio');\n                var blrAspRatElem = parent.element.querySelector('.e-ie-toolbar-aspect-ratio-btn');\n                if (point && point.x && point.y && !isNullOrUndefined(parent.aspectWidth)) {\n                    if (aspectRatioElement || (blrAspRatElem && !blrAspRatElem.classList.contains('e-hidden'))) {\n                        parent.notify('transform', { prop: 'resizeImage', value: { width: parent.aspectWidth, height: parent.aspectHeight } });\n                    }\n                    else {\n                        var bool = parent.currObjType.isUndoAction;\n                        parent.currObjType.isUndoAction = false;\n                        parent.notify('transform', { prop: 'resizeCrop', value: { width: parent.aspectWidth, height: parent.aspectHeight } });\n                        parent.currObjType.isUndoAction = bool;\n                    }\n                }\n                var obj1 = { prevCropObj: parent.prevCropObj };\n                var obj2 = { prevObj: parent.prevObj };\n                parent.notify('toolbar', { prop: 'getPrevCropObj', onPropertyChange: false, value: { obj: obj1 } });\n                parent.notify('toolbar', { prop: 'getPrevObj', onPropertyChange: false, value: { obj: obj2 } });\n                if (obj1['prevCropObj'] && obj2['prevObj']) {\n                    parent.objColl = [];\n                    parent.pointColl = [];\n                    parent.freehandCounter = 0;\n                    parent.cropObj = extend({}, obj1['prevCropObj'], {}, true);\n                    this.setCurrentObj(obj2['prevObj']);\n                    parent.objColl = obj2['prevObj']['objColl'];\n                    parent.pointColl = obj2['prevObj']['pointColl'];\n                    parent.freehandCounter = parent.pointColl.length;\n                    parent.transform.straighten = 0;\n                    parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n                        value: { ctx: this.lowerContext, shape: 'zoom', pen: 'zoom', isPreventApply: null } });\n                    var currObj = parent.currSelectionPoint ?\n                        extend({}, parent.currSelectionPoint, {}, true) : null;\n                    parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                        value: { zoomFactor: -parent.transform.zoomFactor, zoomPoint: null, isResize: true } });\n                    parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                        value: { zoomFactor: obj2['prevObj']['defaultZoom'], zoomPoint: null, isResize: true } });\n                    parent.currSelectionPoint = currObj;\n                    if (obj2['prevObj'].zoomFactor) {\n                        parent.setProperties({ zoomSettings: { zoomFactor: obj2['prevObj'].zoomFactor } }, true);\n                    }\n                    parent.notify('transform', { prop: 'setPreviousZoomValue', onPropertyChange: false,\n                        value: { previousZoomValue: parent.zoomSettings.zoomFactor } });\n                }\n                parent.isResize = false;\n                parent.notify('transform', { prop: 'setResizedImgAngle', onPropertyChange: false, value: { angle: null } });\n                var temp = parent.isCropTab;\n                parent.isCropTab = false;\n                this.updateCropSelObj();\n                parent.cancelCropSelection = null;\n                parent.isCropTab = temp;\n            }\n        }\n        switch (true) {\n            case parent.togglePen:\n                editCompleteArgs['action'] = 'freehand-draw';\n                this.cancelPen();\n                break;\n            case parent.activeObj.shape === 'text':\n                editCompleteArgs['action'] = 'text';\n                this.cancelText();\n                break;\n            case shapes.indexOf(parent.activeObj.shape) !== -1:\n                editCompleteArgs['action'] = parent.activeObj.shape;\n                this.cancelShape();\n                parent.currObjType.isRedact = false;\n                break;\n            case isCropSelection:\n                editCompleteArgs['action'] = 'crop-selection';\n                this.cancelSelection();\n                break;\n            default:\n                parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'cancel' } });\n                break;\n        }\n        parent.notify('selection', { prop: 'setCurrentDrawingShape', onPropertyChange: false, value: { value: '' } });\n        parent.upperCanvas.style.cursor = parent.cursor = 'default';\n        parent.currObjType.isCustomCrop = false;\n        this.tempStrokeSettings = { strokeColor: '#fff', fillColor: '', strokeWidth: null, radius: null, outlineColor: '', outlineWidth: null };\n        var eventargs = { type: 'main', isApplyBtn: null, isCropping: false, isZooming: null };\n        parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: eventargs });\n    };\n    Draw.prototype.cancelPen = function () {\n        var parent = this.parent;\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        parent.togglePen = false;\n        parent.upperCanvas.style.cursor = parent.cursor = 'default';\n        // eslint-disable-next-line\n        var tempPointsColl = extend([], parent.pointColl, [], true);\n        parent.pointColl = {};\n        for (var i = 0; i < this.tempFreehandCounter; i++) {\n            parent.pointColl[i] = tempPointsColl[i];\n        }\n        parent.freehandCounter = this.tempFreehandCounter;\n        parent.notify('freehand-draw', { prop: 'setCurrentFreehandDrawIndex', value: { value: this.tempCurrFhdIndex } });\n        parent.activeObj.strokeSettings = this.tempStrokeSettings;\n        parent.notify('shape', { prop: 'setStrokeSettings', value: { strokeSettings: parent.activeObj.strokeSettings, strokeColor: null,\n                fillColor: null, strokeWidth: null, radius: null } });\n        parent.notify('freehand-draw', { prop: 'setPenStrokeWidth', onPropertyChange: false, value: { value: this.tempStrokeWidth } });\n        parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'cancel' } });\n        parent.notify('selection', { prop: 'setFreehandDrawCustomized', value: { isFreehandDrawCustomized: false } });\n        parent.objColl = extend([], this.tempObjColl, [], true);\n        parent.pointColl = extend([], this.tempPointColl, [], true);\n        parent.freehandCounter = parent.pointColl.length;\n        this.tempPointColl = {};\n        this.renderImage();\n        parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok', isCancel: true } });\n    };\n    Draw.prototype.cancelText = function () {\n        var parent = this.parent;\n        parent.notify('shape', { prop: 'setTextSettings', onPropertyChange: false,\n            value: { textSettings: this.tempTextSettings, fontFamily: null, fontSize: null } });\n        parent.notify('shape', { prop: 'setStrokeSettings',\n            value: { strokeSettings: this.tempStrokeSettings, strokeColor: null, fillColor: null, strokeWidth: null, radius: null } });\n        if (isNullOrUndefined(parent.activeObj.currIndex)) {\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        }\n        else {\n            var object = { appliedUndoRedoColl: [] };\n            parent.notify('undo-redo', { prop: 'getAppliedUndoRedoColl', value: { obj: object } });\n            var len = object['appliedUndoRedoColl'].length;\n            var appliedColl = object['appliedUndoRedoColl'][len - 1];\n            if (this.prevActObj && appliedColl && appliedColl.currentObjColl.length &&\n                appliedColl.currentObjColl[appliedColl.currentObjColl.length - 1].currIndex === this.prevActObj.currIndex) {\n                parent.activeObj = this.prevActObj;\n                this.prevActObj = null;\n            }\n            else {\n                parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            }\n        }\n        parent.notify('toolbar', { prop: 'destroy-qa-toolbar', onPropertyChange: false });\n        this.tempTextSettings = { text: 'Enter Text', fontFamily: parent.fontFamily.default, fontSize: null, fontRatio: null, bold: false,\n            italic: false, underline: false };\n        parent.objColl = extend([], this.tempObjColl, [], true);\n        parent.pointColl = extend([], this.tempPointColl, [], true);\n        this.renderImage();\n        this.tempObjColl = [];\n        parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok', isCancel: true } });\n    };\n    Draw.prototype.cancelShape = function () {\n        var parent = this.parent;\n        parent.notify('shape', { prop: 'setStrokeSettings',\n            value: { strokeSettings: this.tempStrokeSettings, strokeColor: null, fillColor: null, strokeWidth: null, radius: null } });\n        if (isNullOrUndefined(parent.activeObj.currIndex)) {\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        }\n        else if (this.isNewPath) {\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            this.renderImage();\n        }\n        else {\n            var object = { appliedUndoRedoColl: [] };\n            parent.notify('undo-redo', { prop: 'getAppliedUndoRedoColl', value: { obj: object } });\n            var obj = void 0;\n            for (var i = 0, iLen = object['appliedUndoRedoColl'].length; i < iLen; i++) {\n                var currObjColl = object['appliedUndoRedoColl'][i].currentObjColl;\n                for (var j = 0, jLen = currObjColl.length; j < jLen; j++) {\n                    if (this.prevActObj && this.prevActObj.currIndex &&\n                        currObjColl[j].currIndex === this.prevActObj.currIndex) {\n                        obj = currObjColl[0];\n                        break;\n                    }\n                }\n            }\n            if (this.prevActObj && obj) {\n                parent.activeObj = this.prevActObj;\n                this.prevActObj = null;\n                parent.notify('selection', { prop: 'redrawShape', onPropertyChange: false, value: { obj: parent.activeObj } });\n                parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'cancel' } });\n                parent.notify('shape', { prop: 'applyActObj', onPropertyChange: false, value: { isMouseDown: true } });\n            }\n            else {\n                parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            }\n            var undoRedoObj = { undoRedoStep: null };\n            parent.notify('undo-redo', { prop: 'getUndoRedoStep', value: { obj: undoRedoObj } });\n            if (object['appliedUndoRedoColl'][(undoRedoObj['undoRedoStep'] - 1)]) {\n                parent.objColl =\n                    extend([], object['appliedUndoRedoColl'][(undoRedoObj['undoRedoStep'] - 1)].currentObjColl, [], true);\n            }\n            else {\n                parent.objColl = [];\n            }\n            this.renderImage();\n        }\n        parent.currObjType.isDragging = false;\n        parent.notify('toolbar', { prop: 'destroy-qa-toolbar', onPropertyChange: false });\n        parent.objColl = extend([], this.tempObjColl, [], true);\n        parent.pointColl = extend([], this.tempPointColl, [], true);\n        this.renderImage();\n        this.tempObjColl = [];\n        parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok', isCancel: true } });\n    };\n    Draw.prototype.cancelSelection = function () {\n        var parent = this.parent;\n        if (parent.cancelCropSelection) {\n            var obj = { value: parent.tempStraighten };\n            parent.transform.straighten = obj['value'];\n            parent.straightenBaseImageCanvas();\n            parent.notify('freehand-draw', { prop: 'resetStraightenPoint' });\n            parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: false } });\n            parent.notify('draw', { prop: 'setStraightenActObj', value: { activeObj: parent.activeObj } });\n            parent.notify('crop', { prop: 'resizeWrapper' });\n            this.updateCropSelObj();\n            // eslint-disable-next-line max-len\n            if (this.tempStraightenDestPoints && JSON.stringify(this.tempStraightenDestPoints) !== JSON.stringify(this.straightenDestPoints)) {\n                this.straightenDestPoints = extend({}, this.tempStraightenDestPoints, {}, true);\n            }\n        }\n    };\n    Draw.prototype.updateCropSelObj = function () {\n        var parent = this.parent;\n        if (parent.cancelCropSelection) {\n            parent.cropObj = extend({}, parent.cancelCropSelection.previousCropObj, {}, true);\n            parent.afterCropActions = parent.cancelCropSelection.previousObj.afterCropActions;\n            parent.notify('undo-redo', { prop: 'undoDefault', onPropertyChange: false, value: { obj: parent.cancelCropSelection } });\n            parent.currSelectionPoint = extend({}, parent.cancelCropSelection.previousCropObj.activeObj, true);\n            if (parent.currSelectionPoint && isNullOrUndefined(parent.currSelectionPoint.shape)) {\n                parent.currSelectionPoint = null;\n            }\n            this.clearOuterCanvas(this.lowerContext);\n            if (parent.isCircleCrop || (parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle')) {\n                parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                    value: { context: this.lowerContext, isSave: null, isFlip: null } });\n            }\n        }\n    };\n    Draw.prototype.updateCropSelection = function () {\n        var parent = this.parent;\n        var object = { currObj: {} };\n        parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        var currentObj = object['currObj'];\n        currentObj.objColl = extend([], parent.objColl, [], true);\n        currentObj.pointColl = extend([], parent.pointColl, [], true);\n        currentObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: selPointCollObj } });\n        currentObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        parent.cancelCropSelection = { operation: 'cropTransform', previousObj: currentObj, currentObj: currentObj,\n            previousObjColl: currentObj.objColl, currentObjColl: currentObj.objColl,\n            previousPointColl: currentObj.pointColl, currentPointColl: currentObj.pointColl,\n            previousSelPointColl: currentObj.selPointColl, currentSelPointColl: currentObj.selPointColl,\n            previousCropObj: extend({}, parent.cropObj, {}, true),\n            currentCropObj: extend({}, parent.cropObj, {}, true),\n            previousText: null, currentText: null, filter: null, isCircleCrop: parent.isCircleCrop };\n    };\n    Draw.prototype.updateFlipPan = function (tempSelectionObj) {\n        var parent = this.parent;\n        if (parent.transform.currFlipState !== '') {\n            var temp = this.lowerContext.filter;\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            parent.notify('transform', { prop: 'rotatedFlip', onPropertyChange: false });\n            this.lowerContext.filter = 'none';\n            parent.notify('freehand-draw', { prop: 'freehandRedraw', onPropertyChange: false,\n                value: { context: this.lowerContext, points: null } });\n            this.lowerContext.filter = temp;\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            if (tempSelectionObj) {\n                this.drawObject('duplicate', tempSelectionObj);\n            }\n        }\n    };\n    Draw.prototype.select = function (type, startX, startY, width, height) {\n        var parent = this.parent;\n        type = type.toLowerCase();\n        if (!parent.disabled && parent.isImageLoaded) {\n            parent.allowDownScale = false;\n            var object = { currObj: {} };\n            parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n            var previousObj = object['currObj'];\n            previousObj.objColl = extend([], parent.objColl, [], true);\n            previousObj.pointColl = extend([], parent.pointColl, [], true);\n            previousObj.afterCropActions = parent.afterCropActions;\n            var selPointCollObj = { selPointColl: null };\n            parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n                value: { obj: selPointCollObj } });\n            previousObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n            parent.notify('crop', { prop: 'setPreviousCropCurrentObj', onPropertyChange: false, value: { obj: previousObj } });\n            if (parent.transform.zoomFactor > 0 && parent.activeObj.shape &&\n                parent.activeObj.shape.split('-')[0] === 'crop' && isNullOrUndefined(this.currSelPoint)) {\n                this.currSelPoint = extend({}, parent.activeObj, {}, true);\n            }\n            var isPrevent = false;\n            var splitWords = void 0;\n            if (parent.activeObj.shape !== undefined) {\n                splitWords = parent.activeObj.shape.split('-');\n            }\n            if (splitWords === undefined && parent.currObjType.isCustomCrop) {\n                isPrevent = true;\n            }\n            else if (splitWords !== undefined && splitWords[0] === 'crop') {\n                isPrevent = true;\n            }\n            var obj = { currObj: {} };\n            parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: obj } });\n            var prevObj = obj['currObj'];\n            prevObj.objColl = extend([], parent.objColl, [], true);\n            prevObj.pointColl = extend([], parent.pointColl, [], true);\n            prevObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n            parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n                value: { x: null, y: null, isMouseDown: null } });\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            parent.notify('shape', { prop: 'setKeyHistory', onPropertyChange: false, value: { keyHistory: '' } });\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            parent.upperCanvas.style.display = 'block';\n            if (parent.currSelectionPoint || parent.transform.defaultZoomFactor !== 0 ||\n                (parent.transform.degree !== 0 && parent.panPoint.totalPannedInternalPoint.x !== 0 &&\n                    parent.panPoint.totalPannedInternalPoint.y !== 0 && !isPrevent)) {\n                parent.isCircleCrop = false;\n                if (parent.transform.defaultZoomFactor !== 0 && !this.isResizeSelect) {\n                    var isCropTab = parent.isCropTab;\n                    parent.isCropTab = false;\n                    parent.notify('transform', { prop: 'resetZoom', onPropertyChange: false });\n                    parent.isCropTab = isCropTab;\n                    this.resetPanPoints();\n                }\n                parent.notify('freehand-draw', { prop: 'updateFHDColl', onPropertyChange: false });\n                parent.isCropTab = true;\n                parent.isCircleCrop = false;\n                if (!this.isResizeSelect) {\n                    parent.notify('crop', { prop: 'setCurrSelPoints', onPropertyChange: false, value: { isSetDimension: true } });\n                }\n                parent.transform.zoomFactor = parent.transform.cropZoomFactor;\n                if (isNullOrUndefined(parent.cropObj.activeObj.shape)) {\n                    parent.currObjType.shape = 'crop-' + type;\n                    this.drawNewSelection(type, startX, startY, width, height);\n                }\n            }\n            else {\n                if (!this.isCropSelect) {\n                    parent.notify('crop', { prop: 'adjustStraightenForShapes', onPropertyChange: false,\n                        value: { type: 'reverse', isInitialRotated: true } });\n                    parent.notify('freehand-draw', { prop: 'updateFHDColl', onPropertyChange: false });\n                    this.renderImage();\n                }\n                else {\n                    this.isCropSelect = false;\n                }\n                if (type === 'custom') {\n                    parent.currObjType.shape = '';\n                }\n                this.drawNewSelection(type, startX, startY, width, height);\n            }\n        }\n    };\n    Draw.prototype.drawNewSelection = function (type, startX, startY, width, height) {\n        var parent = this.parent;\n        var points;\n        var cropShape = 'crop-' + type.toLowerCase();\n        if (cropShape === 'crop-custom') {\n            if (parent.currObjType.shape === '' || parent.currObjType.shape === 'crop-custom') {\n                this.drawCustomSelection('crop-custom', startX, startY, width, height);\n                this.adjToStraighten();\n                this.updateSelectionInsert();\n                if (parent.isStraightening) {\n                    this.straightenActObj = extend({}, parent.activeObj, {}, true);\n                    this.straightenInitZoom = parent.transform.zoomFactor;\n                }\n            }\n        }\n        else if (cropShape === 'crop-canvas') {\n            parent.upperCanvas.style.display = 'block';\n            parent.notify('selection', { prop: 'setDragCanvas', value: { bool: true } });\n        }\n        else {\n            parent.currObjType.isCustomCrop = false;\n            parent.currObjType.shape = cropShape;\n            if (width && height) {\n                points = { startX: startX, startY: startY, endX: startX + width, endY: startY + height,\n                    width: width, height: height };\n            }\n            else if (width && cropShape === 'crop-circle') {\n                points = { startX: startX, startY: startY, endX: startX + width, endY: startY + width,\n                    width: width, height: width };\n            }\n            parent.activeObj.shape = cropShape;\n            this.updateSelectionInsert(points);\n        }\n    };\n    Draw.prototype.updateSelectionInsert = function (points) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var obj = { shapeSettingsObj: {} };\n        parent.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: obj } });\n        var selectionSettings = { type: parent.getSelectionType(obj['shapeSettingsObj']['type']), startX: obj['shapeSettingsObj']['startX'],\n            startY: obj['shapeSettingsObj']['startY'], width: obj['shapeSettingsObj']['width'], height: obj['shapeSettingsObj']['height'] };\n        var selectionChangingArgs = { action: 'insert', previousSelectionSettings: selectionSettings,\n            currentSelectionSettings: selectionSettings };\n        parent.trigger('selectionChanging', selectionChangingArgs);\n        parent.editCompleteArgs = selectionChangingArgs;\n        parent.notify('shape', { prop: 'updSelChangeEventArgs', onPropertyChange: false,\n            value: { selectionSettings: selectionChangingArgs.currentSelectionSettings } });\n        if (selectionChangingArgs.currentSelectionSettings.type === 'Custom') {\n            this.drawObject('duplicate', parent.activeObj, null, null, true);\n        }\n        else {\n            if (actPoint.startX !== 0 || actPoint.startY !== 0 ||\n                actPoint.width !== 0 || actPoint.height !== 0) {\n                points = { startX: actPoint.startX, startY: actPoint.startY,\n                    endX: actPoint.endX, endY: actPoint.endY,\n                    width: actPoint.width, height: actPoint.height };\n            }\n            this.drawObject('duplicate', null, true, points);\n        }\n    };\n    Draw.prototype.drawCustomSelection = function (cropShape, startX, startY, width, height) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        parent.currObjType.isCustomCrop = true;\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        parent.currObjType.shape = parent.activeObj.shape = cropShape.toLowerCase();\n        if (!isNullOrUndefined(startX) && !isNullOrUndefined(startY) && !isNullOrUndefined(width) && !isNullOrUndefined(height)) {\n            actPoint.startX = startX;\n            actPoint.startY = startY;\n            actPoint.endX = startX + width;\n            actPoint.endY = startY + height;\n            actPoint.width = width;\n            actPoint.height = height;\n        }\n        else if (width && height) {\n            var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n            actPoint.width = width;\n            actPoint.height = height;\n            actPoint.startX = destLeft + ((destWidth / 2) - (width / 2));\n            actPoint.startY = destTop + ((destHeight / 2) - (height / 2));\n        }\n        else {\n            if (isNullOrUndefined(parent.transform.zoomFactor) || parent.transform.zoomFactor === 0) {\n                var _b = parent.img, destLeft_1 = _b.destLeft, destTop_1 = _b.destTop, destWidth_1 = _b.destWidth, destHeight_1 = _b.destHeight;\n                var lowerCanvasWidth_1 = parent.lowerCanvas.width;\n                var lowerCanvasHeight_1 = parent.lowerCanvas.height;\n                var activePoint_1 = actPoint;\n                if (destLeft_1 >= 0 && destTop_1 >= 0) {\n                    activePoint_1.startX = destLeft_1;\n                    activePoint_1.startY = destTop_1;\n                    activePoint_1.endX = destLeft_1 + destWidth_1;\n                    activePoint_1.endY = destTop_1 + destHeight_1;\n                }\n                else if (destLeft_1 >= 0) {\n                    activePoint_1.startX = destLeft_1;\n                    activePoint_1.startY = 7.5;\n                    activePoint_1.endX = destLeft_1 + destWidth_1;\n                    activePoint_1.endY = lowerCanvasHeight_1 - 15;\n                }\n                else if (destTop_1 >= 0) {\n                    activePoint_1.startX = 7.5;\n                    activePoint_1.startY = destTop_1;\n                    activePoint_1.endX = lowerCanvasWidth_1 - 15;\n                    activePoint_1.endY = destTop_1 + destHeight_1;\n                }\n                else {\n                    activePoint_1.startX = 7.5;\n                    activePoint_1.startY = 7.5;\n                    activePoint_1.endX = lowerCanvasWidth_1 - 15;\n                    activePoint_1.endY = lowerCanvasHeight_1 - 15;\n                }\n            }\n            else {\n                var _c = parent.img, destLeft_2 = _c.destLeft, destTop_2 = _c.destTop, destWidth_2 = _c.destWidth, destHeight_2 = _c.destHeight;\n                var lowerCanvasWidth_2 = parent.lowerCanvas.width;\n                var lowerCanvasHeight_2 = parent.lowerCanvas.height;\n                var activePoint_2 = actPoint;\n                activePoint_2.startX = Math.max(destLeft_2 > 0 ? destLeft_2 : 7.5, destLeft_2);\n                activePoint_2.startY = Math.max(destTop_2 > 0 ? destTop_2 : 7.5, destTop_2);\n                activePoint_2.endX = Math.min(destLeft_2 + destWidth_2 + 15 < lowerCanvasWidth_2 ? destLeft_2 + destWidth_2 - 15 :\n                    lowerCanvasWidth_2 - 15, destLeft_2 + destWidth_2);\n                activePoint_2.endY = Math.min(destTop_2 + destHeight_2 + 15 < lowerCanvasHeight_2 ? destTop_2 + destHeight_2 - 15 :\n                    lowerCanvasHeight_2 - 15, destTop_2 + destHeight_2);\n            }\n            var _d = parent.img, destLeft = _d.destLeft, destTop = _d.destTop, destWidth = _d.destWidth, destHeight = _d.destHeight;\n            var lowerCanvasWidth = parent.lowerCanvas.clientWidth;\n            var lowerCanvasHeight = parent.lowerCanvas.clientHeight;\n            var activePoint = actPoint;\n            activePoint.startX = Math.max(activePoint.startX, destLeft);\n            activePoint.startY = Math.max(activePoint.startY, destTop);\n            activePoint.endX = Math.min(activePoint.endX, destLeft + destWidth);\n            activePoint.endY = Math.min(activePoint.endY, destTop + destHeight);\n            if (parent.transform.straighten > 0) {\n                if (this.imgCanvasPoints[0].x > activePoint.startX) {\n                    activePoint.startX = this.imgCanvasPoints[0].x;\n                }\n                if (this.imgCanvasPoints[0].y > activePoint.startY) {\n                    activePoint.startY = this.imgCanvasPoints[0].y;\n                }\n                if (this.imgCanvasPoints[2].x < activePoint.endX) {\n                    activePoint.endX = this.imgCanvasPoints[2].x;\n                }\n                if (this.imgCanvasPoints[2].y < activePoint.endY) {\n                    activePoint.endY = this.imgCanvasPoints[2].x;\n                }\n            }\n            else if (parent.transform.straighten < 0) {\n                if (this.imgCanvasPoints[3].x > activePoint.startX) {\n                    activePoint.startX = this.imgCanvasPoints[3].x;\n                }\n                if (this.imgCanvasPoints[3].y < activePoint.startY) {\n                    activePoint.startY = this.imgCanvasPoints[3].y;\n                }\n                if (this.imgCanvasPoints[1].x < activePoint.endX) {\n                    activePoint.endX = this.imgCanvasPoints[1].x;\n                }\n                if (this.imgCanvasPoints[1].y > activePoint.endY) {\n                    activePoint.endY = this.imgCanvasPoints[1].x;\n                }\n            }\n            if (activePoint.startX === destLeft && destLeft + destWidth > lowerCanvasWidth) {\n                activePoint.endX = lowerCanvasWidth - 15;\n            }\n            if (activePoint.startY === destTop && destTop + destHeight > lowerCanvasHeight) {\n                activePoint.endY = lowerCanvasHeight - 15;\n            }\n            if (parent.activeObj.activePoint.startX > parent.activeObj.activePoint.endX) {\n                var temp = parent.activeObj.activePoint.startX;\n                parent.activeObj.activePoint.startX = parent.activeObj.activePoint.endX;\n                parent.activeObj.activePoint.endX = temp;\n            }\n            if (parent.activeObj.activePoint.startY > parent.activeObj.activePoint.endY) {\n                var temp = parent.activeObj.activePoint.startY;\n                parent.activeObj.activePoint.startY = parent.activeObj.activePoint.endY;\n                parent.activeObj.activePoint.endY = temp;\n            }\n            parent.activeObj = this.updateWidthHeight(parent.activeObj);\n            this.updateActiveObject(actPoint, parent.activeObj);\n            this.adjActObj();\n        }\n        this.updateSelectionInsert();\n    };\n    Draw.prototype.adjToStraighten = function () {\n        var parent = this.parent;\n        if (parent.transform.straighten !== 0 && parent.isStraightening) {\n            var actPoint = parent.activeObj.activePoint;\n            actPoint.startX += 7.5;\n            actPoint.startY += 7.5;\n            actPoint.endX -= 7.5;\n            actPoint.endY -= 7.5;\n            parent.activeObj = this.updateWidthHeight(parent.activeObj);\n        }\n    };\n    Draw.prototype.adjActObj = function () {\n        var parent = this.parent;\n        if (parent.transform.straighten === 0) {\n            return;\n        }\n        var actPoint = parent.activeObj.activePoint;\n        var tempActPoint = extend({}, actPoint, {}, true);\n        var count = 0;\n        while (true) {\n            count++;\n            var object = { isIntersect: null, arr: null };\n            parent.notify('draw', { prop: 'updateImgCanvasPoints', onPropertyChange: false });\n            parent.notify('draw', { prop: 'isLinesIntersect', onPropertyChange: false, value: { obj: object } });\n            if (object['arr'][0] || object['arr'][1] || object['arr'][2] || object['arr'][3] || count === 100) {\n                actPoint = extend({}, tempActPoint, {}, true);\n                break;\n            }\n            tempActPoint = extend({}, actPoint, {}, true);\n            actPoint.startX -= 5;\n            actPoint.endX += 5;\n            actPoint.width = actPoint.endX - actPoint.startX;\n            this.updateActiveObject(actPoint, parent.activeObj);\n        }\n    };\n    Draw.prototype.callUpdateCurrTransState = function () {\n        var parent = this.parent;\n        var tempObjColl = extend([], parent.objColl, [], true);\n        var tempActiveObj = extend({}, parent.activeObj, {}, true);\n        parent.objColl = [];\n        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        this.isRotateZoom = true;\n        this.updateCurrTransState('initial');\n        this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        if (parent.transform.degree === 0 && parent.rotateFlipColl.length > 0) {\n            parent.img.destLeft += parent.panPoint.totalPannedPoint.x;\n            parent.img.destTop += parent.panPoint.totalPannedPoint.y;\n        }\n        parent.img.destLeft += parent.panPoint.totalPannedInternalPoint.x;\n        parent.img.destTop += parent.panPoint.totalPannedInternalPoint.y;\n        var temp = this.lowerContext.filter;\n        if (parent.transform.degree === 0) {\n            parent.notify('transform', { prop: 'setDestPointsForFlipState', onPropertyChange: false });\n        }\n        this.drawImage();\n        this.updateCurrTransState('reverse');\n        if (parent.transform.degree === 0 && parent.rotateFlipColl.length > 0) {\n            parent.img.destLeft += parent.panPoint.totalPannedPoint.x;\n            parent.img.destTop += parent.panPoint.totalPannedPoint.y;\n        }\n        this.isRotateZoom = false;\n        parent.objColl = tempObjColl;\n        var tempTogglePen = parent.togglePen;\n        parent.togglePen = false;\n        this.lowerContext.filter = 'none';\n        var widthObj = { penStrokeWidth: null };\n        parent.notify('freehand-draw', { prop: 'getPenStrokeWidth', onPropertyChange: false, value: { obj: widthObj } });\n        parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n            value: { ctx: this.lowerContext, shape: 'iterate', pen: 'iterate', isPreventApply: null } });\n        parent.notify('freehand-draw', { prop: 'setPenStrokeWidth', onPropertyChange: false, value: { value: widthObj['penStrokeWidth'] } });\n        parent.img.destLeft += parent.panPoint.totalPannedInternalPoint.x;\n        parent.img.destTop += parent.panPoint.totalPannedInternalPoint.y;\n        parent.img.destLeft -= parent.panPoint.totalPannedInternalPoint.x;\n        parent.img.destTop -= parent.panPoint.totalPannedInternalPoint.y;\n        parent.togglePen = tempTogglePen;\n        this.lowerContext.filter = temp;\n        parent.activeObj = tempActiveObj;\n    };\n    Draw.prototype.resetPanPoints = function () {\n        this.parent.panPoint.totalPannedPoint = { x: 0, y: 0 };\n        this.parent.panPoint.totalPannedClientPoint = { x: 0, y: 0 };\n        this.parent.panPoint.totalPannedInternalPoint = { x: 0, y: 0 };\n    };\n    Draw.prototype.setClientTransDim = function (isPreventDimension) {\n        var parent = this.parent;\n        if (parent.transform.degree % 90 === 0 && parent.transform.degree % 180 !== 0) {\n            parent.img.destLeft = (parent.lowerCanvas.clientWidth - parent.img.destHeight) / 2;\n            parent.img.destTop = (parent.lowerCanvas.clientHeight - parent.img.destWidth + 1) / 2;\n            var temp = parent.img.destWidth;\n            parent.img.destWidth = parent.img.destHeight;\n            parent.img.destHeight = temp;\n        }\n        else {\n            if (isNullOrUndefined(isPreventDimension)) {\n                parent.img.destLeft = (parent.lowerCanvas.clientWidth - parent.img.destWidth) / 2;\n                parent.img.destTop = (parent.lowerCanvas.clientHeight - parent.img.destHeight + 1) / 2;\n            }\n        }\n    };\n    Draw.prototype.redrawImgWithObj = function () {\n        var parent = this.parent;\n        var obj = { canvasFilter: parent.canvasFilter };\n        this.lowerContext.filter = obj['canvasFilter'];\n        if (parent.rotateFlipColl.length !== 0) {\n            var totalPannedInternalPoint = extend({}, parent.panPoint.totalPannedInternalPoint, {}, true);\n            var destPoints = { startX: parent.img.destLeft, startY: parent.img.destTop, width: parent.img.destWidth,\n                height: parent.img.destHeight };\n            this.callUpdateCurrTransState();\n            parent.panPoint.totalPannedInternalPoint = totalPannedInternalPoint;\n            parent.img.destLeft = destPoints.startX;\n            parent.img.destTop = destPoints.startY;\n            parent.img.destWidth = destPoints.width;\n            parent.img.destHeight = destPoints.height;\n        }\n        else {\n            this.callUpdateCurrTransState();\n        }\n        if (parent.isCircleCrop) {\n            parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                value: { context: this.lowerContext, isSave: null, isFlip: null } });\n        }\n    };\n    Draw.prototype.setCurrentObj = function (obj, isUndoRedo, isCircleCropped) {\n        var parent = this.parent;\n        var isObj = obj ? true : false;\n        if (!isObj) {\n            parent.cropObj.aspectWidth = parent.aspectWidth;\n            parent.cropObj.aspectHeight = parent.aspectHeight;\n            parent.cropObj.frame = parent.frameObj.type;\n        }\n        obj = obj ? obj : parent.cropObj;\n        parent.transform.cropZoomFactor = obj.cropZoom;\n        parent.transform.defaultZoomFactor = obj.defaultZoom;\n        this.straightenInitZoom = obj.straightenZoom;\n        if (!isObj) {\n            parent.transform.zoomFactor = obj.cropZoom;\n        }\n        else {\n            if (obj.activeObj.shape && obj.activeObj.shape.split('-')[0] === 'crop') {\n                parent.transform.zoomFactor = obj.cropZoom;\n            }\n            else {\n                parent.transform.zoomFactor = obj.defaultZoom;\n            }\n        }\n        parent.setProperties({ zoomSettings: { zoomFactor: obj.zoomFactor } }, true);\n        parent.notify('transform', { prop: 'setPreviousZoomValue', onPropertyChange: false, value: { previousZoomValue: obj.previousZoomValue } });\n        parent.panPoint.totalPannedPoint = extend({}, obj.totalPannedPoint, {}, true);\n        parent.panPoint.totalPannedClientPoint = extend({}, obj.totalPannedClientPoint, {}, true);\n        parent.panPoint.totalPannedInternalPoint = extend({}, obj.totalPannedInternalPoint, {}, true);\n        var point = extend({}, obj.tempFlipPanPoint, {}, true);\n        parent.notify('crop', { prop: 'setTempFlipPanPoint', onPropertyChange: false, value: { point: point } });\n        parent.rotateFlipColl = extend([], obj.rotateFlipColl, [], true);\n        parent.transform.degree = obj.degree;\n        parent.frameObj.type = obj.frame;\n        parent.transform.currFlipState = obj.currFlipState;\n        parent.notify('filter', { prop: 'setAdjustmentLevel', onPropertyChange: false, value: { adjustmentLevel: obj.adjustmentLevel } });\n        parent.notify('filter', { prop: 'setTempAdjVal' });\n        parent.currentFilter = obj.currentFilter;\n        parent.notify('filter', { prop: 'setTempFilVal' });\n        if (parent.transform.straighten !== obj.straighten || isUndoRedo) {\n            parent.transform.straighten = obj.straighten;\n            parent.straightenBaseImageCanvas();\n        }\n        parent.img = { destLeft: obj.destPoints.startX, destTop: obj.destPoints.startY, destWidth: obj.destPoints.width,\n            destHeight: obj.destPoints.height, srcLeft: obj.srcPoints.startX, srcTop: obj.srcPoints.startY,\n            srcWidth: obj.srcPoints.width, srcHeight: obj.srcPoints.height };\n        parent.aspectWidth = obj.aspectWidth;\n        parent.aspectHeight = obj.aspectHeight;\n        if (obj.afterCropActions) {\n            parent.afterCropActions = obj.afterCropActions;\n        }\n        this.lowerContext.filter = obj.filter;\n        parent.notify('filter', { prop: 'setBrightnessAdjusted', onPropertyChange: false, value: { isBrightnessAdjusted: obj.isBrightAdjust } });\n        parent.notify('draw', { prop: 'imageBackgroundColor', onPropertyChange: false, value: { color: obj.bgColor } });\n        var isCircleCrop = parent.isCircleCrop;\n        var currSelectionPoint;\n        if (isNullOrUndefined(parent.currSelectionPoint)) {\n            currSelectionPoint = null;\n        }\n        else {\n            currSelectionPoint = extend({}, parent.currSelectionPoint, {}, true);\n            parent.currSelectionPoint = null;\n        }\n        parent.isCircleCrop = false;\n        if (isCircleCropped) {\n            parent.frameObj.type = 'none';\n        }\n        this.drawCropSelectionImage(obj, false);\n        if (parent.transform.degree !== 0) {\n            if (parent.transform.currFlipState === '') {\n                parent.notify('transform', { prop: 'rotatePan', onPropertyChange: false,\n                    value: { isCropSelection: null, isDefaultZoom: null } });\n            }\n            else {\n                parent.notify('transform', { prop: 'drawPannedImage', value: { xDiff: 0, yDiff: 0 } });\n            }\n            parent.img.destLeft = obj.destPoints.startX;\n            parent.img.destTop = obj.destPoints.startY;\n            parent.panPoint.totalPannedClientPoint = extend({}, obj.totalPannedClientPoint, {}, true);\n            parent.panPoint.totalPannedInternalPoint = extend({}, obj.totalPannedInternalPoint, {}, true);\n        }\n        parent.activeObj = extend({}, obj.activeObj, {}, true);\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        if (parent.activeObj.activePoint.width !== 0 && parent.activeObj.activePoint.height !== 0) {\n            this.drawObject('duplicate', null, null, null, true);\n        }\n        var activeObj = extend({}, obj.activeObj, {}, true);\n        var isAfterCropAction = false;\n        if (parent.afterCropActions.length > 0) {\n            var object = { collection: parent.afterCropActions };\n            parent.notify('shape', { prop: 'alignRotateFlipColl', onPropertyChange: false,\n                value: { collection: parent.afterCropActions, isRotateFlipCollection: null, obj: object } });\n            parent.afterCropActions = object['collection'];\n        }\n        var afterCropActions = extend([], parent.afterCropActions, [], true);\n        if (!isObj && afterCropActions.length > 0) {\n            isAfterCropAction = true;\n            for (var i = 0, len = afterCropActions.length; i < len; i++) {\n                if (afterCropActions[i] === 'horizontalflip' || afterCropActions[i] === 'verticalflip') {\n                    parent.activeObj = extend({}, currSelectionPoint, {}, true);\n                    this.rotatedFlipCropSel = true;\n                }\n                parent.notify('transform', { prop: 'updateTransform', onPropertyChange: false, value: { text: afterCropActions[i] } });\n            }\n            activeObj = extend({}, parent.activeObj, {}, true);\n            this.resetPanPoints();\n            parent.activeObj = activeObj;\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            if (parent.activeObj.activePoint.width !== 0 && parent.activeObj.activePoint.height !== 0) {\n                this.drawObject('duplicate', null, null, null, true);\n            }\n            if (obj.degree !== parent.transform.degree) {\n                parent.transform.cropZoomFactor = null;\n                parent.transform.zoomFactor = 0;\n            }\n            parent.notify('freehand-draw', { prop: 'updateFHDColl', onPropertyChange: false });\n            if (this.rotatedFlipCropSel) {\n                this.rotatedFlipCropSel = false;\n            }\n        }\n        parent.afterCropActions = afterCropActions;\n        if (!this.isCancelAction && !isAfterCropAction) {\n            parent.notify('freehand-draw', { prop: 'updateFHDColl', onPropertyChange: false });\n            parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n                value: { ctx: this.lowerContext, shape: 'zoom', pen: 'zoom', isPreventApply: null } });\n            parent.img.destLeft = obj.destPoints.startX;\n            parent.img.destTop = obj.destPoints.startY;\n        }\n        parent.activeObj = activeObj;\n        parent.isCircleCrop = isCircleCrop;\n        if (isNullOrUndefined(currSelectionPoint)) {\n            parent.currSelectionPoint = null;\n        }\n        else {\n            parent.currSelectionPoint = extend({}, currSelectionPoint, {}, true);\n            if (parent.currSelectionPoint && isNullOrUndefined(parent.currSelectionPoint.shape)) {\n                parent.currSelectionPoint = null;\n            }\n        }\n    };\n    Draw.prototype.drawCropSelectionImage = function (obj, isObj) {\n        var parent = this.parent;\n        var temp = this.lowerContext.filter;\n        parent.clearContext(this.lowerContext);\n        parent.clearContext(this.upperContext);\n        this.lowerContext.setTransform(1, 0, 0, 1, 0, 0);\n        if (isObj) {\n            this.updateCurrTransState('initial');\n        }\n        else {\n            this.setTransformColl(this.lowerContext, 'initial');\n        }\n        parent.notify('transform', { prop: 'setDestPointsForFlipState', onPropertyChange: false });\n        this.drawImage();\n        if (isObj) {\n            this.updateCurrTransState('reverse');\n        }\n        else {\n            this.setTransformColl(this.lowerContext, 'reverse');\n        }\n        parent.img.destLeft = parent.cropObj.destPoints.startX;\n        parent.img.destTop = parent.cropObj.destPoints.startY;\n        var activeObj = extend({}, obj.activeObj, {}, true);\n        this.lowerContext.filter = 'none';\n        parent.img = { destLeft: obj.destPoints.startX, destTop: obj.destPoints.startY, destWidth: obj.destPoints.width,\n            destHeight: obj.destPoints.height, srcLeft: obj.srcPoints.startX, srcTop: obj.srcPoints.startY,\n            srcWidth: obj.srcPoints.width, srcHeight: obj.srcPoints.height };\n        if (obj.activeObj.activePoint.width !== 0 && obj.activeObj.activePoint.height !== 0) {\n            var destPoints = { startX: parent.img.destLeft, startY: parent.img.destTop, width: parent.img.destWidth,\n                height: parent.img.destHeight };\n            parent.img.destLeft = obj.activeObj.activePoint.startX;\n            parent.img.destTop = obj.activeObj.activePoint.startY;\n            parent.img.destWidth = obj.activeObj.activePoint.width;\n            parent.img.destHeight = obj.activeObj.activePoint.height;\n            parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n                value: { ctx: this.lowerContext, shape: 'zoom', pen: 'zoom', isPreventApply: null } });\n            parent.img.destLeft = destPoints.startX;\n            parent.img.destTop = destPoints.startY;\n            parent.img.destWidth = destPoints.width;\n            parent.img.destHeight = destPoints.height;\n        }\n        parent.activeObj = activeObj;\n        this.lowerContext.filter = temp;\n    };\n    Draw.prototype.performPointZoom = function (x, y, type, isResize, value) {\n        var parent = this.parent;\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        var isCropSelection = false;\n        if (parent.activeObj.shape && parent.activeObj.shape.indexOf('crop-') > -1) {\n            isCropSelection = true;\n        }\n        if (parent.element.querySelector('.e-contextual-toolbar-wrapper') && !isCropSelection) {\n            if (!parent.element.querySelector('.e-contextual-toolbar-wrapper').classList.contains('e-hide')) {\n                parent.okBtn();\n                parent.element.querySelector('.e-contextual-toolbar-wrapper').classList.add('e-hide');\n            }\n        }\n        var ratioX = (x - destLeft) / destWidth;\n        var ratioY = (y - destTop) / destHeight;\n        var isUndoRedo = parent.isUndoRedo;\n        parent.isUndoRedo = true;\n        parent.setProperties({ zoomSettings: { zoomPoint: { x: x, y: y } } }, true);\n        var zoomValue = value ? value : (type === 'zoomIn') ? .1 : -.1;\n        parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n            value: { zoomFactor: zoomValue, zoomPoint: null, isResize: isResize } });\n        parent.isUndoRedo = isUndoRedo;\n        this.panToPoint(x, y, ratioX, ratioY);\n    };\n    Draw.prototype.panToPoint = function (x, y, ratioX, ratioY) {\n        var parent = this.parent;\n        if (parent.transform.zoomFactor > 0) {\n            var destLeft = parent.img.destLeft;\n            var destTop = parent.img.destTop;\n            var activeObj = extend({}, parent.activeObj, {}, true);\n            if (parent.transform.degree === 0) {\n                parent.img.destLeft = x - (ratioX * parent.img.destWidth);\n                parent.img.destTop = y - (ratioY * parent.img.destHeight);\n                this.drawZoomPanImage(parent.img.destLeft - destLeft, parent.img.destTop - destTop);\n            }\n            else {\n                var isCropTab = parent.isCropTab;\n                parent.isCropTab = true;\n                var objColl = extend([], parent.objColl, [], true);\n                var pointColl = extend([], parent.pointColl, [], true);\n                var straightenObj = { straightenPoint: null };\n                parent.notify('freehand-draw', { prop: 'getStraightenPoint', onPropertyChange: false,\n                    value: { obj: straightenObj } });\n                parent.objColl = [];\n                parent.pointColl = [];\n                parent.freehandCounter = 0;\n                parent.notify('freehand-draw', { prop: 'setStraightenPoint', onPropertyChange: false,\n                    value: { x: null, y: null, ratioX: null, ratioY: null } });\n                var object = { selPointColl: null };\n                parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n                    value: { obj: object } });\n                var cropSelPointColl = object['selPointColl'];\n                parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false,\n                    value: { obj: { selPointColl: [] } } });\n                parent.panPoint.currentPannedPoint = { x: (x - (ratioX * parent.img.destWidth)) - destLeft,\n                    y: (y - (ratioY * parent.img.destHeight)) - destTop };\n                parent.notify('transform', { prop: 'rotatePan', onPropertyChange: false,\n                    value: { isCropSelection: null, isDefaultZoom: null } });\n                parent.isCropTab = isCropTab;\n                parent.objColl = objColl;\n                parent.pointColl = pointColl;\n                parent.freehandCounter = parent.pointColl.length;\n                if (straightenObj['straightenPoint']['x'] && straightenObj['straightenPoint']['y']) {\n                    parent.notify('freehand-draw', { prop: 'setStraightenPoint', onPropertyChange: false,\n                        value: { x: straightenObj['straightenPoint']['x'], y: straightenObj['straightenPoint']['y'],\n                            ratioX: straightenObj['straightenPoint']['ratioX'], ratioY: straightenObj['straightenPoint']['ratioY'] } });\n                }\n                parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false,\n                    value: { obj: { selPointColl: cropSelPointColl } } });\n                parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n                    value: { ctx: this.lowerContext, shape: 'pan', pen: 'pan', x: parent.panPoint.currentPannedPoint.x,\n                        y: parent.panPoint.currentPannedPoint.y, panRegion: '' } });\n            }\n            this.adjustPanning(activeObj);\n            var isActObj = false;\n            for (var i = 0; i < parent.objColl.length; i++) {\n                if (JSON.stringify(activeObj.activePoint) === JSON.stringify(parent.objColl[i].activePoint)) {\n                    isActObj = true;\n                    break;\n                }\n            }\n            if (!isActObj) {\n                parent.activeObj = activeObj;\n            }\n            if (parent.activeObj.activePoint.width !== 0 && parent.activeObj.activePoint.height !== 0) {\n                this.drawObject('duplicate', null, null, null, true);\n            }\n        }\n    };\n    Draw.prototype.adjustPanning = function (activeObj) {\n        var parent = this.parent;\n        var _a = activeObj.activePoint, startX = _a.startX, startY = _a.startY, width = _a.width, height = _a.height;\n        if (width !== 0 && height !== 0) {\n            var _b = parent.img, destLeft = _b.destLeft, destTop = _b.destTop, destWidth = _b.destWidth, destHeight = _b.destHeight;\n            var point = { x: 0, y: 0 };\n            if (destLeft > startX) {\n                point.x = destLeft - startX;\n            }\n            else if (destLeft + destWidth < startX + width) {\n                point.x = (destLeft + destWidth) - (startX + width);\n            }\n            if (destTop > startY) {\n                point.y = destTop - startY;\n            }\n            else if (destTop + destHeight < startY + height) {\n                point.y = (destTop + destHeight) - (startY + height);\n            }\n            if (parent.transform.degree === 0) {\n                parent.img.destLeft -= point.x;\n                parent.img.destTop -= point.y;\n                this.drawZoomPanImage(parent.img.destLeft - destLeft, parent.img.destTop - destTop);\n            }\n            else {\n                var isCropTab = parent.isCropTab;\n                parent.isCropTab = true;\n                var objColl = extend([], parent.objColl, [], true);\n                var pointColl = extend([], parent.pointColl, [], true);\n                parent.objColl = [];\n                parent.pointColl = [];\n                parent.freehandCounter = 0;\n                var object = { selPointColl: null };\n                parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n                    value: { obj: object } });\n                var cropSelPointColl = object['selPointColl'];\n                parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false,\n                    value: { obj: { selPointColl: [] } } });\n                parent.img.destLeft -= point.x;\n                parent.img.destTop -= point.y;\n                parent.panPoint.currentPannedPoint = { x: parent.img.destLeft - destLeft, y: parent.img.destTop - destTop };\n                parent.notify('transform', { prop: 'rotatePan', onPropertyChange: false,\n                    value: { isCropSelection: null, isDefaultZoom: null } });\n                parent.isCropTab = isCropTab;\n                parent.objColl = objColl;\n                parent.pointColl = pointColl;\n                parent.freehandCounter = parent.pointColl.length;\n                parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false,\n                    value: { obj: { selPointColl: cropSelPointColl } } });\n                parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n                    value: { ctx: this.lowerContext, shape: 'pan', pen: 'pan', x: parent.panPoint.currentPannedPoint.x,\n                        y: parent.panPoint.currentPannedPoint.y, panRegion: '' } });\n            }\n        }\n    };\n    Draw.prototype.panToSel = function () {\n        var parent = this.parent;\n        var activeObj = extend({}, parent.activeObj, {}, true);\n        var _a = activeObj.activePoint, startX = _a.startX, startY = _a.startY, width = _a.width, height = _a.height;\n        this.allowRedactStraighten = true;\n        var straightenObj = { straightenPoint: null };\n        parent.notify('freehand-draw', { prop: 'getStraightenPoint', onPropertyChange: false,\n            value: { obj: straightenObj } });\n        if (straightenObj['straightenPoint']['x'] && straightenObj['straightenPoint']['y']) {\n            var panX = (startX + (width / 2)) - straightenObj['straightenPoint']['x'];\n            var panY = (startY + (height / 2)) - straightenObj['straightenPoint']['y'];\n            if (parent.transform.degree === 0) {\n                parent.img.destLeft += panX;\n                parent.img.destTop += panY;\n                parent.notify('transform', { prop: 'drawPannImage', value: { point: { x: panX, y: panY } } });\n            }\n            else {\n                parent.panPoint.currentPannedPoint = { x: panX, y: panY };\n                parent.notify('transform', { prop: 'drawPannedImage', value: { xDiff: panX, yDiff: panY } });\n                parent.panPoint.currentPannedPoint = { x: 0, y: 0 };\n                parent.notify('transform', { prop: 'setTempPanMove', value: { point: null } });\n            }\n            parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: activeObj } });\n            var _b = parent.img, destLeft_3 = _b.destLeft, destTop_3 = _b.destTop, destWidth_3 = _b.destWidth, destHeight_3 = _b.destHeight;\n            var points = this.imgCanvasPoints;\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            points.forEach(function (point) {\n                point.x = (point.ratioX * destWidth_3) + destLeft_3;\n                point.y = (point.ratioY * destHeight_3) + destTop_3;\n            });\n            this.imgCanvasPoints = points;\n            var count = 0;\n            if (parent.transform.straighten === 3 && !this.preventStraightening) {\n                this.preventStraightening = true;\n                var temp = parent.prevStraightenedDegree;\n                parent.prevStraightenedDegree = parent.transform.straighten;\n                parent.setStraighten(0);\n                parent.setStraighten(3);\n                parent.prevStraightenedDegree = temp;\n                this.preventStraightening = false;\n            }\n            while (this.isLinesIntersect() && parent.transform.straighten !== 0 && parent.transform.straighten !== 360 && count < 100) {\n                count++;\n                this.performPointZoom(parent.activeObj.activePoint.startX + (parent.activeObj.activePoint.width / 2), parent.activeObj.activePoint.startY + (parent.activeObj.activePoint.height / 2), 'zoomIn', false, 0.025);\n                this.updateImgCanvasPoints();\n            }\n        }\n    };\n    Draw.prototype.drawZoomPanImage = function (x, y) {\n        var parent = this.parent;\n        parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n            value: { ctx: this.lowerContext, shape: 'pan', pen: 'pan', x: x, y: y, panRegion: '' } });\n        this.renderImage(true);\n        var obj = { width: 0, height: 0 };\n        parent.notify('transform', { prop: 'calcMaxDimension', onPropertyChange: false,\n            value: { width: parent.img.srcWidth, height: parent.img.srcHeight, obj: obj, isImgShape: null } });\n        var maxDimension = obj;\n        maxDimension.width += (maxDimension.width * parent.transform.zoomFactor);\n        maxDimension.height += (maxDimension.height * parent.transform.zoomFactor);\n        parent.panPoint.totalPannedPoint.x += x;\n        parent.panPoint.totalPannedPoint.y += y;\n        parent.notify('crop', { prop: 'setTempFlipPanPoint', onPropertyChange: false, value: { point: { x: 0, y: 0 } } });\n    };\n    Draw.prototype.openNewImage = function () {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        var inMemoryContext = parent.inMemoryCanvas.getContext('2d');\n        showSpinner(parent.element);\n        parent.element.style.opacity = '0.5';\n        var toolbar = document.querySelector('#' + id + '_currPos');\n        if (toolbar) {\n            toolbar.style.display = 'none';\n        }\n        var obj = { defToolbarItems: null };\n        parent.notify('toolbar', { prop: 'getDefToolbarItems', value: { obj: obj } });\n        if (obj['defToolbarItems'].length === 0 &&\n            (isNullOrUndefined(document.getElementById(id + '_toolbar'))) &&\n            parent.element.querySelector('#' + id + '_toolbarArea')) {\n            var height = parent.element.querySelector('#' + id + '_toolbarArea').clientHeight;\n            parent.notify('toolbar', { prop: 'setToolbarHeight', value: { height: height } });\n        }\n        parent.reset();\n        parent.update();\n        parent.transform.degree = 0;\n        parent.transform.zoomFactor = 0;\n        parent.isImageLoaded = false;\n        parent.currSelectionPoint = null;\n        var type = typeof (this.openURL);\n        if (type === 'string') {\n            var fileName = this.openURL.split('.');\n            if (fileName.length > 1) {\n                fileName = fileName[fileName.length - 2].split('/');\n                this.fileName = fileName[fileName.length - 1];\n            }\n            else {\n                this.fileName = 'ImageEditor';\n            }\n            this.fileType = this.getFileExtensionFromURL(this.openURL);\n            if (this.fileType) {\n                this.fileType = parent.toPascalCase(this.fileType);\n                var fileType = this.fileType.toLowerCase();\n                if (fileType === 'jpg' || fileType === 'jpeg') {\n                    this.fileType = 'Jpeg';\n                    fileType = 'jpeg';\n                }\n                if (fileType !== 'jpeg' && fileType !== 'png' && fileType !== 'svg') {\n                    this.fileType = null;\n                }\n            }\n            this.imageOnLoad(this.openURL);\n            if (typeof (this.openURL) !== 'string' || this.openURL.indexOf('localhost') === -1) {\n                this.getImageSizeFromURL(this.openURL.toString(), function (imageSizeMB) {\n                    if (imageSizeMB !== null) {\n                        _this.parent.notify('toolbar', { prop: 'setInitialSize', value: { value: +imageSizeMB } });\n                    }\n                });\n            }\n        }\n        else {\n            this.fileName = 'ImageEditor';\n            this.fileType = null;\n            parent.lowerCanvas = document.querySelector('#' + id + '_lowerCanvas');\n            parent.upperCanvas = document.querySelector('#' + id + '_upperCanvas');\n            this.lowerContext = parent.lowerCanvas.getContext('2d');\n            this.upperContext = parent.upperCanvas.getContext('2d');\n            parent.clearContext(this.lowerContext);\n            parent.clearContext(this.upperContext);\n            parent.clearContext(inMemoryContext);\n            parent.inMemoryCanvas.width = this.openURL.width;\n            parent.inMemoryCanvas.height = this.openURL.height;\n            inMemoryContext.putImageData(this.openURL, 0, 0);\n            parent.baseImg.src = parent.inMemoryCanvas.toDataURL();\n        }\n    };\n    Draw.prototype.getImageSizeFromURL = function (imageUrl, callback) {\n        return __awaiter(this, void 0, void 0, function () {\n            var response, contentLength, imageSizeMB, ex_1;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        _a.trys.push([0, 2, , 3]);\n                        return [4 /*yield*/, fetch(imageUrl, { method: 'HEAD' })];\n                    case 1:\n                        response = _a.sent();\n                        contentLength = parseInt(response.headers.get('content-length') || '0', 10);\n                        imageSizeMB = contentLength;\n                        callback(imageSizeMB);\n                        return [3 /*break*/, 3];\n                    case 2:\n                        ex_1 = _a.sent();\n                        // eslint-disable-next-line no-console\n                        console.log(ex_1.message);\n                        return [3 /*break*/, 3];\n                    case 3: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    Draw.prototype.dlgBtnClick = function () {\n        this.parent.export();\n        this.applyDialogOption();\n    };\n    Draw.prototype.dlgCloseBtnClick = function () {\n        this.applyDialogOption();\n    };\n    Draw.prototype.applyDialogOption = function () {\n        var parent = this.parent;\n        if (this.isFileChanged) {\n            parent.isImageLoaded = this.isFileChanged = false;\n            parent.reset();\n            this.checkToolbarTemplate(this.inputElem, this.openURL);\n        }\n        else {\n            this.reset();\n            this.openNewImage();\n        }\n        getComponent(document.getElementById(parent.element.id + '_dialog'), 'dialog').destroy();\n        this.isImageEdited = false;\n    };\n    Draw.prototype.showDialogPopup = function () {\n        var parent = this.parent;\n        var headerObj = { key: 'ConfirmDialogHeader' };\n        parent.notify('toolbar', { prop: 'getLocaleText', onPropertyChange: false, value: { obj: headerObj } });\n        var contentObj = { key: 'ConfirmDialogContent' };\n        parent.notify('toolbar', { prop: 'getLocaleText', onPropertyChange: false, value: { obj: contentObj } });\n        var yesObj = { key: 'Yes' };\n        parent.notify('toolbar', { prop: 'getLocaleText', onPropertyChange: false, value: { obj: yesObj } });\n        var noObj = { key: 'No' };\n        parent.notify('toolbar', { prop: 'getLocaleText', onPropertyChange: false, value: { obj: noObj } });\n        parent.element.querySelector('#' + parent.element.id + '_dialog').style.display = 'block';\n        var dialog = new Dialog({\n            header: headerObj['value'],\n            closeOnEscape: true,\n            content: '<span>' + contentObj['value'] + '</span>',\n            target: document.getElementById('target'),\n            width: '285px',\n            isModal: true,\n            animationSettings: { effect: 'Zoom' },\n            close: this.dlgCloseBtnClick.bind(this),\n            buttons: [\n                { click: this.dlgCloseBtnClick.bind(this),\n                    buttonModel: { content: noObj['value'], iconCss: 'e-icons e-close' }\n                },\n                { click: this.dlgBtnClick.bind(this),\n                    buttonModel: { content: yesObj['value'], isPrimary: true, iconCss: 'e-icons e-check' } }\n            ]\n        });\n        dialog.appendTo('#' + parent.element.id + '_dialog');\n    };\n    Draw.prototype.restoreOldImage = function () {\n        if (this.parent.isImageLoaded) {\n            this.reset();\n            this.openNewImage();\n        }\n        else {\n            this.openNewImage();\n        }\n    };\n    Draw.prototype.open = function (data) {\n        var dropArea = document.getElementById(this.parent.element.id + '_dropArea');\n        if (dropArea) {\n            dropArea.style.display = 'none';\n        }\n        if (!this.parent.disabled) {\n            this.openURL = data;\n            this.restoreOldImage();\n        }\n    };\n    Draw.prototype.getInitialLoaded = function (object) {\n        object['isInitialLoaded'] = this.isInitialLoading;\n    };\n    Draw.prototype.getFileExtensionFromURL = function (url) {\n        var lastDotIndex = url.lastIndexOf('.');\n        if (lastDotIndex !== -1) {\n            return url.slice(lastDotIndex + 1).toLowerCase();\n        }\n        else if (url.indexOf('base64') !== -1) {\n            return url.slice(url.indexOf('/') + 1, url.indexOf(';')).toLowerCase();\n        }\n        return null;\n    };\n    Draw.prototype.fileSelect = function (inputElement, args) {\n        var parent = this.parent;\n        var dropArea = document.getElementById(parent.element.id + '_dropArea');\n        if (dropArea) {\n            dropArea.style.display = 'none';\n        }\n        if (!parent.disabled) {\n            var filesData = void 0;\n            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n            var fileData = void 0;\n            if (args.target) {\n                /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                filesData = args.target.files[0];\n                fileData = filesData;\n            }\n            else {\n                /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                filesData = fileData = args.filesData[0].rawFile;\n            }\n            var fileExtension = void 0;\n            if (fileData.name) {\n                var fileExtensionArray = fileData.name.split('.');\n                fileExtension = fileExtensionArray[fileExtensionArray.length - 1].toLowerCase();\n            }\n            if (fileExtension && ['jpg', 'jpeg', 'png', 'svg'].indexOf(fileExtension) === -1) {\n                this.errorLoading();\n                return;\n            }\n            showSpinner(parent.element);\n            parent.element.style.opacity = '0.5';\n            this.inputElem = inputElement;\n            fileExtension = fileData.name && fileData.name.split('.')[1];\n            if (fileExtension) {\n                var fileType = parent.toPascalCase(fileExtension);\n                if (fileType === 'JPG' || fileType === 'Jpg') {\n                    this.fileType = 'Jpeg';\n                }\n                else {\n                    this.fileType = fileType;\n                }\n            }\n            else {\n                this.fileType = null;\n            }\n            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n            var URL_1 = window.URL;\n            var url = URL_1.createObjectURL(filesData);\n            this.openURL = url;\n            // eslint-disable-next-line max-len\n            if (parent.isImageLoaded && !parent.isChangesSaved && (this.isImageEdited || parent.pointColl.length > 0 || parent.objColl.length > 0)) {\n                this.isFileChanged = true;\n                this.showDialogPopup();\n            }\n            else {\n                this.checkToolbarTemplate(inputElement, url);\n            }\n        }\n    };\n    Draw.prototype.checkToolbarTemplate = function (inputElement, url) {\n        var parent = this.parent;\n        if (isNullOrUndefined(parent.toolbarTemplate)) {\n            parent.reset();\n            parent.update();\n        }\n        this.fileName = inputElement.value.split('\\\\')[inputElement.value.split('\\\\').length - 1];\n        this.fileName = this.fileName.split('.')[0];\n        this.imageOnLoad(url.toString());\n        inputElement.value = '';\n    };\n    Draw.prototype.moveToSelectionRange = function (type, activeObj) {\n        var parent = this.parent;\n        if (parent.activeObj.shape) {\n            var isRotated = false;\n            for (var i = 0, len = parent.rotateFlipColl.length; i < len; i++) {\n                var degree = parent.rotateFlipColl[i];\n                if (degree === 90 || degree === -90) {\n                    isRotated = true;\n                    break;\n                }\n            }\n            if (isRotated) {\n                if (parent.transform.degree === 0) {\n                    return;\n                }\n                var zoomFactor = parent.transform.zoomFactor;\n                parent.objColl.push(parent.activeObj);\n                parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                var currObj = parent.objColl[parent.objColl.length - 1];\n                if (type === 'rotateleft' || type === 'rotateright') {\n                    if (parent.transform.degree % 90 === 0 && parent.transform.degree % 180 !== 0) {\n                        if (currObj.activePoint.width < activeObj.activePoint.height) {\n                            for (var i = 2; i < parent.zoomSettings.maxZoomFactor; i++) {\n                                if (currObj.activePoint.width >= activeObj.activePoint.height ||\n                                    this.isSelectionBiggerThanCanvas(currObj) ||\n                                    this.isSelectionOutsideCanvas(currObj)) {\n                                    if (!isNullOrUndefined(zoomFactor)) {\n                                        parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                                            value: { zoomFactor: -0.1, zoomPoint: null }, isResize: null });\n                                    }\n                                    break;\n                                }\n                                zoomFactor += 0.1;\n                                parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                                    value: { zoomFactor: zoomFactor, zoomPoint: null }, isResize: null });\n                            }\n                        }\n                        else {\n                            for (var i = 2; i < parent.zoomSettings.maxZoomFactor; i++) {\n                                if (currObj.activePoint.width >= activeObj.activePoint.height ||\n                                    this.isSelectionBiggerThanCanvas(currObj) ||\n                                    this.isSelectionOutsideCanvas(currObj)) {\n                                    if (!isNullOrUndefined(zoomFactor)) {\n                                        parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                                            value: { zoomFactor: 0.1, zoomPoint: null, isResize: null } });\n                                    }\n                                    break;\n                                }\n                                zoomFactor -= .1;\n                                parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                                    value: { zoomFactor: zoomFactor, zoomPoint: null }, isResize: null });\n                            }\n                        }\n                    }\n                    else {\n                        if (currObj.activePoint.height < activeObj.activePoint.width) {\n                            for (var i = 2; i < parent.zoomSettings.maxZoomFactor; i++) {\n                                if (currObj.activePoint.height >= activeObj.activePoint.width ||\n                                    this.isSelectionBiggerThanCanvas(currObj) ||\n                                    this.isSelectionOutsideCanvas(currObj)) {\n                                    if (!isNullOrUndefined(zoomFactor)) {\n                                        parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                                            value: { zoomFactor: -0.1, zoomPoint: null }, isResize: null });\n                                    }\n                                    break;\n                                }\n                                zoomFactor += 0.1;\n                                parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                                    value: { zoomFactor: zoomFactor, zoomPoint: null }, isResize: null });\n                            }\n                        }\n                        else {\n                            for (var i = 2; i < parent.zoomSettings.maxZoomFactor; i++) {\n                                if (currObj.activePoint.height >= activeObj.activePoint.width ||\n                                    this.isSelectionBiggerThanCanvas(currObj) ||\n                                    this.isSelectionOutsideCanvas(currObj)) {\n                                    if (!isNullOrUndefined(zoomFactor)) {\n                                        parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                                            value: { zoomFactor: 0.1, zoomPoint: null }, isResize: null });\n                                    }\n                                    break;\n                                }\n                                zoomFactor -= .1;\n                                parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                                    value: { zoomFactor: zoomFactor, zoomPoint: null }, isResize: null });\n                            }\n                        }\n                    }\n                }\n                var panX = (parent.lowerCanvas.clientWidth / 2) - (currObj.activePoint.startX +\n                    (currObj.activePoint.width / 2));\n                var panY = ((parent.lowerCanvas.clientHeight + 1) / 2) - (currObj.activePoint.startY +\n                    (currObj.activePoint.height / 2));\n                if (isNullOrUndefined(parent.activeObj.shape)) {\n                    parent.activeObj = extend({}, activeObj, {}, true);\n                }\n                if (parent.transform.degree === 0) {\n                    parent.img.destLeft += panX;\n                    parent.img.destTop += panY;\n                    parent.notify('transform', { prop: 'drawPannImage', value: { point: { x: panX, y: panY } } });\n                }\n                else {\n                    parent.panPoint.currentPannedPoint = { x: panX, y: panY };\n                    parent.notify('transform', { prop: 'drawPannedImage', value: { xDiff: panX, yDiff: panY } });\n                    parent.panPoint.currentPannedPoint = { x: 0, y: 0 };\n                }\n                parent.notify('transform', { prop: 'setTempPanMove', onPropertyChange: false,\n                    value: { point: null } });\n                parent.activeObj = extend({}, parent.objColl[parent.objColl.length - 1]);\n                parent.objColl.pop();\n                parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: parent.activeObj } });\n            }\n        }\n    };\n    Draw.prototype.isSelectionBiggerThanCanvas = function (obj) {\n        var isBigger = false;\n        var parent = this.parent;\n        var _a = obj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY;\n        var _b = parent.img, destLeft = _b.destLeft, destTop = _b.destTop, destWidth = _b.destWidth, destHeight = _b.destHeight;\n        if (startX <= destLeft || startY <= destTop || endX >= destLeft + destWidth || endY >= destTop + destHeight) {\n            isBigger = true;\n        }\n        return isBigger;\n    };\n    Draw.prototype.isSelectionOutsideCanvas = function (obj) {\n        var isOutside = false;\n        var parent = this.parent;\n        if ((obj.activePoint.height < parent.lowerCanvas.height - parent.toolbarHeight) ||\n            (obj.activePoint.width < parent.lowerCanvas.width)) {\n            isOutside = true;\n        }\n        return isOutside;\n    };\n    Draw.prototype.downScaleImgCanvas = function (ctx, isImgAnnotation, isHFlip, isVFlip) {\n        var parent = this.parent;\n        var canvas = isImgAnnotation ? parent.activeObj.imageCanvas : parent.baseImgCanvas;\n        var img = isImgAnnotation ? parent.activeObj.imageElement : parent.baseImg;\n        var width = isImgAnnotation ? parent.activeObj.activePoint.width : parent.img.destWidth;\n        var height = isImgAnnotation ? parent.activeObj.activePoint.height : parent.img.destHeight;\n        var obj = { width: 0, height: 0 };\n        if (parent.transform.degree % 90 === 0 && parent.transform.degree % 180 !== 0) {\n            parent.notify('transform', { prop: 'calcMaxDimension', onPropertyChange: false,\n                value: { width: img.height, height: img.width, obj: obj, isImgShape: isImgAnnotation } });\n        }\n        else {\n            parent.notify('transform', { prop: 'calcMaxDimension', onPropertyChange: false,\n                value: { width: img.width, height: img.height, obj: obj, isImgShape: isImgAnnotation } });\n        }\n        if (isImgAnnotation || (parent.allowDownScale && !parent.isCropTab && !parent.isCropToolbar && img.width !== 0 && img.height !== 0\n            && obj['width'] * 0.75 > width && obj['height'] * 0.75 > height)) {\n            var tempCanvas = parent.createElement('canvas', {\n                id: parent.element.id + '_downScaleCanvas', attrs: { name: 'canvasImage' }\n            });\n            tempCanvas.width = isImgAnnotation ? img.width : parent.img.srcWidth;\n            tempCanvas.height = isImgAnnotation ? img.height : parent.img.srcHeight;\n            if (isImgAnnotation) {\n                tempCanvas.getContext('2d').drawImage(img, 0, 0, tempCanvas.width, tempCanvas.height);\n            }\n            else {\n                if (this.imageBackgroundColor !== '') {\n                    ctx.fillStyle = this.imageBackgroundColor;\n                    ctx.fillRect(parent.img.destLeft, parent.img.destTop, parent.img.destWidth, parent.img.destHeight);\n                }\n                tempCanvas.getContext('2d').drawImage(canvas, parent.img.srcLeft, parent.img.srcTop, parent.img.srcWidth, parent.img.srcHeight, 0, 0, tempCanvas.width, tempCanvas.height);\n            }\n            if (isImgAnnotation || this.isDownScale) {\n                this.downScale(tempCanvas, width, height, isImgAnnotation);\n            }\n            if (isImgAnnotation) {\n                ctx.canvas.width = tempCanvas.width;\n                ctx.canvas.height = tempCanvas.height;\n                if (isHFlip && isVFlip) {\n                    ctx.translate(parent.activeObj.imageCanvas.width, 0);\n                    ctx.scale(-1, 1);\n                    ctx.translate(0, parent.activeObj.imageCanvas.height);\n                    ctx.scale(1, -1);\n                }\n                else {\n                    if (isHFlip) {\n                        if (isNullOrUndefined(parent.activeObj.isHorImageFlip) || !parent.activeObj.isHorImageFlip) {\n                            parent.activeObj.isHorImageFlip = true;\n                            ctx.translate(parent.activeObj.imageCanvas.width, 0);\n                            ctx.scale(-1, 1);\n                        }\n                        else if (parent.activeObj.isHorImageFlip) {\n                            parent.activeObj.isHorImageFlip = false;\n                        }\n                        if (parent.activeObj.isVerImageFlip) {\n                            ctx.translate(0, parent.activeObj.imageCanvas.height);\n                            ctx.scale(1, -1);\n                        }\n                    }\n                    else if (isVFlip) {\n                        if (isNullOrUndefined(parent.activeObj.isVerImageFlip) || !parent.activeObj.isVerImageFlip) {\n                            parent.activeObj.isVerImageFlip = true;\n                            ctx.translate(0, parent.activeObj.imageCanvas.height);\n                            ctx.scale(1, -1);\n                        }\n                        else if (parent.activeObj.isVerImageFlip) {\n                            parent.activeObj.isVerImageFlip = false;\n                        }\n                        if (parent.activeObj.isHorImageFlip) {\n                            ctx.translate(parent.activeObj.imageCanvas.width, 0);\n                            ctx.scale(-1, 1);\n                        }\n                    }\n                }\n                ctx.drawImage(tempCanvas, 0, 0);\n                ctx.setTransform(1, 0, 0, 1, 0, 0);\n            }\n            else if (parent.isFinetuning) {\n                ctx.save();\n                ctx.setTransform(1, 0, 0, 1, 0, 0);\n                ctx.drawImage(parent.inMemoryCanvas, 0, 0);\n                ctx.restore();\n            }\n            else {\n                ctx.drawImage(tempCanvas, 0, 0, tempCanvas.width, tempCanvas.height, parent.img.destLeft, parent.img.destTop, tempCanvas.width, tempCanvas.height);\n            }\n        }\n        else {\n            if ((isNullOrUndefined(isImgAnnotation) || !isImgAnnotation) && parent.baseImgCanvas.width !== 0 &&\n                parent.baseImgCanvas.height !== 0) {\n                if (this.imageBackgroundColor !== '') {\n                    ctx.fillStyle = this.imageBackgroundColor;\n                    ctx.fillRect(parent.img.destLeft, parent.img.destTop, parent.img.destWidth, parent.img.destHeight);\n                }\n                ctx.drawImage(parent.baseImgCanvas, parent.img.srcLeft, parent.img.srcTop, parent.img.srcWidth, parent.img.srcHeight, parent.img.destLeft, parent.img.destTop, parent.img.destWidth, parent.img.destHeight);\n            }\n        }\n        if (parent.isSafari) {\n            parent.notify('filter', { prop: 'apply-filter', onPropertyChange: false, value: { context: ctx } });\n        }\n    };\n    Draw.prototype.downScale = function (canvas, width, height, isImgAnnotation) {\n        var parent = this.parent;\n        if (isImgAnnotation && parent.isStraightening) {\n            return;\n        }\n        var widthSource = canvas.width;\n        var heightSource = canvas.height;\n        width = Math.round(width);\n        height = Math.round(height);\n        var widthRatio = widthSource / width;\n        var heightRatio = heightSource / height;\n        var halfWidthRatio = Math.ceil(widthRatio / 2);\n        var halfHeightRatio = Math.ceil(heightRatio / 2);\n        var ctx = canvas.getContext('2d');\n        var img = ctx.getImageData(0, 0, widthSource, heightSource);\n        var img2 = ctx.createImageData(width, height);\n        var data = img.data;\n        var data2 = img2.data;\n        for (var j = 0; j < height; j++) {\n            for (var i = 0; i < width; i++) {\n                var x2 = (i + j * width) * 4;\n                var weight = 0;\n                var weights = 0;\n                var alphaWeights = 0;\n                var r = 0;\n                var g = 0;\n                var b = 0;\n                var a = 0;\n                var centerY = (j + 0.5) * heightRatio;\n                var startY = Math.floor(j * heightRatio);\n                var stopY = Math.ceil((j + 1) * heightRatio);\n                for (var y = startY; y < stopY; y++) {\n                    var dy = Math.abs(centerY - (y + 0.5)) / halfHeightRatio;\n                    var centerX = (i + 0.5) * widthRatio;\n                    var w0 = dy * dy; //pre-calc part of w\n                    var startX = Math.floor(i * widthRatio);\n                    var stopX = Math.ceil((i + 1) * widthRatio);\n                    for (var x = startX; x < stopX; x++) {\n                        var dx = Math.abs(centerX - (x + 0.5)) / halfWidthRatio;\n                        var w = Math.sqrt(w0 + dx * dx);\n                        if (w >= 1) {\n                            continue;\n                        }\n                        weight = 2 * w * w * w - 3 * w * w + 1;\n                        var xPos = 4 * (x + y * widthSource);\n                        a += weight * data[xPos + 3];\n                        alphaWeights += weight;\n                        weight = weight * data[xPos + 3] / 250;\n                        r += weight * data[xPos];\n                        g += weight * data[xPos + 1];\n                        b += weight * data[xPos + 2];\n                        weights += weight;\n                    }\n                }\n                data2[x2] = r / weights;\n                data2[x2 + 1] = g / weights;\n                data2[x2 + 2] = b / weights;\n                data2[x2 + 3] = a / alphaWeights;\n            }\n        }\n        canvas.width = isImgAnnotation ? parent.activeObj.activePoint.width : parent.lowerCanvas.width;\n        canvas.height = isImgAnnotation ? parent.activeObj.activePoint.height : parent.lowerCanvas.height;\n        ctx.putImageData(img2, 0, 0);\n    };\n    Draw.prototype.drawImgToCtx = function (ctx, preventImg) {\n        var parent = this.parent;\n        if (ctx.canvas.id !== parent.element.id + '_tempCanvas' && ctx !== this.upperContext && isNullOrUndefined(preventImg)) {\n            this.downScaleImgCanvas(ctx, null, null, null);\n        }\n    };\n    Draw.prototype.getFrameColor = function (frameObj, ctx, points) {\n        var parent = this.parent;\n        var color = parent.frameObj.color;\n        if (frameObj.gradientColor) {\n            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n            var gradient = ctx.createLinearGradient(points.startX, points.startY, points.startX + points.width, points.startY + points.height);\n            gradient.addColorStop(0, frameObj.color);\n            gradient.addColorStop(1, frameObj.gradientColor);\n            color = gradient;\n        }\n        else {\n            color = frameObj.color;\n        }\n        return color;\n    };\n    Draw.prototype.applyFrame = function (ctx, frame, preventImg) {\n        var parent = this.parent;\n        parent.frameObj.type = frame;\n        var tempLineWidth;\n        var ratio = { width: 1, height: 1 };\n        var points = { startX: parent.img.destLeft - ctx.lineWidth, startY: parent.img.destTop - ctx.lineWidth,\n            width: parent.img.destWidth + (2 * ctx.lineWidth), height: parent.img.destHeight + (2 * ctx.lineWidth) };\n        var frameObj = { type: parent.frameObj.type, color: parent.frameObj.color, size: parent.frameObj.size,\n            inset: parent.frameObj.inset, offset: parent.frameObj.offset / 2, radius: parent.frameObj.radius,\n            amount: parent.frameObj.amount, border: parent.frameObj.border, gradientColor: parent.frameObj.gradientColor };\n        var zoomFactor = parent.transform.zoomFactor;\n        if (ctx.canvas.id === parent.element.id + '_tempCanvas') {\n            var newWidth = ctx.canvas.width;\n            var newHeight = ctx.canvas.height;\n            var obj = { width: 0, height: 0 };\n            parent.notify('crop', { prop: 'calcRatio', onPropertyChange: false,\n                value: { obj: obj, dimension: { width: newWidth, height: newHeight } } });\n            ratio = obj;\n            frameObj.size *= ((ratio.width + ratio.height) / 2);\n            frameObj.inset *= ((ratio.width + ratio.height) / 2);\n            frameObj.offset *= ((ratio.width + ratio.height) / 2);\n            frameObj.radius *= ((ratio.width + ratio.height) / 2);\n            points = { startX: 0, startY: 0, width: ctx.canvas.width, height: ctx.canvas.height };\n            parent.notify('export', { prop: 'updateSaveContext', onPropertyChange: false, value: { context: ctx } });\n        }\n        else if (ctx === this.upperContext && parent.activeObj.shape) {\n            points = { startX: parent.activeObj.activePoint.startX - ctx.lineWidth, startY: parent.activeObj.activePoint.startY\n                    - ctx.lineWidth, width: parent.activeObj.activePoint.width + (2 * ctx.lineWidth), height: parent.activeObj.activePoint.height + (2 * ctx.lineWidth) };\n        }\n        else if (isNullOrUndefined(preventImg)) {\n            ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);\n        }\n        var valueForty = (40 * ((ratio.width + ratio.height) / 2));\n        var valueFifty = (50 * ((ratio.width + ratio.height) / 2));\n        if (ctx !== this.upperContext) {\n            frameObj.size += (frameObj.size * zoomFactor);\n            frameObj.inset += (frameObj.inset * zoomFactor);\n            frameObj.offset += (frameObj.offset * zoomFactor);\n            frameObj.radius += (frameObj.radius * zoomFactor);\n            valueForty += (valueForty * zoomFactor);\n            valueFifty += (valueFifty * zoomFactor);\n        }\n        if (ctx === this.upperContext && parent.activeObj.shape) {\n            if ((frame === 'mat' && ((points.width - (2 * frameObj.size) < 0) || (points.height - (2 * frameObj.size) < 0))) ||\n                (frame === 'bevel' && (points.width - (2 * frameObj.size) < 40 || points.height - (2 * frameObj.size) < 40)) ||\n                ((frame === 'inset') && (points.startX + points.width - frameObj.offset - (points.startX + frameObj.offset) < 0 ||\n                    points.startY + points.height - frameObj.offset - (points.startY + frameObj.offset) < 0)) ||\n                (frame === 'hook' && (points.width - (2 * frameObj.size) < 50 || points.height - (2 * frameObj.size) < 50))) {\n                return;\n            }\n        }\n        var bevelObj = { bevelFilter: ctx.filter };\n        var filter = ctx.filter;\n        if ((parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle') || parent.isCircleCrop ||\n            (ctx === this.lowerContext && parent.isCropTab)) {\n            this.drawImgToCtx(ctx, preventImg);\n        }\n        else {\n            switch (frame) {\n                case 'none':\n                    this.drawImgToCtx(ctx, preventImg);\n                    break;\n                case 'mat':\n                    this.drawImgToCtx(ctx, preventImg);\n                    while (((points.width - (2 * frameObj.size) < 0) ||\n                        (points.height - (2 * frameObj.size) < 0)) && frameObj.size > 0) {\n                        frameObj.size -= 20;\n                    }\n                    ctx.filter = 'none';\n                    ctx.fillStyle = this.getFrameColor(frameObj, ctx, points);\n                    ctx.beginPath();\n                    ctx.rect(points.startX, points.startY, points.width, points.height);\n                    ctx.rect(points.startX + frameObj.size, points.startY + frameObj.size, points.width -\n                        (2 * frameObj.size), points.height - (2 * frameObj.size));\n                    ctx.fill('evenodd');\n                    ctx.closePath();\n                    break;\n                case 'bevel':\n                    ctx.filter = 'none';\n                    ctx.fillStyle = this.getFrameColor(frameObj, ctx, points);\n                    ctx.beginPath();\n                    ctx.fillRect(points.startX, points.startY, points.width, points.height);\n                    ctx.closePath();\n                    points.startX += frameObj.size;\n                    points.startY += frameObj.size;\n                    points.width -= (2 * frameObj.size);\n                    points.height -= (2 * frameObj.size);\n                    while ((points.width - (2 * frameObj.size) < 40 ||\n                        points.height - (2 * frameObj.size) < 40) && frameObj.size > 0) {\n                        points.startX -= frameObj.size;\n                        points.startY -= frameObj.size;\n                        points.width += (2 * frameObj.size);\n                        points.height += (2 * frameObj.size);\n                        frameObj.size -= 20;\n                        points.startX += frameObj.size;\n                        points.startY += frameObj.size;\n                        points.width -= (2 * frameObj.size);\n                        points.height -= (2 * frameObj.size);\n                    }\n                    ctx.fillStyle = this.getFrameColor(frameObj, ctx, points);\n                    ctx.save();\n                    ctx.beginPath();\n                    ctx.moveTo(points.startX + valueForty, points.startY);\n                    ctx.lineTo(points.startX + points.width - valueForty, points.startY);\n                    ctx.quadraticCurveTo(points.startX + points.width, points.startY, points.startX + points.width, points.startY + valueForty);\n                    ctx.lineTo(points.startX + points.width, points.startY + points.height - valueForty);\n                    ctx.quadraticCurveTo(points.startX + points.width, points.startY + points.height, points.startX + points.width - valueForty, points.startY + points.height);\n                    ctx.lineTo(points.startX + valueForty, points.startY + points.height);\n                    ctx.quadraticCurveTo(points.startX, points.startY + points.height, points.startX, points.startY + points.height\n                        - valueForty);\n                    ctx.lineTo(points.startX, points.startY + valueForty);\n                    ctx.quadraticCurveTo(points.startX, points.startY, points.startX + valueForty, points.startY);\n                    ctx.closePath();\n                    ctx.clip();\n                    ctx.filter = filter === 'none' ? parent.canvasFilter : filter;\n                    if (ctx.canvas.id === parent.element.id + '_tempCanvas') {\n                        preventImg = null;\n                        ctx.filter = 'none';\n                        ctx.drawImage(parent.inMemoryCanvas, 0, 0);\n                        ctx.filter = filter === 'none' ? parent.canvasFilter : filter;\n                    }\n                    else {\n                        ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);\n                        if (preventImg) {\n                            preventImg = null;\n                            if (parent.transform.zoomFactor !== 0) {\n                                this.isRotateZoom = true;\n                            }\n                            parent.notify('filter', { prop: 'getBevelFilter', onPropertyChange: false, value: { obj: bevelObj } });\n                            ctx.filter = bevelObj['bevelFilter'];\n                            this.updateCurrTransState('initial');\n                            this.drawImgToCtx(ctx, preventImg);\n                            this.updateCurrTransState('reverse');\n                            this.isRotateZoom = false;\n                            parent.frameObj.type = 'none';\n                            ctx.filter = 'none';\n                            parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n                                value: { ctx: ctx, shape: 'iterate', pen: 'iterate', isPreventApply: null } });\n                            parent.frameObj.type = 'bevel';\n                            ctx.filter = filter === 'none' ? parent.canvasFilter : filter;\n                        }\n                        else {\n                            parent.notify('filter', { prop: 'getBevelFilter', onPropertyChange: false, value: { obj: bevelObj } });\n                            ctx.filter = bevelObj['bevelFilter'];\n                            this.drawImgToCtx(ctx, preventImg);\n                        }\n                    }\n                    ctx.restore();\n                    break;\n                case 'line':\n                    this.drawImgToCtx(ctx, preventImg);\n                    tempLineWidth = ctx.lineWidth;\n                    ctx.lineWidth = frameObj.size / 10;\n                    for (var i = 0; i < parent.frameObj.amount; i++) {\n                        if (i > 0) {\n                            points.startX += frameObj.offset;\n                            points.startY += frameObj.offset;\n                            points.width -= (2 * frameObj.offset);\n                            points.height -= (2 * frameObj.offset);\n                        }\n                        var arcY2 = points.startY + points.height - frameObj.inset - frameObj.radius;\n                        var lineY = points.startY + frameObj.inset + frameObj.radius;\n                        var arcX2 = points.startX + points.width - frameObj.inset - frameObj.radius;\n                        var lineX = points.startX + frameObj.inset + frameObj.radius;\n                        var arcX1 = points.startX + frameObj.inset + frameObj.radius;\n                        var lineX2 = points.startX + points.width - frameObj.inset - frameObj.radius;\n                        var arcY1 = points.startY + frameObj.inset + frameObj.radius;\n                        var lineY2 = points.startY + points.height - frameObj.inset - frameObj.radius;\n                        if (arcY2 >= lineY && arcX2 >= lineX && arcX1 <= lineX2 && arcY1 <= lineY2) {\n                            ctx.filter = 'none';\n                            ctx.strokeStyle = this.getFrameColor(frameObj, ctx, points);\n                            if (frameObj.border === 'dashed') {\n                                ctx.setLineDash([ctx.lineWidth * 2.5, ctx.lineWidth * 1.5]);\n                            }\n                            else if (frameObj.border === 'dotted') {\n                                ctx.setLineDash([ctx.lineWidth, ctx.lineWidth]);\n                            }\n                            ctx.beginPath();\n                            ctx.moveTo(points.startX + frameObj.inset + frameObj.radius, points.startY + frameObj.inset);\n                            ctx.lineTo(points.startX + points.width - frameObj.inset - frameObj.radius, points.startY + frameObj.inset);\n                            ctx.arcTo(points.startX + points.width - frameObj.inset, points.startY + frameObj.inset, points.startX + points.width - frameObj.inset, points.startY + frameObj.inset + frameObj.radius, frameObj.radius);\n                            ctx.lineTo(points.startX + points.width - frameObj.inset, points.startY + points.height - frameObj.inset -\n                                frameObj.radius);\n                            ctx.arcTo(points.startX + points.width - frameObj.inset, points.startY + points.height - frameObj.inset, points.startX + points.width - frameObj.inset - frameObj.radius, points.startY + points.height\n                                - frameObj.inset, frameObj.radius);\n                            ctx.lineTo(points.startX + frameObj.inset + frameObj.radius, points.startY + points.height - frameObj.inset);\n                            ctx.arcTo(points.startX + frameObj.inset, points.startY + points.height - frameObj.inset, points.startX + frameObj.inset, points.startY + points.height - frameObj.inset - frameObj.radius, frameObj.radius);\n                            ctx.lineTo(points.startX + frameObj.inset, points.startY + frameObj.inset + frameObj.radius);\n                            ctx.arcTo(points.startX + frameObj.inset, points.startY + frameObj.inset, points.startX + frameObj.inset + frameObj.radius, points.startY + frameObj.inset, frameObj.radius);\n                            ctx.closePath();\n                            ctx.stroke();\n                            ctx.setLineDash([]);\n                        }\n                    }\n                    ctx.lineWidth = tempLineWidth;\n                    break;\n                case 'inset':\n                    this.drawImgToCtx(ctx, preventImg);\n                    ctx.filter = 'none';\n                    ctx.strokeStyle = this.getFrameColor(frameObj, ctx, points);\n                    tempLineWidth = ctx.lineWidth;\n                    ctx.lineWidth = frameObj.size / 10;\n                    ctx.beginPath();\n                    ctx.moveTo(points.startX + frameObj.offset, points.startY + frameObj.inset);\n                    ctx.lineTo(points.startX + points.width - frameObj.offset, points.startY + frameObj.inset);\n                    ctx.moveTo(points.startX + points.width - frameObj.inset, points.startY + frameObj.offset);\n                    ctx.lineTo(points.startX + points.width - frameObj.inset, points.startY + points.height - frameObj.offset);\n                    ctx.moveTo(points.startX + points.width - frameObj.offset, points.startY + points.height - frameObj.inset);\n                    ctx.lineTo(points.startX + frameObj.offset, points.startY + points.height - frameObj.inset);\n                    ctx.moveTo(points.startX + frameObj.inset, points.startY + points.height - frameObj.offset);\n                    ctx.lineTo(points.startX + frameObj.inset, points.startY + frameObj.offset);\n                    ctx.stroke();\n                    ctx.closePath();\n                    ctx.lineWidth = tempLineWidth;\n                    break;\n                case 'hook':\n                    this.drawImgToCtx(ctx, preventImg);\n                    ctx.filter = 'none';\n                    ctx.strokeStyle = this.getFrameColor(frameObj, ctx, points);\n                    tempLineWidth = ctx.lineWidth;\n                    ctx.lineWidth = frameObj.size / 10;\n                    ctx.beginPath();\n                    ctx.moveTo(points.startX + frameObj.inset + valueFifty, points.startY + frameObj.inset);\n                    ctx.lineTo(points.startX + frameObj.inset, points.startY + frameObj.inset);\n                    ctx.lineTo(points.startX + frameObj.inset, points.startY + frameObj.inset + valueFifty);\n                    ctx.moveTo(points.startX + points.width - frameObj.inset - valueFifty, points.startY + frameObj.inset);\n                    ctx.lineTo(points.startX + points.width - frameObj.inset, points.startY + frameObj.inset);\n                    ctx.lineTo(points.startX + points.width - frameObj.inset, points.startY + frameObj.inset + valueFifty);\n                    ctx.moveTo(points.startX + points.width - frameObj.inset - valueFifty, points.startY + points.height - frameObj.inset);\n                    ctx.lineTo(points.startX + points.width - frameObj.inset, points.startY + points.height - frameObj.inset);\n                    ctx.lineTo(points.startX + points.width - frameObj.inset, points.startY + points.height - frameObj.inset - valueFifty);\n                    ctx.moveTo(points.startX + frameObj.inset + valueFifty, points.startY + points.height - frameObj.inset);\n                    ctx.lineTo(points.startX + frameObj.inset, points.startY + points.height - frameObj.inset);\n                    ctx.lineTo(points.startX + frameObj.inset, points.startY + points.height - frameObj.inset - valueFifty);\n                    ctx.stroke();\n                    ctx.lineWidth = tempLineWidth;\n                    break;\n            }\n            if (parent.isCircleCrop || (parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle')) {\n                parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                    value: { context: ctx, isSave: ctx.canvas.id === parent.element.id + '_tempCanvas' ? true : null, isFlip: null } });\n            }\n            ctx.filter = filter;\n        }\n    };\n    Draw.prototype.triggerFrameChange = function (prevFrameSettings) {\n        var parent = this.parent;\n        var currFrameSettings = { type: parent.toPascalCase(parent.frameObj.type),\n            color: parent.frameObj.color, gradientColor: parent.frameObj.gradientColor, size: parent.frameObj.size,\n            inset: parent.frameObj.inset, offset: parent.frameObj.offset, borderRadius: parent.frameObj.radius,\n            frameLineStyle: parent.toPascalCase(parent.frameObj.border), lineCount: parent.frameObj.amount };\n        var frameChange = { cancel: false, previousFrameSetting: prevFrameSettings,\n            currentFrameSetting: currFrameSettings };\n        parent.trigger('frameChange', frameChange);\n        parent.editCompleteArgs = frameChange;\n        if (!frameChange.cancel) {\n            this.setFrameObj(frameChange.currentFrameSetting);\n        }\n        return frameChange;\n    };\n    Draw.prototype.setFrameObj = function (currFrameSettings) {\n        var parent = this.parent;\n        parent.frameObj.type = currFrameSettings.type.toLowerCase();\n        parent.frameObj.color = currFrameSettings.color;\n        parent.frameObj.gradientColor = currFrameSettings.gradientColor;\n        parent.frameObj.size = currFrameSettings.size;\n        parent.frameObj.inset = currFrameSettings.inset;\n        parent.frameObj.offset = currFrameSettings.offset;\n        parent.frameObj.radius = currFrameSettings.borderRadius;\n        parent.frameObj.border = currFrameSettings.frameLineStyle.toLowerCase();\n        parent.frameObj.amount = currFrameSettings.lineCount;\n    };\n    Draw.prototype.zoomToSel = function (activeObj, isToolbar) {\n        var parent = this.parent;\n        if (this.straightenActObj && JSON.stringify(this.straightenActObj.activePoint) === JSON.stringify(activeObj.activePoint)) {\n            parent.activeObj = extend({}, this.straightenActObj, null, true);\n            this.allowRedactStraighten = false;\n            if (parent.transform.straighten === 0) {\n                var destWidth = parent.img.destWidth;\n                var destHeight = parent.img.destHeight;\n                parent.transform.straighten = 360;\n                while (true) {\n                    if (!isNullOrUndefined(this.straightenInitZoom) &&\n                        (Math.round(parent.transform.zoomFactor * Math.pow(10, 3)) / Math.pow(10, 3)) >\n                            (Math.round(this.straightenInitZoom * Math.pow(10, 3)) / Math.pow(10, 3))) {\n                        this.setZoomPan('out');\n                        if (destWidth === parent.img.destWidth && destHeight === parent.img.destHeight) {\n                            this.performDummyZoom();\n                            break;\n                        }\n                        if (parent.transform.degree === 0) {\n                            parent.transform.zoomFactor -= 0.025;\n                            parent.transform.cropZoomFactor -= 0.025;\n                        }\n                    }\n                    else {\n                        this.performDummyZoom();\n                        break;\n                    }\n                }\n                parent.transform.straighten = 0;\n                parent.img = { destLeft: parent.img.destLeft, destTop: parent.img.destTop, destWidth: parent.img.destWidth,\n                    destHeight: parent.img.destHeight, srcLeft: parent.img.srcLeft, srcTop: parent.img.srcTop,\n                    srcWidth: parent.img.srcWidth, srcHeight: parent.img.srcHeight };\n            }\n            else {\n                if (isNullOrUndefined(this.straightenInitZoom)) {\n                    this.straightenInitZoom = parent.transform.zoomFactor;\n                }\n                if (this.straightenInitZoom - parent.transform.zoomFactor > 0) {\n                    parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                        value: { zoomFactor: -(this.straightenInitZoom - parent.transform.zoomFactor), zoomPoint: null, isResize: true } });\n                }\n                else if (this.straightenInitZoom - parent.transform.zoomFactor < 0) {\n                    parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                        value: { zoomFactor: (this.straightenInitZoom - parent.transform.zoomFactor), zoomPoint: null, isResize: true } });\n                }\n                parent.activeObj = extend({}, activeObj, null, true);\n                parent.transform.zoomFactor += 0.001;\n                this.calcStraightenedPoints(isToolbar);\n            }\n        }\n        else {\n            this.straightenActObj = extend({}, activeObj, null, true);\n            parent.activeObj = extend({}, this.straightenActObj, null, true);\n            this.straightenInitZoom = parent.transform.zoomFactor;\n            this.calcStraightenedPoints(isToolbar);\n        }\n    };\n    Draw.prototype.isDestPointSmall = function () {\n        var parent = this.parent;\n        var img = parent.img;\n        var destPoints = { startX: img.destLeft, startY: img.destTop,\n            width: img.destWidth, height: img.destHeight };\n        parent.notify('shape', { prop: 'straightenShapes', onPropertyChange: false });\n        var isSmall = false;\n        if (this.straightenDestPoints.destWidth && this.straightenDestPoints.destHeight &&\n            (img.destWidth < this.straightenDestPoints.destWidth || img.destHeight < this.straightenDestPoints.destHeight)) {\n            isSmall = true;\n        }\n        img.destLeft = destPoints.startX;\n        img.destTop = destPoints.startY;\n        img.destWidth = destPoints.width;\n        img.destHeight = destPoints.height;\n        parent.img = img;\n        return isSmall;\n    };\n    Draw.prototype.calcStraightenedPoints = function (isToolbar) {\n        var parent = this.parent;\n        var destWidth = parent.img.destWidth;\n        var destHeight = parent.img.destHeight;\n        if (isNullOrUndefined(parent.transform.zoomFactor)) {\n            parent.transform.zoomFactor += 0.025;\n        }\n        this.updateImgCanvasPoints();\n        var _loop_1 = function () {\n            if (this_1.isLinesIntersect() || this_1.isSelOutsideImg() || (isToolbar && this_1.isDestPointSmall())) {\n                parent.activeObj = extend({}, this_1.straightenActObj, null, true);\n                this_1.setZoomPan('in');\n                if (destWidth === parent.img.destWidth && destHeight === parent.img.destHeight) {\n                    this_1.performDummyZoom();\n                    return \"break\";\n                }\n                if (parent.transform.degree === 0) {\n                    parent.transform.zoomFactor += 0.025;\n                    parent.transform.cropZoomFactor += 0.025;\n                }\n                var points = this_1.imgCanvasPoints;\n                var left_1 = parent.img.destLeft;\n                var top_1 = parent.img.destTop;\n                var width_1 = parent.img.destWidth;\n                var height_1 = parent.img.destHeight;\n                points.forEach(function (point) {\n                    point.x = (point.ratioX * width_1) + left_1;\n                    point.y = (point.ratioY * height_1) + top_1;\n                });\n                this_1.imgCanvasPoints = points;\n            }\n            else {\n                this_1.performDummyZoom();\n                return \"break\";\n            }\n        };\n        var this_1 = this;\n        while (true) {\n            var state_1 = _loop_1();\n            if (state_1 === \"break\")\n                break;\n        }\n    };\n    Draw.prototype.performDummyZoom = function () {\n        var parent = this.parent;\n        parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n            value: { zoomFactor: 0.025, zoomPoint: null, isResize: true } });\n        parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n            value: { zoomFactor: -0.025, zoomPoint: null, isResize: true } });\n        var zoom = parent.transform.zoomFactor * 10;\n        if (zoom < 1) {\n            zoom = 1 + (zoom / 10);\n        }\n        parent.setProperties({ zoomSettings: { zoomFactor: zoom } }, true);\n        parent.notify('transform', { prop: 'setPreviousZoomValue', onPropertyChange: false,\n            value: { previousZoomValue: zoom } });\n        this.panToSel();\n    };\n    Draw.prototype.setZoomPan = function (type) {\n        var parent = this.parent;\n        var obj = { maxDimension: null };\n        if (parent.transform.degree === 0) {\n            parent.notify('transform', { prop: 'cropZoom', onPropertyChange: false,\n                value: { value: type === 'in' ? 0.025 : -0.025, selectionObj: parent.activeObj, obj: obj } });\n            parent.img.destWidth = obj['maxDimension']['width'];\n            parent.img.destHeight = obj['maxDimension']['height'];\n        }\n        else {\n            parent.transform.zoomFactor += (type === 'in' ? 0.025 : -0.025);\n            parent.transform.cropZoomFactor += (type === 'in' ? 0.025 : -0.025);\n            this.updateCurrTransState('initial');\n            this.isRotateZoom = true;\n            this.setDestPoints();\n            this.isRotateZoom = false;\n            this.updateCurrTransState('reverse');\n        }\n    };\n    Draw.prototype.updateImgCanvasPoints = function () {\n        var parent = this.parent;\n        var points = this.getImagePoints();\n        var obj = { width: 0, height: 0 };\n        var width = parent.baseImgCanvas.width;\n        var height = parent.baseImgCanvas.height;\n        parent.notify('crop', { prop: 'calcRatio', onPropertyChange: false,\n            value: { obj: obj, dimension: { width: width, height: height } } });\n        var ratio = obj;\n        width = parent.transform.degree % 90 === 0 && parent.transform.degree % 180 !== 0 ?\n            ratio.height : ratio.width;\n        height = parent.transform.degree % 90 === 0 && parent.transform.degree % 180 !== 0 ?\n            ratio.width : ratio.height;\n        var p1;\n        var p2;\n        var p3;\n        var p4;\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        if (parent.transform.straighten > 0) {\n            p1 = { x: destLeft + (points[0].x / width), y: destTop };\n            p2 = { x: destLeft + destWidth, y: destTop + (points[1].y / height) };\n            p3 = { x: destLeft + destWidth - (points[0].x / width), y: destTop + destHeight };\n            p4 = { x: destLeft, y: destTop + destHeight - (points[1].y / height) };\n        }\n        else if (parent.transform.straighten < 0) {\n            p1 = { x: destLeft, y: destTop + (points[0].y / height) };\n            p2 = { x: destLeft + (points[1].x / width), y: destTop };\n            p3 = { x: destLeft + destWidth, y: destTop + destHeight - (points[0].y / height) };\n            p4 = { x: destLeft + destWidth - (points[1].x / width), y: destTop + destHeight };\n        }\n        else if (parent.transform.straighten === 0) {\n            p1 = { x: destLeft, y: destTop };\n            p2 = { x: destLeft + destWidth, y: destTop };\n            p3 = { x: destLeft + destWidth, y: destTop + destHeight };\n            p4 = { x: destLeft, y: destTop + destHeight };\n        }\n        p1.ratioX = (p1.x - destLeft) / destWidth;\n        p1.ratioY = (p1.y - destTop) / destHeight;\n        p2.ratioX = (p2.x - destLeft) / destWidth;\n        p2.ratioY = (p2.y - destTop) / destHeight;\n        p3.ratioX = (p3.x - destLeft) / destWidth;\n        p3.ratioY = (p3.y - destTop) / destHeight;\n        p4.ratioX = (p4.x - destLeft) / destWidth;\n        p4.ratioY = (p4.y - destTop) / destHeight;\n        this.imgCanvasPoints = [p1, p2, p3, p4];\n    };\n    Draw.prototype.isLinesIntersect = function (obj) {\n        var parent = this.parent;\n        var point = parent.activeObj.activePoint;\n        if (parent.activeObj.rotatedAngle !== 0) {\n            var _a = parent.activeObj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY, width = _a.width, height = _a.height;\n            var center = { x: startX + (width / 2), y: startY +\n                    (height / 2) };\n            var cosAngle = Math.cos(parent.activeObj.rotatedAngle);\n            var sinAngle = Math.sin(parent.activeObj.rotatedAngle);\n            var p1 = { x: cosAngle * (startX - center.x) - sinAngle * (startY - center.y) + center.x,\n                y: sinAngle * (startX - center.x) + cosAngle * (startY - center.y) + center.y };\n            var p2 = { x: cosAngle * (endX - center.x) - sinAngle * (startY - center.y) + center.x,\n                y: sinAngle * (endX - center.x) + cosAngle * (startY - center.y) + center.y };\n            var p3 = { x: cosAngle * (startX - center.x) - sinAngle * (endY - center.y) + center.x,\n                y: sinAngle * (startX - center.x) + cosAngle * (endY - center.y) + center.y };\n            var p4 = { x: cosAngle * (endX - center.x) - sinAngle * (endY - center.y) + center.x,\n                y: sinAngle * (endX - center.x) + cosAngle * (endY - center.y) + center.y };\n            var imgPoints_1 = this.imgCanvasPoints;\n            var isTopIntersect_1 = this.doIntersect(p1, p2, imgPoints_1[0], imgPoints_1[1]);\n            var isRightIntersect_1 = this.doIntersect(p2, p4, imgPoints_1[1], imgPoints_1[2]);\n            var isBottomIntersect_1 = this.doIntersect(p3, p4, imgPoints_1[2], imgPoints_1[3]);\n            var isLeftIntersect_1 = this.doIntersect(p1, p3, imgPoints_1[3], imgPoints_1[0]);\n            if (obj) {\n                obj['arr'] = [isTopIntersect_1, isRightIntersect_1, isBottomIntersect_1, isLeftIntersect_1];\n            }\n            return isTopIntersect_1 || isRightIntersect_1 || isBottomIntersect_1 || isLeftIntersect_1;\n        }\n        var imgPoints = this.imgCanvasPoints;\n        var isTopIntersect = this.doIntersect({ x: point.startX, y: point.startY }, { x: point.endX, y: point.startY }, imgPoints[0], imgPoints[1]);\n        var isRightIntersect = this.doIntersect({ x: point.endX, y: point.startY }, { x: point.endX, y: point.endY }, imgPoints[1], imgPoints[2]);\n        var isBottomIntersect = this.doIntersect({ x: point.startX, y: point.endY }, { x: point.endX, y: point.endY }, imgPoints[2], imgPoints[3]);\n        var isLeftIntersect = this.doIntersect({ x: point.startX, y: point.startY }, { x: point.startX, y: point.endY }, imgPoints[3], imgPoints[0]);\n        var isTopLeftInsideRect = this.isInsideRect(imgPoints[0]);\n        var isTopRightInsideRect = this.isInsideRect(imgPoints[1]);\n        var isBottomRightInsideRect = this.isInsideRect(imgPoints[2]);\n        var isBottomLeftInsideRect = this.isInsideRect(imgPoints[3]);\n        if (obj) {\n            obj['arr'] = [isTopIntersect, isRightIntersect, isBottomIntersect, isLeftIntersect];\n        }\n        return isTopIntersect || isRightIntersect || isBottomIntersect || isLeftIntersect ||\n            isTopLeftInsideRect || isTopRightInsideRect || isBottomRightInsideRect || isBottomLeftInsideRect ||\n            (imgPoints[0].x > point.startX && imgPoints[1].x < point.endX &&\n                imgPoints[2].x < point.endX && imgPoints[3].x > point.startX &&\n                imgPoints[0].y < point.startY && imgPoints[1].y < point.startY &&\n                imgPoints[2].y > point.endY && imgPoints[3].y > point.endY) ||\n            (imgPoints[0].x < point.startX && imgPoints[1].x > point.endX &&\n                imgPoints[2].x > point.endX && imgPoints[3].x < point.startX &&\n                imgPoints[0].y > point.startY && imgPoints[1].y > point.startY &&\n                imgPoints[2].y < point.endY && imgPoints[3].y < point.endY);\n    };\n    Draw.prototype.isSelOutsideImg = function () {\n        var parent = this.parent;\n        var points = this.imgCanvasPoints;\n        var actPoint = parent.activeObj.activePoint;\n        return (this.checkPointPosition(actPoint.startX, actPoint.startY, points[0].x, points[0].y, points[1].x, points[1].y, points[2].x, points[2].y, points[3].x, points[3].y) !== 'inside' ||\n            this.checkPointPosition(actPoint.endX, actPoint.startY, points[0].x, points[0].y, points[1].x, points[1].y, points[2].x, points[2].y, points[3].x, points[3].y) !== 'inside' ||\n            this.checkPointPosition(actPoint.startX, actPoint.endY, points[0].x, points[0].y, points[1].x, points[1].y, points[2].x, points[2].y, points[3].x, points[3].y) !== 'inside' ||\n            this.checkPointPosition(actPoint.endX, actPoint.endY, points[0].x, points[0].y, points[1].x, points[1].y, points[2].x, points[2].y, points[3].x, points[3].y) !== 'inside');\n    };\n    Draw.prototype.calcTriangleArea = function (x1, y1, x2, y2, x3, y3) {\n        return Math.abs((x1 * (y2 - y3) + x2 * (y3 - y1) + x3 * (y1 - y2)) / 2);\n    };\n    Draw.prototype.checkPointPosition = function (x, y, x1, y1, x2, y2, x3, y3, x4, y4) {\n        var area1 = this.calcTriangleArea(x, y, x1, y1, x4, y4);\n        var area2 = this.calcTriangleArea(x, y, x4, y4, x3, y3);\n        var area3 = this.calcTriangleArea(x, y, x3, y3, x2, y2);\n        var area4 = this.calcTriangleArea(x, y, x2, y2, x1, y1);\n        var areaRectangle = this.calcTriangleArea(x1, y1, x2, y2, x3, y3) + this.calcTriangleArea(x3, y3, x4, y4, x1, y1);\n        if (area1 + area2 + area3 + area4 > areaRectangle) {\n            return 'outside';\n        }\n        else if (area1 + area2 + area3 + area4 === areaRectangle && (area1 === 0 || area2 === 0 || area3 === 0 || area4 === 0)) {\n            return 'on';\n        }\n        else {\n            return 'inside';\n        }\n    };\n    Draw.prototype.getImagePoints = function () {\n        var point = [];\n        var parent = this.parent;\n        var degree = parent.transform.degree;\n        var width = parent.baseImg.width;\n        var height = parent.baseImg.height;\n        var obj = { dim: null, width: height, height: width, angle: parent.transform.straighten };\n        obj['dim'] = parent.getRotatedCanvasDim(obj['width'], obj['height'], obj['angle']);\n        var baseImgCanvasWidth = degree % 90 === 0 && degree % 180 !== 0 ? obj['dim']['width'] : parent.baseImgCanvas.width;\n        var baseImgCanvasHeight = degree % 90 === 0 && degree % 180 !== 0 ? obj['dim']['height'] : parent.baseImgCanvas.height;\n        var baseImgWidth = degree % 90 === 0 && degree % 180 !== 0 ? height : width;\n        var baseImgHeight = degree % 90 === 0 && degree % 180 !== 0 ? width : height;\n        var centerX = baseImgCanvasWidth / 2;\n        var centerY = baseImgCanvasHeight / 2;\n        var startX = centerX - (baseImgWidth / 2);\n        var startY = centerY - (baseImgHeight / 2);\n        var endX = centerX + (baseImgWidth / 2);\n        var endY = centerY + (baseImgHeight / 2);\n        var center = { x: centerX, y: centerY };\n        var radians = parent.transform.straighten * (Math.PI / 180);\n        var p1 = { x: Math.cos(radians) * (startX - center.x) - Math.sin(radians) * (startY - center.y) + center.x,\n            y: Math.sin(radians) * (startX - center.x) + Math.cos(radians) * (startY - center.y) + center.y };\n        var p2 = { x: Math.cos(radians) * (endX - center.x) - Math.sin(radians) * (startY - center.y) + center.x,\n            y: Math.sin(radians) * (endX - center.x) + Math.cos(radians) * (startY - center.y) + center.y };\n        var p3 = { x: Math.cos(radians) * (endX - center.x) - Math.sin(radians) * (endY - center.y) + center.x,\n            y: Math.sin(radians) * (endX - center.x) + Math.cos(radians) * (endY - center.y) + center.y };\n        var p4 = { x: Math.cos(radians) * (startX - center.x) - Math.sin(radians) * (endY - center.y) + center.x,\n            y: Math.sin(radians) * (startX - center.x) + Math.cos(radians) * (endY - center.y) + center.y };\n        point.push(p1);\n        point.push(p2);\n        point.push(p3);\n        point.push(p4);\n        return point;\n    };\n    Draw.prototype.doIntersect = function (a, b, c, d) {\n        var point1 = this.initiation(a, b, c);\n        var point2 = this.initiation(a, b, d);\n        var point3 = this.initiation(c, d, a);\n        var point4 = this.initiation(c, d, b);\n        if (point1 !== point2 && point3 !== point4) {\n            return true;\n        }\n        if (point1 === 0 && this.onSegment(a, c, b)) {\n            return true;\n        }\n        if (point2 === 0 && this.onSegment(a, d, b)) {\n            return true;\n        }\n        if (point3 === 0 && this.onSegment(c, a, d)) {\n            return true;\n        }\n        if (point4 === 0 && this.onSegment(c, b, d)) {\n            return true;\n        }\n        return false;\n    };\n    Draw.prototype.initiation = function (a, b, c) {\n        var value = (b.y - a.y) * (c.x - b.x) - (b.x - a.x) * (c.y - b.y);\n        if (value === 0) {\n            return 0;\n        }\n        return (value > 0) ? 1 : 2;\n    };\n    Draw.prototype.onSegment = function (a, b, c) {\n        if (b.x <= Math.max(a.x, c.x) && b.x >= Math.min(a.x, c.x) &&\n            b.y <= Math.max(a.y, c.y) && b.y >= Math.min(a.y, c.y)) {\n            return true;\n        }\n        return false;\n    };\n    Draw.prototype.isInsideRect = function (point) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var isInside = false;\n        if (point.x >= actPoint.startX && point.x <= actPoint.endX &&\n            point.y >= actPoint.startY && point.y <= actPoint.endY) {\n            isInside = true;\n        }\n        return isInside;\n    };\n    Draw.prototype.setDestForStraighten = function () {\n        var parent = this.parent;\n        if (isNullOrUndefined(this.straightenDestPoints)) {\n            var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n            // If straightening performed, then destination points are set in non-straightened state\n            parent.notify('shape', { prop: 'straightenShapes', onPropertyChange: false });\n            this.straightenDestPoints = extend({}, parent.img, {}, true);\n            parent.img.destLeft = destLeft;\n            parent.img.destTop = destTop;\n            parent.img.destWidth = destWidth;\n            parent.img.destHeight = destHeight;\n        }\n    };\n    Draw.prototype.drawRedact = function (canvasDraw, obj) {\n        var _a = obj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY;\n        var _b = obj.activePoint, width = _b.width, height = _b.height;\n        var isSaveCtx = false;\n        var canvas = canvasDraw.canvas;\n        if (canvas.id.indexOf('_tempCanvas') !== -1) {\n            isSaveCtx = true;\n        }\n        var img = this.parent.img;\n        if (width <= 0 || height <= 0) {\n            return;\n        }\n        else if (this.parent.isCropTab) {\n            canvasDraw.drawImage(obj.redactImage, 0, 0, obj.redactImage.width, obj.redactImage.height, startX, startY, width, height);\n        }\n        else {\n            var offscreenCanvas = document.createElement('canvas');\n            var offscreenCtx = offscreenCanvas.getContext('2d');\n            var imageWidth = canvas.width;\n            var imageHeight = canvas.height;\n            var tempRatio = Math.min(imageWidth, imageHeight) / 1000;\n            var straighten = this.parent.transform.straighten !== 0 ? this.parent.transform.straighten :\n                this.parent.cropObj.straighten;\n            if (this.allowRedactStraighten && straighten !== 0) {\n                var tempCanvas = document.createElement('canvas');\n                var tempCtx = tempCanvas.getContext('2d');\n                if (isSaveCtx) {\n                    tempCanvas.width = canvas.width;\n                    tempCanvas.height = canvas.height;\n                    tempCtx.drawImage(canvas, 0, 0);\n                }\n                else {\n                    tempCanvas.width = img.destWidth;\n                    tempCanvas.height = img.destHeight;\n                    tempCtx.drawImage(this.lowerContext.canvas, img.destLeft, img.destTop, img.destWidth, img.destHeight, 0, 0, img.destWidth, img.destHeight);\n                }\n                var radians = -straighten * Math.PI / 180;\n                var straightenCanvas = document.createElement('canvas');\n                var straightenCtx = straightenCanvas.getContext('2d');\n                straightenCanvas.width = tempCanvas.width;\n                straightenCanvas.height = tempCanvas.height;\n                if (img.destWidth > canvas.width && !isSaveCtx) {\n                    straightenCanvas.width = canvas.width;\n                }\n                if (img.destHeight > canvas.height && !isSaveCtx) {\n                    straightenCanvas.height = canvas.height;\n                }\n                straightenCtx.save();\n                straightenCtx.translate(tempCanvas.width / 2, tempCanvas.height / 2);\n                straightenCtx.rotate(radians);\n                straightenCtx.drawImage(tempCanvas, -tempCanvas.width / 2, -tempCanvas.height / 2);\n                straightenCtx.restore();\n                if (img.destLeft > 0 && !isSaveCtx) {\n                    startX -= img.destLeft;\n                    endX -= img.destLeft;\n                }\n                if (img.destTop > 0 && !isSaveCtx) {\n                    startY -= img.destTop;\n                    endY -= img.destTop;\n                }\n                var center = { x: startX + (width / 2), y: startY + (height / 2) };\n                var cosAngle = Math.cos(straighten * Math.PI / 180);\n                var sinAngle = Math.sin(straighten * Math.PI / 180);\n                var p1 = { x: cosAngle * (startX - center.x) - sinAngle * (startY - center.y) + center.x,\n                    y: sinAngle * (startX - center.x) + cosAngle * (startY - center.y) + center.y };\n                var p2 = { x: cosAngle * (endX - center.x) - sinAngle * (startY - center.y) + center.x,\n                    y: sinAngle * (endX - center.x) + cosAngle * (startY - center.y) + center.y };\n                var p3 = { x: cosAngle * (startX - center.x) - sinAngle * (endY - center.y) + center.x,\n                    y: sinAngle * (startX - center.x) + cosAngle * (endY - center.y) + center.y };\n                if (!isSaveCtx) {\n                    center = { x: img.destWidth / 2, y: img.destHeight / 2 };\n                    if (img.destWidth > canvas.width) {\n                        center.x = canvas.width / 2;\n                    }\n                    if (img.destHeight > canvas.height) {\n                        center.y = canvas.height / 2;\n                    }\n                }\n                else {\n                    center = { x: canvas.width / 2, y: canvas.height / 2 };\n                }\n                cosAngle = Math.cos(radians);\n                sinAngle = Math.sin(radians);\n                var newP1 = { x: cosAngle * (p1.x - center.x) - sinAngle * (p1.y - center.y) + center.x,\n                    y: sinAngle * (p1.x - center.x) + cosAngle * (p1.y - center.y) + center.y };\n                var newP2 = { x: cosAngle * (p2.x - center.x) - sinAngle * (p2.y - center.y) + center.x,\n                    y: sinAngle * (p2.x - center.x) + cosAngle * (p2.y - center.y) + center.y };\n                var newP3 = { x: cosAngle * (p3.x - center.x) - sinAngle * (p3.y - center.y) + center.x,\n                    y: sinAngle * (p3.x - center.x) + cosAngle * (p3.y - center.y) + center.y };\n                var tempWidth = isSaveCtx ? canvasDraw.canvas.width : img.destWidth;\n                var tempHeight = isSaveCtx ? canvasDraw.canvas.height : img.destHeight;\n                var rotatedWidth = Math.abs(tempWidth * Math.cos(radians)) + Math.abs(tempHeight * Math.sin(radians));\n                var rotatedHeight = Math.abs(tempWidth * Math.sin(radians)) + Math.abs(tempHeight * Math.cos(radians));\n                straightenCanvas.width = rotatedWidth;\n                straightenCanvas.height = rotatedHeight;\n                straightenCtx.save();\n                straightenCtx.translate(rotatedWidth / 2, rotatedHeight / 2);\n                straightenCtx.rotate(radians);\n                straightenCtx.drawImage(tempCanvas, -tempCanvas.width / 2, -tempCanvas.height / 2);\n                straightenCtx.restore();\n                if (this.parent.activeObj.redactType === 'blur') {\n                    offscreenCanvas.width = width;\n                    offscreenCanvas.height = height;\n                    offscreenCtx.drawImage(straightenCanvas, newP1.x + ((rotatedWidth - tempCanvas.width) / 2), newP1.y + ((rotatedHeight - tempCanvas.height) / 2), newP2.x - newP1.x, newP3.y - newP2.y, 0, 0, width, height);\n                }\n                else {\n                    var pixelSize = (obj.redactPixelate / 100) * 20;\n                    if (isSaveCtx) {\n                        pixelSize = tempRatio * (obj.redactPixelate / 100) * 35;\n                    }\n                    offscreenCanvas.width = Math.ceil(width / pixelSize);\n                    offscreenCanvas.height = Math.ceil(height / pixelSize);\n                    offscreenCtx.drawImage(straightenCanvas, newP1.x + ((rotatedWidth - tempCanvas.width) / 2), newP1.y + ((rotatedHeight - tempCanvas.height) / 2), newP2.x - newP1.x, newP3.y - newP2.y, 0, 0, offscreenCanvas.width, offscreenCanvas.height);\n                }\n            }\n            if (this.parent.activeObj.redactType === 'blur') {\n                if (straighten === 0) {\n                    offscreenCanvas.width = width;\n                    offscreenCanvas.height = height;\n                    offscreenCtx.drawImage((isSaveCtx) ? canvas : this.lowerContext.canvas, startX, startY, width, height, 0, 0, width, height);\n                }\n                if (isSaveCtx) {\n                    var blur_1 = tempRatio * ((obj.redactBlur / 100) * 34);\n                    offscreenCtx.filter = \"blur(\" + blur_1 + \"px)\";\n                }\n                else {\n                    offscreenCtx.filter = \"blur(\" + (obj.redactBlur / 100) * 17 + \"px)\";\n                }\n                offscreenCtx.drawImage(offscreenCanvas, 0, 0);\n                if (straighten === 0) {\n                    offscreenCtx.drawImage((isSaveCtx) ? canvas : this.lowerContext.canvas, startX, startY, width, height, 0, 0, width, height);\n                }\n                else {\n                    if (img.destLeft > 0 && !isSaveCtx) {\n                        startX += img.destLeft;\n                        endX += img.destLeft;\n                    }\n                    if (img.destTop > 0 && !isSaveCtx) {\n                        startY += img.destTop;\n                        endY += img.destTop;\n                    }\n                }\n                if (this.parent.isSafari) {\n                    this.parent.notify('filter', { prop: 'apply-filter', onPropertyChange: false, value: { context: offscreenCtx } });\n                }\n                canvasDraw.drawImage(offscreenCanvas, 0, 0, width, height, startX, startY, width, height);\n            }\n            else {\n                var pixelSize = (obj.redactPixelate / 100) * 20;\n                if (isSaveCtx) {\n                    pixelSize = tempRatio * (obj.redactPixelate / 100) * 35;\n                }\n                if (straighten === 0) {\n                    offscreenCanvas.width = Math.ceil(width / pixelSize);\n                    offscreenCanvas.height = Math.ceil(height / pixelSize);\n                    offscreenCtx.drawImage((isSaveCtx) ? canvas : this.lowerContext.canvas, startX, startY, width, height, 0, 0, offscreenCanvas.width, offscreenCanvas.height);\n                }\n                else {\n                    if (img.destLeft > 0 && !isSaveCtx) {\n                        startX += img.destLeft;\n                        endX += img.destLeft;\n                    }\n                    if (img.destTop > 0 && !isSaveCtx) {\n                        startY += img.destTop;\n                        endY += img.destTop;\n                    }\n                }\n                canvasDraw.imageSmoothingEnabled = false;\n                canvasDraw.drawImage(offscreenCanvas, 0, 0, offscreenCanvas.width, offscreenCanvas.height, startX, startY, width, height);\n            }\n            obj.redactImage = this.parent.createElement('canvas');\n            obj.redactImage.width = offscreenCanvas.width;\n            obj.redactImage.height = offscreenCanvas.height;\n            obj.redactImage.getContext('2d').drawImage(offscreenCanvas, 0, 0);\n            canvasDraw.beginPath();\n            canvasDraw.rect(startX, startY, width, height);\n            canvasDraw.rect(startX, startY, width, height);\n            canvasDraw.fill('evenodd');\n            canvasDraw.closePath();\n        }\n    };\n    return Draw;\n}());\nexport { Draw };\n","/* eslint-disable max-len */\nimport { extend, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { hideSpinner, showSpinner } from '@syncfusion/ej2-popups';\nvar Export = /** @class */ (function () {\n    function Export(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    Export.prototype.destroy = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.removeEventListener();\n    };\n    Export.prototype.addEventListener = function () {\n        this.parent.on('export', this.export, this);\n        this.parent.on('destroyed', this.destroy, this);\n    };\n    Export.prototype.removeEventListener = function () {\n        this.parent.off('export', this.export);\n        this.parent.off('destroyed', this.destroy);\n    };\n    Export.prototype.export = function (args) {\n        this.parent.notify('toolbar', { prop: 'refreshShapeDrawing', onPropertyChange: false });\n        this.updatePvtVar();\n        switch (args.prop) {\n            case 'export':\n                this.exportImg(args.value['type'], args.value['fileName'], args.value['imgQuality']);\n                break;\n            case 'exportToCanvas':\n                this.exportToCanvas(args.value['object']);\n                break;\n            case 'updateSaveContext':\n                this.updateSaveContext(args.value['context']);\n                break;\n            case 'setImageQuality':\n                this.imageQuality = args.value['value'];\n                break;\n            case 'drawAnnotation':\n                this.drawAnnotation(args.value['context'], args.value['ratio']);\n                break;\n        }\n    };\n    Export.prototype.getModuleName = function () {\n        return 'export';\n    };\n    Export.prototype.updatePvtVar = function () {\n        var parent = this.parent;\n        if (parent.lowerCanvas) {\n            this.lowerContext = parent.lowerCanvas.getContext('2d');\n        }\n    };\n    Export.prototype.exportImg = function (type, fileName, imgQuality) {\n        var parent = this.parent;\n        var obj = { fileName: '' };\n        parent.notify('draw', { prop: 'getFileName', onPropertyChange: false, value: { obj: obj } });\n        var imageName = obj['fileName'];\n        if (!parent.disabled && parent.isImageLoaded) {\n            parent.notify('shape', { prop: 'applyActObj', onPropertyChange: false, value: { isMouseDown: null } });\n            var obj_1 = { canvasFilter: this.parent.canvasFilter };\n            this.lowerContext.filter = obj_1['canvasFilter'];\n            type = type ? type : 'Png';\n            parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n                value: { x: null, y: null, isMouseDown: null } });\n            var beforeSave = { cancel: false, fileName: fileName ? fileName : imageName,\n                fileType: type, imageQuality: imgQuality };\n            parent.trigger('beforeSave', beforeSave);\n            this.beforeSaveEvent(beforeSave, type, fileName, imageName, imgQuality);\n        }\n    };\n    Export.prototype.beforeSaveEvent = function (observableSaveArgs, type, fileName, imageName, imgQuality) {\n        var parent = this.parent;\n        if (!observableSaveArgs.cancel) {\n            parent.currObjType.isSave = true;\n            fileName = observableSaveArgs.fileName ? observableSaveArgs.fileName : fileName;\n            var lowerCaseType = type.toLowerCase();\n            fileName = fileName || imageName;\n            if (lowerCaseType === 'svg') {\n                this.toSVGImg(fileName);\n            }\n            else {\n                this.toBlobFn(fileName, lowerCaseType, imgQuality);\n            }\n            var saved = { fileName: fileName ? fileName : imageName, fileType: type };\n            parent.trigger('saved', saved);\n            var actionArgs = { action: 'save', actionEventArgs: saved };\n            parent.triggerEditCompleteEvent(actionArgs);\n            parent.notify('toolbar', { prop: 'refresh-main-toolbar', onPropertyChange: false });\n            parent.lowerCanvas.style.left = parent.upperCanvas.style.left = '';\n            parent.lowerCanvas.style.top = parent.upperCanvas.style.top = '';\n            parent.lowerCanvas.style.maxWidth = parent.upperCanvas.style.maxWidth = '';\n            parent.lowerCanvas.style.maxHeight = parent.upperCanvas.style.maxHeight = '';\n        }\n    };\n    Export.prototype.toSVGImg = function (fileName) {\n        var parent = this.parent;\n        showSpinner(parent.element);\n        parent.element.style.opacity = '0.5';\n        var tempCanvas = this.exportToCanvas();\n        var dataUrl = tempCanvas.toDataURL();\n        hideSpinner(parent.element);\n        parent.element.style.opacity = '1';\n        var svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\n        svg.setAttribute('width', tempCanvas.style.maxWidth);\n        svg.setAttribute('height', tempCanvas.style.maxHeight);\n        var XLinkNS = 'http://www.w3.org/1999/xlink';\n        var img = document.createElementNS('http://www.w3.org/2000/svg', 'image');\n        img.setAttributeNS(null, 'height', tempCanvas.height.toString());\n        img.setAttributeNS(null, 'width', tempCanvas.width.toString());\n        img.setAttributeNS(XLinkNS, 'xlink:href', dataUrl);\n        svg.appendChild(img);\n        var prefix = 'data:image/svg+xml;base64,';\n        var header = '<svg' + ' xmlns=\"http://www.w3.org/2000/svg\"' + ' xmlns:xlink=\"http://www.w3.org/1999/xlink\"'\n            + (\" width=\\\"\" + tempCanvas.width + \"\\\"\") + (\" height=\\\"\" + tempCanvas.height + \"\\\"\") + '>';\n        var footer = '</svg>';\n        var body = svg.innerHTML;\n        var data = header + body + footer;\n        var svgDataUrl = prefix + btoa(data);\n        if (fileName === null) {\n            return svgDataUrl;\n        }\n        else {\n            this.downloadImg(svgDataUrl, fileName + '.' + 'svg');\n            return null;\n        }\n    };\n    Export.prototype.toBlobFn = function (fileName, type, imgQuality) {\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        var proxy = this;\n        var parent = this.parent;\n        showSpinner(parent.element);\n        parent.element.style.opacity = '0.5';\n        if (!isNullOrUndefined(imgQuality)) {\n            imgQuality = imgQuality > 1 ? 1 : (imgQuality <= 0 ? 0.01 : imgQuality);\n            this.imageQuality = imgQuality ? imgQuality : null;\n        }\n        var tempCanvas = this.exportToCanvas();\n        var imagetype = type !== 'jpeg' ? 'image/png' : 'image/jpeg';\n        // eslint-disable-next-line @typescript-eslint/tslint/config\n        tempCanvas.toBlob(function (blob) {\n            var blobUrl = URL.createObjectURL(blob);\n            proxy.downloadImg(blobUrl, fileName + '.' + type);\n            hideSpinner(parent.element);\n            parent.element.style.opacity = '1';\n        }, imagetype, this.imageQuality ? this.imageQuality : null);\n    };\n    Export.prototype.exportToCanvas = function (object) {\n        var parent = this.parent;\n        var width;\n        var height;\n        var tempCropObj = extend({}, parent.cropObj, {}, true);\n        var tempObj = { currObj: {} };\n        parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: tempObj } });\n        var prevObj = tempObj['currObj'];\n        prevObj.objColl = extend([], parent.objColl, [], true);\n        prevObj.pointColl = extend([], parent.pointColl, [], true);\n        prevObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: selPointCollObj } });\n        if (this.parent.aspectWidth) {\n            parent.notify('undo-redo', { prop: 'setPreventUR', value: { bool: true } });\n            parent.notify('toolbar', { prop: 'resizeClick', value: { bool: false } });\n            parent.okBtn();\n            if (parent.transform.degree % 90 === 0 && parent.transform.degree % 180 !== 0) {\n                width = this.parent.aspectHeight;\n                height = this.parent.aspectWidth;\n            }\n            else {\n                width = this.parent.aspectWidth;\n                height = this.parent.aspectHeight;\n            }\n            parent.notify('undo-redo', { prop: 'setPreventUR', value: { bool: false } });\n        }\n        else if (parent.currSelectionPoint) {\n            width = parent.img.srcWidth;\n            height = parent.img.srcHeight;\n        }\n        else {\n            width = parent.baseImgCanvas.width;\n            height = parent.baseImgCanvas.height;\n        }\n        var obj = { width: 0, height: 0 };\n        parent.notify('crop', { prop: 'calcRatio', onPropertyChange: false,\n            value: { obj: obj, dimension: { width: width, height: height } } });\n        var ratio = obj;\n        var tempContextFilter = this.lowerContext.filter;\n        // Manipulating blur value\n        if (this.lowerContext.filter !== 'none') {\n            var splitWords = this.lowerContext.filter.split(' ');\n            var value = parseFloat(splitWords[5].split('(')[1]);\n            value *= ((ratio.width + ratio.height) / 2);\n            splitWords[5] = 'blur(' + value + 'px)';\n            this.lowerContext.filter = splitWords.join(' ');\n        }\n        var tempCanvas = parent.createElement('canvas', {\n            id: parent.element.id + '_tempCanvas', attrs: { name: 'canvasImage' }\n        });\n        var tempContext = tempCanvas.getContext('2d');\n        tempCanvas.width = width;\n        tempCanvas.height = height;\n        var dimObj = { width: 0, height: 0 };\n        parent.notify('transform', { prop: 'calcMaxDimension', onPropertyChange: false,\n            value: { width: width, height: height, obj: dimObj } });\n        var maxDimension = dimObj;\n        tempCanvas.style.maxWidth = maxDimension.width + 'px';\n        tempCanvas.style.maxHeight = maxDimension.height + 'px';\n        var temp = this.lowerContext.filter;\n        tempContext.filter = this.lowerContext.filter;\n        this.downScaleImgCanvas(tempContext, width, height);\n        this.lowerContext.filter = temp;\n        if (parent.transform.degree !== 0 || parent.transform.currFlipState !== '' || parent.transform.straighten !== 0) {\n            this.updateSaveContext(tempContext);\n            this.exportTransformedImage(tempContext);\n        }\n        if (parent.isSafari) {\n            parent.notify('filter', { prop: 'apply-filter', onPropertyChange: false, value: { context: tempContext } });\n        }\n        this.drawAnnotation(tempContext, ratio);\n        if (parent.isCircleCrop) {\n            parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                value: { context: tempContext, isSave: true, isFlip: null } });\n        }\n        this.updateFrame(tempContext, true);\n        this.lowerContext.filter = tempContextFilter;\n        parent.canvasFilter = tempContextFilter;\n        if (object) {\n            object['canvas'] = tempCanvas;\n        }\n        if (parent.aspectWidth) {\n            parent.objColl = [];\n            parent.pointColl = [];\n            parent.freehandCounter = 0;\n            parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false,\n                value: { obj: { selPointColl: [] } } });\n            parent.notify('draw', { prop: 'setCurrentObj', onPropertyChange: false, value: { obj: prevObj } });\n            prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n            parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false,\n                value: { obj: { selPointColl: prevObj.selPointColl } } });\n            parent.cropObj = tempCropObj;\n            parent.objColl = extend([], prevObj.objColl, [], true);\n            parent.pointColl = extend([], prevObj.pointColl, [], true);\n            parent.freehandCounter = parent.pointColl.length;\n            parent.transform.straighten = 0;\n            this.lowerContext.filter = 'none';\n            parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n                value: { ctx: this.lowerContext, shape: 'zoom', pen: 'zoom', isPreventApply: null } });\n            this.lowerContext.filter = prevObj.filter;\n            parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n            if (parent.isCircleCrop || (parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle')) {\n                parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                    value: { context: this.lowerContext, isSave: null, isFlip: null } });\n            }\n        }\n        return tempCanvas;\n    };\n    Export.prototype.drawAnnotation = function (tempContext, ratio) {\n        var parent = this.parent;\n        var tempObjColl = extend([], parent.objColl, [], true);\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        var tempPointColl = extend([], parent.pointColl, [], true);\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        var nonRedact = parent.shapeColl.filter(function (item) { return item.shape !== 'redact'; });\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        var redact = parent.shapeColl.filter(function (item) { return item.shape === 'redact'; });\n        parent.shapeColl = redact.concat(nonRedact);\n        for (var i = 0; i < parent.shapeColl.length; i++) {\n            if (parent.shapeColl[i].order) {\n                if (parent.shapeColl[i].currIndex && parent.shapeColl[i].currIndex.indexOf('shape') > -1) {\n                    parent.objColl = [];\n                    parent.objColl.push(extend({}, parent.shapeColl[i], {}, true));\n                    this.drawShape(tempContext, ratio);\n                }\n                else if (parent.shapeColl[i].id && parent.shapeColl[i].id.indexOf('pen') > -1) {\n                    parent.pointColl = [];\n                    parent.freehandCounter = 0;\n                    parent.pointColl.push(extend({}, parent.shapeColl[i], {}, true));\n                    parent.freehandCounter = parent.pointColl.length;\n                    this.drawPen(tempContext, ratio);\n                }\n            }\n        }\n        parent.objColl = tempObjColl;\n        parent.pointColl = tempPointColl;\n        parent.freehandCounter = parent.pointColl.length;\n    };\n    Export.prototype.drawShape = function (tempContext, ratio) {\n        var parent = this.parent;\n        if (parent.objColl.length > 0) {\n            var temp = tempContext.filter;\n            tempContext.filter = 'none';\n            var indexObj = { index: null };\n            parent.notify('shape', { prop: 'getSmallestIndex', onPropertyChange: false, value: { obj: indexObj } });\n            var index = indexObj['index'];\n            var objColl = extend([], parent.objColl, [], true);\n            var tempObjColl = extend([], parent.objColl, [], true);\n            while (objColl.length > 0) {\n                var found = false;\n                for (var i = 0; i < objColl.length; i++) {\n                    var currentObj = objColl[i];\n                    if (isNullOrUndefined(currentObj.order)) {\n                        objColl.splice(i, 1);\n                        i--;\n                        continue;\n                    }\n                    if (currentObj.order === index) {\n                        var temp_1 = tempContext.filter;\n                        tempContext.filter = 'none';\n                        var currObj = objColl[i];\n                        var activePoint = currObj.activePoint;\n                        // Subtracting destination left and top points\n                        activePoint.startX -= parent.img.destLeft;\n                        activePoint.startY -= parent.img.destTop;\n                        activePoint.endX -= parent.img.destLeft;\n                        activePoint.endY -= parent.img.destTop;\n                        activePoint.width = activePoint.endX - activePoint.startX;\n                        activePoint.height = activePoint.endY - activePoint.startY;\n                        // Manipulating points\n                        activePoint.startX *= ratio.width;\n                        activePoint.startY *= ratio.height;\n                        activePoint.endX *= ratio.width;\n                        activePoint.endY *= ratio.height;\n                        activePoint.width = activePoint.endX - activePoint.startX;\n                        activePoint.height = activePoint.endY - activePoint.startY;\n                        currObj.strokeSettings.strokeWidth *= ((ratio.width + ratio.height) / 2);\n                        if (currObj.shape === 'text') {\n                            currObj.textSettings.fontSize *= ((ratio.width + ratio.height) / 2);\n                        }\n                        else if (currObj.shape === 'path') {\n                            for (var l = 0; l < currObj.pointColl.length; l++) {\n                                currObj.pointColl[l].x =\n                                    (currObj.pointColl[l].x - parent.img.destLeft) * ratio.width;\n                                currObj.pointColl[l].y =\n                                    (currObj.pointColl[l].y - parent.img.destTop) * ratio.height;\n                            }\n                        }\n                        else if (currObj.shape === 'image') {\n                            parent.activeObj = extend({}, objColl[i], {}, true);\n                            parent.notify('selection', { prop: 'upgradeImageQuality', onPropertyChange: false });\n                            objColl[i] = extend({}, parent.activeObj, {}, true);\n                        }\n                        parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'saveContext', obj: objColl[i], isCropRatio: null,\n                                points: null, isPreventDrag: true, saveContext: tempContext, isPreventSelection: null } });\n                        tempContext.filter = temp_1;\n                        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                        index++;\n                        var indexBool = { bool: false };\n                        parent.notify('shape', { prop: 'isIndexInObjColl', onPropertyChange: false, value: { obj: indexBool, index: index } });\n                        if (!indexBool['bool']) {\n                            index++;\n                        }\n                        objColl.splice(i, 1);\n                        found = true;\n                        break; // Exit the loop to start from the beginning\n                    }\n                }\n                if (!found) {\n                    break; // If no matching order was found, exit the loop\n                }\n            }\n            tempContext.filter = temp;\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            parent.objColl = tempObjColl;\n        }\n    };\n    Export.prototype.drawPen = function (tempContext, ratio) {\n        var parent = this.parent;\n        if (parent.freehandCounter > 0) {\n            var widthObj = { penStrokeWidth: null };\n            parent.notify('freehand-draw', { prop: 'getPenStrokeWidth', onPropertyChange: false, value: { obj: widthObj } });\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            var tempPointColl = extend({}, parent.pointColl, {}, true);\n            for (var n = 0; n < parent.freehandCounter; n++) {\n                parent.points = extend([], parent.pointColl[n].points, []);\n                parent.notify('freehand-draw', { prop: 'setPointCounter', onPropertyChange: false, value: { value: 0 } });\n                var len = parent.points.length;\n                parent.pointColl[n].strokeWidth *= ((ratio.width + ratio.height) / 2);\n                for (var l = 0; l < len; l++) {\n                    parent.points[l].x = (parent.points[l].x - parent.img.destLeft) * ratio.width;\n                    parent.points[l].y = (parent.points[l].y - parent.img.destTop) * ratio.height;\n                }\n            }\n            parent.notify('freehand-draw', { prop: 'freehandRedraw', onPropertyChange: false,\n                value: { context: tempContext, points: null } });\n            parent.pointColl = tempPointColl;\n            parent.notify('freehand-draw', { prop: 'setPenStrokeWidth', onPropertyChange: false, value: { value: widthObj['penStrokeWidth'] } });\n        }\n    };\n    Export.prototype.downScaleImgCanvas = function (ctx, width, height) {\n        var parent = this.parent;\n        var canvas = parent.baseImgCanvas;\n        var img = parent.baseImg;\n        var obj = { width: 0, height: 0 };\n        parent.notify('transform', { prop: 'calcMaxDimension', onPropertyChange: false,\n            value: { width: img.width, height: img.height, obj: obj, isImgShape: null } });\n        var bgObj = { color: null };\n        parent.notify('draw', { prop: 'getImageBackgroundColor', value: { obj: bgObj } });\n        if (bgObj['color'] !== '') {\n            ctx.fillStyle = bgObj['color'];\n            ctx.fillRect(0, 0, ctx.canvas.width, ctx.canvas.height);\n        }\n        if (obj['width'] > width && obj['height'] > height) {\n            var tempCanvas = parent.createElement('canvas', {\n                id: parent.element.id + '_downScaleCanvas', attrs: { name: 'canvasImage' }\n            });\n            tempCanvas.width = this.parent.img.srcWidth;\n            tempCanvas.height = this.parent.img.srcHeight;\n            tempCanvas.getContext('2d').drawImage(canvas, parent.img.srcLeft, parent.img.srcTop, parent.img.srcWidth, parent.img.srcHeight, 0, 0, tempCanvas.width, tempCanvas.height);\n            parent.notify('draw', { prop: 'downScale', value: { canvas: tempCanvas, width: width, height: height } });\n            ctx.drawImage(tempCanvas, 0, 0);\n        }\n        else {\n            ctx.drawImage(parent.baseImgCanvas, parent.img.srcLeft, parent.img.srcTop, parent.img.srcWidth, parent.img.srcHeight, 0, 0, width, height);\n        }\n    };\n    Export.prototype.updateFrame = function (tempContext, isAnnotation) {\n        if (this.parent.frameObj.type !== 'none') {\n            var temp = tempContext.filter;\n            tempContext.filter = 'none';\n            this.parent.notify('draw', { prop: 'applyFrame', value: { ctx: tempContext, frame: this.parent.frameObj.type, preventImg: isAnnotation } });\n            tempContext.filter = temp;\n        }\n    };\n    Export.prototype.downloadImg = function (blob, fileName) {\n        var a = document.createElement('a');\n        a.href = blob;\n        a.target = '_parent';\n        a.download = fileName;\n        (document.body || document.documentElement).appendChild(a);\n        a.click();\n        a.parentNode.removeChild(a);\n    };\n    Export.prototype.exportTransformedImage = function (tempContext) {\n        var parent = this.parent;\n        var degree = parent.transform.degree;\n        if (parent.rotateFlipColl.length > 0) {\n            for (var i = 0, len = parent.rotateFlipColl.length; i < len; i++) {\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                var flip = parent.rotateFlipColl[i];\n                if (typeof flip === 'number') {\n                    this.exportRotate(tempContext, flip);\n                }\n                else if (flip === 'horizontal') {\n                    this.exportFlip(tempContext, true, false);\n                }\n                else if (flip === 'vertical') {\n                    this.exportFlip(tempContext, false, true);\n                }\n            }\n        }\n        parent.transform.degree = degree;\n    };\n    Export.prototype.exportRotate = function (tempContext, degree) {\n        var parent = this.parent;\n        tempContext.clearRect(0, 0, tempContext.canvas.width, tempContext.canvas.height);\n        this.setMaxDim(parent.transform.degree, tempContext.canvas);\n        tempContext.translate(tempContext.canvas.width / 2, tempContext.canvas.height / 2);\n        tempContext.rotate(Math.PI / 180 * degree);\n        tempContext.drawImage(parent.inMemoryCanvas, -tempContext.canvas.height / 2, -tempContext.canvas.width / 2, tempContext.canvas.height, tempContext.canvas.width);\n        this.updateSaveContext(tempContext);\n    };\n    Export.prototype.exportFlip = function (tempContext, flipHorizontal, flipVertical) {\n        tempContext.clearRect(0, 0, tempContext.canvas.width, tempContext.canvas.height);\n        if (flipHorizontal) {\n            tempContext.translate(tempContext.canvas.width, 0);\n            tempContext.scale(-1, 1);\n        }\n        if (flipVertical) {\n            tempContext.translate(0, tempContext.canvas.height);\n            tempContext.scale(1, -1);\n        }\n        tempContext.drawImage(this.parent.inMemoryCanvas, 0, 0);\n        this.updateSaveContext(tempContext);\n    };\n    Export.prototype.updateSaveContext = function (tempContext) {\n        var inMemoryContext = this.parent.inMemoryCanvas.getContext('2d');\n        tempContext.setTransform(1, 0, 0, 1, 0, 0);\n        var imageData = tempContext.getImageData(0, 0, tempContext.canvas.width, tempContext.canvas.height);\n        this.parent.inMemoryCanvas.width = imageData.width;\n        this.parent.inMemoryCanvas.height = imageData.height;\n        inMemoryContext.putImageData(imageData, 0, 0);\n    };\n    Export.prototype.setMaxDim = function (degree, tempCanvas) {\n        var newWidth;\n        var newHeight;\n        if (degree % 90 === 0 && degree % 180 !== 0) {\n            if (isNullOrUndefined(this.parent.currSelectionPoint)) {\n                newWidth = this.parent.baseImgCanvas.height;\n                newHeight = this.parent.baseImgCanvas.width;\n            }\n            else {\n                newWidth = this.parent.img.srcHeight;\n                newHeight = this.parent.img.srcWidth;\n            }\n        }\n        else if (degree % 180 === 0 || degree === 0) {\n            if (isNullOrUndefined(this.parent.currSelectionPoint)) {\n                newWidth = this.parent.baseImgCanvas.width;\n                newHeight = this.parent.baseImgCanvas.height;\n            }\n            else {\n                newWidth = this.parent.img.srcWidth;\n                newHeight = this.parent.img.srcHeight;\n            }\n        }\n        if (!isNullOrUndefined(this.parent.aspectWidth)) {\n            newWidth = this.parent.aspectWidth;\n            newHeight = this.parent.aspectHeight;\n        }\n        tempCanvas.width = newWidth;\n        tempCanvas.height = newHeight;\n        var obj = { width: 0, height: 0 };\n        this.parent.notify('transform', { prop: 'calcMaxDimension', onPropertyChange: false,\n            value: { width: newWidth, height: newHeight, obj: obj, isImgShape: null } });\n        var maxDimension = obj;\n        tempCanvas.style.maxWidth = maxDimension.width + 'px';\n        tempCanvas.style.maxHeight = maxDimension.height + 'px';\n    };\n    return Export;\n}());\nexport { Export };\n","import { isNullOrUndefined, extend } from '@syncfusion/ej2-base';\nvar Filter = /** @class */ (function () {\n    function Filter(parent) {\n        this.adjustmentLevel = { brightness: 0, contrast: 0, hue: 0, opacity: 100, saturation: 0, blur: 0,\n            exposure: 0, transparency: 100, sharpen: false, bw: false }; // for toolbar slider value\n        this.tempAdjustmentLevel = { brightness: 0, contrast: 0, hue: 0, opacity: 100, saturation: 0, blur: 0,\n            exposure: 0, transparency: 100, sharpen: false, bw: false }; // for temp toolbar slider value\n        this.adjustmentValue = ''; // for internal slider value\n        this.isBrightnessAdjusted = false;\n        this.bevelFilter = 'none';\n        this.tempAdjVal = { brightness: 0, contrast: 0, hue: 0, opacity: 100, saturation: 0, blur: 0,\n            exposure: 0, transparency: 100, sharpen: false, bw: false };\n        this.tempFilVal = '';\n        this.parent = parent;\n        this.addEventListener();\n    }\n    Filter.prototype.destroy = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.removeEventListener();\n    };\n    Filter.prototype.addEventListener = function () {\n        this.parent.on('filter', this.filter, this);\n        this.parent.on('destroyed', this.destroy, this);\n    };\n    Filter.prototype.removeEventListener = function () {\n        this.parent.off('filter', this.filter);\n        this.parent.off('destroyed', this.destroy);\n    };\n    Filter.prototype.filter = function (args) {\n        this.updatePrivateVariables();\n        switch (args.prop) {\n            case 'finetuneImage':\n                this.finetuneImage(args.value['option'], args.value['value']);\n                break;\n            case 'applyImageFilter':\n                this.setFilter(args.value['option']);\n                break;\n            case 'update-finetunes':\n                this.updateFinetunes();\n                break;\n            case 'set-adjustment':\n                this.setAdjustment(args.value['operation']);\n                break;\n            case 'initFilter':\n                this.initFilter();\n                break;\n            case 'setCurrAdjValue':\n                this.setCurrAdjValue(args.value['type'], args.value['value']);\n                break;\n            case 'updateAdj':\n                this.updateAdj(args.value['type'], args.value['value'], args.value['isPreview'], args.value['ctx']);\n                break;\n            case 'getCurrentObj':\n                this.getCurrentObj(args.value['object']);\n                break;\n            case 'getAdjustmentLevel':\n                if (isNullOrUndefined(this.parent.activeObj.opacity)) {\n                    this.adjustmentLevel.transparency = 100;\n                }\n                else {\n                    this.adjustmentLevel.transparency = this.parent.activeObj.opacity * 100;\n                }\n                args.value['obj']['adjustmentLevel'] = this.adjustmentLevel;\n                break;\n            case 'setAdjustmentLevel':\n                this.adjustmentLevel = args.value['adjustmentLevel'];\n                break;\n            case 'getTempAdjustmentLevel':\n                args.value['obj']['tempAdjustmentLevel'] = this.tempAdjustmentLevel;\n                break;\n            case 'setTempAdjustmentLevel':\n                this.tempAdjustmentLevel = args.value['tempAdjustmentLevel'];\n                break;\n            case 'setAdjustmentValue':\n                this.adjustmentValue = args.value['adjustmentValue'];\n                break;\n            case 'getBrightnessAdjusted':\n                args.value['obj']['isBrightnessAdjusted'] = this.isBrightnessAdjusted;\n                break;\n            case 'setBrightnessAdjusted':\n                this.isBrightnessAdjusted = args.value['isBrightnessAdjusted'];\n                if (this.parent.currentFilter.split('_') && this.parent.currentFilter.split('_')[1] === 'cold') {\n                    this.isBrightnessAdjusted = false;\n                }\n                break;\n            case 'getBevelFilter':\n                args.value['obj']['bevelFilter'] = this.bevelFilter;\n                break;\n            case 'setBevelFilter':\n                this.bevelFilter = args.value['bevelFilter'];\n                break;\n            case 'setTempAdjVal':\n                this.tempAdjVal = extend({}, this.adjustmentLevel, {}, true);\n                break;\n            case 'setTempFilVal':\n                this.tempFilVal = this.parent.currentFilter;\n                break;\n            case 'reset':\n                this.reset();\n                break;\n            case 'apply-filter':\n                this.applyFilter(args.value['context']);\n                break;\n        }\n    };\n    Filter.prototype.updatePrivateVariables = function () {\n        var parent = this.parent;\n        if (parent.lowerCanvas) {\n            this.lowerContext = parent.lowerCanvas.getContext('2d');\n        }\n    };\n    Filter.prototype.getModuleName = function () {\n        return 'filter';\n    };\n    Filter.prototype.reset = function () {\n        this.adjustmentLevel = { brightness: 0, contrast: 0, hue: 0, opacity: 100, saturation: 0,\n            blur: 0, exposure: 0, transparency: 100, sharpen: false, bw: false };\n        this.tempAdjustmentLevel = { brightness: 0, contrast: 0, hue: 0, opacity: 100, saturation: 0,\n            blur: 0, exposure: 0, transparency: 100, sharpen: false, bw: false };\n        this.adjustmentValue = this.parent.getDefaultFilter();\n        this.isBrightnessAdjusted = false;\n        this.bevelFilter = 'none';\n        this.tempFilVal = '';\n        this.tempAdjVal = { brightness: 0, contrast: 0, hue: 0, opacity: 100, saturation: 0,\n            blur: 0, exposure: 0, transparency: 100, sharpen: false, bw: false };\n    };\n    Filter.prototype.updateFinetunes = function () {\n        var _this = this;\n        var parent = this.parent;\n        var fs = parent.finetuneSettings;\n        if (fs) {\n            var propertiesToSet = ['brightness', 'contrast', 'hue', 'saturation', 'exposure', 'opacity', 'blur'];\n            propertiesToSet.forEach(function (property) {\n                if (fs[property]) {\n                    _this.adjustmentLevel[property] = fs[property].defaultValue;\n                    _this.tempAdjustmentLevel[property] = fs[property].defaultValue;\n                }\n            });\n            parent.notify('draw', { prop: 'isInitialLoading', onPropertyChange: false, value: { isInitialLoading: true } });\n        }\n    };\n    Filter.prototype.initFilter = function () {\n        this.setFilterAdj('brightness', this.adjustmentLevel.brightness);\n        this.setFilterAdj('contrast', this.adjustmentLevel.contrast);\n        this.setFilterAdj('hue', this.adjustmentLevel.hue);\n        this.setFilterAdj('saturation', this.adjustmentLevel.saturation);\n        this.setFilterAdj('exposure', this.adjustmentLevel.exposure);\n        this.setFilterAdj('opacity', this.adjustmentLevel.opacity);\n        this.setFilterAdj('blur', this.adjustmentLevel.blur);\n    };\n    Filter.prototype.updateAdj = function (type, value, isPreview, ctx) {\n        var parent = this.parent;\n        this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        var splitWords = this.lowerContext.filter.split(' ');\n        var values = [];\n        var brightness = this.getFilterValue(this.adjustmentLevel.brightness);\n        var excludedTypes = ['brightness', 'contrast', 'hue', 'saturation', 'exposure', 'opacity', 'blur'];\n        if (excludedTypes.indexOf(type) === -1) {\n            if (isNullOrUndefined(isPreview) && (this.adjustmentLevel.sharpen || this.adjustmentLevel.bw)) {\n                parent.isUndoRedo = true;\n                var temp = this.lowerContext.filter;\n                this.lowerContext.filter = 'none';\n                parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n                    value: { ctx: this.lowerContext, shape: 'iterate', pen: 'iterate', isPreventApply: null } });\n                this.lowerContext.filter = temp;\n                parent.isUndoRedo = false;\n            }\n        }\n        var saturate;\n        var bright;\n        var saturatePercent;\n        var contrast;\n        var saturatePercentage;\n        switch (type) {\n            case 'brightness':\n                value = this.getFilterValue(this.adjustmentLevel.exposure) + (value * 0.005);\n                splitWords[0] = 'brightness(' + value + ')';\n                if (this.adjustmentLevel.brightness !== 0) {\n                    value = (this.adjustmentLevel.opacity / 100) - (this.adjustmentLevel.opacity * 0.3) / 100;\n                    splitWords[4] = 'opacity(' + value + ')';\n                }\n                else {\n                    value = this.adjustmentLevel.opacity / 100;\n                    splitWords[4] = 'opacity(' + value + ')';\n                }\n                this.adjustmentValue = splitWords.join(' ');\n                break;\n            case 'contrast':\n                splitWords[1] = 'contrast(' + value + '%)';\n                this.adjustmentValue = splitWords.join(' ');\n                break;\n            case 'hue':\n                splitWords[2] = 'hue-rotate(' + value + 'deg)';\n                this.adjustmentValue = splitWords.join(' ');\n                break;\n            case 'saturation':\n                splitWords[3] = 'saturate(' + value + '%)';\n                this.adjustmentValue = splitWords.join(' ');\n                break;\n            case 'opacity':\n                if (parseFloat(splitWords[0].split('(')[1]) !== 1) {\n                    value -= 0.2;\n                }\n                if (value < 0) {\n                    value = 0;\n                }\n                splitWords[4] = 'opacity(' + value + ')';\n                this.adjustmentValue = splitWords.join(' ');\n                break;\n            case 'blur':\n                splitWords[5] = 'blur(' + value + 'px)';\n                this.adjustmentValue = splitWords.join(' ');\n                break;\n            case 'exposure':\n                if (value > 1) {\n                    value -= 1;\n                    value += brightness;\n                }\n                else if (value < 1) {\n                    value = 1 - value;\n                    value = brightness - value;\n                }\n                splitWords[0] = 'brightness(' + value + ')';\n                this.adjustmentValue = splitWords.join(' ');\n                break;\n            case 'chrome':\n                saturate = this.getSaturationFilterValue(this.adjustmentLevel.saturation);\n                saturate *= 100;\n                value = saturate + (saturate * 0.4);\n                splitWords[3] = 'saturate(' + value + '%)';\n                values = this.adjustmentValue.split(' ');\n                splitWords[0] = values[0];\n                splitWords[1] = values[1];\n                splitWords[2] = values[2];\n                splitWords[4] = values[4];\n                splitWords[5] = values[5];\n                splitWords[6] = 'sepia(0%)';\n                splitWords[7] = 'grayscale(0%)';\n                splitWords[8] = 'invert(0%)';\n                break;\n            case 'cold':\n                // Adjusting Brightness\n                bright = this.getFilterValue(this.adjustmentLevel.brightness);\n                bright *= 100;\n                value = bright * 0.9;\n                value *= 0.01;\n                splitWords[0] = 'brightness(' + value + ')';\n                // Adjusting Contrast\n                contrast = this.getFilterValue(this.adjustmentLevel.contrast);\n                contrast *= 100;\n                value = contrast + (contrast * 0.5);\n                splitWords[1] = 'contrast(' + value + '%)';\n                // Adjusting Saturation\n                saturatePercentage = this.getSaturationFilterValue(this.adjustmentLevel.saturation);\n                saturatePercentage *= 100;\n                value = saturatePercentage;\n                splitWords[3] = 'saturate(' + value + '%)';\n                values = this.adjustmentValue.split(' ');\n                splitWords[2] = values[2];\n                splitWords[4] = values[4];\n                splitWords[5] = values[5];\n                splitWords[6] = 'sepia(0%)';\n                splitWords[7] = 'grayscale(0%)';\n                splitWords[8] = 'invert(0%)';\n                break;\n            case 'warm':\n                saturatePercent = this.getSaturationFilterValue(this.adjustmentLevel.saturation);\n                saturatePercent *= 100;\n                value = saturatePercent + (saturatePercent * 0.4);\n                splitWords[3] = 'saturate(' + value + '%)';\n                splitWords[6] = 'sepia(25%)';\n                values = this.adjustmentValue.split(' ');\n                splitWords[0] = values[0];\n                splitWords[1] = values[1];\n                splitWords[2] = values[2];\n                splitWords[4] = values[4];\n                splitWords[5] = values[5];\n                splitWords[7] = 'grayscale(0%)';\n                splitWords[8] = 'invert(0%)';\n                break;\n            case 'grayscale':\n                splitWords[7] = 'grayscale(100%)';\n                values = this.adjustmentValue.split(' ');\n                splitWords[0] = values[0];\n                splitWords[1] = values[1];\n                splitWords[2] = values[2];\n                splitWords[3] = values[3];\n                splitWords[4] = values[4];\n                splitWords[5] = values[5];\n                splitWords[6] = 'sepia(0%)';\n                splitWords[8] = 'invert(0%)';\n                break;\n            case 'sepia':\n                splitWords[6] = 'sepia(100%)';\n                values = this.adjustmentValue.split(' ');\n                splitWords[0] = values[0];\n                splitWords[1] = values[1];\n                splitWords[2] = values[2];\n                splitWords[3] = values[3];\n                splitWords[4] = values[4];\n                splitWords[5] = values[5];\n                splitWords[7] = 'grayscale(0%)';\n                splitWords[8] = 'invert(0%)';\n                break;\n            case 'invert':\n                splitWords[8] = 'invert(100%)';\n                values = this.adjustmentValue.split(' ');\n                splitWords[0] = values[0];\n                splitWords[1] = values[1];\n                splitWords[2] = values[2];\n                splitWords[3] = values[3];\n                splitWords[4] = values[4];\n                splitWords[5] = values[5];\n                splitWords[6] = 'sepia(0%)';\n                splitWords[7] = 'grayscale(0%)';\n                break;\n        }\n        if (type !== 'sharpen' && type !== 'blackandwhite') {\n            if (isNullOrUndefined(isPreview)) {\n                if (type === 'default') {\n                    splitWords = this.getDefaultCurrentFilter(splitWords);\n                }\n                this.lowerContext.filter = splitWords.join(' ');\n            }\n            splitWords = this.setTempFilterValue(brightness, isPreview, splitWords, type);\n            parent.notify('draw', { prop: 'setRotateZoom', onPropertyChange: false, value: { isRotateZoom: true } });\n            parent.notify('draw', { prop: 'updateCurrTransState', onPropertyChange: false,\n                value: { type: 'initial', isPreventDestination: null, isRotatePan: null } });\n            var tempFilter = void 0;\n            if (parent.frameObj.type === 'bevel') {\n                tempFilter = this.lowerContext.filter;\n                this.bevelFilter = tempFilter;\n            }\n            if (parent.transform.degree === 0 && parent.rotateFlipColl.length > 0) {\n                parent.img.destLeft += parent.panPoint.totalPannedPoint.x;\n                parent.img.destTop += parent.panPoint.totalPannedPoint.y;\n            }\n            parent.img.destLeft += parent.panPoint.totalPannedInternalPoint.x;\n            parent.img.destTop += parent.panPoint.totalPannedInternalPoint.y;\n            if (parent.transform.degree === 0) {\n                parent.notify('transform', { prop: 'setDestPointsForFlipState', onPropertyChange: false });\n            }\n            parent.notify('draw', { prop: 'drawImage', onPropertyChange: false });\n            parent.notify('draw', { prop: 'updateCurrTransState', onPropertyChange: false,\n                value: { type: 'reverse', isPreventDestination: null, isRotatePan: null } });\n            parent.notify('draw', { prop: 'setRotateZoom', onPropertyChange: false, value: { isRotateZoom: false } });\n            if (parent.transform.degree === 0 && parent.rotateFlipColl.length > 0) {\n                parent.img.destLeft += parent.panPoint.totalPannedPoint.x;\n                parent.img.destTop += parent.panPoint.totalPannedPoint.y;\n            }\n            splitWords = this.setTempFilterValue(brightness, isPreview, splitWords, type);\n            if (isNullOrUndefined(isPreview)) {\n                this.lowerContext.filter = splitWords.join(' ');\n            }\n            parent.initialAdjustmentValue = splitWords.join(' ');\n            tempFilter = this.lowerContext.filter;\n            this.lowerContext.filter = 'brightness(' + 1 + ') ' + 'contrast(' + 100 + '%) ' + 'hue-rotate(' + 0 + 'deg) ' +\n                'saturate(' + 100 + '%) ' + 'opacity(' + 1 + ') ' + 'blur(' + 0 + 'px) ' + 'sepia(0%) ' + 'grayscale(0%) ' + 'invert(0%)';\n            this.bevelFilter = tempFilter;\n            parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n                value: { ctx: this.lowerContext, shape: 'iterate', pen: 'iterate', isPreventApply: null } });\n            this.lowerContext.filter = tempFilter;\n            parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n            if ((parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle') || parent.isCircleCrop) {\n                parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                    value: { context: this.lowerContext, isSave: null, isFlip: null } });\n            }\n            this.isBrightnessAdjusted = brightness !== 1;\n        }\n        var filter = splitWords.join(' ');\n        if (ctx) {\n            ctx.filter = filter;\n        }\n    };\n    Filter.prototype.setTempFilterValue = function (brightness, isPreview, splitWords, type) {\n        if (isPreview) {\n            if (type === 'default') {\n                splitWords = this.getDefaultCurrentFilter(splitWords);\n            }\n            else if (brightness !== 1) {\n                var tempSplitWords = this.lowerContext.filter.split(' ');\n                tempSplitWords[4] = splitWords[4];\n                this.lowerContext.filter = tempSplitWords.join(' ');\n            }\n        }\n        return splitWords;\n    };\n    Filter.prototype.getDefaultCurrentFilter = function (splitWords) {\n        var values = this.adjustmentValue.split(' ');\n        splitWords = [values[0], values[1], values[2], values[3], values[4], values[5], 'sepia(0%)', 'grayscale(0%)', 'invert(0%)'];\n        return splitWords;\n    };\n    Filter.prototype.getFilterValue = function (value) {\n        return (value === 0) ? 1 : 1 + ((value * 0.5) / 100);\n    };\n    Filter.prototype.getSaturationFilterValue = function (value) {\n        return value === 0 ? 1 : 1 + (value / 100);\n    };\n    Filter.prototype.setFilterAdj = function (type, value) {\n        var parent = this.parent;\n        parent.notify('freehand-draw', { prop: 'apply-pen-draw', onPropertyChange: false });\n        this.adjustmentLevel[\"\" + type] = value;\n        switch (type) {\n            case 'contrast':\n            case 'exposure':\n                value = this.getFilterValue(value);\n                if (type === 'contrast') {\n                    value *= 100;\n                }\n                break;\n            case 'hue':\n                value *= 3;\n                break;\n            case 'saturation':\n                value = this.getSaturationFilterValue(value) * 100;\n                break;\n            case 'opacity':\n                if (value < 10) {\n                    value += 1;\n                }\n                value /= 100;\n                break;\n            case 'blur':\n                if (value !== 0) {\n                    value /= 20;\n                    // Since 0.5 is not working in blur we consider from 1\n                    value += 0.5;\n                }\n                break;\n        }\n        var prevCropObj = extend({}, parent.cropObj, {}, true);\n        var prevObj = this.getCurrentObj();\n        prevObj.objColl = extend([], parent.objColl, [], true);\n        prevObj.pointColl = extend([], parent.pointColl, [], true);\n        prevObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false, value: { obj: selPointCollObj } });\n        prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        this.updateAdj(type, value);\n        parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false, value: { operation: type, previousObj: prevObj,\n                previousObjColl: prevObj.objColl, previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                previousCropObj: prevCropObj, previousText: null, currentText: null, previousFilter: null, isCircleCrop: null\n            } });\n    };\n    Filter.prototype.setFilter = function (type) {\n        var parent = this.parent;\n        type = type.toLowerCase();\n        parent.notify('freehand-draw', { prop: 'apply-pen-draw', onPropertyChange: false });\n        var obj = { currentFilter: this.parent.currentFilter };\n        var prevFilter = obj['currentFilter'];\n        var prevCropObj = extend({}, parent.cropObj, {}, true);\n        var prevObj = this.getCurrentObj();\n        prevObj.objColl = extend([], parent.objColl, [], true);\n        prevObj.pointColl = extend([], parent.pointColl, [], true);\n        prevObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false, value: { obj: selPointCollObj } });\n        prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        this.updateAdj(type, null);\n        parent.notify('draw', { prop: 'setImageEdited', onPropertyChange: false });\n        parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n            value: { operation: type, previousObj: prevObj, previousObjColl: prevObj.objColl, previousPointColl: prevObj.pointColl,\n                previousSelPointColl: prevObj.selPointColl, previousCropObj: prevCropObj, previousText: null,\n                currentText: null, previousFilter: prevFilter, isCircleCrop: null } });\n    };\n    Filter.prototype.setAdjustment = function (type) {\n        var splitWords = this.lowerContext.filter.split(' ');\n        var value;\n        var valueArr;\n        switch (type) {\n            case 'brightness':\n                valueArr = splitWords[0].split('(');\n                value = parseFloat(valueArr[1].split(')')[0]);\n                this.adjustmentLevel.brightness = this.setFilterValue(value);\n                break;\n            case 'contrast':\n                valueArr = splitWords[1].split('(');\n                value = parseFloat(valueArr[1].split(')')[0]);\n                value /= 100;\n                this.adjustmentLevel.contrast = this.setFilterValue(value);\n                break;\n            case 'hue':\n                valueArr = splitWords[2].split('(');\n                value = parseFloat(valueArr[1].split(')')[0]);\n                value /= 3;\n                this.adjustmentLevel.hue = value;\n                break;\n            case 'saturation':\n                valueArr = splitWords[3].split('(');\n                value = parseFloat(valueArr[1].split(')')[0]);\n                value /= 100;\n                this.adjustmentLevel.saturation = this.setSaturationFilterValue(value);\n                break;\n            case 'opacity':\n                valueArr = splitWords[4].split('(');\n                value = parseFloat(valueArr[1].split(')')[0]);\n                if (value === 0.45) {\n                    value = 40;\n                }\n                else if (value === 0.40) {\n                    value = 30;\n                }\n                else if (value === 0.35) {\n                    value = 20;\n                }\n                else if (value === 0.30) {\n                    value = 10;\n                }\n                else if (value === 0.25) {\n                    value = 0;\n                }\n                else {\n                    value *= 100;\n                }\n                this.adjustmentLevel.opacity = value;\n                break;\n            case 'blur':\n                valueArr = splitWords[5].split('(');\n                value = parseFloat(valueArr[1].split(')')[0]);\n                value *= 20;\n                this.adjustmentLevel.blur = value;\n                break;\n            case 'exposure':\n                valueArr = splitWords[0].split('(');\n                value = parseFloat(valueArr[1].split(')')[0]);\n                this.adjustmentLevel.exposure = this.setFilterValue(value);\n                break;\n        }\n    };\n    Filter.prototype.setFilterValue = function (value) {\n        return Math.round((value === 1) ? 0 : ((value - 1) * 100) / 0.5);\n    };\n    Filter.prototype.setSaturationFilterValue = function (value) {\n        return Math.round((value === 1) ? 0 : (value - 1) * 100);\n    };\n    Filter.prototype.finetuneImage = function (finetuneOption, value) {\n        var parent = this.parent;\n        if (!parent.disabled && parent.isImageLoaded) {\n            switch (finetuneOption.toLowerCase()) {\n                case 'brightness':\n                    this.setFilterAdj('brightness', value);\n                    break;\n                case 'contrast':\n                    this.setFilterAdj('contrast', value);\n                    break;\n                case 'hue':\n                    this.setFilterAdj('hue', value);\n                    break;\n                case 'saturation':\n                    this.setFilterAdj('saturation', value);\n                    break;\n                case 'opacity':\n                    this.setFilterAdj('opacity', value);\n                    break;\n                case 'blur':\n                    this.setFilterAdj('blur', value);\n                    break;\n                case 'exposure':\n                    this.setFilterAdj('exposure', value);\n                    break;\n            }\n            this.parent.canvasFilter = this.lowerContext.filter;\n            parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n        }\n    };\n    Filter.prototype.setCurrAdjValue = function (type, value) {\n        var parent = this.parent;\n        this.parent.notify('draw', { prop: 'setImageEdited', onPropertyChange: false });\n        switch (type) {\n            case 'brightness':\n                this.setFilterAdj('brightness', value);\n                break;\n            case 'contrast':\n                this.setFilterAdj('contrast', value);\n                break;\n            case 'hue':\n                this.setFilterAdj('hue', value);\n                break;\n            case 'saturation':\n                this.setFilterAdj('saturation', value);\n                break;\n            case 'opacity':\n                this.setFilterAdj('opacity', value);\n                break;\n            case 'blur':\n                this.setFilterAdj('blur', value);\n                break;\n            case 'exposure':\n                this.setFilterAdj('exposure', value);\n                break;\n        }\n        parent.isFinetuneBtnClick = true;\n        parent.curFinetuneObjEvent = { finetune: parent.toPascalCase(type), value: value };\n    };\n    Filter.prototype.getCurrentObj = function (dummyObj) {\n        var parent = this.parent;\n        var tempFlipPanPointObj = { point: null };\n        parent.notify('crop', { prop: 'getTempFlipPanPoint', value: { obj: tempFlipPanPointObj } });\n        var zoomObj = { previousZoomValue: null };\n        parent.notify('transform', { prop: 'getPreviousZoomValue', value: { obj: zoomObj } });\n        var straightenObj = { zoomFactor: null };\n        parent.notify('draw', { prop: 'getStraightenInitZoom', value: { obj: straightenObj } });\n        var bgObj = { color: null };\n        parent.notify('draw', { prop: 'getImageBackgroundColor', value: { obj: bgObj } });\n        var obj = { cropZoom: 0, defaultZoom: 0, totalPannedPoint: { x: 0, y: 0 }, totalPannedClientPoint: { x: 0, y: 0 },\n            totalPannedInternalPoint: { x: 0, y: 0 }, tempFlipPanPoint: { x: 0, y: 0 }, activeObj: {},\n            rotateFlipColl: [], degree: 0, currFlipState: '', zoomFactor: 0, previousZoomValue: 0, straighten: 0,\n            destPoints: { startX: 0, startY: 0, width: 0, height: 0 }, frame: 'none',\n            srcPoints: { startX: 0, startY: 0, width: 0, height: 0 }, filter: '', isBrightAdjust: this.isBrightnessAdjusted,\n            aspectWidth: null, aspectHeight: null, straightenZoom: 0, adjustmentLevel: extend({}, this.tempAdjVal, {}, true),\n            currentFilter: this.tempFilVal, imageSource: '', bgColor: '' };\n        obj.cropZoom = parent.transform.cropZoomFactor;\n        obj.defaultZoom = parent.transform.defaultZoomFactor;\n        obj.zoomFactor = parent.zoomSettings.zoomFactor;\n        obj.previousZoomValue = zoomObj['previousZoomValue'];\n        obj.straightenZoom = straightenObj['zoomFactor'];\n        obj.totalPannedPoint = extend({}, parent.panPoint.totalPannedPoint, {}, true);\n        obj.totalPannedClientPoint = extend({}, parent.panPoint.totalPannedClientPoint, {}, true);\n        obj.totalPannedInternalPoint = extend({}, parent.panPoint.totalPannedInternalPoint, {}, true);\n        obj.tempFlipPanPoint = extend({}, tempFlipPanPointObj['point'], {}, true);\n        obj.activeObj = extend({}, parent.activeObj, {}, true);\n        obj.rotateFlipColl = extend([], parent.rotateFlipColl, [], true);\n        obj.degree = parent.transform.degree;\n        obj.straighten = parent.cropObj.straighten;\n        obj.currFlipState = parent.transform.currFlipState;\n        obj.destPoints = { startX: parent.img.destLeft, startY: parent.img.destTop, endX: 0, endY: 0,\n            width: parent.img.destWidth, height: parent.img.destHeight };\n        obj.srcPoints = { startX: parent.img.srcLeft, startY: parent.img.srcTop, endX: 0, endY: 0,\n            width: parent.img.srcWidth, height: parent.img.srcHeight };\n        obj.filter = this.lowerContext.filter;\n        obj.aspectWidth = parent.aspectWidth;\n        obj.aspectHeight = parent.aspectHeight;\n        obj.frame = parent.frameObj.type;\n        obj.frameObj = extend({}, parent.frameObj);\n        obj.imageSource = parent.baseImg.src;\n        obj.bgColor = bgObj['color'];\n        if (dummyObj) {\n            dummyObj['currObj'] = obj;\n        }\n        return obj;\n    };\n    /* Filter safari related codes */\n    Filter.prototype.getValFromPercentage = function (percentage) {\n        var val = parseFloat(percentage);\n        // check for percentages and divide by a hundred\n        if (/%\\s*?$/i.test(percentage)) {\n            val /= 100;\n        }\n        return val;\n    };\n    Filter.prototype.getValFromLength = function (length) {\n        return parseFloat(length);\n    };\n    /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n    Filter.prototype.parseFilterString = function (filterString) {\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var filterArray = [];\n        if (filterString && filterString !== 'none') {\n            filterArray = filterString.split(' ').map(function (filter) {\n                var _a = filter.match(/([a-z-]+)\\(([^)]+)\\)/).slice(1, 3), name = _a[0], value = _a[1];\n                return { filter: name, value: value };\n            });\n        }\n        return filterArray;\n    };\n    Filter.prototype.applyFilter = function (context) {\n        var _a = context.canvas, height = _a.height, width = _a.width;\n        var imageData = context.getImageData(0, 0, width, height);\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var filterArray = this.parseFilterString(context.filter);\n        for (var i = 0, len = filterArray.length; i < len; i++) {\n            switch (filterArray[i].filter) {\n                case 'blur':\n                    imageData = this.blur(context, imageData, filterArray[i].value);\n                    break;\n                case 'brightness':\n                    imageData = this.brightness(imageData, filterArray[i].value);\n                    break;\n                case 'contrast':\n                    imageData = this.contrast(imageData, filterArray[i].value);\n                    break;\n                case 'grayscale':\n                    imageData = this.grayscale(imageData, filterArray[i].value);\n                    break;\n                case 'hue-rotate':\n                    imageData = this.hueRotate(imageData, filterArray[i].value);\n                    break;\n                case 'invert':\n                    imageData = this.invert(imageData, filterArray[i].value);\n                    break;\n                case 'opacity':\n                    imageData = this.opacity(imageData, filterArray[i].value);\n                    break;\n                case 'saturate':\n                    imageData = this.saturate(context, imageData, filterArray[i].value);\n                    break;\n                case 'sepia':\n                    imageData = this.sepia(imageData, filterArray[i].value);\n                    break;\n            }\n        }\n        context.putImageData(imageData, 0, 0);\n    };\n    /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n    Filter.prototype.blur = function (context, imageData, radius) {\n        if (radius === void 0) { radius = '0'; }\n        var blurRadius = this.getValFromLength(radius);\n        blurRadius = Math.floor(blurRadius);\n        if (blurRadius <= 0) {\n            return imageData;\n        }\n        var _a = context.canvas, height = _a.height, width = _a.width;\n        var data = imageData.data;\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var blurredData = new Uint8ClampedArray(data.length);\n        for (var y = 0; y < height; y++) {\n            for (var x = 0; x < width; x++) {\n                var r = 0;\n                var g = 0;\n                var b = 0;\n                var a = 0;\n                var count = 0;\n                for (var dy = -blurRadius; dy <= blurRadius; dy++) {\n                    for (var dx = -blurRadius; dx <= blurRadius; dx++) {\n                        var nx = x + dx;\n                        var ny = y + dy;\n                        if (nx >= 0 && nx < width && ny >= 0 && ny < height) {\n                            var offset = (ny * width + nx) * 4;\n                            r += data[offset];\n                            g += data[offset + 1];\n                            b += data[offset + 2];\n                            a += data[offset + 3];\n                            count++;\n                        }\n                    }\n                }\n                var i = (y * width + x) * 4;\n                blurredData[i] = r / count;\n                blurredData[i + 1] = g / count;\n                blurredData[i + 2] = b / count;\n                blurredData[i + 3] = a / count;\n            }\n        }\n        for (var i = 0; i < data.length; i++) {\n            data[i] = blurredData[i];\n        }\n        return imageData;\n    };\n    /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n    Filter.prototype.brightness = function (imageData, percentage) {\n        if (percentage === void 0) { percentage = '1'; }\n        var factor = this.getValFromPercentage(percentage);\n        if (factor !== 1) {\n            var data = imageData.data;\n            var length_1 = data.length;\n            for (var i = 0; i < length_1; i += 4) {\n                data[i + 0] *= factor;\n                data[i + 1] *= factor;\n                data[i + 2] *= factor;\n            }\n        }\n        return imageData;\n    };\n    /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n    Filter.prototype.contrast = function (imageData, percentage) {\n        if (percentage === void 0) { percentage = '1'; }\n        var factor = this.getValFromPercentage(percentage);\n        if (factor !== 1) {\n            var data = imageData.data;\n            var length_2 = data.length;\n            for (var i = 0; i < length_2; i += 4) {\n                data[i + 0] = ((data[i + 0] / 255 - 0.5) * factor + 0.5) * 255;\n                data[i + 1] = ((data[i + 1] / 255 - 0.5) * factor + 0.5) * 255;\n                data[i + 2] = ((data[i + 2] / 255 - 0.5) * factor + 0.5) * 255;\n            }\n        }\n        return imageData;\n    };\n    /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n    Filter.prototype.grayscale = function (imageData, percentage) {\n        if (percentage === void 0) { percentage = '0'; }\n        var factor = this.getValFromPercentage(percentage);\n        if (factor > 0) {\n            var data = imageData.data;\n            var length_3 = data.length;\n            for (var i = 0; i < length_3; i += 4) {\n                var r = data[i];\n                var g = data[i + 1];\n                var b = data[i + 2];\n                // Calculate the grayscale value using the luminosity method\n                var gray = 0.299 * r + 0.587 * g + 0.114 * b;\n                // Blend the original color with the grayscale value based on the percentage\n                data[i] = r * (1 - factor) + gray * factor;\n                data[i + 1] = g * (1 - factor) + gray * factor;\n                data[i + 2] = b * (1 - factor) + gray * factor;\n            }\n        }\n        return imageData;\n    };\n    /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n    Filter.prototype.hueRotate = function (imageData, rotation) {\n        if (rotation === void 0) { rotation = '0deg'; }\n        var data = imageData.data;\n        var angle = parseFloat(rotation) * (Math.PI / 180);\n        if (angle > 0) {\n            var cosA = Math.cos(angle);\n            var sinA = Math.sin(angle);\n            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n            var matrix = [\n                0.213 + cosA * 0.787 - sinA * 0.213, 0.715 - cosA * 0.715 - sinA * 0.715, 0.072 - cosA * 0.072 + sinA * 0.928,\n                0.213 - cosA * 0.213 + sinA * 0.143, 0.715 + cosA * 0.285 + sinA * 0.140, 0.072 - cosA * 0.072 - sinA * 0.283,\n                0.213 - cosA * 0.213 - sinA * 0.787, 0.715 - cosA * 0.715 + sinA * 0.715, 0.072 + cosA * 0.928 + sinA * 0.072\n            ];\n            for (var i = 0; i < data.length; i += 4) {\n                var r = data[i];\n                var g = data[i + 1];\n                var b = data[i + 2];\n                // Apply the hue rotation matrix\n                data[i] = matrix[0] * r + matrix[1] * g + matrix[2] * b;\n                data[i + 1] = matrix[3] * r + matrix[4] * g + matrix[5] * b;\n                data[i + 2] = matrix[6] * r + matrix[7] * g + matrix[8] * b;\n            }\n        }\n        return imageData;\n    };\n    /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n    Filter.prototype.invert = function (imageData, percentage) {\n        if (percentage === void 0) { percentage = '0'; }\n        var factor = this.getValFromPercentage(percentage);\n        if (factor > 0) {\n            var data = imageData.data;\n            var length_4 = data.length;\n            for (var i = 0; i < length_4; i += 4) {\n                data[i + 0] = Math.abs(data[i + 0] - 255 * factor);\n                data[i + 1] = Math.abs(data[i + 1] - 255 * factor);\n                data[i + 2] = Math.abs(data[i + 2] - 255 * factor);\n            }\n        }\n        return imageData;\n    };\n    /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n    Filter.prototype.opacity = function (imageData, percentage) {\n        if (percentage === void 0) { percentage = '0'; }\n        var factor = this.getValFromPercentage(percentage);\n        if (factor >= 0) {\n            var data = imageData.data;\n            var length_5 = data.length;\n            for (var i = 3; i < length_5; i += 4) {\n                data[i] *= factor;\n            }\n        }\n        return imageData;\n    };\n    /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n    Filter.prototype.saturate = function (context, imageData, percentage) {\n        if (percentage === void 0) { percentage = '0'; }\n        var factor = this.getValFromPercentage(percentage);\n        if (factor !== 1) {\n            var _a = context.canvas, width = _a.width, height = _a.height;\n            var data = imageData.data;\n            var lumR = (1 - factor) * 0.3086;\n            var lumG = (1 - factor) * 0.6094;\n            var lumB = (1 - factor) * 0.082;\n            // tslint:disable-next-line no-bitwise\n            var shiftW = width << 2;\n            for (var j = 0; j < height; j++) {\n                var offset = j * shiftW;\n                for (var i = 0; i < width; i++) {\n                    // tslint:disable-next-line no-bitwise\n                    var pos = offset + (i << 2);\n                    var r = data[pos + 0];\n                    var g = data[pos + 1];\n                    var b = data[pos + 2];\n                    data[pos + 0] = (lumR + factor) * r + lumG * g + lumB * b;\n                    data[pos + 1] = lumR * r + (lumG + factor) * g + lumB * b;\n                    data[pos + 2] = lumR * r + lumG * g + (lumB + factor) * b;\n                }\n            }\n        }\n        return imageData;\n    };\n    /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n    Filter.prototype.sepia = function (imageData, percentage) {\n        if (percentage === void 0) { percentage = '0'; }\n        var factor = this.getValFromPercentage(percentage);\n        if (factor > 1) {\n            factor = 1;\n        }\n        if (factor > 0) {\n            var data = imageData.data;\n            var length_6 = data.length;\n            for (var i = 0; i < length_6; i += 4) {\n                var r = data[i + 0];\n                var g = data[i + 1];\n                var b = data[i + 2];\n                data[i + 0] =\n                    (0.393 * r + 0.769 * g + 0.189 * b) * factor + r * (1 - factor);\n                data[i + 1] =\n                    (0.349 * r + 0.686 * g + 0.168 * b) * factor + g * (1 - factor);\n                data[i + 2] =\n                    (0.272 * r + 0.534 * g + 0.131 * b) * factor + b * (1 - factor);\n            }\n        }\n        return imageData;\n    };\n    return Filter;\n}());\nexport { Filter };\n","import { EventHandler, extend, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { ShapeType } from '../index';\nvar FreehandDrawing = /** @class */ (function () {\n    function FreehandDrawing(parent) {\n        this.fhdObj = { lastWidth: 0, lastVelocity: 0, time: 0, pointX: 0, pointY: 0 };\n        this.isFreehandDrawing = false;\n        this.freehandDownPoint = { x: 0, y: 0 };\n        this.isFreehandPointMoved = false;\n        this.pointCounter = 0;\n        // eslint-disable-next-line\n        this.selPointColl = {};\n        this.currFHDIdx = 0; // Specifies id for every freehand drawing - uses while deleting\n        this.selPoints = [];\n        this.dummyPoints = [];\n        this.tempFHDStyles = { strokeColor: null, fillColor: null, strokeWidth: null };\n        this.straightenPoint = { x: null, y: null, ratioX: null, ratioY: null };\n        this.straightenPointAngle = 0;\n        this.isMasking = false;\n        this.parent = parent;\n        this.addEventListener();\n    }\n    FreehandDrawing.prototype.destroy = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.removeEventListener();\n    };\n    FreehandDrawing.prototype.addEventListener = function () {\n        this.parent.on('freehand-draw', this.draw, this);\n        this.parent.on('destroyed', this.destroy, this);\n    };\n    FreehandDrawing.prototype.removeEventListener = function () {\n        this.parent.off('freehand-draw', this.draw);\n        this.parent.off('destroyed', this.destroy);\n    };\n    FreehandDrawing.prototype.draw = function (args) {\n        this.updateFhdPvtVar();\n        switch (args.prop) {\n            case 'hoverFhd': {\n                this.hoverFhd(args.value['strokeColor'], args.value['strokeWidth']);\n                break;\n            }\n            case 'freehandDownHandler':\n                this.freehandDownHandler(args.value['e'], args.value['canvas']);\n                break;\n            case 'freehandUpHandler':\n                this.freehandUpHandler(args.value['e'], args.value['canvas'], args.value['context']);\n                break;\n            case 'handle-freehand-draw': {\n                var id = parseInt(args.value['id'].split('_')[1], 10) - 1;\n                if (this.isFHDIdx(id)) {\n                    this.deleteFhd(id, true);\n                }\n                break;\n            }\n            case 'freehandRedraw':\n                this.freehandRedraw(args.value['context'], args.value['points']);\n                break;\n            case 'deleteFhd': {\n                var id = parseInt(args.value['id'].split('_')[1], 10) - 1;\n                this.deleteFhd(id, true);\n                break;\n            }\n            case 'selectFhd': {\n                var id = null;\n                if (args.value['id']) {\n                    id = parseInt(args.value['id'].split('_')[1], 10) - 1;\n                }\n                this.selectFhd(id);\n                break;\n            }\n            case 'applyFhd':\n                this.applyFhd();\n                break;\n            case 'cancelFhd':\n                this.cancelFhd();\n                break;\n            case 'updateFHDCurPts':\n                this.updateFHDCurPts();\n                break;\n            case 'rotateFhdColl':\n                this.rotateFhdColl();\n                break;\n            case 'flipFHDColl':\n                this.flipFHDColl(args.value['value']);\n                break;\n            case 'panFHDColl':\n                this.panFHDColl(args.value['xDiff'], args.value['yDiff'], args.value['panRegion']);\n                break;\n            case 'updateFHDColl':\n                if (args.value && args.value['isPreventApply']) {\n                    this.updateFHDColl(args.value['isPreventApply']);\n                }\n                else {\n                    this.updateFHDColl();\n                }\n                break;\n            case 'zoomFHDColl':\n                this.zoomFHDColl(args.value['isPreventApply']);\n                break;\n            case 'apply-pen-draw':\n                this.applyPenDraw();\n                break;\n            case 'freeHandDraw':\n                this.freeHandDraw(args.value['value']);\n                break;\n            case 'isFHDIdx':\n                this.isFHDIdx(args.value['index'], args.value['obj']);\n                break;\n            case 'getSqPtFD':\n                this.getSqPtFD(args.value['idx'], args.value['obj']);\n                break;\n            case 'getSelPointColl':\n                args.value['obj']['selPointColl'] = extend([], this.selPointColl);\n                break;\n            case 'setSelPointColl':\n                this.selPointColl = extend([], args.value['obj']['selPointColl']);\n                break;\n            case 'pushSelPointColl':\n                this.selPointColl.push(extend([], args.value['obj']['selPointColl']));\n                break;\n            case 'setFreehandDrawHoveredIndex':\n                this.fhdHovIdx = args.value['index'];\n                break;\n            case 'getFreehandDrawHoveredIndex':\n                args.value['obj']['index'] = this.fhdHovIdx;\n                break;\n            case 'setPointCounter':\n                this.pointCounter = args.value['value'];\n                break;\n            case 'getPenStrokeWidth':\n                args.value['obj']['penStrokeWidth'] = this.penStrokeWidth;\n                break;\n            case 'setPenStrokeWidth':\n                this.penStrokeWidth = args.value['value'];\n                break;\n            case 'getCurrentFreehandDrawIndex':\n                args.value['obj']['currentFreehandDrawIndex'] = this.currFHDIdx;\n                break;\n            case 'setCurrentFreehandDrawIndex':\n                this.currFHDIdx = args.value['value'];\n                break;\n            case 'updateCropPtsForSel':\n                this.updateCropPtsForSel();\n                break;\n            case 'getFreehandDrawSelectedId':\n                args.value['obj']['freehandDrawSelectedId'] = this.fhdSelID;\n                break;\n            case 'resetFreehandDrawSelectedId':\n                this.fhdSelID = null;\n                break;\n            case 'getTempFreeHandDrawEditingStyles':\n                args.value['obj']['tempFreeHandDrawEditingStyles'] = this.tempFHDStyles;\n                break;\n            case 'setFreehandSelectedIndex':\n                this.fhdSelIdx = args.value['index'];\n                break;\n            case 'getFreehandSelectedIndex':\n                args.value['obj']['freehandSelectedIndex'] = this.fhdSelIdx;\n                break;\n            case 'setCenterSelPoints':\n                this.setCenterSelPoints();\n                break;\n            case 'getStraightenPoint':\n                args.value['obj']['straightenPoint'] = extend({}, this.straightenPoint, {}, true);\n                break;\n            case 'setStraightenPoint':\n                this.straightenPoint.x = args.value['x'];\n                this.straightenPoint.y = args.value['y'];\n                if (args.value['ratioX'] && args.value['ratioY']) {\n                    this.straightenPoint.ratioX = args.value['ratioX'];\n                    this.straightenPoint.ratioY = args.value['ratioY'];\n                }\n                break;\n            case 'resetStraightenPoint':\n                this.straightenPoint = { x: null, y: null, ratioX: null, ratioY: null };\n                this.prevStraightenObj = null;\n                this.straightenPointAngle = 0;\n                break;\n            case 'getStraightenPointAngle':\n                args.value['obj']['angle'] = this.straightenPointAngle;\n                break;\n            case 'reset':\n                this.reset();\n                break;\n            case 'triggerShapeChanging':\n                this.triggerShapeChanging(args.value['shapeChangingArgs']);\n                break;\n            case 'setMasking':\n                this.isMasking = args.value['value'];\n                break;\n            case 'resetSelPoints':\n                this.selPoints = [];\n                break;\n        }\n    };\n    FreehandDrawing.prototype.updateFhdPvtVar = function () {\n        var parent = this.parent;\n        if (parent.lowerCanvas) {\n            this.lowerContext = parent.lowerCanvas.getContext('2d');\n        }\n        if (parent.upperCanvas) {\n            this.upperContext = parent.upperCanvas.getContext('2d');\n        }\n    };\n    FreehandDrawing.prototype.reset = function () {\n        this.fhdObj = { lastWidth: 0, lastVelocity: 0, time: 0, pointX: 0, pointY: 0 };\n        this.isFreehandDrawing = this.isFreehandPointMoved = false;\n        this.selPoints = [];\n        this.dummyPoints = [];\n        this.freehandDownPoint = { x: 0, y: 0 };\n        this.selPointColl = {};\n        this.straightenPointAngle = 0;\n        this.fhdHovIdx = null;\n        this.pointCounter = 0;\n        this.fhdSelID = null;\n        this.isMasking = false;\n        this.penStrokeWidth = undefined;\n        this.currFHDIdx = 0;\n        this.fhdSelIdx = null;\n        this.tempFHDStyles = { strokeColor: null, fillColor: null, strokeWidth: null };\n        this.straightenPoint = { x: null, y: null, ratioX: null, ratioY: null };\n        this.prevStraightenObj = null;\n    };\n    FreehandDrawing.prototype.getModuleName = function () {\n        return 'freehand-draw';\n    };\n    FreehandDrawing.prototype.hoverFhd = function (fillStyle, strokeWidth) {\n        var parent = this.parent;\n        var context = this.upperContext;\n        var idx = -1;\n        if (this.fhdHovIdx > -1) {\n            idx = this.fhdHovIdx;\n        }\n        else {\n            idx = this.fhdSelIdx;\n        }\n        parent.points = extend([], parent.pointColl[idx].points);\n        this.pointCounter = 0;\n        var len = parent.points.length;\n        var controlPoint1;\n        var controlPoint2;\n        var startPoint;\n        var endPoint;\n        var minStrokeWidth = 0;\n        var maxStrokeWidth = 0;\n        context.fillStyle = fillStyle ? fillStyle : parent.pointColl[idx].strokeColor;\n        context.strokeStyle = context.fillStyle;\n        minStrokeWidth = maxStrokeWidth = this.penStrokeWidth = strokeWidth ?\n            strokeWidth : parent.pointColl[idx].strokeWidth;\n        if (len === 1) {\n            controlPoint1 = controlPoint2 = startPoint = endPoint = parent.points[0];\n            this.startDraw(context, controlPoint1, controlPoint2, startPoint, endPoint, minStrokeWidth, maxStrokeWidth);\n        }\n        for (var l = 0; l < len - 3; l++) {\n            if (parent.points[l + 1] && parent.points[l + 2] && parent.points[l + 2]) {\n                controlPoint1 = (this.calcCurveCP(parent.points[l + 0], parent.points[l + 1], parent.points[l + 2])).controlPoint2;\n                controlPoint2 = (this.calcCurveCP(parent.points[l + 1], parent.points[l + 2], parent.points[l + 3])).controlPoint1;\n                if (l === 0) {\n                    startPoint = parent.points[l];\n                }\n                else {\n                    startPoint = parent.points[l + 1];\n                }\n                endPoint = parent.points[l + 2];\n                this.startDraw(context, controlPoint1, controlPoint2, startPoint, endPoint, minStrokeWidth, maxStrokeWidth);\n            }\n        }\n        context.closePath();\n        // Outer selection\n        var point = this.getSqPtFD(idx);\n        var tempLineWidth = context.lineWidth;\n        context.lineWidth = 2;\n        context.strokeStyle = parent.themeColl[parent.theme]['primaryColor'];\n        context.beginPath();\n        context.rect(point.startX, point.startY, point.width, point.height);\n        context.stroke();\n        context.closePath();\n        context.lineWidth = tempLineWidth;\n    };\n    FreehandDrawing.prototype.freehandDownHandler = function (e, canvas) {\n        var parent = this.parent;\n        parent.lowerCanvas = document.querySelector('#' + parent.element.id + '_lowerCanvas');\n        this.lowerContext = parent.lowerCanvas.getContext('2d');\n        parent.upperCanvas = document.querySelector('#' + parent.element.id + '_upperCanvas');\n        this.upperContext = parent.upperCanvas.getContext('2d');\n        this.fhdObj.time = new Date().getTime();\n        this.isFreehandDrawing = true;\n        if (e.type === 'mousedown') {\n            this.freehandDownPoint = { x: e.clientX, y: e.clientY };\n        }\n        else {\n            this.freehandDownPoint = { x: e.touches[0].clientX, y: e.touches[0].clientY };\n        }\n        this.isFreehandPointMoved = false;\n        EventHandler.add(canvas, 'mousemove touchmove', this.freehandMoveHandler, this);\n        var shapeSettings = { id: 'pen_' + (this.currFHDIdx + 1), type: ShapeType.FreehandDraw,\n            startX: this.freehandDownPoint.x, startY: this.freehandDownPoint.y,\n            strokeColor: parent.activeObj.strokeSettings.strokeColor, strokeWidth: this.penStrokeWidth,\n            points: null, index: parent.objColl.length + parent.freehandCounter + 1 };\n        var shapeChangingArgs = { cancel: false, action: 'draw-start', previousShapeSettings: shapeSettings,\n            currentShapeSettings: shapeSettings };\n        this.triggerShapeChanging(shapeChangingArgs);\n    };\n    FreehandDrawing.prototype.freehandUpHandler = function (e, canvas, context) {\n        var rect = canvas.getBoundingClientRect();\n        var parent = this.parent;\n        EventHandler.remove(canvas, 'mousemove touchmove', this.freehandMoveHandler);\n        if (parent.points.length === 0) {\n            if (e.type === 'mouseup') {\n                this.processPoint(e.clientX - rect.left, e.clientY - rect.top, true, context);\n            }\n            else if (e.type === 'touchend' && e.changedTouches) {\n                this.processPoint(e.changedTouches[0].clientX - rect.left, e.changedTouches[0].clientY - rect.top, true, context);\n            }\n            else {\n                if (!this.isFreehandPointMoved) {\n                    this.processPoint(this.freehandDownPoint.x - rect.left, this.freehandDownPoint.y - rect.top, true, context);\n                }\n            }\n        }\n        context.closePath();\n        var prevCropObj = extend({}, parent.cropObj, {}, true);\n        var object = { currObj: {} };\n        parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        var prevObj = object['currObj'];\n        prevObj.objColl = extend([], parent.objColl, [], true);\n        prevObj.pointColl = extend([], parent.pointColl, [], true);\n        prevObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false, value: { obj: selPointCollObj } });\n        prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        var fhCnt = parent.freehandCounter;\n        var order = parent.objColl.length + parent.freehandCounter + 1;\n        parent.pointColl[fhCnt] = { points: extend([], parent.points), strokeColor: parent.activeObj.strokeSettings.strokeColor,\n            strokeWidth: this.penStrokeWidth, flipState: parent.transform.currFlipState,\n            id: 'pen_' + (this.currFHDIdx + 1), order: order };\n        parent.points = [];\n        this.dummyPoints = [];\n        this.selPointColl[fhCnt] = { points: extend([], this.selPoints) };\n        this.selPoints = [];\n        this.pointCounter = 0;\n        parent.freehandCounter++;\n        this.isFreehandDrawing = false;\n        if (!parent.isMaskImage) {\n            parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                value: { operation: 'freehand-draw', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                    previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                    previousCropObj: prevCropObj, previousText: null,\n                    currentText: null, previousFilter: null, isCircleCrop: null } });\n        }\n        var shapeSettings = { id: 'pen_' + (this.currFHDIdx + 1), type: ShapeType.FreehandDraw,\n            startX: this.freehandDownPoint.x, startY: this.freehandDownPoint.y,\n            strokeColor: parent.activeObj.strokeSettings.strokeColor, strokeWidth: this.penStrokeWidth,\n            points: parent.pointColl[this.currFHDIdx].points, index: order };\n        var shapeChangingArgs = { cancel: false, action: 'draw-end', previousShapeSettings: shapeSettings,\n            currentShapeSettings: shapeSettings };\n        this.triggerShapeChanging(shapeChangingArgs);\n        this.currFHDIdx++;\n    };\n    FreehandDrawing.prototype.freehandMoveHandler = function (e) {\n        this.isFreehandPointMoved = true;\n        var rect = this.parent.upperCanvas.getBoundingClientRect();\n        var x;\n        var y;\n        if (e.type === 'mousemove') {\n            x = e.clientX - rect.left;\n            y = e.clientY - rect.top;\n        }\n        else {\n            x = e.touches[0].clientX - rect.left;\n            y = e.touches[0].clientY - rect.top;\n        }\n        if (this.isFreehandDrawing) {\n            this.upperContext.fillStyle = this.parent.activeObj.strokeSettings.strokeColor;\n            if (this.parent.isMaskImage) {\n                this.upperContext.globalCompositeOperation = 'xor';\n            }\n            this.processPoint(x, y, false, this.upperContext);\n        }\n    };\n    FreehandDrawing.prototype.processPoint = function (x, y, mouseDown, context) {\n        var parent = this.parent;\n        var lastPoint = this.point(x, y, new Date().getTime());\n        lastPoint = parent.points.length > 0 && parent.points[parent.points.length - 1];\n        var isLastPointTooClose = lastPoint ? this.distanceTo(lastPoint) <= 5 : false;\n        var controlPoint1;\n        var controlPoint2;\n        var startPoint;\n        var endPoint;\n        this.selPoints.push({ x: x, y: y, ratioX: (x - parent.img.destLeft) / parent.img.destWidth,\n            ratioY: (y - parent.img.destTop) / parent.img.destHeight, time: this.fhdObj.time });\n        if (!lastPoint || !(lastPoint && isLastPointTooClose) || mouseDown) {\n            this.fhdObj.time = new Date().getTime();\n            parent.points.push({ x: x, y: y, ratioX: (x - parent.img.destLeft) / parent.img.destWidth,\n                ratioY: (y - parent.img.destTop) / parent.img.destHeight,\n                time: this.fhdObj.time });\n            this.dummyPoints.push({ x: x, y: y, ratioX: (x - parent.img.destLeft) / parent.img.destWidth,\n                ratioY: (y - parent.img.destTop) / parent.img.destHeight,\n                time: this.fhdObj.time });\n            if (this.dummyPoints.length > 2) {\n                if (this.dummyPoints.length === 3) {\n                    this.dummyPoints.unshift(this.dummyPoints[0]);\n                }\n                var p0 = this.dummyPoints[0];\n                var p1 = this.dummyPoints[1];\n                var p2 = this.dummyPoints[2];\n                var p3 = this.dummyPoints[3];\n                controlPoint1 = this.calcCurveCP(p0, p1, p2).controlPoint2;\n                controlPoint2 = this.calcCurveCP(p1, p2, p3).controlPoint1;\n                startPoint = this.dummyPoints[1];\n                endPoint = this.dummyPoints[2];\n                var minStrokeWidth = 0.5;\n                var maxStrokeWidth = 5;\n                if (!isNullOrUndefined(this.penStrokeWidth)) {\n                    minStrokeWidth = maxStrokeWidth = this.penStrokeWidth;\n                }\n                this.startDraw(context, controlPoint1, controlPoint2, startPoint, endPoint, minStrokeWidth, maxStrokeWidth);\n                this.pointCounter++;\n                this.dummyPoints.shift();\n            }\n            if (mouseDown) {\n                controlPoint1 = controlPoint2 = startPoint = endPoint = { x: x, y: y, time: new Date().getTime() };\n                var minStrokeWidth = 0.5;\n                var maxStrokeWidth = 5;\n                if (!isNullOrUndefined(this.penStrokeWidth)) {\n                    minStrokeWidth = maxStrokeWidth = this.penStrokeWidth;\n                }\n                this.startDraw(context, controlPoint1, controlPoint2, startPoint, endPoint, minStrokeWidth, maxStrokeWidth);\n            }\n        }\n    };\n    FreehandDrawing.prototype.calcCurveCP = function (p1, p2, p3) {\n        if (!p2) {\n            p2 = p1;\n        }\n        if (!p3) {\n            p3 = p2;\n        }\n        var dx1 = p1.x - p2.x;\n        var dy1 = p1.y - p2.y;\n        var dx2 = p2.x - p3.x;\n        var dy2 = p2.y - p3.y;\n        var m1 = { x: (p1.x + p2.x) / 2.0, y: (p1.y + p2.y) / 2.0 };\n        var m2 = { x: (p2.x + p3.x) / 2.0, y: (p2.y + p3.y) / 2.0 };\n        var l1 = Math.sqrt(dx1 * dx1 + dy1 * dy1);\n        var l2 = Math.sqrt(dx2 * dx2 + dy2 * dy2);\n        var dxm = (m1.x - m2.x);\n        var dym = (m1.y - m2.y);\n        var k = l2 / (l1 + l2);\n        var cm = { x: m2.x + dxm * k, y: m2.y + dym * k };\n        var tx = p2.x - cm.x;\n        var ty = p2.y - cm.y;\n        return {\n            controlPoint1: this.point(m1.x + tx, m1.y + ty, 0),\n            controlPoint2: this.point(m2.x + tx, m2.y + ty, 0)\n        };\n    };\n    FreehandDrawing.prototype.point = function (x, y, time) {\n        this.fhdObj.pointX = x;\n        this.fhdObj.pointY = y;\n        return { x: this.fhdObj.pointX, y: this.fhdObj.pointY, time: time };\n    };\n    FreehandDrawing.prototype.startDraw = function (context, controlPoint1, controlPoint2, startPoint, endPoint, minStrokeWidth, maxStrokeWidth) {\n        var tempVelocity;\n        tempVelocity = this.pointVelocity(startPoint);\n        tempVelocity = 0.7 * tempVelocity + (1 - 0.7) * this.fhdObj.lastVelocity;\n        var newWidth = Math.max(maxStrokeWidth / (0.7 + 1), minStrokeWidth);\n        this.drawCurve(this.fhdObj.time, newWidth, context, controlPoint1, controlPoint2, startPoint, endPoint, maxStrokeWidth);\n        this.fhdObj.lastVelocity = tempVelocity;\n        this.fhdObj.time = newWidth;\n    };\n    FreehandDrawing.prototype.pointVelocity = function (startPoint) {\n        return (this.fhdObj.time !== startPoint.time) ? this.distanceTo(startPoint) /\n            (this.fhdObj.time - startPoint.time) : 0;\n    };\n    FreehandDrawing.prototype.distanceTo = function (start) {\n        return Math.sqrt(Math.pow(this.fhdObj.pointX - start.x, 2) + Math.pow(this.fhdObj.pointY - start.y, 2));\n    };\n    FreehandDrawing.prototype.drawCurve = function (startWidth, endWidth, context, controlPoint1, controlPoint2, startPoint, endPoint, maxStrokeWidth) {\n        var width;\n        var i;\n        var t1;\n        var t2;\n        var t3;\n        var u1;\n        var u2;\n        var u3;\n        var x;\n        var y;\n        var widthValue = endWidth - startWidth;\n        var bezierLength = this.bezierLength(controlPoint1, controlPoint2, startPoint, endPoint);\n        var drawSteps = Math.ceil(bezierLength) * 2;\n        context.beginPath();\n        for (i = 0; i < drawSteps; i++) {\n            t1 = i / drawSteps;\n            t2 = t1 * t1;\n            t3 = t2 * t1;\n            u1 = 1 - t1;\n            u2 = u1 * u1;\n            u3 = u2 * u1;\n            x = u3 * startPoint.x;\n            x += 3 * u2 * t1 * controlPoint1.x;\n            x += 3 * u1 * t2 * controlPoint2.x;\n            x += t3 * endPoint.x;\n            y = u3 * startPoint.y;\n            y += 3 * u2 * t1 * controlPoint1.y;\n            y += 3 * u1 * t2 * controlPoint2.y;\n            y += t3 * endPoint.y;\n            width = Math.min(startWidth + t3 * widthValue, maxStrokeWidth);\n            this.drawArc(x, y, width, context);\n        }\n        context.closePath();\n        context.fill();\n    };\n    FreehandDrawing.prototype.bezierLength = function (controlPoint1, controlPoint2, startPoint, endPoint) {\n        var steps = 10;\n        var length = 0;\n        var i;\n        var t;\n        var pointX1;\n        var pointY1;\n        var pointX2;\n        var pointY2;\n        var pointX3;\n        var pointY3;\n        for (i = 0; i <= steps; i++) {\n            t = i / steps;\n            pointX1 = this.bezierPoint(t, startPoint.x, controlPoint1.x, controlPoint2.x, endPoint.x);\n            pointY1 = this.bezierPoint(t, startPoint.y, controlPoint1.y, controlPoint2.y, endPoint.y);\n            if (i > 0) {\n                pointX3 = pointX1 - pointX2;\n                pointY3 = pointY1 - pointY2;\n                length += Math.sqrt(pointX3 * pointX3 + pointY3 * pointY3);\n            }\n            pointX2 = pointX1;\n            pointY2 = pointY1;\n        }\n        return length;\n    };\n    FreehandDrawing.prototype.bezierPoint = function (t, startPoint, cp1, cp2, endPoint) {\n        return startPoint * (1.0 - t) * (1.0 - t) * (1.0 - t) + 3.0 * cp1 * (1.0 - t) * (1.0 - t) * t + 3.0 *\n            cp2 * (1.0 - t) * t * t + endPoint * t * t * t;\n    };\n    FreehandDrawing.prototype.drawArc = function (x, y, size, context) {\n        var img = this.parent.img;\n        if ((x > img.destLeft && y > img.destTop && x < (img.destLeft + img.destWidth) &&\n            y < (img.destTop + img.destHeight) ||\n            (context !== this.lowerContext && context !== this.upperContext))) {\n            context.moveTo(x, y);\n            context.arc(x, y, size, 0, 2 * Math.PI, false);\n        }\n    };\n    FreehandDrawing.prototype.freehandRedraw = function (context, points) {\n        var parent = this.parent;\n        var temp = context.filter;\n        context.filter = 'none';\n        if (points) {\n            parent.pointColl[parent.freehandCounter] = { points: points, strokeColor: parent.activeObj.strokeSettings.strokeColor,\n                strokeWidth: this.penStrokeWidth, flipState: parent.transform.currFlipState,\n                id: 'pen_' + (parent.freehandCounter + 1), order: parent.objColl.length + parent.freehandCounter + 1 };\n            this.selPointColl[parent.freehandCounter] = extend({}, parent.pointColl[parent.freehandCounter], {}, true);\n            parent.freehandCounter++;\n        }\n        if (parent.freehandCounter > 0) {\n            for (var n = 0; n < parent.freehandCounter; n++) {\n                parent.points = extend([], parent.pointColl[n].points);\n                this.pointCounter = 0;\n                var len = parent.points.length;\n                var controlPoint1 = void 0;\n                var controlPoint2 = void 0;\n                var startPoint = void 0;\n                var endPoint = void 0;\n                var minStrokeWidth = void 0;\n                var maxStrokeWidth = void 0;\n                if (len > 0) {\n                    context.fillStyle = parent.pointColl[n].strokeColor;\n                    minStrokeWidth = maxStrokeWidth = this.penStrokeWidth = parent.pointColl[n].strokeWidth;\n                }\n                if (len === 1) {\n                    controlPoint1 = controlPoint2 = startPoint = endPoint = parent.points[0];\n                    this.startDraw(context, controlPoint1, controlPoint2, startPoint, endPoint, minStrokeWidth, maxStrokeWidth);\n                }\n                for (var l = 0; l < len - 3; l++) {\n                    if (parent.points[l + 1] && parent.points[l + 2] && parent.points[l + 2]) {\n                        controlPoint1 = (this.calcCurveCP(parent.points[l + 0], parent.points[l + 1], parent.points[l + 2])).controlPoint2;\n                        controlPoint2 = (this.calcCurveCP(parent.points[l + 1], parent.points[l + 2], parent.points[l + 3])).controlPoint1;\n                        if (l === 0) {\n                            startPoint = parent.points[l];\n                        }\n                        else {\n                            startPoint = parent.points[l + 1];\n                        }\n                        endPoint = parent.points[l + 2];\n                        this.startDraw(context, controlPoint1, controlPoint2, startPoint, endPoint, minStrokeWidth, maxStrokeWidth);\n                    }\n                }\n                context.closePath();\n            }\n            if (context === this.lowerContext) {\n                parent.notify('draw', { prop: 'applyFrame', value: { ctx: this.lowerContext, frame: parent.frameObj.type, preventImg: true } });\n                this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            }\n        }\n        context.filter = temp;\n    };\n    FreehandDrawing.prototype.getSqPtFD = function (idx, obj) {\n        var activePoint = { startX: 0, startY: 0, endX: 0, endY: 0, width: 0, height: 0 };\n        var sPoints = extend([], this.selPointColl[idx].points, []);\n        this.parent.points = extend([], this.parent.pointColl[idx].points);\n        this.pointCounter = 0;\n        var len = sPoints.length;\n        for (var l = 0; l < len; l++) {\n            if (activePoint.startX === 0 && activePoint.startY === 0 && activePoint.endX === 0 && activePoint.endY === 0) {\n                activePoint.startX = sPoints[l].x;\n                activePoint.startY = sPoints[l].y;\n                activePoint.endX = sPoints[l].x;\n                activePoint.endY = sPoints[l].y;\n            }\n            else {\n                activePoint.startX = Math.min(activePoint.startX, sPoints[l].x);\n                activePoint.startY = Math.min(activePoint.startY, sPoints[l].y);\n                activePoint.endX = Math.max(activePoint.endX, sPoints[l].x);\n                activePoint.endY = Math.max(activePoint.endY, sPoints[l].y);\n            }\n        }\n        activePoint.startX -= this.penStrokeWidth;\n        activePoint.startY -= this.penStrokeWidth;\n        activePoint.endX += this.penStrokeWidth;\n        activePoint.endY += this.penStrokeWidth;\n        activePoint.width = activePoint.endX - activePoint.startX;\n        activePoint.height = activePoint.endY - activePoint.startY;\n        if (obj) {\n            obj['activePoint'] = activePoint;\n        }\n        return activePoint;\n    };\n    FreehandDrawing.prototype.applyPenDraw = function () {\n        var parent = this.parent;\n        if (parent.currObjType.shape === 'freehanddraw') {\n            parent.notify('shape', { prop: 'apply', onPropertyChange: false, value: { shape: null, obj: null, canvas: null } });\n            parent.upperCanvas.style.cursor = parent.cursor = 'default';\n            parent.currObjType.shape = '';\n        }\n        parent.notify('shape', { prop: 'clearActObj' });\n    };\n    FreehandDrawing.prototype.applyFhd = function () {\n        var parent = this.parent;\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        var selectedPoint = parent.pointColl[this.fhdSelIdx];\n        if (selectedPoint.strokeColor === '#42a5f5') {\n            selectedPoint.strokeColor = this.tempFHDStyles.strokeColor;\n        }\n        parent.notify('toolbar', { prop: 'setSelectedFreehandColor', value: { color: '#42a5f5' } });\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: null } });\n        parent.notify('toolbar', { prop: 'refresh-main-toolbar', onPropertyChange: false });\n        if (selectedPoint) {\n            selectedPoint.isSelected = false;\n        }\n        parent.notify('selection', { prop: 'resetFreehandDrawVariables' });\n        this.fhdHovIdx = this.fhdSelIdx = null;\n    };\n    FreehandDrawing.prototype.cancelFhd = function () {\n        var parent = this.parent;\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        var selectedPoint = parent.pointColl[this.fhdSelIdx];\n        parent.notify('toolbar', { prop: 'setSelectedFreehandColor', value: { color: '#42a5f5' } });\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        this.lowerContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        this.pointCounter = 0;\n        if (selectedPoint) {\n            selectedPoint.strokeColor = this.tempFHDStyles.strokeColor;\n            selectedPoint.strokeWidth = this.tempFHDStyles.strokeWidth;\n            selectedPoint.isSelected = false;\n        }\n        this.fhdHovIdx = this.fhdSelIdx = this.fhdSelID = null;\n        parent.notify('selection', { prop: 'resetFreehandDrawVariables' });\n        parent.activeObj.strokeSettings.strokeColor = this.tempFHDStyles.strokeColor;\n        parent.activeObj.strokeSettings.strokeWidth = this.penStrokeWidth = this.tempFHDStyles.strokeWidth;\n        this.tempFHDStyles = { strokeColor: null, strokeWidth: null, fillColor: null };\n        parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: null } });\n        parent.notify('toolbar', { prop: 'refresh-main-toolbar', onPropertyChange: false });\n    };\n    FreehandDrawing.prototype.selectFhd = function (index) {\n        var parent = this.parent;\n        var tempFHDStyles = extend({}, this.tempFHDStyles, {}, true);\n        parent.notify('selection', { prop: 'setFreehandDrawEditing', onPropertyChange: false, value: { bool: true } });\n        if (index || index === 0) {\n            if (this.isFHDIdx(index)) {\n                this.fhdSelIdx = this.fhdHovIdx = index;\n                this.hoverFhd();\n                parent.upperCanvas.style.cursor = parent.cursor = 'pointer';\n            }\n            else {\n                return;\n            }\n        }\n        this.fhdSelIdx = this.fhdHovIdx;\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        var point = parent.pointColl[this.fhdSelIdx];\n        point.isSelected = true;\n        this.fhdSelID = point.id;\n        if (point.strokeColor !== '#42a5f5') {\n            parent.activeObj.strokeSettings.strokeColor = this.tempFHDStyles.strokeColor = point.strokeColor;\n        }\n        parent.activeObj.strokeSettings.strokeWidth = this.tempFHDStyles.strokeWidth =\n            parent.pointColl[this.fhdHovIdx].strokeWidth;\n        var obj = { bool: false };\n        parent.notify('selection', { prop: 'getFreehandDrawEditing', onPropertyChange: false, value: { obj: obj } });\n        if (obj['bool']) {\n            var shapeSettings = { id: 'pen_' + (this.fhdSelIdx + 1), type: ShapeType.FreehandDraw,\n                startX: point.points[0].x, startY: point.points[0].y, strokeColor: point.strokeColor,\n                strokeWidth: point.strokeWidth, points: point.points, opacity: point.opacity,\n                index: point.order };\n            var shapeChangingArgs = { cancel: false, action: 'select', previousShapeSettings: shapeSettings,\n                currentShapeSettings: shapeSettings };\n            this.triggerShapeChanging(shapeChangingArgs);\n        }\n        else {\n            parent.okBtn(null, true);\n        }\n        if (parent.isUndoRedoStack) {\n            this.tempFHDStyles = tempFHDStyles;\n        }\n    };\n    // eslint-disable-next-line  @typescript-eslint/no-unused-vars\n    FreehandDrawing.prototype.deleteFhd = function (index, isId) {\n        var parent = this.parent;\n        if (this.isFHDIdx(index)) {\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            var tempPointColl = extend({}, parent.pointColl, {}, true);\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            var tempSelPointColl = extend({}, this.selPointColl, {}, true);\n            parent.pointColl = {};\n            this.selPointColl = {};\n            var count = 0;\n            for (var i = 0; i < parent.freehandCounter; i++) {\n                if (parseInt(tempPointColl[i].id.split('_')[1], 10) - 1 !== index) {\n                    parent.pointColl[count] = tempPointColl[i];\n                    this.selPointColl[count] = tempSelPointColl[i];\n                    count++;\n                }\n            }\n            parent.freehandCounter -= 1;\n            this.fhdHovIdx = this.fhdSelIdx = null;\n            parent.notify('selection', { prop: 'resetFreehandDrawVariables' });\n            parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: null } });\n            parent.notify('toolbar', { prop: 'refresh-main-toolbar', onPropertyChange: false });\n        }\n    };\n    FreehandDrawing.prototype.zoomX = function (x) {\n        return (x * this.parent.img.destWidth) + this.parent.img.destLeft;\n    };\n    FreehandDrawing.prototype.zoomY = function (y) {\n        return (y * this.parent.img.destHeight) + this.parent.img.destTop;\n    };\n    FreehandDrawing.prototype.zoomFHDColl = function (isPreventApply) {\n        var parent = this.parent;\n        var destPoints = { startX: parent.img.destLeft, startY: parent.img.destTop,\n            width: parent.img.destWidth, height: parent.img.destHeight };\n        parent.notify('shape', { prop: 'straightenShapes', onPropertyChange: false });\n        for (var n = 0; n < parent.freehandCounter; n++) {\n            parent.points = extend([], parent.pointColl[n].points, []);\n            this.pointCounter = 0;\n            var len = parent.points.length;\n            for (var l = 0; l < len; l++) {\n                var point = parent.points[l];\n                point.x = this.zoomX(point.ratioX);\n                point.y = this.zoomY(point.ratioY);\n            }\n        }\n        this.updateFHDCurPts();\n        if (this.straightenPoint.x && this.straightenPoint.y) {\n            this.straightenPoint.x = this.zoomX(this.straightenPoint.ratioX);\n            this.straightenPoint.y = this.zoomY(this.straightenPoint.ratioY);\n        }\n        if (parent.transform.straighten !== 0) {\n            parent.notify('shape', { prop: 'straightenFHD', onPropertyChange: false });\n        }\n        parent.img.destLeft = destPoints.startX;\n        parent.img.destTop = destPoints.startY;\n        parent.img.destWidth = destPoints.width;\n        parent.img.destHeight = destPoints.height;\n        if (isNullOrUndefined(isPreventApply)) {\n            this.freehandRedraw(this.lowerContext, null);\n        }\n    };\n    FreehandDrawing.prototype.updateFHDCurPts = function () {\n        var parent = this.parent;\n        for (var n = 0; n < parent.freehandCounter; n++) {\n            if (this.selPointColl[n]) {\n                this.selPoints = extend([], this.selPointColl[n].points, []);\n                this.pointCounter = 0;\n                var len = this.selPoints.length;\n                for (var l = 0; l < len; l++) {\n                    var point = this.selPoints[l];\n                    point.x = this.zoomX(point.ratioX);\n                    point.y = this.zoomY(point.ratioY);\n                }\n            }\n        }\n    };\n    FreehandDrawing.prototype.rotateFhdColl = function () {\n        var parent = this.parent;\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        for (var n = 0; n < parent.freehandCounter; n++) {\n            parent.points = extend([], parent.pointColl[n].points, []);\n            this.pointCounter = 0;\n            var len = parent.points.length;\n            for (var l = 0; l < len; l++) {\n                var point = parent.points[l];\n                point.y = destTop + (destHeight * point.ratioX);\n                point.x = (destLeft + destWidth) - (destWidth * point.ratioY);\n                point.ratioX = (point.x - destLeft) / destWidth;\n                point.ratioY = (point.y - destTop) / destHeight;\n            }\n        }\n        for (var n = 0; n < parent.freehandCounter; n++) {\n            if (this.selPointColl[n]) {\n                this.selPoints = extend([], this.selPointColl[n].points, []);\n                this.pointCounter = 0;\n                var len = this.selPoints.length;\n                for (var l = 0; l < len; l++) {\n                    var point = this.selPoints[l];\n                    point.y = destTop + (destHeight * point.ratioX);\n                    point.x = (destLeft + destWidth) - (destWidth * point.ratioY);\n                    point.ratioX = (point.x - destLeft) / destWidth;\n                    point.ratioY = (point.y - destTop) / destHeight;\n                }\n            }\n        }\n        this.updateFHDCurPts();\n    };\n    FreehandDrawing.prototype.flipFHDColl = function (value) {\n        var lowercaseValue = value.toLowerCase();\n        if (lowercaseValue === 'horizontal') {\n            this.pointsHorizontalFlip();\n        }\n        else if (lowercaseValue === 'vertical') {\n            this.pointsVerticalFlip();\n        }\n        else {\n            this.pointsHorizontalFlip();\n            for (var i = 0; i < this.parent.freehandCounter; i++) {\n                this.parent.pointColl[i].shapeFlip = '';\n            }\n            this.pointsVerticalFlip();\n        }\n    };\n    FreehandDrawing.prototype.pointsHorizontalFlip = function () {\n        var parent = this.parent;\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        for (var n = 0; n < parent.freehandCounter; n++) {\n            if (parent.pointColl[n].shapeFlip !== parent.transform.currFlipState) {\n                parent.points = extend([], parent.pointColl[n].points, []);\n                this.pointCounter = 0;\n                var len = parent.points.length;\n                for (var l = 0; l < len; l++) {\n                    var point = parent.points[l];\n                    if (point.x <= destLeft + (destWidth / 2)) {\n                        point.x = (destLeft + destWidth) - (point.x - destLeft);\n                    }\n                    else if (point.x >= destLeft + (destWidth / 2)) {\n                        point.x = destLeft + (destLeft + destWidth - point.x);\n                    }\n                    point.ratioX = (point.x - destLeft) / destWidth;\n                    point.ratioY = (point.y - destTop) / destHeight;\n                }\n                parent.pointColl[n].shapeFlip = parent.transform.currFlipState;\n            }\n        }\n        for (var n = 0; n < parent.freehandCounter; n++) {\n            if (this.selPointColl[n]) {\n                if (this.selPointColl[n].shapeFlip !== parent.transform.currFlipState) {\n                    this.selPoints = extend([], this.selPointColl[n].points, []);\n                    this.pointCounter = 0;\n                    var len = this.selPoints.length;\n                    for (var l = 0; l < len; l++) {\n                        var point = this.selPoints[l];\n                        if (point.x <= destLeft + (destWidth / 2)) {\n                            point.x = (destLeft + destWidth) - (point.x - destLeft);\n                        }\n                        else if (point.x >= destLeft + (destWidth / 2)) {\n                            point.x = destLeft + (destLeft + destWidth - point.x);\n                        }\n                        point.ratioX = (point.x - destLeft) / destWidth;\n                        point.ratioY = (point.y - destTop) / destHeight;\n                    }\n                }\n            }\n        }\n        this.updateFHDCurPts();\n    };\n    FreehandDrawing.prototype.pointsVerticalFlip = function () {\n        var parent = this.parent;\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        for (var n = 0; n < parent.freehandCounter; n++) {\n            if (parent.pointColl[n].shapeFlip !== parent.transform.currFlipState) {\n                parent.points = extend([], parent.pointColl[n].points, []);\n                this.pointCounter = 0;\n                var len = parent.points.length;\n                for (var l = 0; l < len; l++) {\n                    var point = parent.points[l];\n                    if (point.y <= destTop + (destHeight / 2)) {\n                        point.y = (destTop + destHeight) - (point.y - destTop);\n                    }\n                    else if (point.y >= destTop + (destHeight / 2)) {\n                        point.y = destTop + (destTop + destHeight - point.y);\n                    }\n                    point.ratioX = (point.x - destLeft) / destWidth;\n                    point.ratioY = (point.y - destTop) / destHeight;\n                }\n                parent.pointColl[n].shapeFlip = parent.transform.currFlipState;\n            }\n        }\n        for (var n = 0; n < parent.freehandCounter; n++) {\n            if (this.selPointColl[n]) {\n                if (this.selPointColl[n].shapeFlip !== parent.transform.currFlipState) {\n                    this.selPoints = extend([], this.selPointColl[n].points, []);\n                    this.pointCounter = 0;\n                    var len = this.selPoints.length;\n                    for (var l = 0; l < len; l++) {\n                        var point = this.selPoints[l];\n                        if (point.y <= destTop + (destHeight / 2)) {\n                            point.y = (destTop + destHeight) - (point.y - destTop);\n                        }\n                        else if (point.y >= destTop + (destHeight / 2)) {\n                            point.y = destTop + (destTop + destHeight - point.y);\n                        }\n                        point.ratioX = (point.x - destLeft) / destWidth;\n                        point.ratioY = (point.y - destTop) / destHeight;\n                    }\n                }\n            }\n        }\n        this.updateFHDCurPts();\n    };\n    FreehandDrawing.prototype.updateFHDColl = function (isPreventApply) {\n        var parent = this.parent;\n        var destPoints = { startX: parent.img.destLeft, startY: parent.img.destTop,\n            width: parent.img.destWidth, height: parent.img.destHeight };\n        parent.notify('shape', { prop: 'straightenShapes', onPropertyChange: false });\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        for (var i = 0, iLen = parent.objColl.length; i < iLen; i++) {\n            var currObj = parent.objColl[i];\n            if (currObj.shape === 'line' || currObj.shape === 'arrow') {\n                parent.notify('shape', { prop: 'straightenShapePoints', value: { obj: currObj, isReverse: true } });\n            }\n            else if (currObj.shape === 'path') {\n                var temp = parent.transform.straighten;\n                parent.transform.straighten = -parent.transform.straighten;\n                parent.notify('shape', { prop: 'straightenPath', onPropertyChange: false, value: { obj: currObj } });\n                parent.transform.straighten = temp;\n            }\n            currObj.imageRatio = { startX: ((currObj.activePoint.startX - destLeft) /\n                    destWidth), startY: ((currObj.activePoint.startY - destTop) / destHeight),\n                endX: ((currObj.activePoint.endX - destLeft) / destWidth),\n                endY: ((currObj.activePoint.endY - destTop) / destHeight),\n                width: destWidth / currObj.activePoint.width, height: destHeight /\n                    currObj.activePoint.height };\n            if (currObj.shape === 'path') {\n                for (var j = 0, jLen = currObj.pointColl.length; j < jLen; j++) {\n                    currObj.pointColl[j].ratioX =\n                        (currObj.pointColl[j].x - destLeft) / destWidth;\n                    currObj.pointColl[j].ratioY =\n                        (currObj.pointColl[j].y - destTop) / destHeight;\n                }\n            }\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        }\n        if (parent.freehandCounter > 0 && parent.transform.straighten !== 0) {\n            var temp = parent.transform.straighten;\n            parent.transform.straighten = -parent.transform.straighten;\n            parent.notify('shape', { prop: 'straightenFHD', onPropertyChange: false });\n            parent.transform.straighten = temp;\n        }\n        for (var n = 0; n < parent.freehandCounter; n++) {\n            parent.points = extend([], parent.pointColl[n].points, []);\n            this.pointCounter = 0;\n            var len = parent.points.length;\n            for (var l = 0; l < len; l++) {\n                var point = parent.points[l];\n                point.ratioX = (point.x - destLeft) / destWidth;\n                point.ratioY = (point.y - destTop) / destHeight;\n            }\n        }\n        for (var n = 0; n < parent.freehandCounter; n++) {\n            if (this.selPointColl[n]) {\n                this.selPoints = extend([], this.selPointColl[n].points, []);\n                this.pointCounter = 0;\n                var len = this.selPoints.length;\n                for (var l = 0; l < len; l++) {\n                    var point = this.selPoints[l];\n                    point.ratioX = (point.x - destLeft) / destWidth;\n                    point.ratioY = (point.y - destTop) / destHeight;\n                }\n            }\n        }\n        if (this.straightenPoint.x && this.straightenPoint.y) {\n            this.straightenPoint.ratioX = (this.straightenPoint.x - destLeft) / destWidth;\n            this.straightenPoint.ratioY = (this.straightenPoint.y - destTop) / destHeight;\n        }\n        parent.img.destLeft = destPoints.startX;\n        parent.img.destTop = destPoints.startY;\n        parent.img.destWidth = destPoints.width;\n        parent.img.destHeight = destPoints.height;\n        parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n            value: { ctx: this.lowerContext, shape: 'zoom', pen: 'zoom', isPreventApply: isPreventApply } });\n    };\n    FreehandDrawing.prototype.panFHDColl = function (xDiff, yDiff, panRegion) {\n        var parent = this.parent;\n        for (var n = 0; n < parent.freehandCounter; n++) {\n            parent.points = extend([], parent.pointColl[n].points, []);\n            this.pointCounter = 0;\n            var len = parent.points.length;\n            for (var l = 0; l < len; l++) {\n                var point = parent.points[l];\n                if (panRegion === '' || panRegion === 'vertical') {\n                    point.x += xDiff;\n                }\n                else {\n                    point.x -= xDiff;\n                }\n                if (panRegion === '' || panRegion === 'horizontal') {\n                    point.y += yDiff;\n                }\n                else {\n                    point.y -= yDiff;\n                }\n            }\n        }\n        for (var n = 0; n < parent.freehandCounter; n++) {\n            if (this.selPointColl[n]) {\n                this.selPoints = extend([], this.selPointColl[n].points, []);\n                this.pointCounter = 0;\n                var len = this.selPoints.length;\n                for (var l = 0; l < len; l++) {\n                    var point = this.selPoints[l];\n                    if (panRegion === '' || panRegion === 'vertical') {\n                        point.x += xDiff;\n                    }\n                    else {\n                        point.x -= xDiff;\n                    }\n                    if (panRegion === '' || panRegion === 'horizontal') {\n                        point.y += yDiff;\n                    }\n                    else {\n                        point.y -= yDiff;\n                    }\n                }\n            }\n        }\n        if (this.straightenPoint.x && this.straightenPoint.y) {\n            if (panRegion === '' || panRegion === 'vertical') {\n                this.straightenPoint.x += xDiff;\n            }\n            else {\n                this.straightenPoint.x -= xDiff;\n            }\n            if (panRegion === '' || panRegion === 'horizontal') {\n                this.straightenPoint.y += yDiff;\n            }\n            else {\n                this.straightenPoint.y -= yDiff;\n            }\n        }\n        this.freehandRedraw(this.lowerContext, null);\n    };\n    FreehandDrawing.prototype.freeHandDraw = function (value) {\n        var parent = this.parent;\n        if (value) {\n            parent.points = [];\n            this.dummyPoints = [];\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            parent.togglePen = true;\n            parent.upperCanvas.style.cursor = parent.cursor = 'crosshair';\n            parent.upperCanvas.style.display = 'block';\n            if (isNullOrUndefined(parent.activeObj.strokeSettings)) {\n                var obj = { strokeSettings: {} };\n                parent.notify('shape', { prop: 'getStrokeSettings', onPropertyChange: false,\n                    value: { obj: obj } });\n                parent.activeObj.strokeSettings = obj['strokeSettings'];\n            }\n            if (isNullOrUndefined(parent.activeObj.strokeSettings.strokeWidth)) {\n                parent.activeObj.strokeSettings.strokeWidth = 2;\n            }\n            if (parent.isMaskImage) {\n                parent.notify('toolbar', { prop: 'refresh-main-toolbar', onPropertyChange: false });\n            }\n            else {\n                parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'pen',\n                        isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n            }\n        }\n        else {\n            parent.upperCanvas.style.cursor = parent.cursor = 'default';\n            var strokeWidth = this.penStrokeWidth;\n            parent.notify('shape', { prop: 'apply', onPropertyChange: false, value: { shape: null, obj: null, canvas: null } });\n            parent.notify('toolbar', { prop: 'refresh-main-toolbar', onPropertyChange: false });\n            parent.notify('toolbar', { prop: 'setCurrentToolbar', value: { type: 'main' } });\n            parent.notify('selection', { prop: 'setFreehandDrawCustomized', value: { isFreehandDrawCustomized: false } });\n            this.penStrokeWidth = strokeWidth;\n        }\n    };\n    FreehandDrawing.prototype.isFHDIdx = function (index, obj) {\n        var isIndex = false;\n        for (var i = 0; i < this.parent.freehandCounter; i++) {\n            if (this.parent.pointColl[i].id &&\n                parseInt(this.parent.pointColl[i].id.split('_')[1], 10) - 1 === index) {\n                isIndex = true;\n                break;\n            }\n        }\n        if (obj) {\n            obj['isIndex'] = isIndex;\n        }\n        return isIndex;\n    };\n    FreehandDrawing.prototype.updateCropPtsForSel = function () {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        for (var n = 0; n < parent.freehandCounter; n++) {\n            var obj = { selPointColl: extend([], this.selPointColl) };\n            if (obj['selPointColl'][n]) {\n                this.selPoints = extend([], obj['selPointColl'][n].points, []);\n                this.pointCounter = 0;\n                var len = this.selPoints.length;\n                for (var l = 0; l < len; l++) {\n                    var point = this.selPoints[l];\n                    point.ratioX = (point.x - actPoint.startX) / actPoint.width;\n                    point.ratioY = (point.y - actPoint.startY) / actPoint.height;\n                }\n            }\n        }\n    };\n    FreehandDrawing.prototype.triggerShapeChanging = function (shapeChangingArgs) {\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var parent = this.parent;\n        var point = parent.pointColl[this.fhdSelIdx];\n        parent.trigger('shapeChanging', shapeChangingArgs);\n        if (parent.element.getAttribute('data-value') === 'mask-drawing' && !this.isMasking) {\n            this.isMasking = true;\n            parent.upperCanvas.style.cursor = 'crosshair';\n            parent.notify('draw', { prop: 'updateTempObjColl' });\n            parent.notify('draw', { prop: 'updateTempPointColl' });\n            parent.discard();\n            parent.selectMaskImage();\n            return;\n        }\n        parent.editCompleteArgs = shapeChangingArgs;\n        if (shapeChangingArgs.currentShapeSettings.id.indexOf('pen_') === -1 &&\n            (shapeChangingArgs.action === 'draw-end' || shapeChangingArgs.action === 'select')) {\n            var id = 'pen_' + shapeChangingArgs.currentShapeSettings.id;\n            if (this.fhdSelIdx) {\n                parent.pointColl[this.fhdSelIdx].id = id;\n            }\n            else {\n                parent.pointColl[parent.freehandCounter - 1].id = id;\n            }\n        }\n        this.penStrokeWidth = shapeChangingArgs.currentShapeSettings.strokeWidth;\n        if (parent.activeObj.strokeSettings.strokeColor !== shapeChangingArgs.currentShapeSettings.strokeColor) {\n            parent.activeObj.strokeSettings.strokeColor = shapeChangingArgs.currentShapeSettings.strokeColor;\n            parent.notify('toolbar', { prop: 'update-toolbar-items', onPropertyChange: false });\n        }\n        if (this.fhdSelID && point && shapeChangingArgs.currentShapeSettings) {\n            point.strokeColor = shapeChangingArgs.currentShapeSettings.strokeColor;\n            point.strokeWidth = shapeChangingArgs.currentShapeSettings.strokeWidth;\n            point.points = shapeChangingArgs.currentShapeSettings.points;\n            point.opacity = shapeChangingArgs.currentShapeSettings.opacity;\n        }\n        if (shapeChangingArgs.action === 'select') {\n            this.freehandRedraw(this.upperContext);\n            parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'pen',\n                    isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n        }\n    };\n    FreehandDrawing.prototype.setCenterSelPoints = function () {\n        var parent = this.parent;\n        var destPoints = { startX: parent.img.destLeft, startY: parent.img.destTop,\n            width: parent.img.destWidth, height: parent.img.destHeight };\n        parent.notify('shape', { prop: 'straightenShapes', onPropertyChange: false });\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        var actPoint = parent.activeObj.activePoint;\n        if (isNullOrUndefined(this.prevStraightenObj) ||\n            (JSON.stringify(this.prevStraightenObj.activePoint) !== JSON.stringify(actPoint))) {\n            this.straightenPoint = { x: actPoint.startX + (actPoint.width / 2),\n                y: actPoint.startY + (actPoint.height / 2),\n                ratioX: (actPoint.startX + (actPoint.width / 2) - destLeft) / destWidth,\n                ratioY: (actPoint.startY + (actPoint.height / 2) - destTop) / destHeight };\n            this.prevStraightenObj = extend({}, parent.activeObj, {}, true);\n            this.straightenPointAngle = parent.transform.straighten;\n        }\n        parent.img.destLeft = destPoints.startX;\n        parent.img.destTop = destPoints.startY;\n        parent.img.destWidth = destPoints.width;\n        parent.img.destHeight = destPoints.height;\n    };\n    return FreehandDrawing;\n}());\nexport { FreehandDrawing };\n","/* eslint-disable prefer-const */\nimport { Browser, EventHandler, extend, getComponent, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { ArrowheadType, ShapeType, ZoomTrigger } from '../index';\nvar Selection = /** @class */ (function () {\n    function Selection(parent) {\n        this.diffPoint = { x: 0, y: 0 }; // updates resize points\n        this.oldPoint = {};\n        this.isTouch = false;\n        this.isObjSelected = false;\n        this.isFhdPoint = false; // Specifies whether mouse cursor is on freehand drawing point or not\n        this.dragPoint = { startX: 0, startY: 0, endX: 0, endY: 0 }; // updates drag start and end points in mousedown and mousemove\n        this.isShapeInserted = false;\n        this.tempActiveObj = { activePoint: { startX: 0, startY: 0, endX: 0, endY: 0, width: 0, height: 0 },\n            flipObjColl: [], triangle: [], triangleRatio: [], order: null }; // for undo redo\n        this.isFirstMove = false; // for pinch zoom\n        this.startTouches = []; // for pinch zoom\n        this.tempTouches = []; // for pinch zoom\n        this.currMousePoint = { x: 0, y: 0 }; // To prevent mouse move event on pinch zoom\n        this.cursorTargetId = '';\n        this.isPreventDragging = false; // Shapes dragging is prevented when crop region is inside shape points\n        this.dragElement = '';\n        this.textRow = 1; // text area row count\n        this.mouseDownPoint = { x: 0, y: 0 };\n        this.previousPoint = { x: 0, y: 0 }; // updates prev x and y points in mouseMove\n        this.zoomType = 'Toolbar';\n        this.isInitialTextEdited = false;\n        this.dragCanvas = false;\n        this.isFhdCustomized = false;\n        this.touchEndPoint = {};\n        this.isFhdEditing = false; // Specifies whether freehand drawing is in editing mode or not\n        this.currentDrawingShape = '';\n        this.initialPrevObj = {};\n        this.touchTime = 0;\n        this.resizedElement = '';\n        this.isImageClarity = true;\n        this.isPinching = false;\n        this.isSliding = false;\n        this.mouseDown = '';\n        this.isSliderActive = false;\n        this.arrowShape = [ArrowheadType.None, ArrowheadType.SolidArrow];\n        this.isTouchDblClick = false;\n        this.isMouseDown = false;\n        this.isMouseUp = false;\n        this.mouseWheel = 0;\n        this.parent = parent;\n        this.addEventListener();\n    }\n    Selection.prototype.destroy = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.removeEventListener();\n    };\n    Selection.prototype.addEventListener = function () {\n        this.parent.on('selection', this.selection, this);\n        this.parent.on('destroyed', this.destroy, this);\n    };\n    Selection.prototype.removeEventListener = function () {\n        this.parent.off('selection', this.selection);\n        this.parent.off('destroyed', this.destroy);\n    };\n    Selection.prototype.selection = function (args) {\n        var parent = this.parent;\n        this.updatePrivateVariables();\n        switch (args.prop) {\n            case 'setCursor':\n                this.setCursor(args.value['x'], args.value['y']);\n                break;\n            case 'updateActivePoint':\n                this.updateActivePoint(args.value['x'], args.value['y'], args.value['isCropSelection']);\n                break;\n            case 'updateCursorStyles':\n                this.updateCursorStyles(args.value['x'], args.value['y'], args.value['type']);\n                break;\n            case 'setTextSelection':\n                this.setTextSelection(args.value['width'], args.value['height']);\n                break;\n            case 'setActivePoint':\n                this.setActivePoint(args.value['startX'], args.value['startY']);\n                break;\n            case 'clearSelection':\n                this.clearSelection(args.value['resetCrop']);\n                break;\n            case 'calcShapeRatio':\n                this.calcShapeRatio(args.value['x'], args.value['y'], args.value['imgWidth'], args.value['imgHeight']);\n                break;\n            case 'tab':\n                this.performTabAction();\n                break;\n            case 'setDragDirection':\n                this.setDragDirection(args.value['width'], args.value['height']);\n                break;\n            case 'clearUpperCanvas':\n                if (this.isTouch) {\n                    setTimeout(function () {\n                        parent.upperCanvas.getContext('2d').clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                    }, 550);\n                }\n                break;\n            case 'resetFreehandDrawVariables':\n                this.isFhdEditing = this.isFhdPoint = false;\n                break;\n            case 'isShapeInserted':\n                this.isShapeInserted = args.value['bool'];\n                break;\n            case 'redrawShape':\n                this.redrawShape(args.value['obj']);\n                break;\n            case 'setTextBoxStylesToActObj':\n                this.setTextBoxStylesToActObj();\n                break;\n            case 'mouseDownEventHandler':\n                this.mouseDownEventHandler(args.value['e']);\n                break;\n            case 'mouseMoveEventHandler':\n                this.mouseMoveEventHandler(args.value['e']);\n                break;\n            case 'mouseUpEventHandler':\n                this.mouseUpEventHandler(args.value['e']);\n                break;\n            case 'canvasMouseDownHandler':\n                this.canvasMouseDownHandler(args.value['e']);\n                break;\n            case 'canvasMouseMoveHandler':\n                this.canvasMouseMoveHandler(args.value['e']);\n                break;\n            case 'canvasMouseUpHandler':\n                this.canvasMouseUpHandler(args.value['e']);\n                break;\n            case 'touchStartHandler':\n                this.touchStartHandler(args.value['e']);\n                break;\n            case 'keyDownEventHandler':\n                this.keyDownEventHandler(args.value['e']);\n                break;\n            case 'handleScroll':\n                this.handleScroll(args.value['e']);\n                break;\n            case 'textKeyDown':\n                setTimeout(this.textKeyDown.bind(this), 1, args.value['e']);\n                break;\n            case 'deleteItem':\n                this.deleteItem();\n                break;\n            case 'updatePrevShapeSettings':\n                this.updatePrevShapeSettings(args.value['obj']);\n                break;\n            case 'getZoomType':\n                args.value['obj']['zoomType'] = this.zoomType;\n                break;\n            case 'setZoomType':\n                this.zoomType = args.value['zoomType'];\n                break;\n            case 'setInitialTextEdit':\n                this.isInitialTextEdited = args.value['bool'];\n                break;\n            case 'setDragCanvas':\n                this.dragCanvas = args.value['bool'];\n                break;\n            case 'setFreehandDrawCustomized':\n                this.isFhdCustomized = args.value['isFreehandDrawCustomized'];\n                break;\n            case 'setTouchEndPoint':\n                this.touchEndPoint.x = args.value['x'];\n                this.touchEndPoint.y = args.value['y'];\n                break;\n            case 'getPanDown':\n                args.value['obj']['panDown'] = this.panDown;\n                break;\n            case 'setPanDown':\n                this.panDown = args.value['panDown'];\n                break;\n            case 'getFreehandDrawEditing':\n                args.value['obj']['bool'] = this.isFhdEditing;\n                break;\n            case 'setFreehandDrawEditing':\n                this.isFhdEditing = args.value['bool'];\n                break;\n            case 'getTempActObj':\n                args.value['obj']['tempObj'] = this.tempActiveObj;\n                break;\n            case 'setTempActObj':\n                this.tempActiveObj = args.value['obj'];\n                break;\n            case 'isInside':\n                this.isInside(args.value['x'], args.value['y'], args.value['z1'], args.value['z2'], args.value['z3'], args.value['z4']);\n                break;\n            case 'setDragElement':\n                this.dragElement = args.value['value'];\n                break;\n            case 'setObjSelected':\n                this.isObjSelected = args.value['bool'];\n                break;\n            case 'adjustActObjForLineArrow':\n                this.adjustActObjForLineArrow(args.value['obj']);\n                break;\n            case 'findTarget':\n                this.findTarget(args.value['x'], args.value['y'], args.value['type']);\n                break;\n            case 'getCurrentFlipState':\n                this.getCurrentFlipState();\n                break;\n            case 'setDragWidth':\n                this.setDragWidth(args.value['width']);\n                break;\n            case 'setDragHeight':\n                this.setDragHeight(args.value['setDragHeight']);\n                break;\n            case 'annotate':\n                this.currentDrawingShape = args.value['shape'];\n                if (args.value['shape'] === 'text') {\n                    parent.activeObj.textSettings.fontSize = 11;\n                    parent.activeObj.keyHistory = 'Enter Text';\n                    parent.notify('shape', { prop: 'initializeTextShape', onPropertyChange: false,\n                        value: { text: null, fontFamily: null, fontSize: null, bold: null, italic: null, strokeColor: null } });\n                }\n                else if (args.value['shape'] === 'path') {\n                    parent.activeObj.pointColl = [];\n                }\n                break;\n            case 'getCurrentDrawingShape':\n                args.value['obj']['shape'] = this.currentDrawingShape;\n                break;\n            case 'setCurrentDrawingShape':\n                this.currentDrawingShape = args.value['value'];\n                break;\n            case 'getTransRotationPoint':\n                this.getTransRotationPoint(args.value['obj'], args.value['object']);\n                break;\n            case 'adjustNEPoints':\n                this.adjustNEPoints(args.value['rectangle'], args.value['x'], args.value['y'], args.value['angle']);\n                break;\n            case 'adjustRotationPoints':\n                this.adjustRotationPoints(args.value['rectangle'], args.value['x'], args.value['y'], args.value['angle'], args.value['type'], args.value['elem']);\n                break;\n            case 'getResizeDirection':\n                this.getResizeDirection(args.value['rectangle'], args.value['x'], args.value['y'], args.value['angle']);\n                break;\n            case 'setResizedElement':\n                this.resizedElement = args.value['value'];\n                break;\n            case 'reset':\n                this.reset();\n                break;\n            case 'unWireEvent':\n                this.unwireEvent();\n                break;\n            case 'updPtCollForShpRot':\n                this.updPtCollForShpRot(args.value['obj']);\n                break;\n            case 'findImageRatio':\n                this.findImageRatio(args.value['width'], args.value['height'], args.value['obj']);\n                break;\n            case 'getNumTextValue':\n                this.getNumTextValue(args.value['obj']);\n                break;\n            case 'setImageClarity':\n                this.isImageClarity = args.value['bool'];\n                break;\n            case 'upgradeImageQuality':\n                this.upgradeImageQuality();\n                break;\n            case 'triggerShapeChange':\n                this.triggerShapeChange(args.value['shapeResizingArgs'], args.value['shapeMovingArgs'], args.value['type']);\n                break;\n            case 'applyTransformToImg':\n                this.applyTransformToImg(args.value['ctx']);\n                break;\n            case 'findTargetObj':\n                args.value['obj']['bool'] = this.findTargetObj(args.value['x'], args.value['y'], args.value['isCrop']);\n                break;\n            case 'setSliding':\n                this.isSliding = args.value['bool'];\n                break;\n            case 'setSliderActive':\n                this.isSliderActive = args.value['bool'];\n                break;\n            case 'getArrowType':\n                args.value['obj']['type'] = this.getArrowType(args.value['type']);\n                break;\n            case 'setArrowShape':\n                if (args.value['type'] === 'initial') {\n                    this.arrowShape[0] = args.value['shape'];\n                }\n                else {\n                    this.arrowShape[1] = args.value['shape'];\n                }\n                break;\n            case 'updateNWPoints':\n                this.updateNWPoints(args.value['x'], args.value['y']);\n                break;\n            case 'updateNPoints':\n                this.updateNPoints(args.value['x'], args.value['y']);\n                break;\n            case 'updateNEPoints':\n                this.updateNEPoints(args.value['x'], args.value['y']);\n                break;\n            case 'updateWPoints':\n                this.updateWPoints(args.value['x'], args.value['y']);\n                break;\n            case 'updateEPoints':\n                this.updateEPoints(args.value['x'], args.value['y']);\n                break;\n            case 'updateSWPoints':\n                this.updateSWPoints(args.value['x'], args.value['y']);\n                break;\n            case 'updateSPoints':\n                this.updateSPoints(args.value['x'], args.value['y']);\n                break;\n            case 'updateSEPoints':\n                this.updateSEPoints(args.value['x'], args.value['y']);\n                break;\n            case 'drawMaskCircle':\n                this.drawMaskCircle(args.value['x'], args.value['y']);\n                break;\n            case 'isValueUpdated':\n                this.isValueUpdated();\n                break;\n            case 'getDistance':\n                this.getDistance(args.value['x'], args.value['y']);\n                break;\n            case 'redact':\n                this.currentDrawingShape = args.value['shape'];\n                break;\n        }\n    };\n    Selection.prototype.getModuleName = function () {\n        return 'selection';\n    };\n    Selection.prototype.updatePrivateVariables = function () {\n        var parent = this.parent;\n        if (parent.lowerCanvas) {\n            this.lowerContext = parent.lowerCanvas.getContext('2d');\n        }\n        if (parent.upperCanvas) {\n            this.upperContext = parent.upperCanvas.getContext('2d');\n        }\n    };\n    Selection.prototype.reset = function () {\n        this.diffPoint = { x: 0, y: 0 };\n        this.oldPoint = {};\n        this.isTouch = this.isObjSelected = this.isFhdPoint = this.isShapeInserted = false;\n        this.dragPoint = { startX: 0, startY: 0, endX: 0, endY: 0 };\n        this.tempActiveObj = { activePoint: { startX: 0, startY: 0, endX: 0, endY: 0, width: 0, height: 0 },\n            flipObjColl: [], triangle: [], triangleRatio: [], order: null };\n        this.isFirstMove = false;\n        this.cursorTargetId = this.dragElement = '';\n        this.isTouchDblClick = false;\n        this.startTouches = [];\n        this.tempTouches = [];\n        this.currMousePoint = { x: 0, y: 0 };\n        this.isPreventDragging = false;\n        this.timer = undefined;\n        this.tempObjColl = undefined;\n        this.mouseWheel = 0;\n        this.textRow = 1;\n        this.mouseDownPoint = { x: 0, y: 0 };\n        this.previousPoint = { x: 0, y: 0 };\n        this.zoomType = 'Toolbar';\n        this.isInitialTextEdited = false;\n        this.dragCanvas = this.isPinching = false;\n        this.isFhdCustomized = false;\n        this.touchEndPoint = {};\n        this.panDown = null;\n        this.isSliding = false;\n        this.isFhdEditing = false;\n        this.pathAdjustedIndex = null;\n        this.touchTime = 0;\n        this.isImageClarity = true;\n        this.currentDrawingShape = '';\n        this.initialPrevObj = {};\n        this.resizedElement = '';\n        this.mouseDown = '';\n        this.isSliderActive = false;\n        this.arrowShape = [ArrowheadType.None, ArrowheadType.SolidArrow];\n        this.isMouseDown = this.isMouseUp = false;\n    };\n    Selection.prototype.performTabAction = function () {\n        var parent = this.parent;\n        if (parent.textArea.style.display === 'block' || parent.textArea.style.display === 'inline-block') {\n            var allowUndoRedoPush = this.applyCurrShape(false);\n            parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n                value: { x: null, y: null, isMouseDown: null } });\n            if (allowUndoRedoPush) {\n                parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n            }\n        }\n        parent.isKBDNavigation = true;\n    };\n    Selection.prototype.selMouseUpEvent = function () {\n        this.oldPoint.x = undefined;\n        this.oldPoint.y = undefined;\n    };\n    Selection.prototype.getMouseCursor = function (actObj, x, y, isCropSelection, isApply) {\n        var rotationCirclePoint = this.getTransRotationPoint(actObj);\n        var radius = actObj.bottomCenterCircle.radius;\n        var cursor = 'default';\n        var ratio = isApply ? 0 : ((actObj.topLeftCircle.radius * 2));\n        if (x >= (actObj.topLeftCircle.startX - ratio) &&\n            x <= (actObj.topLeftCircle.startX + ratio) &&\n            y >= (actObj.topLeftCircle.startY - ratio) &&\n            y <= (actObj.topLeftCircle.startY + ratio)) {\n            cursor = 'nw-resize';\n        }\n        else if (x >= (actObj.topLeftCircle.startX - ratio) &&\n            x <= (actObj.topRightCircle.startX - ratio) &&\n            y >= (actObj.topCenterCircle.startY - ratio) &&\n            y <= (actObj.topCenterCircle.startY + ratio)) {\n            cursor = 'n-resize';\n        }\n        else if (x >= (actObj.topRightCircle.startX - ratio) &&\n            x <= (actObj.topRightCircle.startX + ratio) &&\n            y >= (actObj.topRightCircle.startY - ratio) &&\n            y <= (actObj.topRightCircle.startY + ratio)) {\n            cursor = 'ne-resize';\n        }\n        else if (x >= (actObj.centerLeftCircle.startX - ratio) &&\n            x <= (actObj.centerLeftCircle.startX + ratio) &&\n            y >= (actObj.topLeftCircle.startY - ratio) &&\n            y <= (actObj.bottomLeftCircle.startY - ratio)) {\n            cursor = 'w-resize';\n        }\n        else if (x >= (actObj.centerRightCircle.startX - ratio) &&\n            x <= (actObj.centerRightCircle.startX + ratio) &&\n            y >= (actObj.topRightCircle.startY - ratio) &&\n            y <= (actObj.bottomRightCircle.startY - ratio)) {\n            cursor = 'e-resize';\n        }\n        else if (x >= (actObj.bottomLeftCircle.startX - ratio) &&\n            x <= (actObj.bottomLeftCircle.startX + ratio) &&\n            y >= (actObj.bottomLeftCircle.startY - ratio) &&\n            y <= (actObj.bottomLeftCircle.startY + ratio)) {\n            cursor = 'sw-resize';\n        }\n        else if (x >= (actObj.bottomLeftCircle.startX - ratio) &&\n            x <= (actObj.bottomRightCircle.startX - ratio) &&\n            y >= (actObj.bottomCenterCircle.startY - ratio) &&\n            y <= (actObj.bottomCenterCircle.startY + ratio)) {\n            cursor = 's-resize';\n        }\n        else if (x >= (actObj.bottomRightCircle.startX - ratio) &&\n            x <= (actObj.bottomRightCircle.startX + ratio) &&\n            y >= (actObj.bottomRightCircle.startY - ratio) &&\n            y <= (actObj.bottomRightCircle.startY + ratio)) {\n            cursor = 'se-resize';\n        }\n        else if ((x >= actObj.activePoint.startX &&\n            x <= actObj.activePoint.endX) && (y >= actObj.activePoint.startY &&\n            y <= actObj.activePoint.endY)) {\n            if (isCropSelection) {\n                cursor = 'grab';\n            }\n            else {\n                cursor = 'move';\n            }\n        }\n        else if (rotationCirclePoint && !isApply &&\n            x >= (rotationCirclePoint.x - (radius + 2)) &&\n            x <= rotationCirclePoint.x + (radius + 2) &&\n            y >= rotationCirclePoint.y - (radius + 2) &&\n            y <= rotationCirclePoint.y + (radius + 2)) {\n            cursor = 'grabbing';\n        }\n        else {\n            cursor = 'default';\n        }\n        return cursor;\n    };\n    Selection.prototype.setCursor = function (x, y) {\n        var parent = this.parent;\n        parent.upperCanvas.style.cursor = parent.cursor = 'default';\n        var frameObject = { bool: null };\n        parent.notify('toolbar', { prop: 'getFrameToolbar', onPropertyChange: false, value: { obj: frameObject } });\n        if (parent.isResize || this.isSliding || frameObject['bool']) {\n            parent.upperCanvas.style.cursor = 'default';\n            return;\n        }\n        var isCropSelection = false;\n        var splitWords;\n        if (parent.activeObj.shape) {\n            splitWords = parent.activeObj.shape.split('-');\n        }\n        if ((!splitWords && parent.currObjType.isCustomCrop) || (splitWords && splitWords[0] === 'crop')) {\n            isCropSelection = true;\n        }\n        if (parent.currObjType.isDragging) {\n            if (this.dragElement === '') {\n                parent.upperCanvas.style.cursor = parent.cursor = 'move';\n            }\n            else {\n                parent.upperCanvas.style.cursor = parent.cursor = this.dragElement;\n            }\n            return;\n        }\n        if (parent.togglePen) {\n            parent.upperCanvas.style.cursor = parent.cursor = 'crosshair';\n            if (parent.isMaskImage) {\n                this.drawMaskCircle(x, y);\n                parent.upperCanvas.style.cursor = 'none';\n            }\n            return;\n        }\n        if (parent.activeObj.shape) {\n            this.setCursorForActObj(splitWords, isCropSelection, x, y);\n        }\n        if (parent.cursor === 'default' || parent.cursor === 'grab') {\n            var highestOrder = this.getHighestOrder();\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            var tempShapeColl = extend([], parent.shapeColl, [], true);\n            var objColl = extend([], parent.objColl, [], true);\n            var isShape = false;\n            while (highestOrder > 0) {\n                isShape = false;\n                for (var i = tempShapeColl.length - 1; i >= 0; i--) {\n                    if (tempShapeColl[i].order === highestOrder) {\n                        isShape = true;\n                        if (tempShapeColl[i].id && tempShapeColl[i].id.indexOf('pen') > -1) {\n                            if (parent.pointColl[0] && (parent.cursor !== 'grab' || !isCropSelection)\n                                && !parent.currObjType.isDragging && !parent.currObjType.isResize) {\n                                var points = extend([], parent.points, [], true);\n                                if (!isCropSelection) {\n                                    this.setCursorForFreehandDrawing(x, y, parent.upperCanvas, tempShapeColl[i].id);\n                                }\n                                parent.points = points;\n                            }\n                        }\n                        else {\n                            parent.objColl = [];\n                            parent.objColl.push(extend({}, tempShapeColl[i], null, true));\n                            var cursor = parent.upperCanvas.style.cursor;\n                            if (parent.objColl.length > 0 && (parent.cursor !== 'grab' || !isCropSelection)) {\n                                this.setCursorFromObj(x, y, parent.objColl, parent.upperCanvas, isCropSelection);\n                            }\n                            if (cursor === 'grab' && parent.cursor === 'default') {\n                                parent.upperCanvas.style.cursor = parent.cursor = 'grab';\n                            }\n                        }\n                    }\n                    else if (isNullOrUndefined(tempShapeColl[i].order)) {\n                        isShape = true;\n                    }\n                }\n                if (parent.cursor !== 'default' && parent.cursor !== 'grab') {\n                    break;\n                }\n                else if (isShape) {\n                    var isBreak = false;\n                    while (!isBreak && highestOrder > 0) {\n                        for (var a = 0; a < tempShapeColl.length; a++) {\n                            if (tempShapeColl[a].order === highestOrder - 1) {\n                                isBreak = true;\n                                break;\n                            }\n                        }\n                        highestOrder--;\n                        if (!isBreak) {\n                            highestOrder--;\n                        }\n                    }\n                }\n            }\n            parent.objColl = objColl;\n            if (parent.cursor === 'default' || parent.cursor === 'grab') {\n                if (parent.togglePan) {\n                    parent.lowerCanvas.style.cursor = parent.upperCanvas.style.cursor = parent.cursor = 'grab';\n                }\n            }\n        }\n        if (this.currentDrawingShape !== '' && (parent.cursor === 'default' || parent.cursor === 'grab')) {\n            parent.upperCanvas.style.cursor = parent.cursor = 'crosshair';\n        }\n    };\n    Selection.prototype.getHighestOrder = function () {\n        var highestOrder = 0;\n        for (var i = 0; i < this.parent.shapeColl.length; i++) {\n            if (this.parent.shapeColl[i].order > highestOrder) {\n                highestOrder = this.parent.shapeColl[i].order;\n            }\n        }\n        return highestOrder;\n    };\n    Selection.prototype.drawMaskCircle = function (x, y) {\n        var parent = this.parent;\n        if (parent.isMaskImage) {\n            var radius = parent.activeObj.strokeSettings.strokeWidth * 2;\n            var canvasDraw = parent.maskCanvas.getContext('2d');\n            canvasDraw.clearRect(0, 0, parent.maskCanvas.width, parent.maskCanvas.height);\n            canvasDraw.fillStyle = parent.activeObj.strokeSettings.strokeColor;\n            canvasDraw.strokeStyle = '#fff';\n            canvasDraw.beginPath();\n            canvasDraw.ellipse(x, y, radius / 2, radius / 2, 0, 0, 2 * Math.PI, false);\n            canvasDraw.fill();\n            canvasDraw.stroke();\n            canvasDraw.closePath();\n            parent.maskCanvas.style.cursor = 'none';\n        }\n    };\n    Selection.prototype.setCursorForActObj = function (splitWords, isCropSelection, x, y) {\n        var parent = this.parent;\n        if (parent.activeObj.horTopLine !== undefined) {\n            if (parent.activeObj.shape !== undefined) {\n                splitWords = parent.activeObj.shape.split('-');\n            }\n            if (splitWords === undefined && parent.currObjType.isCustomCrop) {\n                isCropSelection = true;\n            }\n            else if (splitWords !== undefined && splitWords[0] === 'crop') {\n                isCropSelection = true;\n            }\n            if (!isCropSelection && parent.togglePan) {\n                parent.lowerCanvas.style.cursor = parent.upperCanvas.style.cursor = parent.cursor = 'grab';\n            }\n            var cursor = parent.upperCanvas.style.cursor;\n            var actObj = extend({}, parent.activeObj, {}, true);\n            this.cursorTargetId = actObj.currIndex;\n            var degree = void 0;\n            if (actObj.shapeDegree === 0) {\n                degree = parent.transform.degree;\n            }\n            else {\n                degree = parent.transform.degree - actObj.shapeDegree;\n            }\n            if (degree < 0) {\n                degree = 360 + degree;\n            }\n            if (actObj.shape === 'line' || actObj.shape === 'arrow') {\n                this.setCursorForLineArrow(actObj, x, y, parent.upperCanvas);\n            }\n            else if (actObj.shape === 'path') {\n                this.setCursorForPath(actObj, x, y, parent.upperCanvas);\n            }\n            else if (!isNullOrUndefined(actObj.rotatedAngle) && actObj.rotatedAngle !== 0) {\n                this.setCursorForRotatedObject(actObj, x, y, parent.upperCanvas);\n            }\n            else {\n                parent.upperCanvas.style.cursor = parent.cursor = this.getMouseCursor(actObj, x, y, isCropSelection, false);\n                var cursorColl = ['n-resize', 's-resize', 'e-resize', 'w-resize'];\n                if ((actObj.shape === 'text') && cursorColl.indexOf(parent.cursor) > -1) {\n                    parent.upperCanvas.style.cursor = parent.cursor = 'move';\n                }\n            }\n            if (cursor === 'default' && parent.cursor === 'default' && isCropSelection) {\n                parent.upperCanvas.style.cursor = parent.cursor = 'grab';\n            }\n            if (cursor === 'grab' && parent.cursor === 'default') {\n                parent.upperCanvas.style.cursor = parent.cursor = 'grab';\n            }\n        }\n        else if (parent.togglePan && !parent.togglePen) {\n            parent.lowerCanvas.style.cursor = parent.upperCanvas.style.cursor = parent.cursor = 'grab';\n        }\n        else {\n            if (parent.currObjType.isCustomCrop || parent.togglePen) {\n                parent.upperCanvas.style.cursor = parent.cursor = 'crosshair';\n            }\n            else {\n                parent.upperCanvas.style.cursor = parent.cursor = 'default';\n            }\n        }\n    };\n    Selection.prototype.setCursorForPath = function (actObj, x, y, upperCanvas) {\n        this.setCursorForLineArrow(actObj, x, y, upperCanvas);\n        var parent = this.parent;\n        if (parent.cursor === 'default') {\n            var obj = extend({}, actObj, null, true);\n            var isMove = false;\n            for (var i = 1, len = actObj.pointColl.length; i < len; i++) {\n                if (isMove) {\n                    break;\n                }\n                obj.activePoint.startX = actObj.pointColl[i - 1].x;\n                obj.activePoint.startY = actObj.pointColl[i - 1].y;\n                obj.activePoint.endX = actObj.pointColl[i].x;\n                obj.activePoint.endY = actObj.pointColl[i].y;\n                parent.notify('shape', { prop: 'setPointCollForLineArrow', onPropertyChange: false,\n                    value: { obj: obj } });\n                var radius = actObj.topLeftCircle.radius;\n                for (var j = 0, jLen = obj.pointColl.length; j < jLen; j++) {\n                    var point = obj.pointColl[j];\n                    if (!isNullOrUndefined(point.x - (radius * 2)) &&\n                        !isNullOrUndefined(point.x + (radius * 2)) &&\n                        !isNullOrUndefined(point.y - (radius * 2)) &&\n                        !isNullOrUndefined(point.y + (radius * 2)) &&\n                        x >= (point.x - (radius * 2)) &&\n                        x <= (point.x + (radius * 2)) &&\n                        y >= (point.y - (radius * 2)) &&\n                        y <= (point.y + (radius * 2))) {\n                        upperCanvas.style.cursor = parent.cursor = 'move';\n                        isMove = true;\n                        break;\n                    }\n                    else {\n                        upperCanvas.style.cursor = parent.cursor = 'default';\n                    }\n                }\n            }\n        }\n        return parent.cursor;\n    };\n    Selection.prototype.setCursorForLineArrow = function (actObj, x, y, upperCanvas) {\n        var index;\n        var radius = actObj.topLeftCircle.radius;\n        if (isNullOrUndefined(actObj.pointColl)) {\n            return index;\n        }\n        for (var i = 0, len = actObj.pointColl.length; i < len; i++) {\n            var point = actObj.pointColl[i];\n            if (x >= (point.x - (radius * 2)) && x <= (point.x + (radius * 2)) &&\n                y >= (point.y - (radius * 2)) && y <= (point.y + (radius * 2))) {\n                upperCanvas.style.cursor = this.parent.cursor = 'move';\n                index = i;\n                break;\n            }\n            else {\n                upperCanvas.style.cursor = this.parent.cursor = 'default';\n            }\n        }\n        return index;\n    };\n    Selection.prototype.setCursorForRotatedObject = function (actObj, x, y, upperCanvas) {\n        this.resizedElement = '';\n        var parent = this.parent;\n        var radius = actObj.bottomCenterCircle.radius;\n        var horTP = actObj.horTopLinePointColl[Math.round(actObj.horTopLinePointColl.length / 2)];\n        var horTP1 = actObj.horTopLinePointColl[Math.round(actObj.horTopLinePointColl.length - 1)];\n        var verLP = actObj.verLeftLinePointColl[Math.round(actObj.verLeftLinePointColl.length / 2)];\n        var verRP = actObj.verRightLinePointColl[Math.round(actObj.verRightLinePointColl.length / 2)];\n        var horBP = actObj.horBottomLinePointColl[Math.round(actObj.horBottomLinePointColl.length / 2)];\n        var horBP1 = actObj.horBottomLinePointColl[Math.round(actObj.horBottomLinePointColl.length - 1)];\n        var rotCP = actObj.rotationCirclePointColl;\n        var horTP0 = actObj.horTopLinePointColl[0];\n        var horBP0 = actObj.horBottomLinePointColl[0];\n        if (x >= (horTP0.x - (radius + 2)) && x <= (horTP0.x + (radius + 2)) && y >= (horTP0.y - (radius + 2)) &&\n            y <= (horTP0.y + (radius + 2))) {\n            upperCanvas.style.cursor = parent.cursor = 'nw-resize';\n        }\n        else if (x >= (horTP.x - 5) && x <= (horTP.x + 5) && y >= (horTP.y - 5) && y <= (horTP.y + 5)) {\n            upperCanvas.style.cursor = parent.cursor = this.resizedElement = 'n-resize';\n        }\n        else if (x >= (horTP1.x - (radius + 2)) && x <= (horTP1.x + (radius + 2)) && y >= (horTP1.y - (radius + 2)) &&\n            y <= (horTP1.y + (radius + 2))) {\n            upperCanvas.style.cursor = parent.cursor = 'ne-resize';\n        }\n        else if (x >= (verLP.x - 5) && x <= (verLP.x + 5) && y >= (verLP.y - 5) && y <= (verLP.y + 5)) {\n            upperCanvas.style.cursor = parent.cursor = this.resizedElement = 'w-resize';\n        }\n        else if (x >= (verRP.x - 5) && x <= (verRP.x + 5) && y >= (verRP.y - 5) && y <= (verRP.y + 5)) {\n            upperCanvas.style.cursor = parent.cursor = this.resizedElement = 'e-resize';\n        }\n        else if (x >= (horBP0.x - (radius + 2)) && x <= (horBP0.x + (radius + 2)) && y >= (horBP0.y - (radius + 2)) &&\n            y <= (horBP0.y + (radius + 2))) {\n            upperCanvas.style.cursor = parent.cursor = 'sw-resize';\n        }\n        else if (x >= (horBP.x - 5) && x <= (horBP.x + 5) && y >= (horBP.y - 5) && y <= (horBP.y + 5)) {\n            upperCanvas.style.cursor = parent.cursor = this.resizedElement = 's-resize';\n        }\n        else if (x >= (horBP1.x - (radius + 2)) && x <= (horBP1.x + (radius + 2)) && y >= (horBP1.y - (radius + 2)) &&\n            y <= (horBP1.y + (radius + 2))) {\n            upperCanvas.style.cursor = parent.cursor = 'se-resize';\n        }\n        else if (rotCP && x >= (rotCP.x - (radius + 2)) && x <= rotCP.x + (radius + 2) && y >= rotCP.y - (radius + 2) &&\n            y <= rotCP.y + (radius + 2)) {\n            upperCanvas.style.cursor = parent.cursor = 'grabbing';\n        }\n        else {\n            upperCanvas.style.cursor = parent.cursor = 'default';\n            var isPointsInsideRectangle = this.getRectanglePoints(actObj.activePoint.startX, actObj.activePoint.startY, actObj.activePoint.width, actObj.activePoint.height, actObj.rotatedAngle * (180 / Math.PI), x, y);\n            if (isPointsInsideRectangle) {\n                upperCanvas.style.cursor = parent.cursor = 'move';\n            }\n        }\n        if (parent.cursor === 'default') {\n            for (var i = 0, len = actObj.horTopLinePointColl.length; i < len; i++) {\n                var horTP_1 = actObj.horTopLinePointColl[i];\n                if (x >= (horTP_1.x - 5) && x <= (horTP_1.x + 5) && y >= (horTP_1.y - 5) && y <= (horTP_1.y + 5)) {\n                    upperCanvas.style.cursor = parent.cursor = this.resizedElement = 'n-resize';\n                    break;\n                }\n            }\n        }\n        if (parent.cursor === 'default') {\n            for (var i = 0, len = actObj.horBottomLinePointColl.length; i < len; i++) {\n                var horBP_1 = actObj.horBottomLinePointColl[i];\n                if (x >= (horBP_1.x - 5) && x <= (horBP_1.x + 5) && y >= (horBP_1.y - 5) && y <= (horBP_1.y + 5)) {\n                    upperCanvas.style.cursor = parent.cursor = this.resizedElement = 's-resize';\n                    break;\n                }\n            }\n        }\n        if (parent.cursor === 'default') {\n            for (var i = 0, len = actObj.verLeftLinePointColl.length; i < len; i++) {\n                var verLP_1 = actObj.verLeftLinePointColl[i];\n                if (x >= (verLP_1.x - 5) && x <= (verLP_1.x + 5) && y >= (verLP_1.y - 5) && y <= (verLP_1.y + 5)) {\n                    upperCanvas.style.cursor = parent.cursor = this.resizedElement = 'w-resize';\n                    break;\n                }\n            }\n        }\n        if (parent.cursor === 'default') {\n            for (var i = 0, len = actObj.verRightLinePointColl.length; i < len; i++) {\n                var verRP_1 = actObj.verRightLinePointColl[i];\n                if (x >= (verRP_1.x - 5) && x <= (verRP_1.x + 5) && y >= (verRP_1.y - 5) && y <= (verRP_1.y + 5)) {\n                    upperCanvas.style.cursor = parent.cursor = this.resizedElement = 'e-resize';\n                    break;\n                }\n            }\n        }\n        this.adjustCursorStylesForRotatedState(actObj);\n        return parent.cursor;\n    };\n    Selection.prototype.adjustCursorStylesForRotatedState = function (actObj) {\n        var parent = this.parent;\n        var length = actObj.rotatedAngle * (180 / Math.PI);\n        length = length > 0 ? Math.floor(length) : Math.ceil(length);\n        if ((length >= 92 && length <= 182) || (length >= -178 && length <= -88)) {\n            var cursorMap = { 'nw-resize': 'ne-resize', 'n-resize': 's-resize',\n                'ne-resize': 'nw-resize', 'w-resize': 'e-resize', 'e-resize': 'w-resize',\n                'sw-resize': 'se-resize', 's-resize': 'n-resize', 'se-resize': 'sw-resize'\n            };\n            if (parent.cursor in cursorMap) {\n                parent.cursor = cursorMap[parent.cursor];\n            }\n        }\n        parent.upperCanvas.style.cursor = this.getResizeElement((actObj.rotatedAngle * (180 / Math.PI)), parent.cursor);\n        return parent.cursor;\n    };\n    Selection.prototype.getResizeElement = function (degree, element) {\n        var resizeMappings = [];\n        switch (element) {\n            case 'nw-resize':\n                resizeMappings = [\n                    [337.5, 22.5, 'nw-resize'], [22.5, 67.5, 'n-resize'], [67.5, 112.5, 'ne-resize'],\n                    [112.5, 157.5, 'e-resize'], [157.5, 202.5, 'se-resize'],\n                    [202.5, 247.5, 's-resize'], [247.5, 292.5, 'sw-resize'],\n                    [292.5, 337.5, 'w-resize']\n                ];\n                break;\n            case 'n-resize':\n                resizeMappings = [\n                    [337.5, 22.5, 'n-resize'], [22.5, 67.5, 'ne-resize'], [67.5, 112.5, 'e-resize'],\n                    [112.5, 157.5, 'se-resize'], [157.5, 202.5, 's-resize'], [202.5, 247.5, 'sw-resize'],\n                    [247.5, 292.5, 'w-resize'], [292.5, 337.5, 'nw-resize']\n                ];\n                break;\n            case 'ne-resize':\n                resizeMappings = [\n                    [337.5, 22.5, 'ne-resize'], [22.5, 67.5, 'e-resize'],\n                    [67.5, 112.5, 'se-resize'], [112.5, 157.5, 's-resize'], [157.5, 202.5, 'sw-resize'],\n                    [202.5, 247.5, 'w-resize'], [247.5, 292.5, 'nw-resize'], [292.5, 337.5, 'n-resize']\n                ];\n                break;\n            case 'e-resize':\n                resizeMappings = [\n                    [337.5, 22.5, 'e-resize'], [22.5, 67.5, 'se-resize'], [67.5, 112.5, 's-resize'],\n                    [112.5, 157.5, 'sw-resize'], [157.5, 202.5, 'w-resize'], [202.5, 247.5, 'nw-resize'],\n                    [247.5, 292.5, 'n-resize'], [292.5, 337.5, 'ne-resize']\n                ];\n                break;\n            case 'se-resize':\n                resizeMappings = [\n                    [337.5, 22.5, 'se-resize'], [22.5, 67.5, 's-resize'], [67.5, 112.5, 'sw-resize'],\n                    [112.5, 157.5, 'w-resize'], [157.5, 202.5, 'nw-resize'], [202.5, 247.5, 'n-resize'],\n                    [247.5, 292.5, 'ne-resize'], [292.5, 337.5, 'e-resize']\n                ];\n                break;\n            case 's-resize':\n                resizeMappings = [\n                    [337.5, 22.5, 's-resize'], [22.5, 67.5, 'sw-resize'], [67.5, 112.5, 'w-resize'],\n                    [112.5, 157.5, 'nw-resize'], [157.5, 202.5, 'n-resize'], [202.5, 247.5, 'ne-resize'],\n                    [247.5, 292.5, 'e-resize'], [292.5, 337.5, 'se-resize']\n                ];\n                break;\n            case 'sw-resize':\n                resizeMappings = [\n                    [337.5, 22.5, 'sw-resize'], [22.5, 67.5, 'w-resize'], [67.5, 112.5, 'nw-resize'],\n                    [112.5, 157.5, 'n-resize'], [157.5, 202.5, 'ne-resize'], [202.5, 247.5, 'e-resize'],\n                    [247.5, 292.5, 'se-resize'], [292.5, 337.5, 's-resize']\n                ];\n                break;\n            case 'w-resize':\n                resizeMappings = [\n                    [337.5, 22.5, 'w-resize'], [22.5, 67.5, 'nw-resize'], [67.5, 112.5, 'n-resize'],\n                    [112.5, 157.5, 'ne-resize'], [157.5, 202.5, 'e-resize'], [202.5, 247.5, 'se-resize'],\n                    [247.5, 292.5, 's-resize'], [292.5, 337.5, 'sw-resize']\n                ];\n                break;\n        }\n        var positiveDegree = degree < 0 ? 360 - Math.abs(degree) : degree;\n        for (var _i = 0, resizeMappings_1 = resizeMappings; _i < resizeMappings_1.length; _i++) {\n            var _a = resizeMappings_1[_i], startDegree = _a[0], endDegree = _a[1], resizeElement = _a[2];\n            if ((positiveDegree > startDegree && positiveDegree <= endDegree) ||\n                (positiveDegree + 360 > startDegree && positiveDegree + 360 <= endDegree)) {\n                return resizeElement;\n            }\n        }\n        return element;\n    };\n    Selection.prototype.setCursorForFreehandDrawing = function (x, y, upperCanvas, id) {\n        var upperContext = upperCanvas.getContext('2d');\n        var parent = this.parent;\n        var textArea = document.querySelector('#' + parent.element.id + '_textArea');\n        var isEntered = false;\n        parent.notify('freehand-draw', { prop: 'setFreehandDrawHoveredIndex', onPropertyChange: false,\n            value: { index: -1 } });\n        var sPoints;\n        for (var n = 0; n < parent.freehandCounter; n++) {\n            if (id && id !== parent.pointColl[n].id) {\n                continue;\n            }\n            var obj = { selPointColl: {} };\n            parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false, value: { obj: obj } });\n            sPoints = extend([], obj['selPointColl'][n].points, []);\n            parent.points = extend([], parent.pointColl[n].points, []);\n            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n            var ptc = parent.pointColl[n];\n            parent.notify('freehand-draw', { prop: 'setPointCounter', onPropertyChange: false, value: { value: 0 } });\n            var len = sPoints.length;\n            for (var l = 0; l < len; l++) {\n                if (l !== 0) {\n                    var isInside = false;\n                    if (sPoints[l - 1] && sPoints[l]) {\n                        isInside = this.isInside(x, y, sPoints[l - 1].x, sPoints[l - 1].y, sPoints[l].x, sPoints[l].y);\n                    }\n                    if (isInside) {\n                        this.isFhdPoint = true;\n                        parent.notify('freehand-draw', { prop: 'setFreehandDrawHoveredIndex', onPropertyChange: false,\n                            value: { index: n } });\n                        parent.notify('freehand-draw', { prop: 'hoverFhd', onPropertyChange: false,\n                            value: { strokeColor: null, strokeWidth: null } });\n                        upperCanvas.style.cursor = parent.cursor = 'pointer';\n                        isEntered = true;\n                        break;\n                    }\n                    else if (!this.isFhdEditing || ptc.isSelected) {\n                        if (this.isFhdPoint || this.isFhdEditing) {\n                            upperContext.clearRect(0, 0, upperCanvas.width, upperCanvas.height);\n                            if (parent.activeObj.shape && textArea.style.display === 'none') {\n                                parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: parent.activeObj } });\n                            }\n                        }\n                        if (this.isFhdEditing) {\n                            var indexObj = { freehandSelectedIndex: -1 };\n                            parent.notify('freehand-draw', { prop: 'getFreehandSelectedIndex', onPropertyChange: false, value: { obj: indexObj } });\n                            var strokeColor = parent.pointColl[indexObj['freehandSelectedIndex']].strokeColor;\n                            var strokeWidth = parent.pointColl[indexObj['freehandSelectedIndex']].strokeWidth;\n                            parent.notify('freehand-draw', { prop: 'hoverFhd', onPropertyChange: false,\n                                value: { strokeColor: strokeColor, strokeWidth: strokeWidth } });\n                        }\n                        else {\n                            parent.notify('freehand-draw', { prop: 'setFreehandDrawHoveredIndex', onPropertyChange: false,\n                                value: { index: null } });\n                        }\n                        this.isFhdPoint = false;\n                    }\n                }\n                else {\n                    var pt = parent.points[l];\n                    if (x > pt.x - ptc.strokeWidth && x < pt.x + ptc.strokeWidth && y > pt.y - ptc.strokeWidth &&\n                        y < pt.y + ptc.strokeWidth) {\n                        this.isFhdPoint = true;\n                        parent.notify('freehand-draw', { prop: 'setFreehandDrawHoveredIndex', onPropertyChange: false, value: { index: n } });\n                        parent.notify('freehand-draw', { prop: 'hoverFhd', onPropertyChange: false, value: { strokeColor: null, strokeWidth: null } });\n                        upperCanvas.style.cursor = parent.cursor = 'pointer';\n                        isEntered = true;\n                        break;\n                    }\n                    else if (!this.isFhdEditing || ptc.isSelected) {\n                        if (this.isFhdPoint || this.isFhdEditing) {\n                            upperContext.clearRect(0, 0, upperCanvas.width, upperCanvas.height);\n                            if (parent.activeObj.shape && textArea.style.display === 'none') {\n                                parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: parent.activeObj } });\n                            }\n                        }\n                        if (this.isFhdEditing) {\n                            var indexObj = { freehandSelectedIndex: -1 };\n                            parent.notify('freehand-draw', { prop: 'getFreehandSelectedIndex', onPropertyChange: false, value: { obj: indexObj } });\n                            var strokeColor = parent.pointColl[indexObj['freehandSelectedIndex']].strokeColor;\n                            var strokeWidth = parent.pointColl[indexObj['freehandSelectedIndex']].strokeWidth;\n                            parent.notify('freehand-draw', { prop: 'hoverFhd', onPropertyChange: false,\n                                value: { strokeColor: strokeColor, strokeWidth: strokeWidth } });\n                        }\n                        this.isFhdPoint = false;\n                    }\n                }\n            }\n            if (isEntered) {\n                break;\n            }\n        }\n    };\n    Selection.prototype.setCursorFromObj = function (x, y, obj, upperCanvas, isCropSelection) {\n        var parent = this.parent;\n        for (var i = 0, len = obj.length; i < len; i++) {\n            if (parent.cursor === 'move') {\n                return;\n            }\n            var actObj = extend({}, obj[i], {}, true);\n            if (actObj.activePoint.width === 0 && actObj.activePoint.height === 0) {\n                obj.splice(i, 1);\n                return;\n            }\n            this.cursorTargetId = actObj.currIndex;\n            if (actObj.shape === 'line' || actObj.shape === 'arrow') {\n                this.setCursorForLineArrow(actObj, x, y, upperCanvas);\n            }\n            else if (actObj.shape === 'path') {\n                this.setCursorForPath(actObj, x, y, upperCanvas);\n            }\n            else if (!isNullOrUndefined(actObj.rotatedAngle) && actObj.rotatedAngle !== 0) {\n                this.setCursorForRotatedObject(actObj, x, y, upperCanvas);\n            }\n            else {\n                upperCanvas.style.cursor = parent.cursor = this.getMouseCursor(actObj, x, y, isCropSelection, true);\n            }\n        }\n    };\n    Selection.prototype.isInside = function (x, y, z1, z2, z3, z4) {\n        var x1 = Math.min(z1, z3);\n        var x2 = Math.max(z1, z3);\n        var y1 = Math.min(z2, z4);\n        var y2 = Math.max(z2, z4);\n        if ((x1 <= x && x <= x2) && (y1 <= y && y <= y2)) {\n            return true;\n        }\n        else {\n            return false;\n        }\n    };\n    Selection.prototype.preventResizing = function (tempActiveObj) {\n        var parent = this.parent;\n        if (parent.activeObj.preventShapeDragOut && this.isShapeDragOut()) {\n            var actPoint = parent.activeObj.activePoint;\n            actPoint.startX = tempActiveObj.activePoint.startX;\n            actPoint.startY = tempActiveObj.activePoint.startY;\n            actPoint.endX = tempActiveObj.activePoint.endX;\n            actPoint.endY = tempActiveObj.activePoint.endY;\n            actPoint.width = tempActiveObj.activePoint.width;\n            actPoint.height = tempActiveObj.activePoint.height;\n            parent.activeObj.rotatedAngle = tempActiveObj.rotatedAngle;\n            parent.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false,\n                value: { actPoint: actPoint, obj: parent.activeObj, isMouseMove: null, x: null, y: null } });\n        }\n    };\n    Selection.prototype.updateActivePoint = function (x, y, isCropSelection) {\n        var parent = this.parent;\n        var obj = { width: 0, height: 0 };\n        var _a = parent.activeObj.activePoint, startX = _a.startX, startY = _a.startY;\n        var _b = parent.activeObj.activePoint, width = _b.width, height = _b.height;\n        parent.notify('transform', { prop: 'calcMaxDimension', onPropertyChange: false,\n            value: { width: width, height: height, obj: obj, isImgShape: null } });\n        var previousShapeSettings = this.updatePrevShapeSettings();\n        var shapeResizingArgs = { cancel: false, action: 'resize', previousShapeSettings: previousShapeSettings, allowShapeOverflow: this.allowOutofBound() };\n        var shapeMovingArgs = { cancel: false, action: 'move', previousShapeSettings: previousShapeSettings, allowShapeOverflow: this.allowOutofBound() };\n        this.shapeResizingArgs = shapeResizingArgs;\n        this.shapeMovingArgs = shapeMovingArgs;\n        if (parent.activeObj.shape === 'text' && this.dragElement !== '') {\n            parent.notify('shape', { prop: 'updateFontRatio', onPropertyChange: false,\n                value: { obj: parent.activeObj, isTextArea: null } });\n        }\n        if (this.currentDrawingShape !== '' && (this.dragElement === '' || this.dragElement === 'move') && parent.isShapeDrawing) {\n            var shapeColl = ['line', 'arrow', 'path'];\n            if (shapeColl.indexOf(parent.activeObj.shape) > -1) {\n                this.dragElement = 'e-resize';\n            }\n            else {\n                if (x > startX && y > startY) {\n                    this.dragElement = 'se-resize';\n                }\n                else if (x < startX && y > startY) {\n                    this.dragElement = 'sw-resize';\n                }\n                else if (x > startX && y < startY) {\n                    this.dragElement = 'ne-resize';\n                }\n                else if (x < startX && y < startY) {\n                    this.dragElement = 'nw-resize';\n                }\n            }\n        }\n        if (parent.activeObj.shape === 'arrow') {\n            if (Math.atan2(x - parent.lowerCanvas.width / 2, y - parent.lowerCanvas.height / 2) > 0) {\n                parent.activeObj.rotatedAngle = -Math.atan2(x - parent.lowerCanvas.width / 2, y - parent.lowerCanvas.height / 2);\n            }\n            else {\n                parent.activeObj.rotatedAngle = Math.abs(Math.atan2(x - parent.lowerCanvas.width / 2, y - parent.lowerCanvas.height / 2));\n            }\n        }\n        var degree;\n        var isHorizontalflip = false;\n        var isVerticalflip = false;\n        if (isCropSelection && parent.transform.straighten !== 0 && this.isMouseOutsideImg(x, y)) {\n            return;\n        }\n        var tempActiveObj = extend({}, parent.activeObj, {}, true);\n        var splitWords;\n        var cropResize;\n        if (parent.activeObj.shape !== undefined) {\n            splitWords = parent.activeObj.shape.split('-');\n        }\n        if (splitWords !== undefined && splitWords[0] === 'crop') {\n            cropResize = true;\n        }\n        switch (this.dragElement.toLowerCase()) {\n            case 'nw-resize':\n                this.updateNWPoints(x, y);\n                this.preventResizing(tempActiveObj);\n                parent.notify('shape', { prop: 'updateArrowDirection', onPropertyChange: false,\n                    value: { obj: parent.activeObj, flip: null, rotatedDegree: null } });\n                this.triggerShapeChange(shapeResizingArgs, shapeMovingArgs, 'resize');\n                break;\n            case 'n-resize':\n                this.updateNPoints(x, y);\n                this.preventResizing(tempActiveObj);\n                parent.notify('shape', { prop: 'updateArrowDirection', onPropertyChange: false,\n                    value: { obj: parent.activeObj, flip: null, rotatedDegree: null } });\n                this.triggerShapeChange(shapeResizingArgs, shapeMovingArgs, 'resize');\n                break;\n            case 'ne-resize':\n                this.updateNEPoints(x, y);\n                this.preventResizing(tempActiveObj);\n                parent.notify('shape', { prop: 'updateArrowDirection', onPropertyChange: false,\n                    value: { obj: parent.activeObj, flip: null, rotatedDegree: null } });\n                this.triggerShapeChange(shapeResizingArgs, shapeMovingArgs, 'resize');\n                break;\n            case 'w-resize':\n                this.updateWPoints(x, y);\n                this.preventResizing(tempActiveObj);\n                parent.notify('shape', { prop: 'updateArrowDirection', onPropertyChange: false,\n                    value: { obj: parent.activeObj, flip: null, rotatedDegree: null } });\n                this.triggerShapeChange(shapeResizingArgs, shapeMovingArgs, 'resize');\n                break;\n            case 'e-resize':\n                this.updateEPoints(x, y);\n                this.preventResizing(tempActiveObj);\n                parent.notify('shape', { prop: 'updateArrowDirection', onPropertyChange: false,\n                    value: { obj: parent.activeObj, flip: null, rotatedDegree: null } });\n                this.triggerShapeChange(shapeResizingArgs, shapeMovingArgs, 'resize');\n                break;\n            case 'sw-resize':\n                this.updateSWPoints(x, y);\n                this.preventResizing(tempActiveObj);\n                parent.notify('shape', { prop: 'updateArrowDirection', onPropertyChange: false,\n                    value: { obj: parent.activeObj, flip: null, rotatedDegree: null } });\n                this.triggerShapeChange(shapeResizingArgs, shapeMovingArgs, 'resize');\n                break;\n            case 's-resize':\n                this.updateSPoints(x, y);\n                this.preventResizing(tempActiveObj);\n                parent.notify('shape', { prop: 'updateArrowDirection', onPropertyChange: false,\n                    value: { obj: parent.activeObj, flip: null, rotatedDegree: null } });\n                this.triggerShapeChange(shapeResizingArgs, shapeMovingArgs, 'resize');\n                break;\n            case 'se-resize':\n                this.updateSEPoints(x, y);\n                this.preventResizing(tempActiveObj);\n                parent.notify('shape', { prop: 'updateArrowDirection', onPropertyChange: false,\n                    value: { obj: parent.activeObj, flip: null, rotatedDegree: null } });\n                this.triggerShapeChange(shapeResizingArgs, shapeMovingArgs, 'resize');\n                break;\n            case 'grabbing':\n                if (Math.atan2(x - (startX + (width / 2)), y - (startY + (height / 2))) > 0) {\n                    parent.activeObj.rotatedAngle = -Math.atan2(x - (startX + (width / 2)), y - (startY + (height / 2)));\n                }\n                else {\n                    parent.activeObj.rotatedAngle = Math.abs(Math.atan2(x - (startX + (width / 2)), y - (startY + (height / 2))));\n                }\n                if (parent.activeObj.shapeDegree === 0) {\n                    degree = parent.transform.degree;\n                }\n                else {\n                    degree = parent.transform.degree - parent.activeObj.shapeDegree;\n                }\n                if (degree < 0) {\n                    degree = 360 + degree;\n                }\n                for (var i = 0, len = parent.activeObj.flipObjColl.length; i < len; i++) {\n                    if (parent.activeObj.flipObjColl[i].toLowerCase() === 'horizontal') {\n                        isHorizontalflip = true;\n                    }\n                    else if (parent.activeObj.flipObjColl[i].toLowerCase() === 'vertical') {\n                        isVerticalflip = true;\n                    }\n                }\n                parent.activeObj.rotatedAngle -= (degree * (Math.PI / 180));\n                if (degree === 0 || degree === 360) {\n                    if (isVerticalflip) {\n                        parent.activeObj.rotatedAngle -= (180 * (Math.PI / 180));\n                    }\n                }\n                else if (degree === 90 || degree === -270) {\n                    if (isHorizontalflip) {\n                        parent.activeObj.rotatedAngle -= (180 * (Math.PI / 180));\n                    }\n                }\n                else if (degree === 180 || degree === -180) {\n                    if (isVerticalflip) {\n                        parent.activeObj.rotatedAngle -= (180 * (Math.PI / 180));\n                    }\n                }\n                else if (degree === 270 || degree === -90) {\n                    if (isHorizontalflip) {\n                        parent.activeObj.rotatedAngle -= (180 * (Math.PI / 180));\n                    }\n                }\n                this.preventResizing(tempActiveObj);\n                break;\n            case 'pathdrag':\n                if (!isNullOrUndefined(this.pathAdjustedIndex)) {\n                    parent.activeObj.pointColl[this.pathAdjustedIndex].x = x;\n                    parent.activeObj.pointColl[this.pathAdjustedIndex].y = y;\n                }\n                break;\n            default:\n                if (!isCropSelection && !parent.currObjType.isCustomCrop) {\n                    var activePoint = parent.activeObj.activePoint;\n                    if (this.dragPoint.startX) {\n                        var width_1 = (this.dragPoint.endX - this.previousPoint.x);\n                        var height_1 = (this.dragPoint.endY - this.previousPoint.y);\n                        activePoint.startX += width_1;\n                        activePoint.endX += width_1;\n                        activePoint.startY += height_1;\n                        activePoint.endY += height_1;\n                        startX = activePoint.startX;\n                        startY = activePoint.startY;\n                        if (parent.activeObj.shape !== 'line' && parent.activeObj.shape !== 'arrow' &&\n                            parent.activeObj.rotationCirclePointColl) {\n                            parent.activeObj.rotationCirclePointColl.x += width_1;\n                            parent.activeObj.rotationCirclePointColl.y += height_1;\n                            parent.activeObj.rotationCirclePoint.x += width_1;\n                            parent.activeObj.rotationCirclePoint.y += height_1;\n                        }\n                        if (parent.activeObj.shape === 'path') {\n                            for (var i = 0, len = parent.activeObj.pointColl.length; i < len; i++) {\n                                parent.activeObj.pointColl[i].x += width_1;\n                                parent.activeObj.pointColl[i].y += height_1;\n                            }\n                        }\n                        if ((!this.isPreventDragging && this.isShapeDragOut()) && (parent.activeObj.preventShapeDragOut || parent.activeObj.shape === 'redact' || cropResize)) {\n                            activePoint.startX -= width_1;\n                            activePoint.endX -= width_1;\n                            activePoint.startY -= height_1;\n                            activePoint.endY -= height_1;\n                            if (parent.activeObj.shape !== 'line' && parent.activeObj.shape !== 'arrow' &&\n                                parent.activeObj.rotationCirclePointColl) {\n                                parent.activeObj.rotationCirclePointColl.x -= width_1;\n                                parent.activeObj.rotationCirclePointColl.y -= height_1;\n                                parent.activeObj.rotationCirclePoint.x -= width_1;\n                                parent.activeObj.rotationCirclePoint.y -= height_1;\n                            }\n                            else if (parent.activeObj.shape === 'path') {\n                                for (var l = 0, len = parent.activeObj.pointColl.length; l < len; l++) {\n                                    parent.activeObj.pointColl[l].x -= width_1;\n                                    parent.activeObj.pointColl[l].y -= height_1;\n                                }\n                            }\n                            if (parent.activeObj.rotatedAngle === 0) {\n                                var tempEndX = parent.activeObj.activePoint.endX;\n                                var tempEndY = parent.activeObj.activePoint.endY;\n                                if (parent.activeObj.shape === 'path') {\n                                    parent.activeObj.activePoint = parent.getSquarePointForPath(parent.activeObj);\n                                }\n                                this.setDragWidth(width_1);\n                                this.setDragHeight(height_1);\n                                var currObj = parent.activeObj;\n                                var xDiff = currObj.activePoint.endX - tempEndX;\n                                var yDiff = currObj.activePoint.endY - tempEndY;\n                                if (currObj.shape === 'path') {\n                                    for (var l = 0, len = currObj.pointColl.length; l < len; l++) {\n                                        currObj.pointColl[l].x += xDiff;\n                                        currObj.pointColl[l].y += yDiff;\n                                    }\n                                }\n                            }\n                            else {\n                                parent.notify('selection', { prop: 'updPtCollForShpRot', onPropertyChange: false, value: { obj: parent.activeObj } });\n                            }\n                        }\n                    }\n                    else {\n                        activePoint.startX = x < this.mouseDownPoint.x ? x : this.mouseDownPoint.x;\n                        activePoint.startY = y < this.mouseDownPoint.y ? y : this.mouseDownPoint.y;\n                        x = x < this.mouseDownPoint.x ? this.mouseDownPoint.x : x;\n                        y = y < this.mouseDownPoint.y ? this.mouseDownPoint.y : y;\n                        activePoint.endX = x;\n                        activePoint.endY = y;\n                    }\n                    this.triggerShapeChange(shapeResizingArgs, shapeMovingArgs, 'move');\n                }\n                break;\n        }\n    };\n    Selection.prototype.isShapeDragOut = function () {\n        var parent = this.parent;\n        var isShapeDragOut = false;\n        var allowPreventing = false;\n        var shape = parent.activeObj.shape;\n        if (parent.activeObj.preventShapeDragOut) {\n            allowPreventing = true;\n        }\n        else if (parent.activeObj.rotatedAngle === 0 &&\n            (shape !== 'line' && shape !== 'arrow' && shape !== 'path')) {\n            allowPreventing = true;\n        }\n        if (allowPreventing) {\n            var _a = parent.activeObj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY;\n            if (shape === 'path') {\n                var path = parent.getSquarePointForPath(parent.activeObj);\n                startX = path.startX;\n                startY = path.startY;\n                endX = path.endX;\n                endY = path.endY;\n            }\n            if (parent.activeObj.rotatedAngle === 0 || shape === 'arrow') {\n                isShapeDragOut = this.isObjOutsideImg(startX, startY, endX, endY, shape);\n            }\n            else {\n                var obj = { isIntersect: null, arr: null };\n                parent.notify('draw', { prop: 'updateImgCanvasPoints', onPropertyChange: false });\n                parent.notify('draw', { prop: 'isLinesIntersect', onPropertyChange: false, value: { obj: obj } });\n                if (obj['arr'][0] || obj['arr'][1] || obj['arr'][2] || obj['arr'][3]) {\n                    isShapeDragOut = true;\n                }\n                else {\n                    isShapeDragOut = this.isObjOutsideImg(startX, startY, endX, endY, shape);\n                }\n            }\n        }\n        return isShapeDragOut;\n    };\n    Selection.prototype.isObjOutsideImg = function (startX, startY, endX, endY, shape) {\n        var parent = this.parent;\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        if (startX < destLeft || startY < destTop || endX > destLeft + destWidth ||\n            endY > destTop + destHeight || ((shape === 'line' || shape === 'arrow') &&\n            (startX > destLeft + destWidth || startY > destTop + destHeight ||\n                endX < destLeft || endY < destTop))) {\n            return true;\n        }\n        return false;\n    };\n    Selection.prototype.triggerShapeChange = function (shapeResizingArgs, shapeMovingArgs, type) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        actPoint.width = actPoint.endX - actPoint.startX;\n        actPoint.height = actPoint.endY - actPoint.startY;\n        var currentShapeSettings = this.updatePrevShapeSettings();\n        if (!isNullOrUndefined(this.shapeResizingArgs) && !isNullOrUndefined(this.shapeMovingArgs)) {\n            shapeResizingArgs.currentShapeSettings = this.shapeResizingArgs.currentShapeSettings = currentShapeSettings;\n            shapeMovingArgs.currentShapeSettings = this.shapeMovingArgs.currentShapeSettings = currentShapeSettings;\n        }\n        else {\n            shapeResizingArgs.currentShapeSettings = currentShapeSettings;\n            shapeMovingArgs.currentShapeSettings = currentShapeSettings;\n        }\n        if (type === 'resize') {\n            this.isCropSelection = false;\n            var splitWords = void 0;\n            if (parent.activeObj.shape !== undefined) {\n                splitWords = parent.activeObj.shape.split('-');\n            }\n            if (splitWords !== undefined && splitWords[0] === 'crop') {\n                this.isCropSelection = true;\n            }\n            if (!this.isCropSelection) {\n                if (this.currentDrawingShape !== '' && parent.upperCanvas.style.cursor === 'crosshair') {\n                    shapeResizingArgs.action = 'drawing';\n                }\n                if (!parent.currObjType.isRedact || parent.activeObj.shape !== 'redact') {\n                    parent.trigger('shapeChanging', shapeResizingArgs);\n                }\n                parent.editCompleteArgs = shapeResizingArgs;\n                this.isPreventShaping = shapeResizingArgs.cancel;\n                parent.notify('shape', { prop: 'updateShapeChangeEventArgs', onPropertyChange: false, value: { shapeSettings: shapeResizingArgs.currentShapeSettings, allowShapeOverflow: shapeResizingArgs.allowShapeOverflow } });\n            }\n            else {\n                if (this.isMouseDown) {\n                    shapeResizingArgs.action = 'resize-start';\n                }\n                else if (this.isMouseUp) {\n                    shapeResizingArgs.action = 'resize-end';\n                }\n                var selectionResizingArgs = { action: shapeResizingArgs.action,\n                    previousSelectionSettings: { type: parent.getSelectionType(parent.activeObj.shape),\n                        startX: shapeResizingArgs.previousShapeSettings.startX,\n                        startY: shapeResizingArgs.previousShapeSettings.startY,\n                        width: shapeResizingArgs.previousShapeSettings.width,\n                        height: shapeResizingArgs.previousShapeSettings.height },\n                    currentSelectionSettings: { type: parent.getSelectionType(parent.activeObj.shape),\n                        startX: shapeResizingArgs.currentShapeSettings.startX,\n                        startY: shapeResizingArgs.currentShapeSettings.startY,\n                        width: shapeResizingArgs.currentShapeSettings.width,\n                        height: shapeResizingArgs.currentShapeSettings.height } };\n                this.selectionResizingArgs = selectionResizingArgs;\n                parent.trigger('selectionChanging', selectionResizingArgs);\n                parent.editCompleteArgs = selectionResizingArgs;\n                parent.notify('shape', { prop: 'updSelChangeEventArgs', onPropertyChange: false,\n                    value: { selectionSettings: selectionResizingArgs.currentSelectionSettings } });\n            }\n        }\n        else if (type === 'mouse-down' || type === 'mouse-up') {\n            if (parent.activeObj.shape !== 'redact') {\n                parent.trigger('shapeChanging', shapeResizingArgs);\n            }\n            parent.editCompleteArgs = shapeResizingArgs;\n            this.isPreventShaping = shapeResizingArgs.cancel;\n            parent.notify('shape', { prop: 'updateShapeChangeEventArgs', onPropertyChange: false,\n                value: { shapeSettings: shapeResizingArgs.currentShapeSettings, allowShapeOverflow: shapeResizingArgs.allowShapeOverflow } });\n        }\n        else {\n            if (parent.activeObj.shape !== 'redact') {\n                parent.trigger('shapeChanging', shapeMovingArgs);\n            }\n            parent.editCompleteArgs = shapeMovingArgs;\n            this.isPreventShaping = shapeMovingArgs.cancel;\n            parent.notify('shape', { prop: 'updateShapeChangeEventArgs', onPropertyChange: false,\n                value: { shapeSettings: shapeMovingArgs.currentShapeSettings, allowShapeOverflow: shapeMovingArgs.allowShapeOverflow } });\n        }\n        parent.eventType = type;\n    };\n    Selection.prototype.setDragWidth = function (width) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var _a = parent.img, destLeft = _a.destLeft, destWidth = _a.destWidth;\n        var tempWidth = width;\n        var shape = parent.activeObj.shape;\n        var preventDragOut = false;\n        if (parent.activeObj.preventShapeDragOut && (shape === 'line' || shape === 'arrow')) {\n            preventDragOut = true;\n        }\n        if (tempWidth >= 0) {\n            for (var i = 0; i < tempWidth; i++) {\n                width = tempWidth - i;\n                actPoint.startX += width;\n                actPoint.endX += width;\n                if ((actPoint.startX >= destLeft &&\n                    actPoint.endX <= destLeft + destWidth && !preventDragOut) ||\n                    (actPoint.startX >= destLeft && actPoint.endX <= destLeft + destWidth &&\n                        actPoint.endX >= destLeft && actPoint.startX <= destLeft + destWidth && preventDragOut)) {\n                    break;\n                }\n                else {\n                    actPoint.startX -= width;\n                    actPoint.endX -= width;\n                }\n            }\n        }\n        else {\n            for (var i = 1; i < Math.abs(tempWidth); i++) {\n                width = tempWidth + i;\n                actPoint.startX += width;\n                actPoint.endX += width;\n                if ((actPoint.startX >= destLeft &&\n                    actPoint.endX <= destLeft + destWidth && !preventDragOut) ||\n                    (actPoint.startX >= destLeft && actPoint.endX <= destLeft + destWidth &&\n                        actPoint.endX >= destLeft && actPoint.startX <= destLeft + destWidth && preventDragOut)) {\n                    break;\n                }\n                else {\n                    actPoint.startX -= width;\n                    actPoint.endX -= width;\n                }\n            }\n        }\n    };\n    Selection.prototype.setDragHeight = function (height) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var _a = parent.img, destTop = _a.destTop, destHeight = _a.destHeight;\n        var tempHeight = height;\n        var shape = parent.activeObj.shape;\n        var preventDragOut = false;\n        if (parent.activeObj.preventShapeDragOut && (shape === 'line' || shape === 'arrow')) {\n            preventDragOut = true;\n        }\n        if (tempHeight >= 0) {\n            for (var i = 1; i < tempHeight; i++) {\n                height = tempHeight - i;\n                actPoint.startY += height;\n                actPoint.endY += height;\n                if ((actPoint.startY >= destTop &&\n                    actPoint.endY <= destTop + destHeight && !preventDragOut) ||\n                    (actPoint.startY >= destTop && actPoint.endY <= destTop + destHeight &&\n                        actPoint.endY >= destTop && actPoint.startY <= destTop + destHeight && preventDragOut)) {\n                    break;\n                }\n                else {\n                    actPoint.startY -= height;\n                    actPoint.endY -= height;\n                }\n            }\n        }\n        else {\n            for (var i = 0; i < Math.abs(tempHeight); i++) {\n                height = tempHeight + i;\n                actPoint.startY += height;\n                actPoint.endY += height;\n                if ((actPoint.startY >= destTop &&\n                    actPoint.endY <= destTop + destHeight && !preventDragOut) ||\n                    (actPoint.startY >= destTop && actPoint.endY <= destTop + destHeight &&\n                        actPoint.endY >= destTop && actPoint.startY <= destTop + destHeight && preventDragOut)) {\n                    break;\n                }\n                else {\n                    actPoint.startY -= height;\n                    actPoint.endY -= height;\n                }\n            }\n        }\n    };\n    Selection.prototype.limitDrag = function (isStart) {\n        var isLimiting = false;\n        var parent = this.parent;\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        var actPoint = parent.activeObj.activePoint;\n        var startX = isStart ? actPoint.startX : actPoint.endX;\n        var startY = isStart ? actPoint.startY : actPoint.endY;\n        var endX = isStart ? actPoint.endX : actPoint.startX;\n        var endY = isStart ? actPoint.endY : actPoint.startY;\n        var wrapperWidth = parent.upperCanvas.width;\n        var wrapperHeight = parent.upperCanvas.height;\n        if (Browser.isDevice) {\n            if (startX < 0 && destLeft < 0) {\n                startX = 0;\n            }\n            if (startY < 0 && destTop < 0) {\n                startY = 0;\n            }\n            if (endX > wrapperWidth && destLeft + destWidth > wrapperWidth) {\n                endX = wrapperWidth;\n            }\n            if (endY > wrapperHeight && destTop + destHeight > wrapperHeight) {\n                endY = wrapperHeight;\n            }\n        }\n        else {\n            if (startX < destLeft) {\n                startX = destLeft;\n            }\n            if (startY < destTop) {\n                startY = destTop;\n            }\n            if (endX > destLeft + destWidth) {\n                endX = destLeft + destWidth;\n            }\n            if (endY > destTop + destHeight) {\n                endY = destTop + destHeight;\n            }\n        }\n        if (parent.transform.straighten !== 0) {\n            var obj = { isIntersect: null, arr: null };\n            parent.notify('draw', { prop: 'updateImgCanvasPoints', onPropertyChange: false });\n            parent.notify('draw', { prop: 'isLinesIntersect', onPropertyChange: false, value: { obj: obj } });\n            if (obj['arr'][0] || obj['arr'][1] || obj['arr'][2] || obj['arr'][3]) {\n                isLimiting = true;\n            }\n        }\n        if (isStart) {\n            actPoint.startX = startX;\n            actPoint.startY = startY;\n            actPoint.endX = endX;\n            actPoint.endY = endY;\n        }\n        else {\n            actPoint.startX = endX;\n            actPoint.startY = endY;\n            actPoint.endX = startX;\n            actPoint.endY = startY;\n        }\n        return isLimiting;\n    };\n    Selection.prototype.isMouseOutsideImg = function (x, y) {\n        var obj = { bool: false };\n        this.parent.notify('draw', { prop: 'updateImgCanvasPoints', onPropertyChange: false });\n        this.parent.notify('draw', { prop: 'isPointsInsideImg', value: { obj: obj, x: x, y: y } });\n        return obj['bool'];\n    };\n    Selection.prototype.preventDraggingInvertly = function () {\n        var isLimiting = false;\n        var parent = this.parent;\n        if (parent.activeObj.shape === 'image') {\n            return isLimiting;\n        }\n        var splitWords;\n        var cropResize;\n        if (parent.activeObj.shape !== undefined) {\n            splitWords = parent.activeObj.shape.split('-');\n        }\n        if (splitWords !== undefined && splitWords[0] === 'crop') {\n            cropResize = true;\n        }\n        if ((!this.isPreventDragging && parent.activeObj.rotatedAngle === 0) && (parent.activeObj.preventShapeDragOut || parent.activeObj.shape === 'redact' || cropResize)) {\n            isLimiting = this.limitDrag(true);\n            var shapeColl = ['line', 'arrow', 'path'];\n            if (shapeColl.indexOf(parent.activeObj.shape) > -1) {\n                isLimiting = this.limitDrag(false);\n            }\n        }\n        return isLimiting;\n    };\n    Selection.prototype.preventTextDraggingInvertly = function () {\n        var parent = this.parent;\n        var isLimiting = false;\n        var actPoint = parent.activeObj.activePoint;\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        if (!this.isPreventDragging) {\n            if (actPoint.startX < destLeft ||\n                actPoint.startY < destTop ||\n                actPoint.endX > destLeft + destWidth ||\n                actPoint.endY > destTop + destHeight) {\n                isLimiting = true;\n            }\n        }\n        return isLimiting;\n    };\n    Selection.prototype.preventInverseResize = function (tempActiveObj) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        if (actPoint.width < 0) {\n            actPoint.width = 0;\n            actPoint.startX = tempActiveObj.activePoint.startX;\n            actPoint.endX = tempActiveObj.activePoint.endX;\n        }\n        if (actPoint.height < 0) {\n            actPoint.height = 0;\n            actPoint.startY = tempActiveObj.activePoint.startY;\n            actPoint.endY = tempActiveObj.activePoint.endY;\n        }\n    };\n    Selection.prototype.getScaleRatio = function (scale) {\n        var parent = this.parent;\n        var point = { x: scale, y: scale };\n        if (parent.activeObj.shape && parent.activeObj.shape !== 'crop-custom' &&\n            parent.activeObj.shape !== 'crop-circle' && parent.activeObj.shape !== 'crop-square') {\n            var ratio = parent.activeObj.shape === 'image' || parent.activeObj.shape === 'text' ?\n                this.findImageRatio(parent.activeObj.activePoint.width, parent.activeObj.activePoint.height).split('-') :\n                parent.activeObj.shape.split('-');\n            if (ratio.length > 1 || parent.activeObj.shape === 'image' || parent.activeObj.shape === 'text') {\n                ratio = parent.activeObj.shape === 'image' || parent.activeObj.shape === 'text' ? ratio[0].split(':') : ratio[1].split(':');\n                var newScale = scale / (parseInt(ratio[1], 10));\n                point.x = newScale * (parseInt(ratio[0], 10));\n                point.y = newScale * (parseInt(ratio[1], 10));\n            }\n        }\n        return point;\n    };\n    Selection.prototype.findImageRatio = function (width, height, obj) {\n        // eslint-disable-next-line @typescript-eslint/tslint/config\n        var gcd = function (a, b) {\n            if (b === 0) {\n                return a;\n            }\n            return gcd(b, a % b);\n        };\n        var divisor = gcd(width, height);\n        var ratio = width / divisor + \":\" + height / divisor;\n        if (obj) {\n            obj['ratio'] = ratio;\n        }\n        return ratio;\n    };\n    Selection.prototype.revertResizing = function (tempActiveObj) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        if (this.preventDraggingInvertly()) {\n            actPoint.startX = tempActiveObj.activePoint.startX;\n            actPoint.startY = tempActiveObj.activePoint.startY;\n            actPoint.endX = tempActiveObj.activePoint.endX;\n            actPoint.endY = tempActiveObj.activePoint.endY;\n        }\n    };\n    Selection.prototype.performSEResize = function (x, y, tempActiveObj, actPoint) {\n        var parent = this.parent;\n        this.resizeImg(x, y, 'se-resize', tempActiveObj);\n        if (actPoint.endX < actPoint.startX) {\n            var temp = actPoint.endX;\n            actPoint.endX = actPoint.startX;\n            actPoint.startX = temp;\n            this.dragElement = parent.upperCanvas.style.cursor = parent.cursor = 'sw-resize';\n        }\n        if (actPoint.endY < actPoint.startY) {\n            var temp = actPoint.endY;\n            actPoint.endY = actPoint.startY;\n            actPoint.startY = temp;\n            this.dragElement = parent.upperCanvas.style.cursor = parent.cursor = 'ne-resize';\n        }\n        this.revertCustomSelection(actPoint, tempActiveObj, 'se-resize');\n        this.revertResizing(tempActiveObj);\n    };\n    Selection.prototype.performNWResize = function (x, y, tempActiveObj, actPoint) {\n        var parent = this.parent;\n        this.resizeImg(x, y, 'nw-resize', tempActiveObj);\n        if (actPoint.startX > actPoint.endX) {\n            var temp = actPoint.startX;\n            actPoint.startX = actPoint.endX;\n            actPoint.endX = temp;\n            this.dragElement = parent.upperCanvas.style.cursor = parent.cursor = 'ne-resize';\n        }\n        if (actPoint.startY > actPoint.endY) {\n            var temp = actPoint.startY;\n            actPoint.startY = actPoint.endY;\n            actPoint.endY = temp;\n            this.dragElement = parent.upperCanvas.style.cursor = parent.cursor = 'sw-resize';\n        }\n        this.revertCustomSelection(actPoint, tempActiveObj, 'nw-resize');\n        this.revertResizing(tempActiveObj);\n    };\n    Selection.prototype.isCustomSelection = function () {\n        if (this.parent.activeObj.shape) {\n            var shapeColl = ['custom', 'circle', 'square', '2:3', '3:2', '3:4', '4:3', '4:5', '5:4', '5:7', '7:5', '9:16', '16:9'];\n            return this.parent.activeObj.shape.indexOf('crop-') > -1 && shapeColl.indexOf(this.parent.activeObj.shape.split('-')[1]) === -1;\n        }\n        return false;\n    };\n    Selection.prototype.revertCustomSelection = function (actPoint, tempActiveObj, type) {\n        var parent = this.parent;\n        if (this.isCustomSelection()) {\n            var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n            var endX = destLeft + destWidth < parent.lowerCanvas.width ?\n                destLeft + destWidth : parent.lowerCanvas.width;\n            var endY = destTop + destHeight < parent.lowerCanvas.height ?\n                destTop + destHeight : parent.lowerCanvas.height;\n            var left = destLeft > 0 ? destLeft : 0;\n            var top_1 = destTop > 0 ? destTop : 0;\n            var endY1 = destTop > 0 ? destTop : 0;\n            var endX1 = destLeft > 0 ? destLeft : 0;\n            if ((type === 'se-resize' && (actPoint.endX > endX || actPoint.endY > endY)) ||\n                (type === 'nw-resize' && (actPoint.startX < left || actPoint.startY < top_1)) ||\n                (type === 'ne-resize' && (actPoint.endX > endX || actPoint.startY < endY1)) ||\n                (type === 'sw-resize' && (actPoint.startX < endX1 || actPoint.endY > endY))) {\n                this.revertPoints(actPoint, tempActiveObj);\n            }\n        }\n    };\n    Selection.prototype.revertPoints = function (actPoint, tempActiveObj) {\n        actPoint.startX = tempActiveObj.activePoint.startX;\n        actPoint.startY = tempActiveObj.activePoint.startY;\n        actPoint.endX = tempActiveObj.activePoint.endX;\n        actPoint.endY = tempActiveObj.activePoint.endY;\n        actPoint.width = tempActiveObj.activePoint.width;\n        actPoint.height = tempActiveObj.activePoint.height;\n    };\n    Selection.prototype.updateNWPoints = function (x, y) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var width;\n        var height;\n        var scale;\n        var tempActiveObj = extend({}, parent.activeObj, null, true);\n        if (parent.activeObj.shape === 'text') {\n            this.resizeImg(x, y, 'nw-resize', tempActiveObj);\n            parent.notify('shape', { prop: 'updateFontSize', onPropertyChange: false,\n                value: { obj: parent.activeObj } });\n        }\n        else {\n            var splitWords = void 0;\n            if (parent.activeObj.shape !== undefined) {\n                splitWords = parent.activeObj.shape.split('-');\n            }\n            if (parent.activeObj.shape === 'crop-custom' || (parent.activeObj.shape !== undefined && splitWords[0] !== 'crop')\n                || this.isCustomSelection()) {\n                if (parent.activeObj.shape === 'image' || this.isCustomSelection()) {\n                    this.resizeImg(x, y, 'nw-resize', tempActiveObj);\n                }\n                else {\n                    this.adjustNWPoints(actPoint, x, y, parent.activeObj.rotatedAngle);\n                }\n                if (actPoint.startX > actPoint.endX) {\n                    var temp = actPoint.startX;\n                    actPoint.startX = actPoint.endX;\n                    actPoint.endX = temp;\n                    this.dragElement = parent.upperCanvas.style.cursor = parent.cursor = 'ne-resize';\n                }\n                if (actPoint.startY > actPoint.endY) {\n                    var temp = actPoint.startY;\n                    actPoint.startY = actPoint.endY;\n                    actPoint.endY = temp;\n                    this.dragElement = parent.upperCanvas.style.cursor = parent.cursor = 'sw-resize';\n                }\n                this.revertCustomSelection(actPoint, tempActiveObj, 'nw-resize');\n                this.revertResizing(tempActiveObj);\n            }\n            else {\n                var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop;\n                if (actPoint.startX < x && actPoint.startY < y) {\n                    width = x - actPoint.startX;\n                    height = y - actPoint.startY;\n                    scale = Math.min(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    actPoint.startX += newScale.x;\n                    actPoint.startY += newScale.y;\n                    var left = destLeft > 0 ? destLeft : 0;\n                    var top_2 = destTop > 0 ? destTop : 0;\n                    if (actPoint.startX < left || actPoint.startY < top_2) {\n                        actPoint.startX -= newScale.x;\n                        actPoint.startY -= newScale.y;\n                    }\n                }\n                else {\n                    width = actPoint.startX - x;\n                    height = y - actPoint.endY;\n                    scale = Math.max(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    actPoint.startX -= newScale.x;\n                    actPoint.startY -= newScale.y;\n                    var left = destLeft > 0 ? destLeft : 0;\n                    var top_3 = destTop > 0 ? destTop : 0;\n                    if (actPoint.startX < left || actPoint.startY < top_3) {\n                        actPoint.startX += newScale.x;\n                        actPoint.startY += newScale.y;\n                    }\n                }\n                actPoint.width = actPoint.endX - actPoint.startX;\n                actPoint.height = actPoint.endY - actPoint.startY;\n                this.revertResizing(tempActiveObj);\n            }\n            actPoint.width = actPoint.endX - actPoint.startX;\n            actPoint.height = actPoint.endY - actPoint.startY;\n            this.preventInverseResize(tempActiveObj);\n        }\n    };\n    Selection.prototype.updateNPoints = function (x, y) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var width;\n        var height;\n        var scale;\n        var tempActiveObj = extend({}, parent.activeObj, null, true);\n        if (parent.activeObj.shape !== 'text') {\n            var splitWords = void 0;\n            if (parent.activeObj.shape) {\n                splitWords = parent.activeObj.shape.split('-');\n            }\n            if (parent.activeObj.shape === 'crop-custom' || (parent.activeObj.shape && splitWords[0] !== 'crop')) {\n                if (parent.activeObj.shape !== 'line' && parent.activeObj.shape !== 'arrow' && parent.activeObj.shape !== 'path' &&\n                    parent.activeObj.rotatedAngle !== 0 && this.dragPoint.startX) {\n                    if (this.dragPoint.startX && this.dragPoint.startY) {\n                        this.previousPoint.x = this.dragPoint.endX;\n                        this.previousPoint.y = this.dragPoint.endY;\n                        this.dragPoint.endX = x;\n                        this.dragPoint.endY = y;\n                    }\n                    width = (this.dragPoint.endX - this.previousPoint.x);\n                    height = (this.dragPoint.endY - this.previousPoint.y);\n                    this.adjustRotationPoints(actPoint, width, height, parent.activeObj.rotatedAngle);\n                }\n                else {\n                    actPoint.startY = y;\n                    actPoint.height = actPoint.endY - actPoint.startY;\n                }\n                if (actPoint.startY > actPoint.endY) {\n                    var temp = actPoint.startY;\n                    actPoint.startY = actPoint.endY;\n                    actPoint.endY = temp;\n                    this.dragElement = this.resizedElement = 's-resize';\n                }\n                this.revertResizing(tempActiveObj);\n            }\n            else {\n                var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth;\n                if (this.isCustomSelection()) {\n                    this.performNWResize(x, y, tempActiveObj, actPoint);\n                }\n                else if (actPoint.endX > x && actPoint.startY < y) {\n                    width = actPoint.endX - x;\n                    height = y - actPoint.startY;\n                    scale = Math.min(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    actPoint.endX -= newScale.x;\n                    actPoint.startY += newScale.y;\n                    if (actPoint.endX > (destLeft + destWidth) ||\n                        actPoint.startY < destTop) {\n                        actPoint.endX += newScale.x;\n                        actPoint.startY -= newScale.y;\n                    }\n                }\n                else {\n                    width = x - actPoint.endX;\n                    height = actPoint.startY - y;\n                    scale = Math.max(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    actPoint.endX += newScale.x;\n                    actPoint.startY -= newScale.y;\n                    if (actPoint.endX > (destLeft + destWidth) ||\n                        actPoint.startY < destTop) {\n                        actPoint.endX -= newScale.x;\n                        actPoint.startY += newScale.y;\n                    }\n                }\n                actPoint.width = actPoint.endX - actPoint.startX;\n                actPoint.height = actPoint.endY - actPoint.startY;\n                this.revertResizing(tempActiveObj);\n            }\n        }\n    };\n    Selection.prototype.updateNEPoints = function (x, y) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var width;\n        var height;\n        var scale;\n        var tempActiveObj = extend({}, parent.activeObj, null, true);\n        if (parent.activeObj.shape === 'text') {\n            this.resizeImg(x, y, 'ne-resize', tempActiveObj);\n            parent.notify('shape', { prop: 'updateFontSize', onPropertyChange: false,\n                value: { obj: parent.activeObj } });\n        }\n        else {\n            var splitWords = void 0;\n            if (parent.activeObj.shape) {\n                splitWords = parent.activeObj.shape.split('-');\n            }\n            if (parent.activeObj.shape === 'crop-custom' || (parent.activeObj.shape !== undefined && splitWords[0] !== 'crop')\n                || this.isCustomSelection()) {\n                if (parent.activeObj.shape === 'image' || this.isCustomSelection()) {\n                    this.resizeImg(x, y, 'ne-resize', tempActiveObj);\n                }\n                else {\n                    this.adjustNEPoints(actPoint, x, y, parent.activeObj.rotatedAngle);\n                }\n                if (actPoint.endX < actPoint.startX) {\n                    var temp = actPoint.endX;\n                    actPoint.endX = actPoint.startX;\n                    actPoint.startX = temp;\n                    this.dragElement = parent.upperCanvas.style.cursor = parent.cursor = 'nw-resize';\n                }\n                if (actPoint.startY > actPoint.endY) {\n                    var temp = actPoint.startY;\n                    actPoint.startY = actPoint.endY;\n                    actPoint.endY = temp;\n                    this.dragElement = parent.upperCanvas.style.cursor = parent.cursor = 'se-resize';\n                }\n                this.revertCustomSelection(actPoint, tempActiveObj, 'ne-resize');\n                this.revertResizing(tempActiveObj);\n            }\n            else {\n                var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth;\n                if (actPoint.endX > x && actPoint.startY < y) {\n                    width = actPoint.endX - x;\n                    height = y - actPoint.startY;\n                    scale = Math.min(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    actPoint.endX -= newScale.x;\n                    actPoint.startY += newScale.y;\n                    var endX = destLeft + destWidth < parent.lowerCanvas.width ?\n                        destLeft + destWidth : parent.lowerCanvas.width;\n                    var endY = destTop > 0 ? destTop : 0;\n                    if (actPoint.endX > endX || actPoint.startY < endY) {\n                        actPoint.endX += newScale.x;\n                        actPoint.startY -= newScale.y;\n                    }\n                }\n                else {\n                    width = x - actPoint.endX;\n                    height = actPoint.startY - y;\n                    scale = Math.max(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    actPoint.endX += newScale.x;\n                    actPoint.startY -= newScale.y;\n                    var endX = destLeft + destWidth < parent.lowerCanvas.width ?\n                        destLeft + destWidth : parent.lowerCanvas.width;\n                    var endY = destTop > 0 ? destTop : 0;\n                    if (actPoint.endX > endX || actPoint.startY < endY) {\n                        actPoint.endX -= newScale.x;\n                        actPoint.startY += newScale.y;\n                    }\n                }\n                actPoint.width = actPoint.endX - actPoint.startX;\n                actPoint.height = actPoint.endY - actPoint.startY;\n                this.revertResizing(tempActiveObj);\n            }\n            actPoint.width = actPoint.endX - actPoint.startX;\n            actPoint.height = actPoint.endY - actPoint.startY;\n            this.preventInverseResize(tempActiveObj);\n        }\n    };\n    Selection.prototype.updateWPoints = function (x, y) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var width;\n        var height;\n        var scale;\n        var tempActiveObj = extend({}, parent.activeObj, null, true);\n        if (parent.activeObj.shape !== 'text') {\n            var splitWords = void 0;\n            if (parent.activeObj.shape) {\n                splitWords = parent.activeObj.shape.split('-');\n            }\n            if (parent.activeObj.shape === 'crop-custom' || (parent.activeObj.shape && splitWords[0] !== 'crop')) {\n                if (parent.activeObj.shape !== 'line' && parent.activeObj.shape !== 'arrow' && parent.activeObj.shape !== 'path' &&\n                    parent.activeObj.rotatedAngle !== 0 && this.dragPoint.startX) {\n                    if (this.dragPoint.startX && this.dragPoint.startY) {\n                        this.previousPoint.x = this.dragPoint.endX;\n                        this.previousPoint.y = this.dragPoint.endY;\n                        this.dragPoint.endX = x;\n                        this.dragPoint.endY = y;\n                    }\n                    width = (this.dragPoint.endX - this.previousPoint.x);\n                    height = (this.dragPoint.endY - this.previousPoint.y);\n                    this.adjustRotationPoints(actPoint, width, height, parent.activeObj.rotatedAngle);\n                }\n                else {\n                    actPoint.startX = x;\n                    actPoint.width = actPoint.endX - actPoint.startX;\n                }\n                if (parent.activeObj.shape === 'line' || parent.activeObj.shape === 'arrow' || parent.activeObj.shape === 'path') {\n                    actPoint.startY = y;\n                    actPoint.height = actPoint.endY - actPoint.startY;\n                    if (this.adjustActObjForLineArrow()) {\n                        this.dragElement = 'e-resize';\n                        if (parent.activeObj.triangleDirection === 'right') {\n                            parent.activeObj.triangleDirection = 'left';\n                        }\n                        else if (parent.activeObj.triangleDirection === 'left') {\n                            parent.activeObj.triangleDirection = 'right';\n                        }\n                    }\n                }\n                else if (actPoint.startX > actPoint.endX) {\n                    var temp = actPoint.startX;\n                    actPoint.startX = actPoint.endX;\n                    actPoint.endX = temp;\n                    this.dragElement = this.resizedElement = 'e-resize';\n                }\n                this.revertResizing(tempActiveObj);\n            }\n            else {\n                var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destHeight = _a.destHeight;\n                if (this.isCustomSelection()) {\n                    this.performNWResize(x, y, tempActiveObj, actPoint);\n                }\n                else if (actPoint.startX < x && actPoint.endY > y) {\n                    width = x - actPoint.startX;\n                    height = actPoint.endY - y;\n                    scale = Math.min(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    actPoint.startX += newScale.x;\n                    actPoint.endY -= newScale.y;\n                    if (actPoint.startX < destLeft || actPoint.endY >\n                        (destTop + destHeight)) {\n                        actPoint.startX -= newScale.x;\n                        actPoint.endY += newScale.y;\n                    }\n                }\n                else {\n                    width = actPoint.startX - x;\n                    height = y - actPoint.endY;\n                    scale = Math.max(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    actPoint.startX -= newScale.x;\n                    actPoint.endY += newScale.y;\n                    if (actPoint.startX < destLeft || actPoint.endY >\n                        (destTop + destHeight)) {\n                        actPoint.startX += newScale.x;\n                        actPoint.endY -= newScale.y;\n                    }\n                }\n                actPoint.width = actPoint.endX - actPoint.startX;\n                actPoint.height = actPoint.endY - actPoint.startY;\n                this.revertResizing(tempActiveObj);\n            }\n        }\n    };\n    Selection.prototype.updateEPoints = function (x, y) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var width;\n        var height;\n        var scale;\n        var tempActiveObj = extend({}, parent.activeObj, null, true);\n        if (parent.activeObj.shape !== 'text') {\n            var splitWords = void 0;\n            if (parent.activeObj.shape) {\n                splitWords = parent.activeObj.shape.split('-');\n            }\n            if (parent.activeObj.shape === 'crop-custom' || (parent.activeObj.shape && splitWords[0] !== 'crop')) {\n                if (parent.activeObj.shape !== 'line' && parent.activeObj.shape !== 'arrow' && parent.activeObj.shape !== 'path' &&\n                    parent.activeObj.rotatedAngle !== 0 && this.dragPoint.startX) {\n                    if (this.dragPoint.startX && this.dragPoint.startY) {\n                        this.previousPoint.x = this.dragPoint.endX;\n                        this.previousPoint.y = this.dragPoint.endY;\n                        this.dragPoint.endX = x;\n                        this.dragPoint.endY = y;\n                    }\n                    width = (this.dragPoint.endX - this.previousPoint.x);\n                    height = (this.dragPoint.endY - this.previousPoint.y);\n                    this.adjustRotationPoints(actPoint, width, height, parent.activeObj.rotatedAngle);\n                }\n                else {\n                    actPoint.endX = x;\n                    actPoint.width = actPoint.endX - actPoint.startX;\n                }\n                if (parent.activeObj.shape === 'line' || parent.activeObj.shape === 'arrow' || parent.activeObj.shape === 'path') {\n                    actPoint.endY = y;\n                    actPoint.height = actPoint.endY - actPoint.startY;\n                    if (this.adjustActObjForLineArrow()) {\n                        this.dragElement = 'w-resize';\n                        if (parent.activeObj.triangleDirection === 'right') {\n                            parent.activeObj.triangleDirection = 'left';\n                        }\n                        else if (parent.activeObj.triangleDirection === 'left') {\n                            parent.activeObj.triangleDirection = 'right';\n                        }\n                    }\n                }\n                else if (actPoint.endX < actPoint.startX) {\n                    var temp = actPoint.endX;\n                    actPoint.endX = actPoint.startX;\n                    actPoint.startX = temp;\n                    this.dragElement = this.resizedElement = 'w-resize';\n                }\n                this.revertResizing(tempActiveObj);\n            }\n            else {\n                var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n                if (this.isCustomSelection()) {\n                    this.performSEResize(x, y, tempActiveObj, actPoint);\n                }\n                else if (actPoint.endX > x && actPoint.endY > y) {\n                    width = actPoint.endX - x;\n                    height = actPoint.endY - y;\n                    scale = Math.min(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    actPoint.endX -= newScale.x;\n                    actPoint.endY -= newScale.y;\n                    if (actPoint.endX > (destLeft + destWidth) ||\n                        actPoint.endY > (destTop + destHeight)) {\n                        actPoint.endX += newScale.x;\n                        actPoint.endY += newScale.y;\n                    }\n                }\n                else {\n                    width = x - actPoint.endX;\n                    height = y - actPoint.endY;\n                    scale = Math.max(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    actPoint.endX += newScale.x;\n                    actPoint.endY += newScale.y;\n                    if (actPoint.endX > (destLeft + destWidth) ||\n                        actPoint.endY > (destTop + destHeight)) {\n                        actPoint.endX -= newScale.x;\n                        actPoint.endY -= newScale.y;\n                    }\n                }\n                actPoint.width = actPoint.endX - actPoint.startX;\n                actPoint.height = actPoint.endY - actPoint.startY;\n                this.revertResizing(tempActiveObj);\n            }\n        }\n    };\n    Selection.prototype.updateSWPoints = function (x, y) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var width;\n        var height;\n        var scale;\n        var tempActiveObj = extend({}, parent.activeObj, null, true);\n        if (parent.activeObj.shape === 'text') {\n            this.resizeImg(x, y, 'sw-resize', tempActiveObj);\n            parent.notify('shape', { prop: 'updateFontSize', onPropertyChange: false,\n                value: { obj: parent.activeObj } });\n        }\n        else {\n            var splitWords = void 0;\n            if (parent.activeObj.shape !== undefined) {\n                splitWords = parent.activeObj.shape.split('-');\n            }\n            if (parent.activeObj.shape === 'crop-custom' || (parent.activeObj.shape !== undefined && splitWords[0] !== 'crop')\n                || this.isCustomSelection()) {\n                if (parent.activeObj.shape === 'image' || this.isCustomSelection()) {\n                    this.resizeImg(x, y, 'sw-resize', tempActiveObj);\n                }\n                else {\n                    this.adjustSWPoints(actPoint, x, y, parent.activeObj.rotatedAngle);\n                }\n                if (actPoint.startX > actPoint.endX) {\n                    var temp = actPoint.startX;\n                    actPoint.startX = actPoint.endX;\n                    actPoint.endX = temp;\n                    this.dragElement = parent.upperCanvas.style.cursor = parent.cursor = 'se-resize';\n                }\n                if (actPoint.endY < actPoint.startY) {\n                    var temp = actPoint.endY;\n                    actPoint.endY = actPoint.startY;\n                    actPoint.startY = temp;\n                    this.dragElement = parent.upperCanvas.style.cursor = parent.cursor = 'nw-resize';\n                }\n                this.revertCustomSelection(actPoint, tempActiveObj, 'sw-resize');\n                this.revertResizing(tempActiveObj);\n            }\n            else {\n                var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destHeight = _a.destHeight;\n                if (actPoint.startX < x && actPoint.endY > y) {\n                    width = x - actPoint.startX;\n                    height = actPoint.endY - y;\n                    scale = Math.min(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    actPoint.startX += newScale.x;\n                    actPoint.endY -= newScale.y;\n                    var endX = destLeft > 0 ? destLeft : 0;\n                    var endY = destTop + destHeight < parent.lowerCanvas.height ? destTop +\n                        destHeight : parent.lowerCanvas.height;\n                    if (actPoint.startX < endX || actPoint.endY > endY) {\n                        actPoint.startX -= newScale.x;\n                        actPoint.endY += newScale.y;\n                    }\n                }\n                else {\n                    width = actPoint.startX - x;\n                    height = y - actPoint.endY;\n                    scale = Math.max(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    actPoint.startX -= newScale.x;\n                    actPoint.endY += newScale.y;\n                    var endX = destLeft > 0 ? destLeft : 0;\n                    var endY = destTop + destHeight < parent.lowerCanvas.height ? destTop +\n                        destHeight : parent.lowerCanvas.height;\n                    if (actPoint.startX < endX || actPoint.endY > endY) {\n                        actPoint.startX += newScale.x;\n                        actPoint.endY -= newScale.y;\n                    }\n                }\n                actPoint.width = actPoint.endX - actPoint.startX;\n                actPoint.height = actPoint.endY - actPoint.startY;\n                this.revertResizing(tempActiveObj);\n            }\n            actPoint.width = actPoint.endX - actPoint.startX;\n            actPoint.height = actPoint.endY - actPoint.startY;\n            this.preventInverseResize(tempActiveObj);\n        }\n    };\n    Selection.prototype.updateSPoints = function (x, y) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var width;\n        var height;\n        var scale;\n        var tempActiveObj = extend({}, parent.activeObj, null, true);\n        if (parent.activeObj.shape !== 'text') {\n            var splitWords = void 0;\n            if (parent.activeObj.shape) {\n                splitWords = parent.activeObj.shape.split('-');\n            }\n            if (parent.activeObj.shape === 'crop-custom' || (parent.activeObj.shape && splitWords[0] !== 'crop')) {\n                if (parent.activeObj.shape !== 'line' && parent.activeObj.shape !== 'arrow' && parent.activeObj.shape !== 'path' &&\n                    parent.activeObj.rotatedAngle !== 0 && this.dragPoint.startX) {\n                    if (this.dragPoint.startX && this.dragPoint.startY) {\n                        this.previousPoint.x = this.dragPoint.endX;\n                        this.previousPoint.y = this.dragPoint.endY;\n                        this.dragPoint.endX = x;\n                        this.dragPoint.endY = y;\n                    }\n                    width = (this.dragPoint.endX - this.previousPoint.x);\n                    height = (this.dragPoint.endY - this.previousPoint.y);\n                    this.adjustRotationPoints(actPoint, width, height, parent.activeObj.rotatedAngle);\n                }\n                else {\n                    actPoint.endY = y;\n                    actPoint.height = actPoint.endY - actPoint.startY;\n                }\n                if (actPoint.endY < actPoint.startY) {\n                    var temp = actPoint.endY;\n                    actPoint.endY = actPoint.startY;\n                    actPoint.startY = temp;\n                    this.dragElement = this.resizedElement = 'n-resize';\n                }\n                this.revertResizing(tempActiveObj);\n            }\n            else {\n                var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n                if (this.isCustomSelection()) {\n                    this.performSEResize(x, y, tempActiveObj, actPoint);\n                }\n                else if (actPoint.endX > x && actPoint.endY > y) {\n                    width = actPoint.endX - x;\n                    height = actPoint.endY - y;\n                    scale = Math.min(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    actPoint.endX -= newScale.x;\n                    actPoint.endY -= newScale.y;\n                    if (actPoint.endX > (destLeft + destWidth) ||\n                        actPoint.endY > (destTop + destHeight)) {\n                        actPoint.endX += newScale.x;\n                        actPoint.endY += newScale.y;\n                    }\n                }\n                else {\n                    width = x - actPoint.endX;\n                    height = y - actPoint.endY;\n                    scale = Math.max(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    actPoint.endX += newScale.x;\n                    actPoint.endY += newScale.x;\n                    if (actPoint.endX > (destLeft + destWidth) ||\n                        actPoint.endY > (destTop + destHeight)) {\n                        actPoint.endX -= newScale.x;\n                        actPoint.endY -= newScale.y;\n                    }\n                }\n                actPoint.width = actPoint.endX - actPoint.startX;\n                actPoint.height = actPoint.endY - actPoint.startY;\n                this.revertResizing(tempActiveObj);\n            }\n        }\n    };\n    Selection.prototype.updateSEPoints = function (x, y) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var width;\n        var height;\n        var scale;\n        var tempActiveObj = extend({}, parent.activeObj, null, true);\n        if (parent.activeObj.shape === 'text') {\n            this.resizeImg(x, y, 'se-resize', tempActiveObj);\n            parent.notify('shape', { prop: 'updateFontSize', onPropertyChange: false,\n                value: { obj: parent.activeObj } });\n        }\n        else {\n            var splitWords = void 0;\n            var newScale = void 0;\n            if (parent.activeObj.shape !== undefined) {\n                splitWords = parent.activeObj.shape.split('-');\n            }\n            if (parent.activeObj.shape === 'crop-custom' || (parent.activeObj.shape !== undefined && splitWords[0] !== 'crop')\n                || this.isCustomSelection()) {\n                if (parent.activeObj.shape === 'image' || this.isCustomSelection()) {\n                    this.resizeImg(x, y, 'se-resize', tempActiveObj);\n                }\n                else {\n                    this.adjustSEPoints(actPoint, x, y, parent.activeObj.rotatedAngle);\n                }\n                if (actPoint.endX < actPoint.startX) {\n                    var temp = actPoint.endX;\n                    actPoint.endX = actPoint.startX;\n                    actPoint.startX = temp;\n                    this.dragElement = parent.upperCanvas.style.cursor = parent.cursor = 'sw-resize';\n                }\n                if (actPoint.endY < actPoint.startY) {\n                    var temp = actPoint.endY;\n                    actPoint.endY = actPoint.startY;\n                    actPoint.startY = temp;\n                    this.dragElement = parent.upperCanvas.style.cursor = parent.cursor = 'ne-resize';\n                }\n                this.revertCustomSelection(actPoint, tempActiveObj, 'se-resize');\n                this.revertResizing(tempActiveObj);\n            }\n            else {\n                var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n                if (actPoint.endX > x && actPoint.endY > y) {\n                    width = actPoint.endX - x;\n                    height = actPoint.endY - y;\n                    scale = Math.min(width, height);\n                    newScale = this.getScaleRatio(scale);\n                    actPoint.endX -= newScale.x;\n                    actPoint.endY -= newScale.y;\n                    var endX = destLeft + destWidth < parent.lowerCanvas.width ?\n                        destLeft + destWidth : parent.lowerCanvas.width;\n                    var endY = destTop + destHeight < parent.lowerCanvas.height ?\n                        destTop + destHeight : parent.lowerCanvas.height;\n                    if (actPoint.endX > endX || actPoint.endY > endY) {\n                        actPoint.endX += newScale.x;\n                        actPoint.endY += newScale.y;\n                    }\n                }\n                else {\n                    width = x - actPoint.endX;\n                    height = y - actPoint.endY;\n                    scale = Math.max(width, height);\n                    newScale = this.getScaleRatio(scale);\n                    actPoint.endX += newScale.x;\n                    actPoint.endY += newScale.y;\n                    var endX = destLeft + destWidth < parent.lowerCanvas.width ? destLeft +\n                        destWidth : parent.lowerCanvas.width;\n                    var endY = destTop + destHeight < parent.lowerCanvas.height ? destTop +\n                        destHeight : parent.lowerCanvas.height;\n                    if (actPoint.endX > endX || actPoint.endY > endY) {\n                        actPoint.endX -= newScale.x;\n                        actPoint.endY -= newScale.y;\n                    }\n                }\n                actPoint.width = actPoint.endX - actPoint.startX;\n                actPoint.height = actPoint.endY - actPoint.startY;\n                this.revertResizing(tempActiveObj);\n            }\n            this.preventInverseResize(tempActiveObj);\n        }\n    };\n    Selection.prototype.resizeImg = function (x, y, elem, tempActiveObj) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var width;\n        var height;\n        var scale;\n        var newScale;\n        if (this.previousPoint.x !== 0 && this.previousPoint.y !== 0) {\n            if (this.currentDrawingShape === 'text') {\n                this.setCursor(x, y);\n                if (parent.activeObj.textSettings.fontSize === 0) {\n                    parent.activeObj.textSettings.fontSize = 11;\n                    parent.notify('shape', { prop: 'updateFontRatio', onPropertyChange: false,\n                        value: { obj: parent.activeObj, isTextArea: null } });\n                    parent.activeObj.textSettings.text = parent.activeObj.keyHistory = 'Enter Text';\n                    parent.notify('shape', { prop: 'updateFontStyles', onPropertyChange: false,\n                        value: { isTextBox: null } });\n                    var width_2 = this.upperContext.measureText(parent.activeObj.textSettings.text).width +\n                        parent.activeObj.textSettings.fontSize * 0.5;\n                    actPoint.endX = actPoint.startX + width_2;\n                    actPoint.endY = actPoint.startY + parent.activeObj.textSettings.fontSize;\n                    actPoint.width = actPoint.endX - actPoint.startX;\n                    actPoint.height = actPoint.endY - actPoint.startY;\n                    tempActiveObj = extend({}, parent.activeObj, null, true);\n                    parent.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: parent.activeObj.activePoint, obj: parent.activeObj,\n                            isMouseMove: null, x: null, y: null } });\n                }\n            }\n            switch (parent.upperCanvas.style.cursor) {\n                case 'se-resize':\n                case 's-resize':\n                    if (this.previousPoint.x > x || this.previousPoint.y > y) {\n                        width = (this.previousPoint.x - x);\n                        height = (this.previousPoint.y - y);\n                        scale = (width + height) / 2;\n                        newScale = this.getScaleRatio(scale);\n                        this.adjustRotationPoints(actPoint, -Math.abs(newScale.x), -Math.abs(newScale.y), parent.activeObj.rotatedAngle, 'img-resize', elem);\n                    }\n                    else if (this.previousPoint.x !== 0 && this.previousPoint.y !== 0) {\n                        width = (x - this.previousPoint.x);\n                        height = (y - this.previousPoint.y);\n                        scale = (width + height) / 2;\n                        newScale = this.getScaleRatio(scale);\n                        this.adjustRotationPoints(actPoint, Math.abs(newScale.x), Math.abs(newScale.y), parent.activeObj.rotatedAngle, 'img-resize', elem);\n                    }\n                    break;\n                case 'sw-resize':\n                    if (this.previousPoint.x < x || this.previousPoint.y > y) {\n                        width = (x - this.previousPoint.x);\n                        height = (this.previousPoint.y - y);\n                        scale = (width + height) / 2;\n                        newScale = this.getScaleRatio(scale);\n                        this.adjustRotationPoints(actPoint, -Math.abs(newScale.x), -Math.abs(newScale.y), parent.activeObj.rotatedAngle, 'img-resize', elem);\n                    }\n                    else if (this.previousPoint.x !== 0 && this.previousPoint.y !== 0) {\n                        width = (this.previousPoint.x - x);\n                        height = (y - this.previousPoint.y);\n                        scale = (width + height) / 2;\n                        newScale = this.getScaleRatio(scale);\n                        this.adjustRotationPoints(actPoint, Math.abs(newScale.x), Math.abs(newScale.y), parent.activeObj.rotatedAngle, 'img-resize', elem);\n                    }\n                    break;\n                case 'w-resize':\n                case 'nw-resize':\n                    if (this.previousPoint.x < x || this.previousPoint.y < y) {\n                        width = (x - this.previousPoint.x);\n                        height = (y - this.previousPoint.y);\n                        scale = (width + height) / 2;\n                        newScale = this.getScaleRatio(scale);\n                        this.adjustRotationPoints(actPoint, -Math.abs(newScale.x), -Math.abs(newScale.y), parent.activeObj.rotatedAngle, 'img-resize', elem);\n                    }\n                    else if (this.previousPoint.x !== 0 && this.previousPoint.y !== 0) {\n                        width = (this.previousPoint.x - x);\n                        height = (this.previousPoint.y - y);\n                        scale = (width + height) / 2;\n                        newScale = this.getScaleRatio(scale);\n                        this.adjustRotationPoints(actPoint, Math.abs(newScale.x), Math.abs(newScale.y), parent.activeObj.rotatedAngle, 'img-resize', elem);\n                    }\n                    break;\n                case 'n-resize':\n                case 'ne-resize':\n                    if (this.previousPoint.x > x || this.previousPoint.y < y) {\n                        width = (this.previousPoint.x - x);\n                        height = (y - this.previousPoint.y);\n                        scale = (width + height) / 2;\n                        newScale = this.getScaleRatio(scale);\n                        this.adjustRotationPoints(actPoint, -Math.abs(newScale.x), -Math.abs(newScale.y), parent.activeObj.rotatedAngle, 'img-resize', elem);\n                    }\n                    else if (this.previousPoint.x !== 0 && this.previousPoint.y !== 0) {\n                        width = (x - this.previousPoint.x);\n                        height = (this.previousPoint.y - y);\n                        scale = (width + height) / 2;\n                        newScale = this.getScaleRatio(scale);\n                        this.adjustRotationPoints(actPoint, Math.abs(newScale.x), Math.abs(newScale.y), parent.activeObj.rotatedAngle, 'img-resize', elem);\n                    }\n                    break;\n                case 'e-resize':\n                    if (this.previousPoint.x > x || this.previousPoint.y > y) {\n                        width = (this.previousPoint.x - x);\n                        height = (this.previousPoint.y - y);\n                        scale = (width + height) / 2;\n                        newScale = this.getScaleRatio(scale);\n                        this.adjustRotationPoints(actPoint, -Math.abs(newScale.x), -Math.abs(newScale.y), parent.activeObj.rotatedAngle, 'img-resize', elem);\n                    }\n                    else if (this.previousPoint.x !== 0 && this.previousPoint.y !== 0) {\n                        width = (x - this.previousPoint.x);\n                        height = (y - this.previousPoint.y);\n                        scale = (width + height) / 2;\n                        newScale = this.getScaleRatio(scale);\n                        this.adjustRotationPoints(actPoint, Math.abs(newScale.x), Math.abs(newScale.y), parent.activeObj.rotatedAngle, 'img-resize', elem);\n                    }\n                    break;\n            }\n            actPoint.width = actPoint.endX - actPoint.startX;\n            actPoint.height = actPoint.endY - actPoint.startY;\n            if ((actPoint.width < 10 || actPoint.height < 10) ||\n                (parent.activeObj.shape === 'text' && parent.activeObj.rotatedAngle === 0 && this.preventTextDraggingInvertly())) {\n                parent.activeObj = extend({}, tempActiveObj, null, true);\n            }\n        }\n        this.previousPoint = { x: x, y: y };\n    };\n    Selection.prototype.adjustNWPoints = function (rectangle, x, y, angle) {\n        var cx = rectangle.startX + rectangle.width / 2;\n        var cy = rectangle.startY + rectangle.height / 2;\n        var rotatedC = this.rotatePoints(rectangle.endX, rectangle.endY, cx, cy, angle);\n        var newCenter = [(rotatedC[0] + x) / 2, (rotatedC[1] + y) / 2];\n        var newBottomRight = this.rotatePoints(rotatedC[0], rotatedC[1], newCenter[0], newCenter[1], -angle);\n        var newTopLeft = this.rotatePoints(x, y, newCenter[0], newCenter[1], -angle);\n        rectangle.endX = newBottomRight[0];\n        rectangle.endY = newBottomRight[1];\n        rectangle.startY = newTopLeft[1];\n        rectangle.startX = newTopLeft[0];\n        rectangle.width = rectangle.endX - rectangle.startX;\n        rectangle.height = rectangle.endY - rectangle.startY;\n        return rectangle;\n    };\n    Selection.prototype.adjustNEPoints = function (rectangle, x, y, angle) {\n        var cx = rectangle.startX + rectangle.width / 2;\n        var cy = rectangle.startY + rectangle.height / 2;\n        var rotatedD = this.rotatePoints(rectangle.startX, rectangle.endY, cx, cy, angle);\n        var newCenter = [(rotatedD[0] + x) / 2, (rotatedD[1] + y) / 2];\n        var newBottomLeft = this.rotatePoints(rotatedD[0], rotatedD[1], newCenter[0], newCenter[1], -angle);\n        var newTopRight = this.rotatePoints(x, y, newCenter[0], newCenter[1], -angle);\n        rectangle.startX = newBottomLeft[0];\n        rectangle.endY = newBottomLeft[1];\n        rectangle.width = newTopRight[0] - newBottomLeft[0];\n        rectangle.height = newBottomLeft[1] - newTopRight[1];\n        rectangle.endX = rectangle.startX + rectangle.width;\n        rectangle.startY = rectangle.endY - rectangle.height;\n        return rectangle;\n    };\n    Selection.prototype.adjustSWPoints = function (rectangle, x, y, angle) {\n        var cx = rectangle.startX + rectangle.width / 2;\n        var cy = rectangle.startY + rectangle.height / 2;\n        var rotatedB = this.rotatePoints(rectangle.endX, rectangle.startY, cx, cy, angle);\n        var newCenter = [(rotatedB[0] + x) / 2, (rotatedB[1] + y) / 2];\n        var newTopRight = this.rotatePoints(rotatedB[0], rotatedB[1], newCenter[0], newCenter[1], -angle);\n        var newBottomLeft = this.rotatePoints(x, y, newCenter[0], newCenter[1], -angle);\n        rectangle.endX = newTopRight[0];\n        rectangle.startY = newTopRight[1];\n        rectangle.startX = newBottomLeft[0];\n        rectangle.endY = newBottomLeft[1];\n        rectangle.width = rectangle.endX - rectangle.startX;\n        rectangle.height = rectangle.endY - rectangle.startY;\n        return rectangle;\n    };\n    Selection.prototype.adjustSEPoints = function (rectangle, x, y, angle) {\n        var cx = rectangle.startX + rectangle.width / 2;\n        var cy = rectangle.startY + rectangle.height / 2;\n        var rotatedA = this.rotatePoints(rectangle.startX, rectangle.startY, cx, cy, angle);\n        var newCenter = [(rotatedA[0] + x) / 2, (rotatedA[1] + y) / 2];\n        var newTopLeft = this.rotatePoints(rotatedA[0], rotatedA[1], newCenter[0], newCenter[1], -angle);\n        var newBottomRight = this.rotatePoints(x, y, newCenter[0], newCenter[1], -angle);\n        rectangle.startX = newTopLeft[0];\n        rectangle.startY = newTopLeft[1];\n        rectangle.width = newBottomRight[0] - newTopLeft[0];\n        rectangle.height = newBottomRight[1] - newTopLeft[1];\n        rectangle.endX = rectangle.startX + rectangle.width;\n        rectangle.endY = rectangle.startY + rectangle.height;\n        return rectangle;\n    };\n    Selection.prototype.adjustRotationPoints = function (rectangle, x, y, angle, type, elem) {\n        var cx = rectangle.startX + rectangle.width / 2;\n        var cy = rectangle.startY + rectangle.height / 2;\n        this.getResizeDirection(rectangle, x, y, angle, type, elem);\n        var rotatedA = this.rotatePoints(rectangle.startX, rectangle.startY, cx, cy, angle);\n        var rotatedB = this.rotatePoints(rectangle.endX, rectangle.startY, cx, cy, angle);\n        var rotatedC = this.rotatePoints(rectangle.endX, rectangle.endY, cx, cy, angle);\n        var rotatedD = this.rotatePoints(rectangle.startX, rectangle.endY, cx, cy, angle);\n        var newCenter = [(rotatedA[0] + rotatedC[0]) / 2, (rotatedA[1] + rotatedC[1]) / 2];\n        var newTopLeft = this.rotatePoints(rotatedA[0], rotatedA[1], newCenter[0], newCenter[1], -angle);\n        var newBottomLeft = this.rotatePoints(rotatedD[0], rotatedD[1], newCenter[0], newCenter[1], -angle);\n        var newTopRight = this.rotatePoints(rotatedB[0], rotatedB[1], newCenter[0], newCenter[1], -angle);\n        rectangle.startX = newTopLeft[0];\n        rectangle.startY = newTopLeft[1];\n        rectangle.endX = newTopRight[0];\n        rectangle.endY = newBottomLeft[1];\n        rectangle.width = rectangle.endX - rectangle.startX;\n        rectangle.height = rectangle.endY - rectangle.startY;\n        return rectangle;\n    };\n    Selection.prototype.rotatePoints = function (x, y, cx, cy, angle) {\n        return [\n            (x - cx) * Math.cos(angle) - (y - cy) * Math.sin(angle) + cx,\n            (x - cx) * Math.sin(angle) + (y - cy) * Math.cos(angle) + cy\n        ];\n    };\n    Selection.prototype.setResizedValue = function (element, value, x, y) {\n        switch (element) {\n            case 'x':\n                value += x;\n                break;\n            case 'y':\n                value += y;\n                break;\n            case 'abs-x':\n                value += (x > 0 ? -x : Math.abs(x));\n                break;\n            case 'abs-y':\n                value += (y > 0 ? -y : Math.abs(y));\n                break;\n            case 'y-abs-x':\n                value += (y + ((x > 0 ? -x : Math.abs(x)) / 2));\n                break;\n            case 'abs-x-abs-y':\n                value += ((x > 0 ? -x : Math.abs(x)) + ((y > 0 ? -y : Math.abs(y)) / 2));\n                break;\n            case 'abs-y-x':\n                value += ((y > 0 ? -y : Math.abs(y)) + (x / 2));\n                break;\n            case 'x-y':\n                value += (x + (y / 2));\n                break;\n            case 'y-x':\n                value += (y + (x / 2));\n                break;\n            case 'img-resize-x':\n                value += x;\n                break;\n            case 'img-resize-y':\n                value += y;\n                break;\n        }\n        return value;\n    };\n    Selection.prototype.getResizeDirection = function (rectangle, x, y, angle, type, elem) {\n        var rotatedAngle = angle * (180 / Math.PI);\n        var element = this.getResizedElement(rotatedAngle, this.resizedElement);\n        if (this.resizedElement === 'e-resize') {\n            rectangle.width = this.setResizedValue(element, rectangle.width, x, y);\n            rectangle.endX = rectangle.width + rectangle.startX;\n        }\n        else if (this.resizedElement === 'n-resize') {\n            rectangle.startY = this.setResizedValue(element, rectangle.startY, x, y);\n            rectangle.height = rectangle.endY - rectangle.startY;\n        }\n        else if (this.resizedElement === 'w-resize') {\n            rectangle.startX = this.setResizedValue(element, rectangle.startX, x, y);\n            rectangle.width = rectangle.startX + rectangle.endX;\n        }\n        else if (this.resizedElement === 's-resize') {\n            rectangle.height = this.setResizedValue(element, rectangle.height, x, y);\n            rectangle.endY = rectangle.height + rectangle.startY;\n        }\n        else if (type && type === 'img-resize') {\n            rectangle.width = this.setResizedValue('img-resize-x', rectangle.width, x, y);\n            rectangle.height = this.setResizedValue('img-resize-y', rectangle.height, x, y);\n            if (elem === 'se-resize') {\n                rectangle.endX = rectangle.width + rectangle.startX;\n                rectangle.endY = rectangle.height + rectangle.startY;\n            }\n            else if (elem === 'sw-resize') {\n                rectangle.startX = rectangle.endX - rectangle.width;\n                rectangle.endY = rectangle.height + rectangle.startY;\n            }\n            else if (elem === 'ne-resize') {\n                rectangle.endX = rectangle.width + rectangle.startX;\n                rectangle.startY = rectangle.endY - rectangle.height;\n            }\n            else if (elem === 'nw-resize') {\n                rectangle.startX = rectangle.endX - rectangle.width;\n                rectangle.startY = rectangle.endY - rectangle.height;\n            }\n        }\n        else if (type && type === 'text') {\n            if (elem === 'widthHeight') {\n                rectangle.width = this.setResizedValue('x-y', rectangle.width, x, y);\n                rectangle.endX = rectangle.width + rectangle.startX;\n                rectangle.height = this.setResizedValue('y-x', rectangle.height, x, y);\n                rectangle.endY = rectangle.height + rectangle.startY;\n            }\n            else if (elem === 'width') {\n                rectangle.width = this.setResizedValue('x-y', rectangle.width, x, y);\n                rectangle.endX = rectangle.width + rectangle.startX;\n            }\n            else if (elem === 'height') {\n                rectangle.height = this.setResizedValue('y-abs-x', rectangle.height, x, y);\n                rectangle.endY = rectangle.height + rectangle.startY;\n            }\n        }\n    };\n    Selection.prototype.getResizedElement = function (degree, element) {\n        var resizeMappings = [];\n        if (element === 'n-resize') {\n            resizeMappings = [\n                [337.5, 360, 'y'],\n                [0, 22.5, 'y'],\n                [22.5, 67.5, 'y-abs-x'],\n                [67.5, 112.5, 'abs-x'],\n                [112.5, 157.5, 'abs-x-abs-y'],\n                [157.5, 202.5, 'abs-y'],\n                [202.5, 247.5, 'abs-y-x'],\n                [247.5, 292.5, 'x'],\n                [292.5, 337.5, 'x-y']\n            ];\n        }\n        else if (element === 'e-resize') {\n            resizeMappings = [\n                [337.5, 360, 'x'],\n                [0, 22.5, 'x'],\n                [22.5, 67.5, 'x-y'],\n                [67.5, 112.5, 'y'],\n                [112.5, 157.5, 'y-abs-x'],\n                [157.5, 202.5, 'abs-x'],\n                [202.5, 247.5, 'abs-x-abs-y'],\n                [247.5, 292.5, 'abs-y'],\n                [292.5, 337.5, 'abs-y-x']\n            ];\n        }\n        else if (element === 's-resize') {\n            resizeMappings = [\n                [337.5, 360, 'y'],\n                [0, 22.5, 'y'],\n                [22.5, 67.5, 'y-abs-x'],\n                [67.5, 112.5, 'abs-x'],\n                [112.5, 157.5, 'abs-x-abs-y'],\n                [157.5, 202.5, 'abs-y'],\n                [202.5, 247.5, 'abs-y-x'],\n                [247.5, 292.5, 'x'],\n                [292.5, 337.5, 'x-y']\n            ];\n        }\n        else if (element === 'w-resize') {\n            resizeMappings = [\n                [337.5, 360, 'x'],\n                [0, 22.5, 'x'],\n                [22.5, 67.5, 'x-y'],\n                [67.5, 112.5, 'y'],\n                [112.5, 157.5, 'y-abs-x'],\n                [157.5, 202.5, 'abs-x'],\n                [202.5, 247.5, 'abs-x-abs-y'],\n                [247.5, 292.5, 'abs-y'],\n                [292.5, 337.5, 'abs-y-x']\n            ];\n        }\n        var positiveDegree = degree < 0 ? 360 - Math.abs(degree) : degree;\n        for (var _i = 0, resizeMappings_2 = resizeMappings; _i < resizeMappings_2.length; _i++) {\n            var _a = resizeMappings_2[_i], startDegree = _a[0], endDegree = _a[1], resizeElement = _a[2];\n            if ((positiveDegree > startDegree && positiveDegree <= endDegree) ||\n                (positiveDegree + 360 > startDegree && positiveDegree + 360 <= endDegree)) {\n                return resizeElement;\n            }\n        }\n        return element;\n    };\n    Selection.prototype.updateCursorStyles = function (x, y, type) {\n        var parent = this.parent;\n        var isResize = false;\n        if (parent.activeObj.keyHistory !== '' && parent.activeObj.shape === undefined && !parent.currObjType.isCustomCrop &&\n            !parent.currObjType.isLine && parent.currObjType.isText) {\n            parent.activeObj.shape = 'text';\n        }\n        var actObj = extend({}, parent.activeObj, {}, true);\n        if (isNullOrUndefined(actObj.topLeftCircle)) {\n            return;\n        }\n        var degree;\n        if (actObj.shapeDegree === 0) {\n            degree = parent.transform.degree;\n        }\n        else {\n            degree = parent.transform.degree - actObj.shapeDegree;\n        }\n        if (degree < 0) {\n            degree = 360 + degree;\n        }\n        if (this.isObjSelected) {\n            if (actObj.shape === 'line' || actObj.shape === 'arrow') {\n                isResize = this.updateCursorStylesForLineArrow(x, y, actObj);\n            }\n            else if (actObj.shape === 'path') {\n                isResize = this.updateCursorStylesForPath(x, y, actObj);\n            }\n            else if (actObj.rotatedAngle) {\n                this.setCursorForRotatedObject(actObj, x, y, parent.upperCanvas);\n                if (parent.cursor === 'grabbing') {\n                    parent.upperCanvas.style.cursor = parent.cursor = 'grabbing';\n                    this.dragElement = parent.cursor;\n                }\n                else if (parent.cursor === 'move') {\n                    this.dragPoint.startX = this.previousPoint.x = this.dragPoint.endX = x;\n                    this.dragPoint.startY = this.previousPoint.y = this.dragPoint.endY = y;\n                }\n                else if (parent.cursor !== 'default') {\n                    isResize = true;\n                    this.dragElement = parent.cursor;\n                    parent.currObjType.isResize = true;\n                }\n            }\n            else {\n                var rotationCirclePoint = this.getTransRotationPoint(actObj);\n                var radius = actObj.topLeftCircle.radius;\n                if (rotationCirclePoint &&\n                    x >= rotationCirclePoint.x - (radius * 2) &&\n                    x <= rotationCirclePoint.x + (radius * 2) &&\n                    y >= rotationCirclePoint.y - (radius * 2) &&\n                    y <= rotationCirclePoint.y + (radius * 2) && this.dragElement !== 'grabbing') {\n                    parent.upperCanvas.style.cursor = parent.cursor = 'grabbing';\n                    this.dragElement = parent.upperCanvas.style.cursor;\n                }\n                else if (x >= (actObj.topLeftCircle.startX - (radius * 2)) &&\n                    x <= (actObj.topLeftCircle.startX + (radius * 2)) &&\n                    y >= (actObj.topLeftCircle.startY - (radius * 2)) &&\n                    y <= (actObj.topLeftCircle.startY + (radius * 2)) && this.dragElement !== 'nw-resize') {\n                    actObj.topLeftCircle.startX = actObj.topLeftCircle.startY = 0;\n                    parent.upperCanvas.style.cursor = parent.cursor = 'nw-resize';\n                    isResize = true;\n                    this.dragElement = parent.upperCanvas.style.cursor;\n                }\n                else if (x >= (actObj.topLeftCircle.startX - (radius * 2)) &&\n                    x <= (actObj.topRightCircle.startX - (radius * 2)) &&\n                    y >= (actObj.topCenterCircle.startY - (radius * 2)) &&\n                    y <= (actObj.topCenterCircle.startY + (radius * 2)) && this.dragElement !== 'n-resize') {\n                    actObj.topCenterCircle.startX = actObj.topCenterCircle.startY = 0;\n                    parent.upperCanvas.style.cursor = parent.cursor = 'n-resize';\n                    isResize = true;\n                    this.dragElement = parent.upperCanvas.style.cursor;\n                }\n                else if (x >= (actObj.topRightCircle.startX - (radius * 2)) &&\n                    x <= (actObj.topRightCircle.startX + (radius * 2)) &&\n                    y >= (actObj.topRightCircle.startY - (radius * 2)) &&\n                    y <= (actObj.topRightCircle.startY + (radius * 2)) && this.dragElement !== 'ne-resize') {\n                    actObj.topRightCircle.startX = actObj.topRightCircle.startY = 0;\n                    parent.upperCanvas.style.cursor = parent.cursor = 'ne-resize';\n                    isResize = true;\n                    this.dragElement = parent.upperCanvas.style.cursor;\n                }\n                else if (x >= (actObj.centerLeftCircle.startX - (radius * 2)) &&\n                    x <= (actObj.centerLeftCircle.startX + (radius * 2)) &&\n                    y >= (actObj.topLeftCircle.startY - (radius * 2)) &&\n                    y <= (actObj.bottomLeftCircle.startY - (radius * 2)) && this.dragElement !== 'w-resize') {\n                    actObj.centerLeftCircle.startX = actObj.centerLeftCircle.startY = 0;\n                    parent.upperCanvas.style.cursor = parent.cursor = 'w-resize';\n                    isResize = true;\n                    this.dragElement = parent.upperCanvas.style.cursor;\n                }\n                else if (x >= (actObj.centerRightCircle.startX - (radius * 2)) &&\n                    x <= (actObj.centerRightCircle.startX + (radius * 2)) &&\n                    y >= (actObj.topRightCircle.startY - (radius * 2)) &&\n                    y <= (actObj.bottomRightCircle.startY - (radius * 2)) && this.dragElement !== 'e-resize') {\n                    actObj.centerRightCircle.startX = actObj.centerRightCircle.startY = 0;\n                    parent.upperCanvas.style.cursor = parent.cursor = 'e-resize';\n                    isResize = true;\n                    this.dragElement = parent.upperCanvas.style.cursor;\n                }\n                else if (x >= (actObj.bottomLeftCircle.startX - (radius * 2)) &&\n                    x <= (actObj.bottomLeftCircle.startX + (radius * 2)) &&\n                    y >= (actObj.bottomLeftCircle.startY - (radius * 2)) &&\n                    y <= (actObj.bottomLeftCircle.startY + (radius * 2)) && this.dragElement !== 'sw-resize') {\n                    actObj.bottomLeftCircle.startX = actObj.bottomLeftCircle.startY = 0;\n                    parent.upperCanvas.style.cursor = parent.cursor = 'sw-resize';\n                    isResize = true;\n                    this.dragElement = parent.upperCanvas.style.cursor;\n                }\n                else if (x >= (actObj.bottomLeftCircle.startX - (radius * 2)) &&\n                    x <= (actObj.bottomRightCircle.startX - (radius * 2)) &&\n                    y >= (actObj.bottomCenterCircle.startY - (radius * 2)) &&\n                    y <= (actObj.bottomCenterCircle.startY + (radius * 2)) && this.dragElement !== 's-resize') {\n                    actObj.bottomCenterCircle.startX = actObj.bottomCenterCircle.startY = 0;\n                    parent.upperCanvas.style.cursor = parent.cursor = 's-resize';\n                    isResize = true;\n                    this.dragElement = parent.upperCanvas.style.cursor;\n                }\n                else if (x >= (actObj.bottomRightCircle.startX - (radius * 2)) &&\n                    x <= (actObj.bottomRightCircle.startX + (radius * 2)) &&\n                    y >= (actObj.bottomRightCircle.startY - (radius * 2)) &&\n                    y <= (actObj.bottomRightCircle.startY + (radius * 2)) && this.dragElement !== 'se-resize') {\n                    actObj.bottomRightCircle.startX = actObj.bottomRightCircle.startY = 0;\n                    parent.upperCanvas.style.cursor = parent.cursor = 'se-resize';\n                    isResize = true;\n                    this.dragElement = parent.upperCanvas.style.cursor;\n                }\n                else {\n                    this.dragPoint.startX = this.previousPoint.x = this.dragPoint.endX = x;\n                    this.dragPoint.startY = this.previousPoint.y = this.dragPoint.endY = y;\n                }\n                if ((actObj.shape === 'text') && (parent.cursor === 'n-resize' ||\n                    parent.cursor === 's-resize' || parent.cursor === 'e-resize' ||\n                    parent.cursor === 'w-resize')) {\n                    parent.upperCanvas.style.cursor = parent.cursor = 'move';\n                    this.dragElement = '';\n                    this.dragPoint.startX = this.previousPoint.x = this.dragPoint.endX = x;\n                    this.dragPoint.startY = this.previousPoint.y = this.dragPoint.endY = y;\n                }\n            }\n        }\n        else {\n            this.dragPoint.startX = this.previousPoint.x = this.dragPoint.endX = x;\n            this.dragPoint.startY = this.previousPoint.y = this.dragPoint.endY = y;\n        }\n        this.previousPoint.x = this.previousPoint.y = this.diffPoint.x = this.diffPoint.y = 0;\n        if (type === 'touchstart') {\n            if (isResize || (x >= actObj.activePoint.startX && x <= actObj.activePoint.endX\n                && y >= actObj.activePoint.startY && y <= actObj.activePoint.endY) || this.dragElement === 'grabbing') {\n                parent.currObjType.isDragging = true;\n            }\n            else if (actObj.shape === 'line' || actObj.shape === 'arrow') {\n                this.setCursorForLineArrow(actObj, x, y, parent.upperCanvas);\n                if (parent.cursor === 'move') {\n                    parent.currObjType.isDragging = true;\n                }\n            }\n            else if (actObj.shape === 'path') {\n                this.setCursorForPath(actObj, x, y, parent.upperCanvas);\n                if (parent.cursor === 'move') {\n                    parent.currObjType.isDragging = true;\n                }\n            }\n        }\n        else {\n            parent.currObjType.isDragging = true;\n        }\n        if (actObj.rotatedAngle !== 0 && (this.dragElement === 'e-resize' ||\n            this.dragElement === 'w-resize' || this.dragElement === 'n-resize' ||\n            this.dragElement === 's-resize')) {\n            this.dragPoint.startX = this.previousPoint.x = this.dragPoint.endX = x;\n            this.dragPoint.startY = this.previousPoint.y = this.dragPoint.endY = y;\n        }\n    };\n    Selection.prototype.updateCursorStylesForLineArrow = function (x, y, actObj) {\n        var isResize = false;\n        var parent = this.parent;\n        var point;\n        var radius = actObj.topLeftCircle.radius;\n        for (var i = 0; i < 5; i++) {\n            point = actObj.pointColl[i];\n            if (x >= (point.x - (radius * 2)) && x <= (point.x + (radius * 2)) &&\n                y >= (point.y - (radius * 2)) && y <= (point.y + (radius * 2))) {\n                actObj.centerLeftCircle.startX = actObj.centerLeftCircle.startY = 0;\n                this.dragElement = 'w-resize';\n                isResize = true;\n                break;\n            }\n        }\n        if (!isResize) {\n            for (var i = 1; i < 6; i++) {\n                point = actObj.pointColl[actObj.pointColl.length - i];\n                if (x >= (point.x - (radius * 2)) && x <= (point.x + (radius * 2)) &&\n                    y >= (point.y - (radius * 2)) && y <= (point.y + (radius * 2))) {\n                    actObj.centerRightCircle.startX = actObj.centerRightCircle.startY = 0;\n                    this.dragElement = 'e-resize';\n                    isResize = true;\n                    break;\n                }\n            }\n        }\n        if (!isResize) {\n            for (var i = 0; i < actObj.pointColl.length; i++) {\n                point = actObj.pointColl[i];\n                if (x >= (point.x - (radius * 2)) && x <= (point.x + (radius * 2)) &&\n                    y >= (point.y - (radius * 2)) && y <= (point.y + (radius * 2))) {\n                    parent.upperCanvas.style.cursor = parent.cursor = 'move';\n                    this.dragPoint.startX = this.previousPoint.x = this.dragPoint.endX = x;\n                    this.dragPoint.startY = this.previousPoint.y = this.dragPoint.endY = y;\n                    break;\n                }\n                else {\n                    parent.upperCanvas.style.cursor = parent.cursor = 'default';\n                }\n            }\n        }\n        return isResize;\n    };\n    Selection.prototype.updateCursorStylesForPath = function (x, y, actObj) {\n        var isResize = false;\n        var parent = this.parent;\n        this.pathAdjustedIndex = this.setCursorForLineArrow(actObj, x, y, parent.upperCanvas);\n        if (parent.cursor === 'move') {\n            isResize = true;\n            this.dragElement = 'pathDrag';\n        }\n        if (!isResize) {\n            parent.upperCanvas.style.cursor = parent.cursor = 'move';\n            this.dragPoint.startX = this.previousPoint.x = this.dragPoint.endX = x;\n            this.dragPoint.startY = this.previousPoint.y = this.dragPoint.endY = y;\n        }\n        return isResize;\n    };\n    Selection.prototype.setTextSelection = function (width, height) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var degree = parent.transform.degree;\n        if (parent.activeObj.shapeDegree === 0) {\n            degree = parent.transform.degree;\n        }\n        else {\n            degree = parent.transform.degree - parent.activeObj.shapeDegree;\n        }\n        if (degree < 0) {\n            degree = 360 + degree;\n        }\n        for (var i = 0, len = parent.activeObj.flipObjColl.length; i < len; i++) {\n            var flip = parent.activeObj.flipObjColl[i].toLowerCase();\n            switch (degree) {\n                case 0:\n                    switch (flip) {\n                        case 'horizontal':\n                            actPoint = { startX: actPoint.endX - width, startY: actPoint.startY, endX: (actPoint.endX),\n                                endY: actPoint.startY + (height ? height : 0) };\n                            break;\n                        case 'vertical':\n                            actPoint.startY = actPoint.endY - height;\n                            actPoint = { startX: actPoint.startX, startY: actPoint.startY, endX: (actPoint.startX + (width ? width : 0)),\n                                endY: actPoint.endY };\n                            break;\n                        default:\n                            actPoint = { startX: actPoint.startX,\n                                startY: actPoint.startY, endX: (actPoint.startX + (width ? width : 0)), endY: actPoint.startY +\n                                    (height ? height : 0) };\n                            break;\n                    }\n                    break;\n                case 90:\n                    switch (flip) {\n                        case 'horizontal':\n                            actPoint.endX = actPoint.startX + height;\n                            actPoint = { startX: actPoint.startX, startY: actPoint.startY, endX: (actPoint.endX),\n                                endY: actPoint.startY + (width ? width : 0) };\n                            break;\n                        case 'vertical':\n                            actPoint.startX = actPoint.endX - height;\n                            actPoint = { startX: actPoint.startX, startY: actPoint.endY - width, endX: (actPoint.endX), endY: actPoint.endY };\n                            break;\n                        default:\n                            actPoint.startX = actPoint.endX - height;\n                            actPoint = { startX: actPoint.startX, startY: actPoint.startY, endX: (actPoint.endX),\n                                endY: actPoint.startY + (width ? width : 0) };\n                            break;\n                    }\n                    break;\n                case 180:\n                    switch (flip) {\n                        case 'horizontal':\n                            actPoint.startY = actPoint.endY - height;\n                            actPoint = { startX: actPoint.startX, startY: actPoint.startY, endX: (actPoint.startX + width),\n                                endY: actPoint.endY };\n                            break;\n                        case 'vertical':\n                            actPoint.endY = actPoint.startY + height;\n                            actPoint = { endX: actPoint.endX, endY: actPoint.endY, startX: (actPoint.endX - (width ? width : 0)),\n                                startY: actPoint.startY };\n                            break;\n                        default:\n                            actPoint = { endX: actPoint.endX, endY: actPoint.endY, startX: (actPoint.endX - (width ? width : 0)),\n                                startY: actPoint.endY - (height ? height : 0) };\n                            break;\n                    }\n                    break;\n                case 270:\n                    switch (flip) {\n                        case 'horizontal':\n                            actPoint.startX = actPoint.endX - height;\n                            actPoint = { startX: actPoint.startX, startY: actPoint.endY - (width ? width : 0), endX: actPoint.endX,\n                                endY: actPoint.endY };\n                            break;\n                        case 'vertical':\n                            actPoint = { startX: actPoint.startX, startY: actPoint.startY, endX: (actPoint.startX + height),\n                                endY: actPoint.startY + (width ? width : 0) };\n                            break;\n                        default:\n                            actPoint.endX = actPoint.startX + height;\n                            actPoint = { startX: actPoint.startX, startY: actPoint.endY - (width ? width : 0), endX: actPoint.endX,\n                                endY: actPoint.endY };\n                            break;\n                    }\n                    break;\n            }\n        }\n        if (parent.activeObj.flipObjColl.length === 0) {\n            switch (degree) {\n                case 0:\n                    actPoint = { startX: actPoint.startX, startY: actPoint.startY, endX: (actPoint.startX + (width ? width : 0)),\n                        endY: actPoint.startY + (height ? height : 0) };\n                    break;\n                case 90:\n                    actPoint.startX = actPoint.endX - height;\n                    actPoint = { startX: actPoint.startX, startY: actPoint.startY, endX: (actPoint.endX),\n                        endY: actPoint.startY + (width ? width : 0) };\n                    break;\n                case 180:\n                    actPoint = { endX: actPoint.endX, endY: actPoint.endY, startX: (actPoint.endX - (width ? width : 0)),\n                        startY: actPoint.endY - (height ? height : 0) };\n                    break;\n                case 270:\n                    actPoint.endX = actPoint.startX + height;\n                    actPoint = { startX: actPoint.startX, startY: actPoint.endY - (width ? width : 0), endX: actPoint.endX,\n                        endY: actPoint.endY };\n                    break;\n            }\n        }\n        actPoint.width = actPoint.endX - actPoint.startX;\n        actPoint.height = actPoint.endY - actPoint.startY;\n        parent.activeObj.activePoint = actPoint;\n        if (parent.transform.degree === 360 || parent.transform.degree === -360) {\n            parent.transform.degree = 0;\n        }\n    };\n    Selection.prototype.setActivePoint = function (startX, startY) {\n        var parent = this.parent;\n        var activePoint = parent.activeObj.activePoint;\n        if (isNullOrUndefined(activePoint)) {\n            return;\n        }\n        if (parent.currObjType.isText) {\n            var textWidth = startX ? startX : 0;\n            var textHeight = startY ? startY : parent.activeObj.textSettings.fontSize;\n            if (parent.activeObj.textSettings.fontSize === undefined) {\n                parent.activeObj.textSettings.fontSize = (Math.abs(parent.baseImgCanvas.width - parent.baseImgCanvas.height)) * 0.1;\n            }\n            this.setTextSelection(textWidth, textHeight);\n            this.mouseDownPoint.x = activePoint.endX;\n            this.mouseDownPoint.y = activePoint.endY;\n            if (parent.activeObj.horTopLine !== undefined) {\n                parent.activeObj.activePoint = extend({}, activePoint, {}, true);\n            }\n            parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate' } });\n        }\n        else if (startX && startY) {\n            activePoint.startX = this.mouseDownPoint.x = startX;\n            activePoint.startY = this.mouseDownPoint.y = startY;\n            parent.currObjType.isDragging = true;\n        }\n        else {\n            var selectInfo = parent.activeObj;\n            activePoint = { startX: selectInfo.horTopLine.startX, startY: selectInfo.horTopLine.startY,\n                endX: selectInfo.horTopLine.endX, endY: selectInfo.horTopLine.endY };\n            activePoint.width = activePoint.endX - activePoint.startX;\n            activePoint.height = activePoint.endY - activePoint.startY;\n        }\n    };\n    Selection.prototype.mouseDownEventHandler = function (e) {\n        var parent = this.parent;\n        parent.isKBDNavigation = false;\n        this.mouseDown = e.currentTarget === parent.lowerCanvas || e.currentTarget === parent.upperCanvas ?\n            'canvas' : '';\n        if (e.type === 'touchstart') {\n            this.isTouch = true;\n        }\n        else {\n            this.isTouch = false;\n        }\n        if (e.type === 'touchstart' && e.currentTarget === parent.lowerCanvas && !parent.isImageLoaded) {\n            return;\n        }\n        this.isCropSelection = false;\n        this.isPan = true;\n        var splitWords;\n        if (parent.activeObj.shape !== undefined) {\n            splitWords = parent.activeObj.shape.split('-');\n        }\n        if (splitWords !== undefined && splitWords[0] === 'crop') {\n            this.isCropSelection = true;\n        }\n        if (this.isCropSelection) {\n            this.dragCanvas = parent.togglePan = true;\n        }\n        if (parent.cursor === 'grabbing') {\n            var obj = { shapeSettingsObj: {} };\n            this.isGrabbing = true;\n            parent.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: obj } });\n            var shapeSettings = obj['shapeSettingsObj'];\n            var shapeResizingArgs = { cancel: false, action: 'rotate-start', previousShapeSettings: shapeSettings, allowShapeOverflow: this.allowOutofBound() };\n            var shapeMovingArgs = { cancel: false, action: 'rotate-start', previousShapeSettings: shapeSettings, allowShapeOverflow: this.allowOutofBound() };\n            this.triggerShapeChange(shapeResizingArgs, shapeMovingArgs, 'mouse-down');\n        }\n        var imageEditorClickEventArgs = { point: this.setXYPoints(e) };\n        parent.trigger('click', imageEditorClickEventArgs);\n        this.isMouseDown = true;\n        this.isMouseUp = false;\n        this.clickEvent(imageEditorClickEventArgs, e);\n    };\n    Selection.prototype.getImagePoints = function (x, y) {\n        var parent = this.parent;\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        if (x < destLeft) {\n            x = destLeft;\n        }\n        else if (x > destLeft + destWidth) {\n            x = destLeft + destWidth;\n        }\n        if (y < destTop) {\n            y = destTop;\n        }\n        else if (y > destTop + destHeight) {\n            y = destTop + destHeight;\n        }\n        return { x: x, y: y };\n    };\n    Selection.prototype.clickEvent = function (imageEditorClickEventArgs, e) {\n        var parent = this.parent;\n        var activePoint = parent.activeObj.activePoint;\n        var x = imageEditorClickEventArgs.point.x;\n        var y = imageEditorClickEventArgs.point.y;\n        var cursor = parent.activeObj.shape && parent.activeObj.shape === 'text' ?\n            parent.cursor : 'default';\n        var tempCursor = parent.upperCanvas.style.cursor;\n        if (parent.isResize) {\n            this.performEnterAction();\n            parent.upperCanvas.style.cursor = 'default';\n            return;\n        }\n        else if (JSON.stringify(parent.frameObj) !== JSON.stringify(parent.tempFrameObj)) {\n            parent.okBtn();\n        }\n        else if (this.currentDrawingShape !== '' && (!this.isShapeTouch(e, this.isCropSelection) &&\n            ((this.isTouch) || tempCursor === 'crosshair' || parent.isShapeDrawing))) {\n            if (parent.drawingShape && !parent.isShapeDrawing) {\n                parent.okBtn();\n                parent.enableShapeDrawing(parent.toPascalCase(parent.drawingShape), true);\n            }\n            activePoint = parent.activeObj.activePoint;\n            var object_1 = { currObj: {} };\n            parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object_1 } });\n            this.initialPrevObj = object_1['currObj'];\n            this.initialPrevObj.objColl = extend([], parent.objColl, [], true);\n            this.initialPrevObj.pointColl = extend([], parent.pointColl, [], true);\n            this.initialPrevObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n            var selPointCollObj = { selPointColl: null };\n            parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n                value: { obj: selPointCollObj } });\n            this.initialPrevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n            this.setActivePoint(x, y);\n            activePoint = parent.activeObj.activePoint;\n            if (this.currentDrawingShape === 'path') {\n                var point = this.getImagePoints(x, y);\n                parent.activeObj.pointColl.push({ x: point.x, y: point.y });\n                if (activePoint.width !== 0 && activePoint.height !== 0) {\n                    activePoint.width = 0;\n                    activePoint.height = 0;\n                    activePoint.startX = parent.activeObj.pointColl[parent.activeObj.pointColl.length - 1].x;\n                    activePoint.startY = parent.activeObj.pointColl[parent.activeObj.pointColl.length - 1].y;\n                }\n            }\n            activePoint.endX = activePoint.startX;\n            activePoint.endY = activePoint.startY;\n            if (this.currentDrawingShape === 'text') {\n                parent.activeObj.textSettings.fontSize = 11;\n                this.previousPoint.x = activePoint.startX;\n                this.previousPoint.y = activePoint.startY;\n                parent.notify('shape', { prop: 'updateFontStyles', onPropertyChange: false,\n                    value: { isTextBox: null } });\n                var width = this.upperContext.measureText(parent.activeObj.textSettings.text).width + parent.activeObj.textSettings.fontSize * 0.5;\n                activePoint.endX = activePoint.startX + width;\n                activePoint.endY = activePoint.startY + parent.activeObj.textSettings.fontSize;\n                activePoint.width = activePoint.endX - activePoint.startX;\n                activePoint.height = activePoint.endY - activePoint.startY;\n            }\n            else if (this.currentDrawingShape === 'arrow') {\n                parent.activeObj.start = this.arrowShape[0];\n                parent.activeObj.end = this.arrowShape[1];\n            }\n            parent.currObjType.isDragging = true;\n            var previousShapeSettings = this.updatePrevShapeSettings();\n            var shapeResizingArgs = { cancel: false, action: 'draw-start', previousShapeSettings: previousShapeSettings, allowShapeOverflow: this.allowOutofBound() };\n            var shapeMovingArgs = { cancel: false, action: 'move', previousShapeSettings: previousShapeSettings, allowShapeOverflow: this.allowOutofBound() };\n            this.shapeResizingArgs = shapeResizingArgs;\n            this.shapeMovingArgs = shapeMovingArgs;\n            this.triggerShapeChange(shapeResizingArgs, shapeMovingArgs, 'mouse-down');\n            parent.activeObj.activePoint = activePoint;\n            parent.isShapeDrawing = true;\n            this.tempActiveObj = extend({}, parent.activeObj, {}, true);\n            return;\n        }\n        parent.notify('draw', { prop: 'resetFrameZoom', onPropertyChange: false, value: { isOk: true } });\n        if (this.isCropSelection && this.dragCanvas) {\n            this.setCursor(x, y);\n            if (parent.cursor !== 'move' && parent.cursor !== 'crosshair' &&\n                parent.cursor !== 'default' && parent.cursor !== 'grab') {\n                this.isPan = false;\n            }\n        }\n        if (parent.activeObj.shape) {\n            this.isObjSelected = true;\n        }\n        else {\n            this.isObjSelected = false;\n        }\n        var object = { currObj: {} };\n        parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        var prevObj = object['currObj'];\n        var activeObj = extend({}, parent.activeObj, null, true);\n        var isShape = this.isShapeTouch(e, this.isCropSelection);\n        var isFreehandDraw = this.isFreehandDrawTouch(e, this.isCropSelection);\n        var isShapeClick = isShape ? isShape : this.isShapeClick(e, this.isCropSelection);\n        var allowUndoRedoPush = this.applyCurrShape(isShapeClick);\n        var isTextArea = parent.textArea.style.display !== 'none' ? true : false;\n        if (this.isTouch && !isShape && activeObj.shape && !this.isCropSelection) {\n            if (this.applyObj(x, y)) {\n                parent.okBtn(true);\n                parent.notify('draw', { prop: 'setPrevActObj', onPropertyChange: false, value: { prevActObj: null } });\n            }\n            var prevCropObj = extend({}, parent.cropObj, {}, true);\n            parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                value: { operation: 'shapeTransform', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                    previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                    previousCropObj: prevCropObj, previousText: null,\n                    currentText: null, previousFilter: null, isCircleCrop: parent.isCircleCrop } });\n            if (allowUndoRedoPush) {\n                parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n            }\n        }\n        if (!isShape && !parent.togglePen && !this.isCropSelection && parent.activeObj.redactType !== 'blur' && parent.activeObj.redactType !== 'pixelate') {\n            parent.notify('toolbar', { prop: 'refresh-main-toolbar', onPropertyChange: false });\n            parent.notify('toolbar', { prop: 'close-contextual-toolbar', onPropertyChange: false });\n        }\n        if (this.dragCanvas && this.isPan && (parent.cursor === 'grab' || this.isTouch)\n            && !isShape && !isFreehandDraw && !parent.togglePen) {\n            if (this.applyObj(x, y)) {\n                parent.okBtn(true);\n                if (allowUndoRedoPush) {\n                    var cursor_1 = parent.cursor;\n                    parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n                    parent.cursor = cursor_1;\n                }\n                parent.notify('draw', { prop: 'setPrevActObj', onPropertyChange: false, value: { prevActObj: null } });\n            }\n            if (this.isFhdEditing) {\n                parent.notify('freehand-draw', { prop: 'applyFhd', onPropertyChange: false });\n                this.isFhdCustomized = false;\n                parent.notify('toolbar', { prop: 'destroy-qa-toolbar', onPropertyChange: false });\n            }\n            var shape = parent.activeObj.shape;\n            var shapeColl = ['rectangle', 'ellipse', 'line', 'arrow', 'path', 'text', 'image', 'redact'];\n            if (shape && shapeColl.indexOf(shape) > -1) {\n                parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n                    value: { x: null, y: null, isMouseDown: null } });\n                parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                parent.notify('toolbar', { prop: 'setCurrentToolbar', value: { type: 'main' } });\n                parent.notify('toolbar', { prop: 'refresh-main-toolbar', onPropertyChange: false });\n            }\n            var isCropSelection = false;\n            if (parent.activeObj.shape && parent.activeObj.shape.indexOf('crop-') > -1) {\n                isCropSelection = true;\n            }\n            if (parent.element.querySelector('.e-contextual-toolbar-wrapper') && !isCropSelection) {\n                if (!parent.element.querySelector('.e-contextual-toolbar-wrapper').classList.contains('e-hide')) {\n                    parent.okBtn();\n                    parent.element.querySelector('.e-contextual-toolbar-wrapper').classList.add('e-hide');\n                }\n            }\n            this.canvasMouseDownHandler(e);\n        }\n        else {\n            var isLineArrow = false;\n            if (parent.activeObj.shape && (parent.activeObj.shape === 'line' ||\n                parent.activeObj.shape === 'arrow')) {\n                isLineArrow = true;\n            }\n            var points = this.setXYPoints(e);\n            var x_1 = points.x;\n            var y_1 = points.y;\n            if (this.applyObj(x_1, y_1)) {\n                parent.okBtn(true);\n                if (allowUndoRedoPush) {\n                    var cursor_2 = parent.cursor;\n                    parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n                    parent.cursor = cursor_2;\n                }\n                parent.notify('draw', { prop: 'setPrevActObj', onPropertyChange: false, value: { prevActObj: null } });\n            }\n            parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n                value: { x: x_1, y: y_1, isMouseDown: true } });\n            var obj = { index: null };\n            parent.notify('freehand-draw', { prop: 'getFreehandDrawHoveredIndex', onPropertyChange: false, value: { obj: obj } });\n            var indexObj = { freehandSelectedIndex: null };\n            parent.notify('freehand-draw', { prop: 'getFreehandSelectedIndex', onPropertyChange: false, value: { obj: indexObj } });\n            if (this.isFhdPoint || (this.isFhdCustomized && !parent.togglePen)) {\n                if (!isNullOrUndefined(indexObj['freehandSelectedIndex']) &&\n                    indexObj['freehandSelectedIndex'] !== obj['index']) {\n                    var tempHoveredIndex = obj['index'];\n                    parent.okBtn();\n                    this.isFhdCustomized = false;\n                    parent.notify('freehand-draw', { prop: 'setFreehandDrawHoveredIndex', onPropertyChange: false,\n                        value: { index: tempHoveredIndex } });\n                    if (obj['index'] > -1) {\n                        var strokeColor = parent.pointColl[obj['index']].strokeColor;\n                        parent.notify('freehand-draw', { prop: 'hoverFhd', onPropertyChange: false,\n                            value: { strokeColor: strokeColor, strokeWidth: parent.pointColl[obj['index']].strokeWidth } });\n                    }\n                }\n                indexObj['freehandSelectedIndex'] = null;\n                parent.notify('freehand-draw', { prop: 'getFreehandSelectedIndex', onPropertyChange: false, value: { obj: indexObj } });\n                var objColl = extend([], parent.objColl, [], true);\n                if (!isNullOrUndefined(obj['index']) && obj['index'] > -1) {\n                    parent.notify('freehand-draw', { prop: 'selectFhd', value: { type: 'ok' } });\n                    parent.notify('freehand-draw', { prop: 'hoverFhd', onPropertyChange: false,\n                        value: { strokeColor: null, strokeWidth: null } });\n                    parent.notify('toolbar', { prop: 'renderQAT', onPropertyChange: false, value: { isPenEdit: true } });\n                }\n                else if (indexObj['freehandSelectedIndex']) {\n                    parent.okBtn();\n                    var strokeColor = parent.pointColl[indexObj['freehandSelectedIndex']].strokeColor;\n                    parent.notify('freehand-draw', { prop: 'hoverFhd', onPropertyChange: false,\n                        value: { strokeColor: strokeColor, strokeWidth: parent.pointColl[indexObj['freehandSelectedIndex']].strokeWidth } });\n                }\n                else if (this.findTargetObj(x_1, y_1, false)) {\n                    parent.objColl = objColl;\n                    this.findTarget(x_1, y_1, e.type);\n                    parent.notify('draw', { prop: 'redrawDownScale' });\n                }\n            }\n            else {\n                if (this.isFhdEditing) {\n                    parent.apply();\n                    var qbArea = document.getElementById(parent.element.id + '_quickAccessToolbarArea');\n                    if (qbArea) {\n                        qbArea.style.display = 'none';\n                    }\n                    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                    var point = parent.pointColl[indexObj['freehandSelectedIndex']];\n                    var shapeSettings = { id: 'pen_' + (indexObj['freehandSelectedIndex'] + 1), type: ShapeType.FreehandDraw,\n                        startX: point.points[0].x, startY: point.points[0].y, strokeColor: point.strokeColor,\n                        strokeWidth: point.strokeWidth, points: point.points, opacity: point.opacity,\n                        index: point.order };\n                    var shapeChangedArgs = { action: 'apply', currentShapeSettings: extend({}, shapeSettings, {}, true) };\n                    parent.trigger('shapeChange', shapeChangedArgs);\n                    parent.editCompleteArgs = shapeChangedArgs;\n                }\n                var isPenDraw = parent.togglePen;\n                parent.notify('toolbar', { prop: 'close-contextual-toolbar', onPropertyChange: false });\n                if (isPenDraw) {\n                    parent.freeHandDraw(true);\n                }\n                this.isFhdEditing = false;\n                if (isLineArrow) {\n                    this.setCursor(x_1, y_1);\n                }\n                else if (cursor !== 'default') {\n                    parent.upperCanvas.style.cursor = parent.cursor = cursor;\n                }\n                if (parent.cursor === 'crosshair' || (Browser.isDevice && parent.togglePen)) {\n                    if (parent.togglePen) {\n                        if (isNullOrUndefined(parent.activeObj.strokeSettings)) {\n                            var obj_1 = { strokeSettings: {} };\n                            parent.notify('shape', { prop: 'getStrokeSettings', onPropertyChange: false, value: { obj: obj_1 } });\n                            parent.activeObj.strokeSettings = obj_1['strokeSettings'];\n                        }\n                        var obj_2 = { penStrokeWidth: null };\n                        parent.notify('freehand-draw', { prop: 'getPenStrokeWidth', onPropertyChange: false, value: { obj: obj_2 } });\n                        if (isNullOrUndefined(obj_2['penStrokeWidth'])) {\n                            parent.notify('freehand-draw', { prop: 'setPenStrokeWidth', onPropertyChange: false, value: { value: 2 } });\n                        }\n                        this.upperContext.strokeStyle = parent.activeObj.strokeSettings.strokeColor;\n                        this.upperContext.fillStyle = parent.activeObj.strokeSettings.strokeColor;\n                        parent.notify('freehand-draw', { prop: 'resetSelPoints', onPropertyChange: false });\n                        parent.notify('freehand-draw', { prop: 'freehandDownHandler', onPropertyChange: false,\n                            value: { e: e, canvas: parent.upperCanvas } });\n                    }\n                    else {\n                        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                    }\n                    parent.currObjType.isActiveObj = false;\n                    this.dragElement = '';\n                    this.dragPoint.startX = this.dragPoint.startY = this.dragPoint.endX = this.dragPoint.endY = 0;\n                }\n                if (((this.isTouch && tempCursor !== 'crosshair' || parent.cursor !== 'crosshair') &&\n                    e.type.toLowerCase() === 'touchstart') ||\n                    (parent.currObjType.isActiveObj && parent.cursor !== 'default' && !parent.togglePen)) {\n                    parent.notify('draw', { prop: 'updateTempObjColl' });\n                    parent.notify('draw', { prop: 'updateTempPointColl' });\n                    this.findTarget(x_1, y_1, e.type);\n                    parent.notify('draw', { prop: 'redrawDownScale' });\n                }\n                else if ((parent.currObjType.shape === '' || parent.currObjType.isCustomCrop) && !parent.togglePen && parent.cursor !== 'default') {\n                    this.setActivePoint(x_1, y_1);\n                }\n                if (isTextArea) {\n                    parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n                }\n            }\n        }\n        this.isShapeInserted = false;\n        this.tempActiveObj = extend({}, parent.activeObj, {}, true);\n    };\n    Selection.prototype.mouseMoveEventHandler = function (e) {\n        var parent = this.parent;\n        var cursor = parent.cursor;\n        var canvasCursor = parent.upperCanvas.style.cursor;\n        e.preventDefault();\n        if (this.isPreventShaping || (parent.isShapeDrawing && parent.currObjType.isDragging && this.isTouch &&\n            parent.activeObj.shape && parent.activeObj.shape === 'path')) {\n            return;\n        }\n        if (parent.cursor === 'grabbing' && this.isGrabbing) {\n            var obj = { shapeSettingsObj: {} };\n            parent.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: obj } });\n            var shapeSettings = obj['shapeSettingsObj'];\n            var shapeResizingArgs = { cancel: false, action: 'rotating', previousShapeSettings: shapeSettings, allowShapeOverflow: this.allowOutofBound() };\n            var shapeMovingArgs = { cancel: false, action: 'rotating', previousShapeSettings: shapeSettings, allowShapeOverflow: this.allowOutofBound() };\n            this.triggerShapeChange(shapeResizingArgs, shapeMovingArgs, 'mouse-down');\n        }\n        if (this.timer && this.timer > 0 && this.dragPoint.startX && this.dragPoint.startY) {\n            var width = Math.abs(this.dragPoint.startX - e.touches[0].clientX);\n            var height = Math.abs(this.dragPoint.startY - e.touches[0].clientY);\n            if (width > 10 || height > 10) {\n                this.timer = 0;\n            }\n        }\n        var bbox = parent.lowerCanvas.getBoundingClientRect();\n        if (e.type === 'touchmove' && e.touches.length === 2) {\n            if (this.isFirstMove) {\n                this.startTouches = this.targetTouches(e.touches);\n                this.tempTouches = [];\n                this.tempTouches.push({ x: (e.touches[0].clientX || (e.touches[0].pageX - parent.lowerCanvas.offsetLeft) - bbox.left),\n                    y: (e.touches[0].clientY || (e.touches[0].pageY - parent.lowerCanvas.offsetTop)) - bbox.top });\n                this.tempTouches.push({ x: (e.touches[1].clientX || (e.touches[1].pageX - parent.lowerCanvas.offsetLeft)) - bbox.left,\n                    y: (e.touches[1].clientY || (e.touches[1].pageY - parent.lowerCanvas.offsetTop)) - bbox.top });\n            }\n            else {\n                var firstFingerX = (e.touches[0].clientX || (e.touches[0].pageX - parent.lowerCanvas.offsetLeft)) - bbox.left;\n                var firstFingerY = (e.touches[0].clientY || (e.touches[0].pageY - parent.lowerCanvas.offsetTop)) - bbox.top;\n                var secondFingerX = (e.touches[1].clientX || (e.touches[1].pageX - parent.lowerCanvas.offsetLeft)) - bbox.left;\n                var secondFingerY = (e.touches[1].clientY || (e.touches[1].pageY - parent.lowerCanvas.offsetTop)) - bbox.top;\n                var center = { x: firstFingerX < secondFingerX ? secondFingerX - ((secondFingerX - firstFingerX) / 2) :\n                        firstFingerX - ((firstFingerX - secondFingerX) / 2), y: firstFingerY < secondFingerY ?\n                        secondFingerY - ((secondFingerY - firstFingerY) / 2) : firstFingerY - ((firstFingerY - secondFingerY) / 2) };\n                if (this.currMousePoint.x !== center.x && this.currMousePoint.y !== center.y) {\n                    var type = '';\n                    if (e.type === 'touchmove' && (parent.zoomSettings.zoomTrigger & ZoomTrigger.Pinch) === ZoomTrigger.Pinch) {\n                        this.zoomType = 'Pinch';\n                        var scale = this.calculateScale(this.startTouches, this.targetTouches(e.touches));\n                        this.startTouches = this.targetTouches(e.touches);\n                        if (scale > 1) {\n                            type = 'zoomIn';\n                        }\n                        else if (scale < 1) {\n                            type = 'zoomOut';\n                        }\n                    }\n                    if (type !== '') {\n                        parent.isZoomBtnClick = true;\n                        parent.notify('draw', { prop: 'performPointZoom', onPropertyChange: false,\n                            value: { x: center.x, y: center.y, type: type, isResize: null } });\n                    }\n                    this.tempTouches = [];\n                    this.tempTouches.push({ x: e.touches[0].clientX || (e.touches[0].pageX - parent.lowerCanvas.offsetLeft),\n                        y: e.touches[0].clientY || (e.touches[0].pageY - parent.lowerCanvas.offsetTop) });\n                    this.tempTouches.push({ x: e.touches[1].clientX || (e.touches[1].pageX - parent.lowerCanvas.offsetLeft),\n                        y: e.touches[1].clientY || (e.touches[1].pageY - parent.lowerCanvas.offsetTop) });\n                    this.currMousePoint.x = center.x;\n                    this.currMousePoint.y = center.y;\n                    this.isPinching = true;\n                }\n            }\n            this.isFirstMove = false;\n            return;\n        }\n        var x;\n        var y;\n        if (e.type === 'mousemove') {\n            x = e.clientX;\n            y = e.clientY;\n        }\n        else {\n            this.touchEndPoint.x = x = e.touches[0].clientX;\n            this.touchEndPoint.y = y = e.touches[0].clientY;\n        }\n        x -= bbox.left;\n        y -= bbox.top;\n        this.canvasMouseMoveHandler(e);\n        var isCropSelection = false;\n        var splitWords;\n        if (parent.activeObj.shape !== undefined) {\n            splitWords = parent.activeObj.shape.split('-');\n        }\n        if (splitWords !== undefined && splitWords[0] === 'crop') {\n            isCropSelection = true;\n        }\n        if (isCropSelection) {\n            parent.notify('transform', { prop: 'disableZoomOutBtn', value: { isZoomOut: true } });\n        }\n        parent.upperCanvas.style.cursor = canvasCursor;\n        parent.cursor = cursor;\n        if (parent.currObjType.isActiveObj && (parent.activeObj.activePoint !== undefined || parent.objColl.length > 0) &&\n            !this.dragCanvas || parent.activeObj.activePoint !== undefined) {\n            if (this.dragElement === '') {\n                this.setCursor(x, y);\n                if ((parent.activeObj.activePoint &&\n                    (parent.activeObj.activePoint.width === 0 || (!isNullOrUndefined(parent.activeObj.currIndex) &&\n                        this.cursorTargetId !== parent.activeObj.currIndex)))\n                    && parent.cursor !== 'default' &&\n                    parent.cursor !== 'move' && parent.cursor !== 'crosshair'\n                    && parent.cursor !== 'grab' && parent.cursor !== 'pointer') {\n                    parent.upperCanvas.style.cursor = parent.cursor = 'move';\n                }\n                this.findTarget(x, y, e.type);\n            }\n        }\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        if (parent.currObjType.isDragging) {\n            if (parent.activeObj.shape && parent.activeObj.preventShapeDragOut) {\n                if (x < destLeft || x > destLeft + destWidth || y < destTop || y > destTop + destHeight) {\n                    return;\n                }\n            }\n            this.upperContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n            this.updateActivePoint(x, y, isCropSelection);\n            parent.notify('shape', { prop: 'updateTrianglePoints', onPropertyChange: false, value: { obj: parent.activeObj } });\n            if (this.isPreventDragging) {\n                if (!this.isShapeDragOut()) {\n                    this.isPreventDragging = false;\n                }\n                parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: null, isCropRatio: null,\n                        points: null, isPreventDrag: true, saveContext: null, isPreventSelection: null } });\n            }\n            else {\n                parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: null, isCropRatio: null,\n                        points: null, isPreventDrag: null, saveContext: null, isPreventSelection: null } });\n            }\n            if (isCropSelection) {\n                this.dragCanvas = parent.togglePan = true;\n            }\n        }\n        this.isMouseDown = false;\n        this.isMouseUp = false;\n    };\n    Selection.prototype.mouseUpEventHandler = function (e) {\n        var parent = this.parent;\n        var id = parent.element.id;\n        parent.isKBDNavigation = this.isMouseDown = false;\n        this.isMouseUp = true;\n        if (!Browser.isDevice && ((parent.element.querySelector('#' + id + '_contextualToolbar') &&\n            !parent.element.querySelector('#' + id + '_contextualToolbar').parentElement.classList.contains('e-hide')) ||\n            (parent.element.querySelector('#' + id + '_headWrapper')\n                && !parent.element.querySelector('#' + id + '_headWrapper').parentElement.classList.contains('e-hide')))) {\n            if (!(parent.activeObj.shape && parent.activeObj.shape === 'redact' && parent.isShapeDrawing)) {\n                return;\n            }\n        }\n        if (parent.cursor === 'grabbing' && this.isGrabbing) {\n            var obj = { shapeSettingsObj: {} };\n            parent.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: obj } });\n            var shapeSettings = obj['shapeSettingsObj'];\n            var shapeResizingArgs = { cancel: false, action: 'rotate-end', previousShapeSettings: shapeSettings, allowShapeOverflow: this.allowOutofBound() };\n            var shapeMovingArgs = { cancel: false, action: 'rotate-end', previousShapeSettings: shapeSettings, allowShapeOverflow: this.allowOutofBound() };\n            this.triggerShapeChange(shapeResizingArgs, shapeMovingArgs, 'mouse-up');\n        }\n        this.isGrabbing = false;\n        if (this.isPreventShaping) {\n            this.isPreventShaping = false;\n        }\n        if (this.mouseDown === 'canvas' || this.isSliderActive ||\n            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n            e.target.closest('.e-image-editor') || e.target.closest('.e-ie-ddb-popup')) {\n            if (e.type === 'touchstart') {\n                this.isTouch = false;\n            }\n            else if (e.type === 'touchend') {\n                e.stopImmediatePropagation();\n            }\n            e.preventDefault();\n            if (parent.togglePan) {\n                this.canvasMouseUpHandler(e);\n            }\n            var x = void 0;\n            var y = void 0;\n            if (e.type === 'mouseup') {\n                x = e.clientX;\n                y = e.clientY;\n            }\n            else if (!this.isTouchDblClick) {\n                x = this.touchEndPoint.x;\n                y = this.touchEndPoint.y;\n            }\n            var bbox = parent.lowerCanvas.getBoundingClientRect();\n            x -= bbox.left;\n            y -= bbox.top;\n            var activeObjShape = void 0;\n            var currentDrawingShape = this.currentDrawingShape;\n            var dummyClick = false;\n            if (e.type === 'touchend') {\n                this.startTouches = this.tempTouches = [];\n                this.isFirstMove = false;\n                if (parent.textArea.style.display === 'none') {\n                    this.timer = 0;\n                }\n                if (this.isPinching) {\n                    this.isPinching = false;\n                    parent.notify('draw', { prop: 'redrawDownScale' });\n                    if (parent.isCropTab || parent.activeObj.shape) {\n                        parent.notify('draw', { prop: 'setStraightenActObj', value: { activeObj: null } });\n                        parent.notify('freehand-draw', { prop: 'resetStraightenPoint' });\n                    }\n                    if (parent.isStraightening) {\n                        parent.notify('draw', { prop: 'resetStraightenDestPoints' });\n                        parent.notify('draw', { prop: 'setDestForStraighten' });\n                    }\n                    return;\n                }\n            }\n            var isCropSelection = false;\n            var splitWords = void 0;\n            if (parent.activeObj.shape !== undefined) {\n                splitWords = parent.activeObj.shape.split('-');\n            }\n            if (splitWords !== undefined && splitWords[0] === 'crop') {\n                isCropSelection = true;\n            }\n            if (this.currentDrawingShape === 'path' && parent.isShapeDrawing) {\n                /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                var elem = e.srcElement;\n                var elemId = elem.parentElement.id;\n                var id_1 = parent.element.id;\n                // eslint-disable-next-line max-len\n                if (e.currentTarget !== parent.upperCanvas && e.currentTarget !== parent.lowerCanvas && parent.activeObj.pointColl.length > 0 &&\n                    (elem.classList.contains('e-upload-icon') || elemId === id_1 + '_zoomIn' ||\n                        elemId === id_1 + '_zoomOut' || elemId === id_1 + '_annotationBtn' ||\n                        elemId === id_1 + '_borderColorBtn' || elemId === id_1 + '_borderWidthBtn')) {\n                    parent.notify('shape', { prop: 'stopPathDrawing', onPropertyChange: false, value: { e: e, isApply: true } });\n                    this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                    parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: parent.activeObj, isCropRatio: null,\n                            points: null, isPreventDrag: true, saveContext: null, isPreventSelection: true } });\n                }\n                if (parent.currObjType.isDragging && this.isTouch &&\n                    parent.activeObj.shape && parent.activeObj.shape === 'path') {\n                    this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                    parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: parent.activeObj, isCropRatio: null,\n                            points: null, isPreventDrag: true, saveContext: null, isPreventSelection: true } });\n                }\n                return;\n            }\n            if (e.currentTarget === parent.upperCanvas && !parent.isResize) {\n                this.pathAdjustedIndex = null;\n                if (this.currentDrawingShape !== '') {\n                    if (this.currentDrawingShape === 'text') {\n                        var prevCropObj_1 = extend({}, parent.cropObj, {}, true);\n                        parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                            value: { operation: 'shapeInsert', previousObj: this.initialPrevObj, previousObjColl: this.initialPrevObj.objColl,\n                                previousPointColl: this.initialPrevObj.pointColl, previousSelPointColl: this.initialPrevObj.selPointColl,\n                                previousCropObj: prevCropObj_1, previousText: null,\n                                currentText: null, previousFilter: null, isCircleCrop: null } });\n                    }\n                    else {\n                        parent.notify('undo-redo', { prop: 'updateUrObj', onPropertyChange: false, value: { objColl: this.initialPrevObj.objColl, operation: 'shapeInsert' } });\n                    }\n                    this.isShapeInserted = true;\n                    this.currentDrawingShape = '';\n                    if ((parent.activeObj.shape && parent.activeObj.shape === 'path' && parent.activeObj.pointColl.length === 0) ||\n                        ((!parent.activeObj.shape || parent.activeObj.shape !== 'path') && parent.activeObj.activePoint.width === 0 &&\n                            parent.activeObj.activePoint.height === 0)) {\n                        dummyClick = true;\n                        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                    }\n                    var previousShapeSettings = this.updatePrevShapeSettings();\n                    var shapeResizingArgs = { cancel: false, action: 'draw-end', previousShapeSettings: previousShapeSettings };\n                    var shapeMovingArgs = { cancel: false, action: 'move', previousShapeSettings: previousShapeSettings };\n                    this.shapeResizingArgs = shapeResizingArgs;\n                    this.shapeMovingArgs = shapeMovingArgs;\n                    this.triggerShapeChange(shapeResizingArgs, shapeMovingArgs, 'mouse-up');\n                }\n                if (parent.activeObj.shape && parent.activeObj.shape === 'path' && parent.activeObj.pointColl.length > 0) {\n                    parent.activeObj.activePoint = parent.getSquarePointForPath(parent.activeObj);\n                }\n                this.adjustActObjForLineArrow();\n                this.updPtCollForShpRot();\n                parent.currObjType.shape = parent.currObjType.shape.toLowerCase();\n                var prevCropObj = extend({}, parent.cropObj, {}, true);\n                var object = { currObj: {} };\n                parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n                var prevObj = object['currObj'];\n                prevObj.objColl = extend([], parent.objColl, [], true);\n                prevObj.pointColl = extend([], parent.pointColl, [], true);\n                prevObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n                var selPointCollObj = { selPointColl: null };\n                parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n                    value: { obj: selPointCollObj } });\n                prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n                if (!parent.togglePen && !isCropSelection) {\n                    if (this.tempObjColl && parent.activeObj.activePoint.width !== 0) {\n                        parent.notify('shape', { prop: 'updImgRatioForActObj', onPropertyChange: false });\n                        parent.objColl.push(parent.activeObj);\n                        if (JSON.stringify(parent.activeObj.activePoint) !== JSON.stringify(this.tempActiveObj.activePoint)) {\n                            parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                                value: { operation: 'shapeTransform', previousObj: prevObj, previousObjColl: this.tempObjColl,\n                                    previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                                    previousCropObj: prevCropObj, previousText: null,\n                                    currentText: null, previousFilter: null, isCircleCrop: null } });\n                        }\n                        var tempObj = extend({}, parent.objColl[parent.objColl.length - 1], {}, true);\n                        parent.objColl.pop();\n                        this.redrawShape(tempObj);\n                        this.tempObjColl = undefined;\n                    }\n                    if (!this.isFhdEditing) {\n                        this.applyCurrActObj(x, y);\n                        parent.currObjType.isResize = false;\n                        parent.notify('toolbar', { prop: 'destroy-qa-toolbar', onPropertyChange: false });\n                    }\n                }\n                else if (isCropSelection && this.isMouseUp && parent.cursor.indexOf('resize') > -1) {\n                    var previousShapeSettings = this.updatePrevShapeSettings();\n                    var shapeResizingArgs = { cancel: false, action: 'resize-end', previousShapeSettings: previousShapeSettings };\n                    this.triggerShapeChange(shapeResizingArgs, shapeResizingArgs, 'resize');\n                }\n                if (parent.activeObj) {\n                    var isCropSelection_1 = false;\n                    var splitWords_1;\n                    if (parent.activeObj.shape !== undefined) {\n                        splitWords_1 = parent.activeObj.shape.split('-');\n                    }\n                    if (splitWords_1 === undefined && (parent.currObjType.isCustomCrop || parent.togglePen)) {\n                        isCropSelection_1 = true;\n                    }\n                    else if (splitWords_1 !== undefined && splitWords_1[0] === 'crop') {\n                        isCropSelection_1 = true;\n                    }\n                    var shape = parent.activeObj.shape;\n                    activeObjShape = shape;\n                    var shapeColl = ['rectangle', 'ellipse', 'line', 'arrow', 'path'];\n                    if (shapeColl.indexOf(shape) > -1) {\n                        parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'shapes',\n                                isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                    }\n                    else if (shape === 'text') {\n                        if (parent.textArea.style.display === 'none') {\n                            parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'text',\n                                    isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                        }\n                    }\n                    else if (shape === 'redact') {\n                        parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'redact',\n                                isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                    }\n                    else if (this.isFhdEditing) {\n                        parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'pen',\n                                isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                    }\n                    else if (!isCropSelection_1) {\n                        var eventargs = { type: 'main', isApplyBtn: null, isCropping: false, isZooming: null };\n                        parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: eventargs });\n                    }\n                    parent.notify('toolbar', { prop: 'update-toolbar-items', onPropertyChange: false });\n                    if (!this.isFhdEditing) {\n                        if (parent.activeObj.shape && parent.activeObj.shape === 'text' &&\n                            parent.activeObj.textSettings.fontSize === 11 && Math.floor(parent.activeObj.activePoint.width) === 55 &&\n                            Math.floor(parent.activeObj.activePoint.height) === 11) {\n                            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                            if (parent.drawingShape === 'text' && !parent.activeObj.keyHistory) {\n                                parent.activeObj.keyHistory = 'Enter Text';\n                            }\n                        }\n                        if (!isCropSelection_1) {\n                            this.adjustActObjForLineArrow();\n                            if (parent.isShapeDrawing) {\n                                var temp = this.currentDrawingShape;\n                                parent.notify('undo-redo', { prop: 'updateUndoRedoStack', onPropertyChange: false });\n                                this.currentDrawingShape = temp;\n                            }\n                            else {\n                                parent.notify('undo-redo', { prop: 'updateUndoRedoStack', onPropertyChange: false });\n                            }\n                        }\n                    }\n                }\n            }\n            if (parent.activeObj.shape !== undefined) {\n                splitWords = parent.activeObj.shape.split('-');\n            }\n            if (splitWords !== undefined && splitWords[0] === 'crop') {\n                isCropSelection = true;\n            }\n            if (parent.activeObj.shape && !isCropSelection && e.currentTarget === parent.upperCanvas &&\n                parent.textArea.style.display === 'none') {\n                if (parent.activeObj.shape === 'text') {\n                    parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'text',\n                            isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                }\n                else if (parent.activeObj.shape === 'redact') {\n                    parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'redact',\n                            isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                }\n                else {\n                    var temp = this.currentDrawingShape;\n                    this.currentDrawingShape = '';\n                    parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'shapes',\n                            isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                    this.currentDrawingShape = temp;\n                }\n                parent.notify('toolbar', { prop: 'update-toolbar-items', onPropertyChange: false });\n                parent.notify('toolbar', { prop: 'renderQAT', onPropertyChange: false, value: { isPenEdit: null } });\n            }\n            var obj = { freehandDrawSelectedId: null };\n            parent.notify('freehand-draw', { prop: 'getFreehandDrawSelectedId', onPropertyChange: false, value: { obj: obj } });\n            if (parent.togglePen && e.currentTarget === parent.upperCanvas && !obj['freehandDrawSelectedId']) {\n                parent.notify('freehand-draw', { prop: 'freehandUpHandler', onPropertyChange: false,\n                    value: { e: e, canvas: parent.upperCanvas, context: this.upperContext } });\n                if (parent.togglePen && !parent.isMaskImage && (isNullOrUndefined(parent.toolbar) ||\n                    (parent.toolbar && parent.toolbar.length > 0) || !isNullOrUndefined(parent.toolbarTemplate))) {\n                    parent.okBtn();\n                    parent.freeHandDraw(true);\n                }\n            }\n            else {\n                parent.currObjType.shape = '';\n            }\n            this.dragElement = '';\n            this.mouseDown = '';\n            this.isSliderActive = false;\n            parent.currObjType.isInitialLine = parent.currObjType.isDragging = false;\n            this.selMouseUpEvent();\n            if (isNullOrUndefined(parent.drawingShape) && activeObjShape && currentDrawingShape !== '') {\n                parent.drawingShape = activeObjShape;\n            }\n            if (parent.drawingShape) {\n                this.currentDrawingShape = parent.drawingShape.toLowerCase();\n                if (dummyClick) {\n                    parent.enableShapeDrawing(parent.toPascalCase(parent.drawingShape), true);\n                    parent.upperCanvas.style.cursor = 'crosshair';\n                }\n            }\n            parent.isShapeDrawing = false;\n            parent.notify('freehand-draw', { prop: 'resetSelPoints', onPropertyChange: false });\n        }\n        this.isMouseUp = false;\n    };\n    Selection.prototype.adjustActObjForLineArrow = function (obj) {\n        var isAdjusted = false;\n        var parent = this.parent;\n        obj = obj ? obj : parent.activeObj;\n        if (obj.shape && (obj.shape === 'line' || parent.activeObj.shape === 'arrow')) {\n            var temp = void 0;\n            if ((this.dragElement === 'e-resize' && obj.activePoint.endX < obj.activePoint.startX) ||\n                (this.dragElement === 'w-resize' && obj.activePoint.startX > obj.activePoint.endX)) {\n                isAdjusted = true;\n                temp = obj.activePoint.startX;\n                obj.activePoint.startX = obj.activePoint.endX;\n                obj.activePoint.endX = temp;\n                temp = obj.activePoint.startY;\n                obj.activePoint.startY = obj.activePoint.endY;\n                obj.activePoint.endY = temp;\n            }\n            obj.activePoint.width = Math.abs(obj.activePoint.endX - obj.activePoint.startX);\n            obj.activePoint.height = Math.abs(obj.activePoint.endY - obj.activePoint.startY);\n            if (parent.activeObj.shape !== 'path') {\n                parent.notify('shape', { prop: 'setPointCollForLineArrow', onPropertyChange: false,\n                    value: { obj: obj } });\n                for (var i = 0; i < obj.pointColl.length; i++) {\n                    obj.pointColl[i].ratioX = (obj.pointColl[i].x -\n                        parent.img.destLeft) / parent.img.destWidth;\n                    obj.pointColl[i].ratioY = (obj.pointColl[i].y -\n                        parent.img.destTop) / parent.img.destHeight;\n                }\n            }\n        }\n        return isAdjusted;\n    };\n    Selection.prototype.updPtCollForShpRot = function (obj) {\n        var parent = this.parent;\n        obj = obj ? obj : parent.activeObj;\n        if (obj.shape && obj.rotatedAngle !== 0) {\n            parent.notify('shape', { prop: 'setPointCollForShapeRotation', onPropertyChange: false, value: { obj: obj } });\n            var _a = parent.img, destLeft_1 = _a.destLeft, destTop_1 = _a.destTop, destWidth_1 = _a.destWidth, destHeight_1 = _a.destHeight;\n            var horTopLinePointColl = obj.horTopLinePointColl, horBottomLinePointColl = obj.horBottomLinePointColl, verLeftLinePointColl = obj.verLeftLinePointColl, verRightLinePointColl = obj.verRightLinePointColl;\n            // eslint-disable-next-line @typescript-eslint/tslint/config\n            var setRatio = function (point) {\n                point.ratioX = (point.x - destLeft_1) / destWidth_1;\n                point.ratioY = (point.y - destTop_1) / destHeight_1;\n            };\n            horTopLinePointColl.forEach(setRatio);\n            horBottomLinePointColl.forEach(setRatio);\n            verLeftLinePointColl.forEach(setRatio);\n            verRightLinePointColl.forEach(setRatio);\n        }\n    };\n    Selection.prototype.setXYPoints = function (e) {\n        e.preventDefault();\n        var x;\n        var y;\n        if (e.type === 'mousedown') {\n            x = e.clientX;\n            y = e.clientY;\n        }\n        else {\n            this.touchEndPoint.x = x = e.touches[0].clientX;\n            this.touchEndPoint.y = y = e.touches[0].clientY;\n        }\n        var bbox = this.parent.lowerCanvas.getBoundingClientRect();\n        x -= bbox.left;\n        y -= bbox.top;\n        return { x: x, y: y };\n    };\n    Selection.prototype.getCurrentIndex = function () {\n        var index;\n        var parent = this.parent;\n        for (var i = 0, len = parent.objColl.length; i < len; i++) {\n            if (parent.activeObj.currIndex === parent.objColl[i].currIndex) {\n                index = i;\n                break;\n            }\n        }\n        return index;\n    };\n    Selection.prototype.isShapeClick = function (e, isCropSelection) {\n        var parent = this.parent;\n        var isShape = false;\n        if (parent.togglePen) {\n            return isShape;\n        }\n        if (parent.activeObj.shape && parent.activeObj.shape === 'text' && this.isShapeInserted) {\n            var isTextArea = (parent.textArea.style.display === 'block' || parent.textArea.style.display === 'inline-block')\n                ? true : false;\n            var activeObj = extend({}, parent.activeObj, null, true);\n            parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n                value: { x: null, y: null, isMouseDown: true } });\n            var points = this.setXYPoints(e);\n            var x = points.x;\n            var y = points.y;\n            isShape = this.findTargetObj(x, y, isCropSelection);\n            if (!isCropSelection) {\n                this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                if (isShape) {\n                    parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n                        value: { x: null, y: null, isMouseDown: true } });\n                }\n            }\n            if (isTextArea) {\n                parent.textArea.value = parent.objColl[parent.objColl.length - 1].keyHistory;\n                parent.textArea.style.display = 'block';\n                parent.activeObj = activeObj;\n                var index = this.getCurrentIndex();\n                if (isNullOrUndefined(index)) {\n                    parent.objColl.pop();\n                }\n                else {\n                    parent.objColl.splice(index, 1);\n                }\n            }\n            else if (!isShape && activeObj.shape) {\n                parent.activeObj = activeObj;\n                var index = this.getCurrentIndex();\n                if ((!isNullOrUndefined(index) &&\n                    JSON.stringify(parent.activeObj.activePoint) === JSON.stringify(parent.objColl[index].activePoint))) {\n                    parent.objColl.splice(index, 1);\n                }\n                else if (isNullOrUndefined(parent.activeObj.currIndex)) {\n                    parent.objColl.pop();\n                }\n            }\n        }\n        return isShape;\n    };\n    Selection.prototype.isShapeTouch = function (e, isCropSelection) {\n        var parent = this.parent;\n        var isShape = false;\n        if (e.type === 'touchstart' && !parent.togglePen) {\n            if (parent.activeObj && parent.activeObj.shape === 'text') {\n                this.timer = setTimeout(this.setTimer.bind(this), 1000, e);\n            }\n            var isTextArea = (parent.textArea.style.display === 'block' || parent.textArea.style.display === 'inline-block')\n                ? true : false;\n            var activeObj = extend({}, parent.activeObj, null, true);\n            parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n                value: { x: null, y: null, isMouseDown: true } });\n            var points = this.setXYPoints(e);\n            var x = points.x;\n            var y = points.y;\n            isShape = this.findTargetObj(x, y, isCropSelection);\n            if (!isCropSelection) {\n                this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            }\n            if (isTextArea) {\n                parent.textArea.value = parent.objColl[parent.objColl.length - 1].keyHistory;\n                parent.textArea.style.display = 'block';\n                parent.activeObj = activeObj;\n                var index = this.getCurrentIndex();\n                if (isNullOrUndefined(index)) {\n                    parent.objColl.pop();\n                }\n                else {\n                    parent.objColl.splice(index, 1);\n                }\n            }\n            else if (!isShape && activeObj.shape && (activeObj.activePoint.width !== 0 || activeObj.activePoint.height !== 0 ||\n                (activeObj.shape === 'path' && activeObj.pointColl.length > 0))) {\n                parent.activeObj = activeObj;\n                var index = this.getCurrentIndex();\n                if (!isCropSelection) {\n                    if ((!isNullOrUndefined(index) && JSON.stringify(parent.activeObj.activePoint) ===\n                        JSON.stringify(parent.objColl[index].activePoint))) {\n                        parent.objColl.splice(index, 1);\n                    }\n                    else if (isNullOrUndefined(parent.activeObj.currIndex)) {\n                        parent.objColl.pop();\n                    }\n                }\n            }\n        }\n        return isShape;\n    };\n    Selection.prototype.isFreehandDrawTouch = function (e, isCropSelection) {\n        var parent = this.parent;\n        var isFreehandDraw = false;\n        if (e.type === 'touchstart' && !isCropSelection && !parent.togglePen) {\n            var isTextArea = (parent.textArea.style.display === 'block' || parent.textArea.style.display === 'inline-block')\n                ? true : false;\n            var activeObj = extend({}, parent.activeObj, null, true);\n            parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n                value: { x: null, y: null, isMouseDown: true } });\n            var points = this.setXYPoints(e);\n            var x = points.x;\n            var y = points.y;\n            this.setCursor(x, y);\n            if (this.isFhdPoint) {\n                isFreehandDraw = true;\n            }\n            if (isTextArea) {\n                parent.textArea.value = parent.objColl[parent.objColl.length - 1].keyHistory;\n                parent.textArea.style.display = 'block';\n                parent.activeObj = activeObj;\n                var index = this.getCurrentIndex();\n                if (isNullOrUndefined(index)) {\n                    parent.objColl.pop();\n                }\n                else {\n                    parent.objColl.splice(index, 1);\n                }\n            }\n            else if (activeObj.shape) {\n                parent.activeObj = activeObj;\n                var index = this.getCurrentIndex();\n                if (!isCropSelection) {\n                    if ((!isNullOrUndefined(index) && JSON.stringify(parent.activeObj.activePoint) ===\n                        JSON.stringify(parent.objColl[index].activePoint))) {\n                        parent.objColl.splice(index, 1);\n                    }\n                    else if (isNullOrUndefined(parent.activeObj.currIndex)) {\n                        parent.objColl.pop();\n                    }\n                }\n            }\n        }\n        return isFreehandDraw;\n    };\n    Selection.prototype.applyObj = function (x, y) {\n        var parent = this.parent;\n        var isApply = false;\n        if (parent.activeObj.activePoint.width === 0 && parent.activeObj.activePoint.height === 0) {\n            return false;\n        }\n        var shapeColl = ['rectangle', 'ellipse', 'line', 'arrow', 'path', 'image', 'text'];\n        var _a = parent.activeObj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY;\n        if (parent.activeObj.shape && shapeColl.indexOf(parent.activeObj.shape) > -1) {\n            var radius = parent.activeObj.topLeftCircle.radius;\n            if (x >= (startX - (radius * 2)) && x <= (endX + (radius * 2)) && y >= (startY - (radius * 2)) &&\n                y <= (endY + (radius * 2))) {\n                isApply = false;\n            }\n            else if (parent.upperCanvas.style.cursor !== 'default' && parent.upperCanvas.style.cursor !== 'grab' &&\n                parent.upperCanvas.style.cursor !== 'crosshair' && parent.upperCanvas.style.cursor !== 'pointer' &&\n                parent.upperCanvas.style.cursor !== 'move') {\n                isApply = false;\n            }\n            else {\n                isApply = true;\n            }\n        }\n        return isApply;\n    };\n    Selection.prototype.applyCurrShape = function (isShapeClick) {\n        var parent = this.parent;\n        var isApply = false;\n        if (parent.togglePen) {\n            return isApply;\n        }\n        var obj = extend({}, parent.activeObj, null, true);\n        if (this.isShapeInserted && parent.activeObj.shape === 'text' && isShapeClick) {\n            this.isInitialTextEdited = true;\n            parent.notify('draw', { prop: 'setShapeTextInsert', onPropertyChange: false, value: { bool: true } });\n        }\n        if (parent.textArea.style.display === 'block' || parent.textArea.style.display === 'inline-block') {\n            var activeObj = extend({}, parent.activeObj, null, true);\n            parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n                value: { x: null, y: null, isMouseDown: null } });\n            obj = extend({}, parent.objColl[parent.objColl.length - 1], null, true);\n            parent.objColl.pop();\n            parent.activeObj = extend({}, activeObj, null, true);\n            parent.textArea.value = obj.keyHistory;\n            parent.textArea.style.display = 'block';\n            var strokeColor = obj.strokeSettings && obj.strokeSettings.strokeColor ? obj.strokeSettings.strokeColor.split('(')[0] === 'rgb' ?\n                this.rgbToHex(parseFloat(obj.strokeSettings.strokeColor.split('(')[1].split(',')[0]), parseFloat(obj.strokeSettings.strokeColor.split('(')[1].split(',')[1]), parseFloat(obj.strokeSettings.strokeColor.split('(')[1].split(',')[2]), parseFloat(obj.strokeSettings.strokeColor.split('(')[1].split(',')[3])) :\n                obj.strokeSettings.strokeColor : null;\n            if (strokeColor && strokeColor === '#ffffff') {\n                strokeColor = '#fff';\n            }\n            if (this.tempActiveObj.strokeSettings && this.tempActiveObj.strokeSettings.strokeColor &&\n                this.tempActiveObj.strokeSettings.strokeColor === '#ffffff') {\n                this.tempActiveObj.strokeSettings.strokeColor = '#fff';\n            }\n            if (obj.keyHistory !== this.tempActiveObj.keyHistory ||\n                (strokeColor && (strokeColor !== this.tempActiveObj.strokeSettings.strokeColor)) ||\n                (obj.textSettings && obj.textSettings.fontFamily !== this.tempActiveObj.textSettings.fontFamily) ||\n                (obj.textSettings && Math.round(obj.textSettings.fontSize) !== Math.round(this.tempActiveObj.textSettings.fontSize)) ||\n                (obj.textSettings && Math.round(obj.textSettings.fontRatio) !== Math.round(this.tempActiveObj.textSettings.fontRatio)) ||\n                (obj.textSettings && obj.textSettings.bold !== this.tempActiveObj.textSettings.bold) ||\n                (obj.textSettings && obj.textSettings.italic !== this.tempActiveObj.textSettings.italic) ||\n                (obj.textSettings && obj.textSettings.underline !== this.tempActiveObj.textSettings.underline)) {\n                isApply = true;\n            }\n            if (this.isInitialTextEdited && !isApply) {\n                isApply = true;\n                this.isInitialTextEdited = false;\n            }\n        }\n        else {\n            this.tempActiveObj.activePoint.height = Math.abs(this.tempActiveObj.activePoint.height);\n            isApply = JSON.stringify(obj) !== JSON.stringify(this.tempActiveObj);\n        }\n        return isApply;\n    };\n    Selection.prototype.canvasMouseDownHandler = function (e) {\n        var parent = this.parent;\n        e.preventDefault();\n        var x;\n        var y;\n        if (e.type === 'mousedown') {\n            x = e.offsetX || (e.pageX - parent.lowerCanvas.offsetLeft);\n            y = e.offsetY || (e.pageY - parent.lowerCanvas.offsetTop);\n        }\n        else {\n            x = e.touches[0].clientX || (e.touches[0].pageX - parent.lowerCanvas.offsetLeft);\n            y = e.touches[0].clientY || (e.touches[0].pageY - parent.lowerCanvas.offsetTop);\n        }\n        var bbox = parent.lowerCanvas.getBoundingClientRect();\n        x -= bbox.left;\n        y -= bbox.top;\n        this.panDown = { x: x, y: y };\n        var tempPanMoveObj = { tempPanMove: null };\n        parent.notify('transform', { prop: 'getTempPanMove', onPropertyChange: false,\n            value: { obj: tempPanMoveObj } });\n        if (isNullOrUndefined(tempPanMoveObj['tempPanMove'])) {\n            parent.notify('transform', { prop: 'setTempPanMove', onPropertyChange: false,\n                value: { point: { x: x, y: y } } });\n        }\n    };\n    Selection.prototype.canvasMouseMoveHandler = function (e) {\n        var parent = this.parent;\n        var frameObject = { bool: null };\n        parent.notify('toolbar', { prop: 'getFrameToolbar', onPropertyChange: false, value: { obj: frameObject } });\n        if (parent.isResize || frameObject['bool']) {\n            parent.upperCanvas.style.cursor = 'default';\n            return;\n        }\n        if (this.dragCanvas) {\n            parent.lowerCanvas.style.cursor = 'grab';\n        }\n        else {\n            this.dragCanvas = parent.togglePan = false;\n            parent.lowerCanvas.style.cursor = parent.upperCanvas.style.cursor = parent.cursor = 'default';\n        }\n        var x;\n        var y;\n        if (e.type === 'mousemove') {\n            x = e.offsetX;\n            y = e.offsetY;\n        }\n        else {\n            x = e.touches[0].clientX || (e.touches[0].pageX - parent.lowerCanvas.offsetLeft);\n            y = e.touches[0].clientY || (e.touches[0].pageY - parent.lowerCanvas.offsetTop);\n        }\n        var bbox = parent.lowerCanvas.getBoundingClientRect();\n        x -= bbox.left;\n        y -= bbox.top;\n        var panMove = { x: x, y: y };\n        parent.notify('transform', { prop: 'setPanMove', onPropertyChange: false,\n            value: { point: { x: x, y: y } } });\n        if (this.panDown && panMove && parent.togglePan && this.dragCanvas) {\n            if (parent.isCropTab || parent.activeObj.shape) {\n                parent.notify('draw', { prop: 'setStraightenActObj', value: { activeObj: null } });\n                parent.notify('freehand-draw', { prop: 'resetStraightenPoint' });\n            }\n            parent.notify('transform', { prop: 'drawPannedImage', onPropertyChange: false,\n                value: { xDiff: null, yDiff: null } });\n        }\n    };\n    Selection.prototype.canvasMouseUpHandler = function (e) {\n        var parent = this.parent;\n        e.preventDefault();\n        var panMoveObj = { panMove: null };\n        parent.notify('transform', { prop: 'getPanMove', onPropertyChange: false,\n            value: { obj: panMoveObj } });\n        if (parent.togglePan) {\n            if (this.panDown && panMoveObj['panMove'] && parent.togglePan && this.dragCanvas) {\n                this.panDown = null;\n                parent.notify('transform', { prop: 'setPanMove', onPropertyChange: false,\n                    value: { point: null } });\n            }\n        }\n        parent.notify('transform', { prop: 'setTempPanMove', onPropertyChange: false,\n            value: { point: null } });\n        if (this.currentDrawingShape !== 'path') {\n            parent.currObjType.isDragging = false;\n        }\n    };\n    Selection.prototype.touchStartHandler = function (e) {\n        e.preventDefault();\n        var parent = this.parent;\n        if (this.touchTime === 0) {\n            this.touchTime = new Date().getTime();\n        }\n        else {\n            if (((new Date().getTime()) - this.touchTime) < 400) {\n                this.isTouchDblClick = true;\n                var temp = parent.isShapeDrawing;\n                parent.notify('shape', { prop: 'stopPathDrawing', onPropertyChange: false, value: { e: e, isApply: null } });\n                this.isTouchDblClick = false;\n                this.touchTime = 0;\n                if (temp !== parent.isShapeDrawing && parent.activeObj.shape &&\n                    parent.activeObj.shape === 'path') {\n                    return;\n                }\n            }\n            else {\n                this.touchTime = new Date().getTime();\n            }\n        }\n        if (e.touches.length === 2) {\n            this.isFirstMove = true;\n        }\n        else {\n            this.mouseDownEventHandler(e);\n        }\n        EventHandler.add(parent.lowerCanvas, 'touchend', this.mouseUpEventHandler, this);\n        EventHandler.add(parent.lowerCanvas, 'touchmove', this.mouseMoveEventHandler, this);\n        EventHandler.add(parent.upperCanvas, 'touchend', this.mouseUpEventHandler, this);\n        EventHandler.add(parent.upperCanvas, 'touchmove', this.mouseMoveEventHandler, this);\n    };\n    Selection.prototype.unwireEvent = function () {\n        var parent = this.parent;\n        EventHandler.remove(parent.lowerCanvas, 'touchend', this.mouseUpEventHandler);\n        EventHandler.remove(parent.lowerCanvas, 'touchmove', this.mouseMoveEventHandler);\n        EventHandler.remove(parent.upperCanvas, 'touchend', this.mouseUpEventHandler);\n        EventHandler.remove(parent.upperCanvas, 'touchmove', this.mouseMoveEventHandler);\n    };\n    Selection.prototype.keyDownEventHandler = function (e) {\n        var parent = this.parent;\n        if (e.ctrlKey && (e.key === '+' || e.key === '-')) {\n            e.preventDefault();\n        }\n        var obj = { fileName: '', fileType: null };\n        parent.notify('draw', { prop: 'getFileName', onPropertyChange: false, value: { obj: obj } });\n        var beforeSave = { fileName: obj['fileName'], fileType: obj['fileType'], cancel: false };\n        switch (e.key) {\n            case (e.ctrlKey && 's'):\n                parent.trigger('beforeSave', beforeSave);\n                this.beforeSaveEvent(beforeSave, e);\n                break;\n            case (e.ctrlKey && 'z'):\n                if (parent.allowUndoRedo) {\n                    parent.noPushUndo = false;\n                    if (parent.togglePen || parent.drawingShape) {\n                        parent.okBtn();\n                        parent.drawingShape = null;\n                    }\n                    parent.notify('undo-redo', { prop: 'call-undo' });\n                }\n                break;\n            case (e.ctrlKey && 'y'):\n                if (parent.allowUndoRedo) {\n                    parent.noPushUndo = false;\n                    if (parent.togglePen || parent.drawingShape) {\n                        parent.okBtn();\n                        parent.drawingShape = null;\n                    }\n                    parent.notify('undo-redo', { prop: 'call-redo' });\n                }\n                break;\n            case (e.ctrlKey && '+'):\n                if ((parent.zoomSettings.zoomTrigger & ZoomTrigger.Commands) === ZoomTrigger.Commands) {\n                    this.zoomType = 'Commands';\n                    parent.isZoomBtnClick = true;\n                    parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                        value: { zoomFactor: .1, zoomPoint: null }, isResize: null });\n                    parent.notify('draw', { prop: 'redrawDownScale' });\n                    if (parent.isCropTab || parent.activeObj.shape) {\n                        parent.notify('draw', { prop: 'setStraightenActObj', value: { activeObj: null } });\n                        parent.notify('freehand-draw', { prop: 'resetStraightenPoint' });\n                    }\n                    if (parent.isStraightening) {\n                        parent.notify('draw', { prop: 'resetStraightenDestPoints' });\n                        parent.notify('draw', { prop: 'setDestForStraighten' });\n                    }\n                }\n                break;\n            case (e.ctrlKey && '-'):\n                if ((parent.zoomSettings.zoomTrigger & ZoomTrigger.Commands) === ZoomTrigger.Commands) {\n                    this.zoomType = 'Commands';\n                    parent.isZoomBtnClick = true;\n                    parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                        value: { zoomFactor: -.1, zoomPoint: null }, isResize: null });\n                    parent.notify('draw', { prop: 'redrawDownScale' });\n                    if (parent.isCropTab || parent.activeObj.shape) {\n                        parent.notify('draw', { prop: 'setStraightenActObj', value: { activeObj: null } });\n                        parent.notify('freehand-draw', { prop: 'resetStraightenPoint' });\n                    }\n                    if (parent.isStraightening) {\n                        parent.notify('draw', { prop: 'resetStraightenDestPoints' });\n                        parent.notify('draw', { prop: 'setDestForStraighten' });\n                    }\n                }\n                break;\n            case 'Delete':\n                this.deleteItem();\n                break;\n            case 'Escape':\n                parent.notify('draw', { prop: 'performCancel', value: { isContextualToolbar: null, isFinalCancel: true } });\n                break;\n            case 'Enter':\n                this.performEnterAction(e);\n                break;\n            case 'Tab':\n                this.performTabAction();\n                break;\n            default:\n                if (Browser.isDevice && (parent.textArea.style.display === 'block' || parent.textArea.style.display === 'inline-block')) {\n                    setTimeout(this.textKeyDown.bind(this), 1, e);\n                }\n                break;\n        }\n    };\n    Selection.prototype.performEnterAction = function (e) {\n        var parent = this.parent;\n        if (parent.isResize) {\n            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n            var target = e.target;\n            var isIcon = target.id.indexOf('aspectratio') ||\n                target.id.indexOf('non-aspectratio') > -1 ? true : false;\n            var isValue = this.isValueUpdated();\n            if (!isValue) {\n                if (isIcon) {\n                    this.focusRatioBtn();\n                }\n                return;\n            }\n            var point = this.getNumTextValue();\n            var aspectRatioElement = parent.element.querySelector('#' + parent.element.id + '_aspectratio');\n            var blrAspRatElem = parent.element.querySelector('.e-ie-toolbar-aspect-ratio-btn');\n            if (point && point.x && point.y) {\n                if (aspectRatioElement || (blrAspRatElem && !blrAspRatElem.classList.contains('e-hidden'))) {\n                    parent.notify('transform', { prop: 'resize', value: { width: point.x, height: null, isAspectRatio: true } });\n                }\n                else {\n                    parent.notify('transform', { prop: 'resize', value: { width: point.x, height: point.y, isAspectRatio: false } });\n                }\n            }\n            var aspectRatioHeight = parent.element.querySelector('#' + parent.element.id + '_resizeHeight');\n            var aspectRatioWidth = parent.element.querySelector('#' + parent.element.id + '_resizeWidth');\n            if (isNullOrUndefined(aspectRatioElement)) {\n                if (aspectRatioHeight) {\n                    var elem = getComponent(aspectRatioHeight, 'numerictextbox');\n                    if (aspectRatioHeight && aspectRatioHeight.value === '') {\n                        elem.value = parseFloat(elem.placeholder);\n                        aspectRatioHeight.value = elem.placeholder + 'px';\n                    }\n                }\n                if (aspectRatioWidth) {\n                    var elem = getComponent(aspectRatioWidth, 'numerictextbox');\n                    if (aspectRatioWidth && aspectRatioWidth.value === '') {\n                        elem.value = parseFloat(elem.placeholder);\n                        aspectRatioWidth.value = elem.placeholder + 'px';\n                    }\n                }\n            }\n            parent.notify('draw', { prop: 'redrawDownScale' });\n            if (isIcon) {\n                this.focusRatioBtn();\n            }\n            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        }\n        else if (e.target.classList.contains('e-upload')) {\n            var upload = parent.element.querySelector('.e-image-upload');\n            if (upload && upload.querySelector('.e-tbar-btn')) {\n                upload.querySelector('.e-tbar-btn').click();\n            }\n            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        }\n        else if (e.target.classList.contains('filter-wrapper')) {\n            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n            e.target.parentElement.click();\n        }\n        else {\n            var splitWords = void 0;\n            if (parent.activeObj.shape) {\n                splitWords = parent.activeObj.shape.split('-');\n            }\n            if (e && this.isKeyBoardCrop(e) &&\n                parent.activeObj.horTopLine && (parent.activeObj.shape && splitWords[0] === 'crop')) {\n                parent.crop();\n            }\n        }\n    };\n    Selection.prototype.focusRatioBtn = function () {\n        var id = this.parent.element.id;\n        if (this.parent.isKBDNavigation) {\n            // eslint-disable-next-line @typescript-eslint/tslint/config\n            setTimeout(function () {\n                if (document.getElementById(id + '_aspectratio')) {\n                    document.getElementById(id + '_aspectratio').focus();\n                }\n                else if (document.getElementById(id + '_nonaspectratio')) {\n                    document.getElementById(id + '_nonaspectratio').focus();\n                }\n            }, 50);\n        }\n    };\n    Selection.prototype.isKeyBoardCrop = function (e) {\n        var bool = false;\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var target = e.target;\n        if (target.id === this.parent.element.id + '_ok' || target.id === '') {\n            bool = true;\n        }\n        return bool;\n    };\n    Selection.prototype.beforeSaveEvent = function (observableSaveArgs, e) {\n        var parent = this.parent;\n        if (!observableSaveArgs.cancel) {\n            parent.notify('export', { prop: 'export', onPropertyChange: false,\n                value: { type: observableSaveArgs.fileType, fileName: observableSaveArgs.fileName } });\n        }\n        e.preventDefault();\n        e.stopImmediatePropagation();\n    };\n    Selection.prototype.handleScroll = function (e) {\n        this.mouseWheel++;\n        var parent = this.parent;\n        var x;\n        var y;\n        var isInsideCanvas = false;\n        if (e.type === 'mousewheel') {\n            // eslint-disable-next-line\n            x = e.clientX;\n            y = e.clientY;\n        }\n        var bbox = parent.lowerCanvas.getBoundingClientRect();\n        x -= bbox.left;\n        y -= bbox.top;\n        if (x > parent.img.destLeft && x < parent.img.destLeft + parent.img.destWidth && y > parent.img.destTop &&\n            y < parent.img.destTop + parent.img.destHeight) {\n            isInsideCanvas = true;\n        }\n        if (this.mouseWheel === 2) {\n            this.mouseWheel = 0;\n            if (e.ctrlKey === true && isInsideCanvas) {\n                e.preventDefault();\n            }\n            return;\n        }\n        e.stopPropagation();\n        if (e.ctrlKey === true && isInsideCanvas) {\n            e.preventDefault();\n            if (!parent.isCropTab && (parent.activeObj.shape && parent.activeObj.shape.split('-')[0] !== 'crop')) {\n                parent.okBtn(null, true);\n                parent.notify('toolbar', { prop: 'close-contextual-toolbar', onPropertyChange: false });\n            }\n            var type = '';\n            if (e.type === 'mousewheel' && (parent.zoomSettings.zoomTrigger & ZoomTrigger.MouseWheel) === ZoomTrigger.MouseWheel) {\n                this.zoomType = 'MouseWheel';\n                // eslint-disable-next-line\n                if (e.wheelDelta > 0) {\n                    type = 'zoomIn';\n                }\n                else {\n                    type = 'zoomOut';\n                }\n            }\n            if (type !== '') {\n                parent.isZoomBtnClick = true;\n                parent.notify('draw', { prop: 'performPointZoom', onPropertyChange: false,\n                    value: { x: x, y: y, type: type, isResize: null } });\n                parent.notify('draw', { prop: 'redrawDownScale' });\n                if (parent.isCropTab || parent.activeObj.shape) {\n                    parent.notify('draw', { prop: 'setStraightenActObj', value: { activeObj: null } });\n                    parent.notify('freehand-draw', { prop: 'resetStraightenPoint' });\n                }\n                if (parent.isStraightening) {\n                    parent.notify('draw', { prop: 'resetStraightenDestPoints' });\n                    parent.notify('draw', { prop: 'setDestForStraighten' });\n                }\n            }\n        }\n    };\n    Selection.prototype.textKeyDown = function (e) {\n        var parent = this.parent;\n        if (parent.activeObj.rotatedAngle !== 0) {\n            return;\n        }\n        if (String.fromCharCode(e.which) === '\\r') {\n            this.textRow += 1;\n        }\n        parent.textArea.setAttribute('rows', this.textRow.toString());\n        parent.textArea.style.height = 'auto';\n        parent.textArea.style.height = parent.textArea.scrollHeight + 'px';\n        parent.notify('shape', { prop: 'setTextBoxWidth', onPropertyChange: false, value: { e: e } });\n        if (Browser.isDevice) {\n            parent.textArea.style.width = parseFloat(parent.textArea.style.width) + parent.textArea.style.fontSize + 'px';\n        }\n        var rows = parent.textArea.value.split('\\n');\n        this.textRow = rows.length;\n        parent.textArea.setAttribute('rows', this.textRow.toString());\n        this.isInitialTextEdited = false;\n    };\n    Selection.prototype.clearSelection = function (resetCrop) {\n        var parent = this.parent;\n        if (!parent.disabled && parent.isImageLoaded) {\n            if (resetCrop) {\n                parent.notify('draw', { prop: 'performCancel', value: { isContextualToolbar: null } });\n            }\n            else {\n                parent.togglePen = false;\n                parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                this.dragElement = '';\n                this.dragPoint.startX = this.dragPoint.startY = this.dragPoint.endX = this.dragPoint.endY = 0;\n                parent.currObjType.shape = '';\n                this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                parent.currObjType.isActiveObj = true;\n                parent.currObjType.isCustomCrop = false;\n                parent.upperCanvas.style.cursor = parent.cursor = 'default';\n            }\n        }\n    };\n    Selection.prototype.setDragDirection = function (width, height) {\n        var arcRadius = (7.5);\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        if (parent.img.destWidth > parent.img.destHeight) {\n            actPoint.startX = this.dragPoint.startX = ((width / 2) - (height / 2)) + arcRadius;\n            actPoint.startY = this.dragPoint.startY = ((height / 2) - (height / 2)) + arcRadius;\n            actPoint.endX = ((width / 2) + (height / 2)) - arcRadius;\n            actPoint.endY = ((height / 2) + (height / 2)) - arcRadius;\n        }\n        else {\n            actPoint.startY = this.dragPoint.startX = ((height / 2) - (width) / 2) + arcRadius;\n            actPoint.endY = ((height / 2) + (width) / 2) - arcRadius;\n            actPoint.startX = this.dragPoint.startX = arcRadius;\n            actPoint.endX = width - arcRadius;\n        }\n    };\n    Selection.prototype.calcShapeRatio = function (x, y, imgWidth, imgHeight) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var arcRadius = (7.5);\n        var presetRatio = x / y;\n        var originalWidth = imgWidth;\n        var originalHeight = imgHeight;\n        var standardSize = originalWidth >= originalHeight ? originalWidth : originalHeight;\n        var width = standardSize * presetRatio;\n        var height = standardSize;\n        var scaleWidth = this.getScale(width, originalWidth);\n        var snippetArray = [];\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        for (var i = 0; i < 2; i++) {\n            if (i === 0) {\n                snippetArray.push(width * scaleWidth);\n            }\n            else {\n                snippetArray.push(height * scaleWidth);\n            }\n        }\n        width = snippetArray[0];\n        height = snippetArray[1];\n        var scaleHeight = this.getScale(height, originalHeight);\n        var snippetArray1 = [];\n        for (var i = 0; i < 2; i++) {\n            if (i === 0) {\n                snippetArray1.push(width * scaleHeight);\n            }\n            else {\n                snippetArray1.push(height * scaleHeight);\n            }\n        }\n        width = snippetArray1[0];\n        height = snippetArray1[1];\n        actPoint.width = width;\n        actPoint.height = height;\n        actPoint.startX = (this.dragPoint.startX = (originalWidth - width) / 2) + arcRadius;\n        actPoint.startY = (this.dragPoint.startY = (originalHeight - height) / 2) + arcRadius;\n        actPoint.endX = actPoint.startX + actPoint.width;\n        actPoint.endY = actPoint.startY + actPoint.height;\n        if (actPoint.startX < destLeft && destLeft + destWidth > parent.lowerCanvas.clientWidth) {\n            actPoint.startX = destLeft;\n            actPoint.endX = actPoint.startX + width - arcRadius;\n        }\n        if (actPoint.startY < destTop && destTop + destHeight > parent.lowerCanvas.clientHeight) {\n            actPoint.startY = destTop;\n            actPoint.endY = actPoint.startY + height - arcRadius;\n        }\n        actPoint.width = actPoint.endX - actPoint.startX;\n        actPoint.height = actPoint.endY - actPoint.startY;\n    };\n    Selection.prototype.getScale = function (value, originalValue) {\n        return value > originalValue ? originalValue / value : 1;\n    };\n    Selection.prototype.findTarget = function (x, y, type) {\n        var parent = this.parent;\n        if (type.toLowerCase() === 'mousedown' || type.toLowerCase() === 'touchstart') {\n            var splitWords = void 0;\n            var isCrop = false;\n            if (parent.activeObj.shape) {\n                splitWords = parent.activeObj.shape.split('-');\n                if (splitWords[0] === 'crop') {\n                    isCrop = true;\n                }\n            }\n            this.findTargetObj(x, y, isCrop);\n            this.updateCursorStyles(x, y, type);\n        }\n        else {\n            var _a = parent.activeObj, topLeftCircle = _a.topLeftCircle, topCenterCircle = _a.topCenterCircle, topRightCircle = _a.topRightCircle, centerLeftCircle = _a.centerLeftCircle, centerRightCircle = _a.centerRightCircle, bottomLeftCircle = _a.bottomLeftCircle, bottomCenterCircle = _a.bottomCenterCircle, bottomRightCircle = _a.bottomRightCircle;\n            switch (this.dragElement.toLowerCase()) {\n                case 'nw-resize':\n                    topLeftCircle.startX = x;\n                    topLeftCircle.startY = y;\n                    break;\n                case 'n-resize':\n                    topCenterCircle.startX = x;\n                    topCenterCircle.startY = y;\n                    break;\n                case 'ne-resize':\n                    topRightCircle.startX = x;\n                    topRightCircle.startY = y;\n                    break;\n                case 'w-resize':\n                    centerLeftCircle.startX = x;\n                    centerLeftCircle.startY = y;\n                    break;\n                case 'e-resize':\n                    centerRightCircle.startX = x;\n                    centerRightCircle.startY = y;\n                    break;\n                case 'sw-resize':\n                    bottomLeftCircle.startX = x;\n                    bottomLeftCircle.startY = y;\n                    break;\n                case 's-resize':\n                    bottomCenterCircle.startX = x;\n                    bottomCenterCircle.startY = y;\n                    break;\n                case 'se-resize':\n                    bottomRightCircle.startX = x;\n                    bottomRightCircle.startY = y;\n                    break;\n                default:\n                    if (this.dragPoint.startX && this.dragPoint.startY) {\n                        this.previousPoint.x = this.dragPoint.endX;\n                        this.previousPoint.y = this.dragPoint.endY;\n                        this.dragPoint.endX = x;\n                        this.dragPoint.endY = y;\n                    }\n                    break;\n            }\n        }\n    };\n    Selection.prototype.findTargetObj = function (x, y, isCrop) {\n        var parent = this.parent;\n        var isShape = false;\n        if (parent.objColl.length !== 0 && !parent.currObjType.isCustomCrop && !isCrop) {\n            var prevIndex = 0;\n            var i = void 0;\n            for (var index = 0; index < parent.objColl.length; index++) {\n                var cursor = parent.upperCanvas.style.cursor;\n                this.setCursor(x, y);\n                var actObj = extend({}, parent.objColl[index], {}, true);\n                var radius = actObj.topLeftCircle.radius;\n                if (actObj.shape === 'line' || actObj.shape === 'arrow') {\n                    for (var j = 0; j < actObj.pointColl.length; j++) {\n                        if (x >= actObj.pointColl[j].x - (radius * 2) &&\n                            x <= actObj.pointColl[j].x + (radius * 2) &&\n                            y >= actObj.pointColl[j].y - (radius * 2) &&\n                            y <= actObj.pointColl[j].y + (radius * 2)) {\n                            if (this.tempActiveObj && this.tempActiveObj.activePoint &&\n                                JSON.stringify(this.tempActiveObj.activePoint) === JSON.stringify(actObj.activePoint)) {\n                                i = index;\n                                break;\n                            }\n                            else {\n                                if (this.isTouch || parent.cursor === 'move' ||\n                                    parent.cursor === 'grab' || this.isShapeInserted) {\n                                    if (prevIndex === 0 || prevIndex < actObj.order) {\n                                        prevIndex = actObj.order;\n                                        i = index;\n                                    }\n                                }\n                                else if (parent.objColl[index].currIndex === this.tempActiveObj.currIndex) {\n                                    i = index;\n                                }\n                            }\n                            break;\n                        }\n                    }\n                }\n                else if (actObj.shape === 'path') {\n                    var cursor_3 = this.setCursorForPath(actObj, x, y, parent.upperCanvas);\n                    if (cursor_3 !== 'default' && cursor_3 !== 'grab') {\n                        if (this.tempActiveObj && this.tempActiveObj.activePoint &&\n                            JSON.stringify(this.tempActiveObj.activePoint) === JSON.stringify(actObj.activePoint)) {\n                            i = index;\n                            break;\n                        }\n                        else {\n                            if (this.isTouch || parent.cursor === 'move' || parent.cursor === 'grab' || this.isShapeInserted) {\n                                if (prevIndex === 0 || prevIndex < actObj.order) {\n                                    prevIndex = actObj.order;\n                                    i = index;\n                                }\n                            }\n                            else if (parent.objColl[index].currIndex === this.tempActiveObj.currIndex) {\n                                i = index;\n                            }\n                        }\n                    }\n                }\n                else if (actObj.rotatedAngle !== 0) {\n                    var cursor_4 = this.setCursorForRotatedObject(actObj, x, y, parent.upperCanvas);\n                    if (cursor_4 !== 'default' && cursor_4 !== 'grab') {\n                        if (this.tempActiveObj && this.tempActiveObj.activePoint &&\n                            JSON.stringify(this.tempActiveObj.activePoint) === JSON.stringify(actObj.activePoint)) {\n                            i = index;\n                            break;\n                        }\n                        else {\n                            if (this.isTouch || parent.cursor === 'move' || parent.cursor === 'grab' || this.isShapeInserted) {\n                                if (prevIndex === 0 || (prevIndex < actObj.order && (actObj.shape !== 'redact' || parent.drawingShape === 'redact'))) {\n                                    prevIndex = actObj.order;\n                                    i = index;\n                                }\n                            }\n                            else if (parent.objColl[index].currIndex === this.tempActiveObj.currIndex) {\n                                i = index;\n                            }\n                        }\n                    }\n                }\n                else {\n                    var rotationCirclePoint = this.getTransRotationPoint(actObj);\n                    if ((x >= (actObj.activePoint.startX - (radius * 2)) &&\n                        x <= (actObj.activePoint.endX + (radius * 2)) &&\n                        y >= (actObj.activePoint.startY - (radius * 2)) &&\n                        y <= (actObj.activePoint.endY + (radius * 2))) ||\n                        (rotationCirclePoint &&\n                            x >= (rotationCirclePoint.x - (radius * 2)) &&\n                            x <= (rotationCirclePoint.x + (radius * 2)) &&\n                            y >= (rotationCirclePoint.y - (radius * 2)) &&\n                            y <= (rotationCirclePoint.y + (radius * 2)))) {\n                        if (this.tempActiveObj && this.tempActiveObj.activePoint &&\n                            JSON.stringify(this.tempActiveObj.activePoint) === JSON.stringify(actObj.activePoint)) {\n                            i = index;\n                            break;\n                        }\n                        else {\n                            if (this.isTouch || cursor === 'move' || cursor === 'grabbing' || this.isShapeInserted\n                                || parent.cursor === 'move' || parent.cursor === 'grabbing') {\n                                if (prevIndex === 0 || (prevIndex < actObj.order && (actObj.shape !== 'redact' || parent.drawingShape === 'redact'))) {\n                                    prevIndex = actObj.order;\n                                    i = index;\n                                }\n                            }\n                            else if (parent.objColl[index].currIndex === this.tempActiveObj.currIndex) {\n                                i = index;\n                            }\n                        }\n                    }\n                }\n            }\n            if (isNullOrUndefined(i)) {\n                parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                isShape = false;\n            }\n            else {\n                this.tempObjColl = extend([], parent.objColl, [], true);\n                parent.currObjType.isCustomCrop = false;\n                parent.activeObj = extend({}, parent.objColl[i], {}, true);\n                var temp = extend({}, parent.objColl[i], {}, true);\n                parent.objColl.splice(i, 1);\n                if (parent.transform.degree === 0) {\n                    var temp_1 = this.lowerContext.filter;\n                    this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n                    parent.notify('draw', { prop: 'drawImage', onPropertyChange: false });\n                    this.lowerContext.filter = 'none';\n                    parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n                        value: { ctx: this.lowerContext, shape: 'iterate', pen: 'iterate', isPreventApply: null } });\n                    parent.activeObj = extend({}, temp_1, {}, true);\n                    this.lowerContext.filter = temp_1;\n                    this.getCurrentFlipState();\n                }\n                else {\n                    var totalPannedInternalPoint = extend({}, parent.panPoint.totalPannedInternalPoint, {}, true);\n                    var destPoints = { startX: parent.img.destLeft, startY: parent.img.destTop, width: parent.img.destWidth,\n                        height: parent.img.destHeight };\n                    parent.notify('draw', { prop: 'callUpdateCurrTransState', onPropertyChange: false });\n                    parent.panPoint.totalPannedInternalPoint = totalPannedInternalPoint;\n                    parent.img.destLeft = destPoints.startX;\n                    parent.img.destTop = destPoints.startY;\n                    parent.img.destWidth = destPoints.width;\n                    parent.img.destHeight = destPoints.height;\n                    parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n                        value: { ctx: this.lowerContext, shape: 'iterate', pen: 'iterate', isPreventApply: null } });\n                }\n                parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n                if ((parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle') || parent.isCircleCrop) {\n                    parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                        value: { context: this.lowerContext, isSave: null, isFlip: null } });\n                }\n                parent.activeObj = extend({}, temp, {}, true);\n                this.setActivePoint();\n                parent.activeObj = extend({}, temp, {}, true);\n                var tempStrokeSettings = extend({}, parent.activeObj.strokeSettings, {}, true);\n                parent.notify('draw', { prop: 'setTempStrokeSettings', onPropertyChange: false,\n                    value: { tempStrokeSettings: tempStrokeSettings } });\n                var tempTextSettings = extend({}, parent.activeObj.textSettings, {}, true);\n                parent.notify('draw', { prop: 'setTempTextSettings', onPropertyChange: false, value: { tempTextSettings: tempTextSettings } });\n                var shapeSettings = this.updatePrevShapeSettings();\n                var shapeChangingArgs = { cancel: false, action: 'select', previousShapeSettings: shapeSettings,\n                    currentShapeSettings: shapeSettings, allowShapeOverflow: this.allowOutofBound() };\n                if (parent.activeObj.shape === 'line' || parent.activeObj.shape === 'arrow') {\n                    shapeChangingArgs.currentShapeSettings.width = parent.activeObj.activePoint.endX - parent.activeObj.activePoint.startX;\n                    shapeChangingArgs.currentShapeSettings.height = parent.activeObj.activePoint.endY - parent.activeObj.activePoint.startY;\n                }\n                this.isCropSelection = false;\n                var splitWords = void 0;\n                if (parent.activeObj.shape !== undefined) {\n                    splitWords = parent.activeObj.shape.split('-');\n                }\n                if (splitWords !== undefined && splitWords[0] === 'crop') {\n                    this.isCropSelection = true;\n                }\n                if (!this.isCropSelection && parent.activeObj.shape !== 'redact') {\n                    parent.trigger('shapeChanging', shapeChangingArgs);\n                    this.shapeEvent(shapeChangingArgs);\n                    parent.editCompleteArgs = shapeChangingArgs;\n                }\n                else {\n                    if (this.isMouseDown) {\n                        shapeChangingArgs.action = 'resize-start';\n                    }\n                    else if (this.isMouseUp) {\n                        shapeChangingArgs.action = 'resize-end';\n                    }\n                    var selectionChangingArgs = { action: shapeChangingArgs.action,\n                        previousSelectionSettings: { type: parent.getSelectionType(parent.activeObj.shape),\n                            startX: shapeChangingArgs.previousShapeSettings.startX,\n                            startY: shapeChangingArgs.previousShapeSettings.startY,\n                            width: shapeChangingArgs.previousShapeSettings.width,\n                            height: shapeChangingArgs.previousShapeSettings.height },\n                        currentSelectionSettings: { type: parent.getSelectionType(parent.activeObj.shape),\n                            startX: shapeChangingArgs.currentShapeSettings.startX,\n                            startY: shapeChangingArgs.currentShapeSettings.startY,\n                            width: shapeChangingArgs.currentShapeSettings.width,\n                            height: shapeChangingArgs.currentShapeSettings.height } };\n                    parent.trigger('selectionChanging', selectionChangingArgs);\n                    parent.editCompleteArgs = selectionChangingArgs;\n                    shapeChangingArgs.currentShapeSettings.startX = selectionChangingArgs.currentSelectionSettings.startX;\n                    shapeChangingArgs.currentShapeSettings.startY = selectionChangingArgs.currentSelectionSettings.startY;\n                    shapeChangingArgs.currentShapeSettings.width = selectionChangingArgs.currentSelectionSettings.width;\n                    shapeChangingArgs.currentShapeSettings.height = selectionChangingArgs.currentSelectionSettings.height;\n                    this.shapeEvent(shapeChangingArgs);\n                }\n                isShape = true;\n            }\n        }\n        return isShape;\n    };\n    Selection.prototype.shapeEvent = function (shapeChangingArgs) {\n        var parent = this.parent;\n        parent.notify('shape', { prop: 'updateShapeChangeEventArgs', onPropertyChange: false,\n            value: { shapeSettings: shapeChangingArgs.currentShapeSettings, allowShapeOverflow: shapeChangingArgs.allowShapeOverflow } });\n        if (parent.activeObj.activePoint) {\n            var obj = { prevActObj: null };\n            parent.notify('draw', { prop: 'getPrevActObj', onPropertyChange: false, value: { obj: obj } });\n            if (isNullOrUndefined(obj['prevActObj'])) {\n                parent.notify('draw', { prop: 'setPrevActObj', onPropertyChange: false,\n                    value: { prevActObj: extend({}, parent.activeObj, {}, true) } });\n            }\n            if (parent.activeObj.shape === 'image' && !this.isImageClarity) {\n                this.upgradeImageQuality();\n                this.isImageClarity = true;\n            }\n            parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: parent.activeObj, isCropRatio: null,\n                    points: null, isPreventDrag: true, saveContext: null, isPreventSelection: true } });\n            if (!this.isShapeInserted) {\n                this.isPreventDragging = this.isShapeDragOut();\n            }\n        }\n    };\n    Selection.prototype.upgradeImageQuality = function () {\n        var parent = this.parent;\n        if (!parent.activeObj.imageCanvas) {\n            return;\n        }\n        var activeObj = extend({}, parent.activeObj, null, true);\n        var ctx = parent.activeObj.imageCanvas.getContext('2d');\n        var dimObj = { width: 0, height: 0 };\n        parent.notify('transform', { prop: 'calcMaxDimension', onPropertyChange: false, value: { width: parent.activeObj.imageElement.width,\n                height: parent.activeObj.imageElement.height, obj: dimObj, isImgShape: null } });\n        parent.notify('shape', { prop: 'updateObj', onPropertyChange: false, value: { dimObj: dimObj, x: null, y: null } });\n        ctx.clearRect(0, 0, parent.activeObj.imageCanvas.width, parent.activeObj.imageCanvas.height);\n        this.applyTransformToImg(ctx);\n        parent.activeObj = activeObj;\n    };\n    Selection.prototype.applyTransformToImg = function (ctx) {\n        var parent = this.parent;\n        if (parent.activeObj.isHorImageFlip && parent.activeObj.isVerImageFlip) {\n            parent.activeObj.isHorImageFlip = parent.activeObj.isVerImageFlip = false;\n            parent.notify('draw', { prop: 'downScaleImgCanvas', onPropertyChange: false,\n                value: { ctx: ctx, isImgAnnotation: true, isHFlip: true, isVFlip: true } });\n        }\n        else if (parent.activeObj.isHorImageFlip) {\n            parent.activeObj.isHorImageFlip = false;\n            parent.notify('draw', { prop: 'downScaleImgCanvas', onPropertyChange: false,\n                value: { ctx: ctx, isImgAnnotation: true, isHFlip: true, isVFlip: false } });\n        }\n        else if (parent.activeObj.isVerImageFlip) {\n            parent.activeObj.isVerImageFlip = false;\n            parent.notify('draw', { prop: 'downScaleImgCanvas', onPropertyChange: false,\n                value: { ctx: ctx, isImgAnnotation: true, isHFlip: false, isVFlip: true } });\n        }\n        else {\n            parent.notify('draw', { prop: 'downScaleImgCanvas', onPropertyChange: false,\n                value: { ctx: ctx, isImgAnnotation: true, isHFlip: false, isVFlip: false } });\n        }\n    };\n    // eslint-disable-next-line\n    Selection.prototype.targetTouches = function (touches) {\n        var bbox = this.parent.lowerCanvas.getBoundingClientRect();\n        var p1 = { x: touches[0].pageX - bbox.left, y: touches[0].pageY - bbox.top };\n        var p2 = { x: touches[1].pageX - bbox.left, y: touches[1].pageY - bbox.top };\n        var points = [p1, p2];\n        return points;\n    };\n    Selection.prototype.calculateScale = function (startTouches, endTouches) {\n        var startDistance = this.getDistance(startTouches[0], startTouches[1]);\n        var endDistance = this.getDistance(endTouches[0], endTouches[1]);\n        return endDistance / startDistance;\n    };\n    Selection.prototype.getDistance = function (a, b) {\n        var x = 0;\n        var y = 0;\n        if (a && b) {\n            x = a.x - b.x;\n            y = a.y - b.y;\n        }\n        return Math.sqrt(x * x + y * y);\n    };\n    Selection.prototype.redrawShape = function (obj, isMouseUp) {\n        var parent = this.parent;\n        for (var i = 0, len = parent.objColl.length; i < len; i++) {\n            if (JSON.stringify(obj) === JSON.stringify(parent.objColl[i])) {\n                parent.objColl.splice(i, 1);\n                if (obj.shape && parent.textArea.style.display === 'none') {\n                    var actObj = extend({}, obj, {}, true);\n                    parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                    this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n                    parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: null } });\n                    if (parent.rotateFlipColl.length > 0 && (parent.panPoint.totalPannedClientPoint.x !== 0 ||\n                        parent.panPoint.totalPannedClientPoint.y !== 0)) {\n                        parent.notify('draw', { prop: 'redrawImgWithObj', onPropertyChange: false });\n                    }\n                    obj = parent.activeObj = actObj;\n                }\n                break;\n            }\n        }\n        if ((obj.shape === 'path' && obj.pointColl.length === 0) ||\n            (obj.shape !== 'path' && (obj.activePoint.width === 0 && obj.activePoint.height === 0))) {\n            return;\n        }\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        if (this.isPreventDragging) {\n            if (parent.activeObj.activePoint.startX > parent.img.destLeft) {\n                this.isPreventDragging = false;\n            }\n            if (isMouseUp && parent.activeObj.rotatedAngle !== 0) {\n                parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: null, isCropRatio: null,\n                        points: null, isPreventDrag: true, saveContext: null, isPreventSelection: null } });\n            }\n            else {\n                parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: null, isCropRatio: null,\n                        points: null, isPreventDrag: true, saveContext: null, isPreventSelection: null } });\n            }\n        }\n        else {\n            if (isMouseUp && parent.activeObj.rotatedAngle !== 0) {\n                parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: null, isCropRatio: null,\n                        points: null, isPreventDrag: true, saveContext: null, isPreventSelection: null } });\n            }\n            else {\n                if (parent.activeObj.shape === 'redact') {\n                    this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n                    parent.notify('draw', { prop: 'redrawImgWithObj', onPropertyChange: false });\n                    parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n                }\n                parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: null, isCropRatio: null,\n                        points: null, isPreventDrag: true, saveContext: null, isPreventSelection: null } });\n            }\n        }\n    };\n    Selection.prototype.setTimer = function (e) {\n        var parent = this.parent;\n        if (this.timer > 10) {\n            clearTimeout(this.timer);\n            this.timer = 0;\n            parent.notify('shape', { prop: 'findTextTarget', onPropertyChange: false, value: { e: e } });\n            if (Browser.isDevice) {\n                this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            }\n        }\n    };\n    Selection.prototype.applyCurrActObj = function (x, y) {\n        var parent = this.parent;\n        var isInside = false;\n        var actObj = extend({}, parent.activeObj, {}, true);\n        if (isNullOrUndefined(actObj.activePoint)) {\n            return;\n        }\n        var _a = actObj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY;\n        var radius = actObj.topLeftCircle ? actObj.topLeftCircle.radius : 0;\n        if ((x >= Math.floor(startX) && x <= Math.ceil(endX) && y >= Math.floor(startY) && y <= Math.ceil(endY))) {\n            isInside = true;\n        }\n        else if (radius !== 0 && (x >= Math.floor(startX) - radius && x <= Math.ceil(endX) + radius &&\n            y >= Math.floor(startY) - radius && y <= Math.ceil(endY) + radius)) {\n            isInside = true;\n            this.tempActiveObj = { activePoint: { startX: 0, startY: 0, endX: 0, endY: 0, width: 0, height: 0 },\n                flipObjColl: [], triangle: [], triangleRatio: [] };\n        }\n        else if ((actObj.shape === 'text' || actObj.shape === 'image') && this.dragElement !== '') {\n            isInside = true;\n        }\n        else if (actObj.shape === 'line' || actObj.shape === 'arrow') {\n            var smallPoint = { x: startX < endX ? startX : endX, y: startY < endY ? startY : endY };\n            var largePoint = { x: startX > endX ? startX : endX, y: startY > endY ? startY : endY };\n            if ((x >= (Math.floor(smallPoint.x) - 5) && x <= (Math.ceil(largePoint.x) + 5) &&\n                y >= (Math.floor(smallPoint.y) - 5) && y <= (Math.ceil(largePoint.y) + 5)) ||\n                parent.activeObj.preventShapeDragOut) {\n                isInside = true;\n            }\n        }\n        else if (actObj.shape === 'path') {\n            var cursor = this.setCursorForPath(actObj, x, y, parent.upperCanvas);\n            if (cursor === 'move') {\n                isInside = true;\n            }\n        }\n        else if (this.dragElement === 'grabbing') {\n            isInside = true;\n        }\n        else if (actObj.rotatedAngle !== 0) {\n            var cursor = this.setCursorForRotatedObject(actObj, x, y, parent.upperCanvas);\n            if ((cursor !== 'default' && cursor !== 'grab') || this.dragElement === 'n-resize' || this.dragElement === 'e-resize' ||\n                this.dragElement === 's-resize' || this.dragElement === 'w-resize') {\n                isInside = true;\n            }\n        }\n        else if (parent.textArea.style.display === 'block' || parent.textArea.style.display === 'inline-block') {\n            isInside = true;\n        }\n        if (!isInside) {\n            if (isNullOrUndefined(parent.activeObj.currIndex)) {\n                var shapeIDObj = { id: 'shape_' + (parent.objColl.length + 1) };\n                parent.notify('shape', { prop: 'getNewShapeId', onPropertyChange: false, value: { obj: shapeIDObj } });\n                parent.activeObj.currIndex = shapeIDObj['id'];\n            }\n            parent.notify('shape', { prop: 'updImgRatioForActObj', onPropertyChange: false });\n            if (parent.activeObj.horTopLine !== undefined && parent.activeObj.horTopLine.startX !== 0 && parent.activeObj.horTopLine.endX\n                !== 0 && !parent.currObjType.isCustomCrop && parent.currObjType.shape !== '') {\n                if (parent.objColl.length > 0 &&\n                    JSON.stringify(parent.objColl[parent.objColl.length - 1].activePoint) !==\n                        JSON.stringify(parent.activeObj.activePoint)) {\n                    parent.objColl.push(extend({}, parent.activeObj, {}, true));\n                }\n            }\n            var shapeColl = ['rectangle', 'ellipse', 'line', 'arrow', 'path', 'text', 'image'];\n            if (shapeColl.indexOf(parent.activeObj.shape) > -1) {\n                var tempFilter = this.lowerContext.filter;\n                this.lowerContext.filter = 'brightness(' + 1 + ') ' + 'contrast(' + 100 + '%) ' + 'hue-rotate(' + 0 + 'deg) ' +\n                    'saturate(' + 100 + '%) ' + 'opacity(' + 1 + ') ' + 'blur(' + 0 + 'px) ' + 'sepia(0%) ' + 'grayscale(0%) ' +\n                    'invert(0%)';\n                parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n                    value: { ctx: this.lowerContext, shape: 'zoom', pen: 'zoom', isPreventApply: null } });\n                this.lowerContext.filter = tempFilter;\n                if (parent.activeObj.shape) {\n                    parent.notify('shape', { prop: 'apply', onPropertyChange: false,\n                        value: { shape: null, obj: null, canvas: null } });\n                }\n                parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n                parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.upperContext } });\n                if (parent.isCircleCrop) {\n                    parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                        value: { context: this.lowerContext, isSave: null, isFlip: null } });\n                }\n            }\n            parent.notify('toolbar', { prop: 'refresh-main-toolbar', onPropertyChange: false });\n        }\n    };\n    Selection.prototype.getCurrentFlipState = function () {\n        var parent = this.parent;\n        if (parent.rotateFlipColl.length !== 0) {\n            var totalPannedInternalPoint = extend({}, parent.panPoint.totalPannedInternalPoint, {}, true);\n            parent.notify('draw', { prop: 'callUpdateCurrTransState', onPropertyChange: false });\n            parent.panPoint.totalPannedInternalPoint = totalPannedInternalPoint;\n        }\n        else {\n            parent.notify('draw', { prop: 'callUpdateCurrTransState', onPropertyChange: false });\n        }\n    };\n    Selection.prototype.setTextBoxStylesToActObj = function () {\n        var parent = this.parent;\n        parent.activeObj.textSettings.fontFamily = parent.textArea.style.fontFamily;\n        parent.activeObj.strokeSettings.strokeColor = parent.textArea.style.color !== '' &&\n            parent.textArea.style.color.split('(')[1] && parent.textArea.style.color.split('(')[1].split(',')[0] &&\n            parent.textArea.style.color.split('(')[1].split(',')[1] && parent.textArea.style.color.split('(')[1].split(',')[2]\n            && parent.textArea.style.color.split('(')[1].split(',')[3] ?\n            this.rgbToHex(parseFloat(parent.textArea.style.color.split('(')[1].split(',')[0]), parseFloat(parent.textArea.style.color.split('(')[1].split(',')[1]), parseFloat(parent.textArea.style.color.split('(')[1].split(',')[2]), parseFloat(parent.textArea.style.color.split('(')[1].split(',')[3])) :\n            parent.textArea.style.color;\n        parent.activeObj.strokeSettings.fillColor = parent.textArea.style.backgroundColor !== '' &&\n            parent.textArea.style.backgroundColor.split('(')[1] && parent.textArea.style.backgroundColor.split('(')[1].split(',')[0] &&\n            parent.textArea.style.backgroundColor.split('(')[1].split(',')[1] && parent.textArea.style.backgroundColor.split('(')[1].split(',')[2]\n            && parent.textArea.style.backgroundColor.split('(')[1].split(',')[3] ?\n            this.rgbToHex(parseFloat(parent.textArea.style.backgroundColor.split('(')[1].split(',')[0]), parseFloat(parent.textArea.style.backgroundColor.split('(')[1].split(',')[1]), parseFloat(parent.textArea.style.backgroundColor.split('(')[1].split(',')[2]), parseFloat(parent.textArea.style.backgroundColor.split('(')[1].split(',')[3])) :\n            parent.textArea.style.backgroundColor;\n        parent.activeObj.strokeSettings.outlineColor = parent.textArea.style.textShadow !== '' &&\n            parent.textArea.style.textShadow.split('(')[1] && parent.textArea.style.textShadow.split('(')[1].split(',')[0] &&\n            parent.textArea.style.textShadow.split('(')[1].split(',')[1] && parent.textArea.style.textShadow.split('(')[1].split(',')[2]\n            && parent.textArea.style.textShadow.split('(')[1].split(',')[3] ?\n            this.rgbToHex(parseFloat(parent.textArea.style.textShadow.split('(')[1].split(',')[0]), parseFloat(parent.textArea.style.textShadow.split('(')[1].split(',')[1]), parseFloat(parent.textArea.style.textShadow.split('(')[1].split(',')[2]), parseFloat(parent.textArea.style.textShadow.split('(')[1].split(',')[3])) :\n            (parent.textArea.style.textShadow.match(/^(\\s*[\\w#]+)\\s/) ?\n                parent.textArea.style.textShadow.match(/^(\\s*[\\w#]+)\\s/)[1].trim() :\n                parent.textArea.style.textShadow);\n        if (parent.textArea.style.fontWeight === 'bold') {\n            parent.activeObj.textSettings.bold = true;\n        }\n        else {\n            parent.activeObj.textSettings.bold = false;\n        }\n        if (parent.textArea.style.fontStyle === 'italic') {\n            parent.activeObj.textSettings.italic = true;\n        }\n        else {\n            parent.activeObj.textSettings.italic = false;\n        }\n        parent.activeObj.textSettings.fontSize = (parseFloat(parent.textArea.style.fontSize));\n    };\n    Selection.prototype.rgbToHex = function (r, g, b, a) {\n        r = Math.max(0, Math.min(255, Math.round(r)));\n        g = Math.max(0, Math.min(255, Math.round(g)));\n        b = Math.max(0, Math.min(255, Math.round(b)));\n        a = Math.max(0, Math.min(1, a));\n        var hexR = this.padLeft(r.toString(16), 2, '0');\n        var hexG = this.padLeft(g.toString(16), 2, '0');\n        var hexB = this.padLeft(b.toString(16), 2, '0');\n        var hexA = this.padLeft(Math.round(a * 255).toString(16), 2, '0');\n        var hex;\n        if (isNaN(Number(hexA))) {\n            hex = \"#\" + hexR + hexG + hexB;\n        }\n        else {\n            hex = \"#\" + hexR + hexG + hexB + hexA;\n        }\n        return hex;\n    };\n    Selection.prototype.padLeft = function (value, length, padChar) {\n        while (value.length < length) {\n            value = padChar + value;\n        }\n        return value;\n    };\n    Selection.prototype.deleteItem = function () {\n        var parent = this.parent;\n        var shapeChangingArgs = { cancel: false };\n        var previousShapeSettings = {};\n        if (this.isFhdEditing) {\n            this.updateFreehandDrawColorChange();\n            var prevCropObj = extend({}, parent.cropObj, {}, true);\n            var object = { currObj: {} };\n            parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n            var prevObj = object['currObj'];\n            prevObj.objColl = extend([], parent.objColl, [], true);\n            prevObj.pointColl = extend([], parent.pointColl, [], true);\n            prevObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n            var selPointCollObj = { selPointColl: null };\n            parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n                value: { obj: selPointCollObj } });\n            prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n            var obj = { freehandDrawSelectedId: null };\n            parent.notify('freehand-draw', { prop: 'getFreehandDrawSelectedId', onPropertyChange: false, value: { obj: obj } });\n            parent.notify('freehand-draw', { prop: 'deleteFhd', value: { id: obj['freehandDrawSelectedId'] } });\n            parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                value: { operation: 'deleteFreehandDrawing', previousObj: prevObj, previousObjColl: this.tempObjColl,\n                    previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                    previousCropObj: prevCropObj, previousText: null,\n                    currentText: null, previousFilter: null, isCircleCrop: null } });\n            parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n            parent.notify('freehand-draw', { prop: 'resetFreehandDrawSelectedId' });\n        }\n        else if (parent.textArea.style.display === 'none') {\n            var obj = { prevActObj: null };\n            parent.notify('draw', { prop: 'getPrevActObj', onPropertyChange: false, value: { obj: obj } });\n            if (obj['prevActObj']) {\n                obj['prevActObj']['activePoint']['width'] = Math.abs(obj['prevActObj']['activePoint']['width']);\n                obj['prevActObj']['activePoint']['height'] = Math.abs(obj['prevActObj']['activePoint']['height']);\n            }\n            if (obj['prevActObj'] && JSON.stringify(obj['prevActObj']) !== JSON.stringify(parent.activeObj)) {\n                var index = parent.activeObj.currIndex;\n                parent.notify('draw', { prop: 'performCancel', value: { isContextualToolbar: null, isFinalCancel: true } });\n                for (var i = 0, len = parent.objColl.length; i < len; i++) {\n                    if (parent.objColl[i].currIndex === index) {\n                        parent.objColl.splice(i, 1);\n                        parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: null } });\n                        break;\n                    }\n                }\n            }\n            var object = { isNewPath: null };\n            parent.notify('draw', { prop: 'getNewPath', value: { obj: object } });\n            if (object['isNewPath']) {\n                parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: null } });\n                parent.notify('toolbar', { prop: 'refresh-main-toolbar', onPropertyChange: false });\n            }\n            else if (parent.activeObj.shape) {\n                parent.objColl.push(parent.activeObj);\n                var prevCropObj = extend({}, parent.cropObj, {}, true);\n                var object_2 = { currObj: {} };\n                parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object_2 } });\n                var prevObj = object_2['currObj'];\n                prevObj.objColl = extend([], parent.objColl, [], true);\n                prevObj.pointColl = extend([], parent.pointColl, [], true);\n                prevObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n                var selPointCollObj = { selPointColl: null };\n                parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n                    value: { obj: selPointCollObj } });\n                prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n                parent.objColl.pop();\n                previousShapeSettings = this.updatePrevShapeSettings();\n                shapeChangingArgs = { cancel: false, action: 'delete', previousShapeSettings: previousShapeSettings, currentShapeSettings: null };\n                parent.notify('shape', { prop: 'setKeyHistory', onPropertyChange: false, value: { keyHistory: '' } });\n                parent.clearSelection();\n                parent.trigger('shapeChanging', shapeChangingArgs);\n                parent.editCompleteArgs = shapeChangingArgs;\n                parent.notify('toolbar', { prop: 'refresh-main-toolbar', onPropertyChange: false });\n                parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: null } });\n                if (!isNullOrUndefined(prevObj.objColl[prevObj.objColl.length - 1].currIndex)) {\n                    parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                        value: { operation: 'deleteObj', previousObj: prevObj, previousObjColl: this.tempObjColl,\n                            previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                            previousCropObj: prevCropObj, previousText: null,\n                            currentText: null, previousFilter: null, isCircleCrop: null } });\n                    parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n                }\n            }\n            parent.notify('draw', { prop: 'setPrevActObj', onPropertyChange: false, value: { prevActObj: null } });\n            if (parent.drawingShape) {\n                this.currentDrawingShape = parent.drawingShape.toLowerCase();\n                parent.enableShapeDrawing(parent.toPascalCase(parent.drawingShape), true);\n                parent.upperCanvas.style.cursor = 'crosshair';\n            }\n        }\n        if (document.getElementById(parent.element.id + '_quickAccessToolbarArea')) {\n            document.getElementById(parent.element.id + '_quickAccessToolbarArea').style.display = 'none';\n        }\n    };\n    Selection.prototype.updateFreehandDrawColorChange = function () {\n        var parent = this.parent;\n        var indexObj = { freehandSelectedIndex: null };\n        parent.notify('freehand-draw', { prop: 'getFreehandSelectedIndex', onPropertyChange: false, value: { obj: indexObj } });\n        if (!isNullOrUndefined(indexObj['freehandSelectedIndex']) && !isNullOrUndefined(parent.pointColl[indexObj['freehandSelectedIndex']])\n            && parent.pointColl[indexObj['freehandSelectedIndex']].strokeColor === '#42a5f5') {\n            var obj = { tempFreeHandDrawEditingStyles: null };\n            parent.notify('freehand-draw', { prop: 'getTempFreeHandDrawEditingStyles', value: { obj: obj } });\n            parent.pointColl[indexObj['freehandSelectedIndex']].strokeColor = obj['tempFreeHandDrawEditingStyles'].strokeColor;\n        }\n    };\n    Selection.prototype.updatePrevShapeSettings = function (obj) {\n        var parent = this.parent;\n        var fontStyle = [];\n        if (isNullOrUndefined(parent.activeObj.currIndex)) {\n            var shapeIDObj = { id: 'shape_' + (parent.objColl.length + 1) };\n            parent.notify('shape', { prop: 'getNewShapeId', onPropertyChange: false, value: { obj: shapeIDObj } });\n            parent.activeObj.currIndex = shapeIDObj['id'];\n        }\n        if (parent.activeObj.shape === 'text' && parent.activeObj.textSettings) {\n            if (parent.activeObj.textSettings.bold) {\n                fontStyle.push('bold');\n            }\n            if (parent.activeObj.textSettings.italic) {\n                fontStyle.push('italic');\n            }\n            if (parent.activeObj.textSettings.underline) {\n                fontStyle.push('underline');\n            }\n        }\n        var _a = parent.activeObj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY, width = _a.width, height = _a.height;\n        var _b = parent.activeObj, keyHistory = _b.keyHistory, currIndex = _b.currIndex, shape = _b.shape, textSettings = _b.textSettings, strokeSettings = _b.strokeSettings, rotatedAngle = _b.rotatedAngle, imageElement = _b.imageElement, opacity = _b.opacity;\n        var shapeSettingsObj = {\n            id: !isNullOrUndefined(currIndex) ? currIndex : null,\n            type: parent.toPascalCase(shape),\n            startX: startX, startY: startY, width: width, height: height,\n            strokeColor: strokeSettings ? strokeSettings.strokeColor : null,\n            strokeWidth: strokeSettings ? strokeSettings.strokeWidth : null,\n            fillColor: strokeSettings ? strokeSettings.fillColor : null,\n            radius: shape === 'ellipse' ? width / 2 : null,\n            length: shape === 'line' || shape === 'arrow' ? width : null,\n            text: shape === 'text' ? (keyHistory ? keyHistory : (textSettings.text ? textSettings.text : null)) : null,\n            fontSize: shape === 'text' ? (textSettings ? textSettings.fontSize : null) : null,\n            fontFamily: shape === 'text' ? (textSettings ? textSettings.fontFamily : null) : null,\n            fontStyle: shape === 'text' ? fontStyle : null,\n            color: shape === 'text' ? (strokeSettings ? strokeSettings.strokeColor : null) : null,\n            degree: shape === 'ellipse' || shape === 'rectangle' || shape === 'image' || shape === 'text' ? rotatedAngle * (180 / Math.PI) : null,\n            imageData: shape === 'image' ? imageElement.src : null,\n            opacity: shape === 'image' ? opacity : null,\n            radiusX: shape === 'ellipse' ? width / 2 : null,\n            radiusY: shape === 'ellipse' ? height / 2 : null,\n            endX: shape === 'line' || shape === 'arrow' ? endX : null,\n            endY: shape === 'line' || shape === 'arrow' ? endY : null,\n            arrowHead: shape === 'arrow' ? this.getArrowType(parent.activeObj.start) : null,\n            arrowTail: shape === 'arrow' ? this.getArrowType(parent.activeObj.end) : null,\n            points: shape === 'path' ? parent.activeObj.pointColl : null,\n            index: parent.activeObj.order\n        };\n        if (obj) {\n            obj['shapeSettingsObj'] = shapeSettingsObj;\n        }\n        return shapeSettingsObj;\n    };\n    Selection.prototype.getArrowType = function (type) {\n        var typeToArrowType = { 'none': 'None', 'arrow': 'Arrow', 'arrowSolid': 'SolidArrow',\n            'circle': 'Circle', 'circleSolid': 'SolidCircle', 'square': 'Square', 'squareSolid': 'SolidSquare', 'bar': 'Bar' };\n        return typeToArrowType[\"\" + type];\n    };\n    Selection.prototype.getRectanglePoints = function (rectX, rectY, rectWidth, rectHeight, rectAngle, pointX, pointY) {\n        var centerX = rectX + rectWidth / 2;\n        var centerY = rectY + rectHeight / 2;\n        var angleRad = rectAngle * (Math.PI / 180);\n        var cosAngle = Math.cos(angleRad);\n        var sinAngle = Math.sin(angleRad);\n        var localX = pointX - centerX;\n        var localY = pointY - centerY;\n        var rotatedX = localX * cosAngle + localY * sinAngle;\n        var rotatedY = -localX * sinAngle + localY * cosAngle;\n        var halfWidth = rectWidth / 2;\n        var halfHeight = rectHeight / 2;\n        if (rotatedX >= -halfWidth && rotatedX <= halfWidth && rotatedY >= -halfHeight &&\n            rotatedY <= halfHeight) {\n            return true;\n        }\n        else {\n            return false;\n        }\n    };\n    Selection.prototype.getTransRotationPoint = function (obj, object) {\n        var rotationCirclePoint;\n        var degree;\n        var isHorizontalflip = false;\n        var isVerticalflip = false;\n        degree = (obj.shapeDegree === 0) ? this.parent.transform.degree : this.parent.transform.degree - obj.shapeDegree;\n        if (degree < 0) {\n            degree = 360 + degree;\n        }\n        if (obj.flipObjColl) {\n            for (var i = 0, iLen = obj.flipObjColl.length; i < iLen; i++) {\n                if (obj.flipObjColl[i].toLowerCase() === 'horizontal') {\n                    isHorizontalflip = true;\n                }\n                else if (obj.flipObjColl[i].toLowerCase() === 'vertical') {\n                    isVerticalflip = true;\n                }\n            }\n        }\n        if (degree === 0 || degree === 360) {\n            if (isVerticalflip) {\n                rotationCirclePoint = { x: obj.topCenterCircle.startX, y: obj.topCenterCircle.startY - obj.rotationCircleLine };\n            }\n            else {\n                rotationCirclePoint = { x: obj.bottomCenterCircle.startX, y: obj.bottomCenterCircle.startY + obj.rotationCircleLine };\n            }\n        }\n        else if (degree === 90 || degree === -270) {\n            if (isHorizontalflip) {\n                rotationCirclePoint = { x: obj.centerRightCircle.startX + obj.rotationCircleLine, y: obj.centerLeftCircle.startY };\n            }\n            else {\n                rotationCirclePoint = { x: obj.centerLeftCircle.startX - obj.rotationCircleLine, y: obj.centerLeftCircle.startY };\n            }\n        }\n        else if (degree === 180 || degree === -180) {\n            if (isVerticalflip) {\n                rotationCirclePoint = { x: obj.bottomCenterCircle.startX, y: obj.bottomCenterCircle.startY + obj.rotationCircleLine };\n            }\n            else {\n                rotationCirclePoint = { x: obj.topCenterCircle.startX, y: obj.topCenterCircle.startY - obj.rotationCircleLine };\n            }\n        }\n        else if (degree === 270 || degree === -90) {\n            if (isHorizontalflip) {\n                rotationCirclePoint = { x: obj.centerLeftCircle.startX - obj.rotationCircleLine, y: obj.centerLeftCircle.startY };\n            }\n            else {\n                rotationCirclePoint = { x: obj.centerRightCircle.startX + obj.rotationCircleLine, y: obj.centerLeftCircle.startY };\n            }\n        }\n        if (object) {\n            object['rotationCirclePoint'] = rotationCirclePoint;\n        }\n        return rotationCirclePoint;\n    };\n    Selection.prototype.getNumTextValue = function (obj) {\n        var parent = this.parent;\n        var elem = parent.element;\n        var height;\n        var width;\n        var widthElement;\n        var heightElement;\n        widthElement = elem.querySelector('#' + elem.id + '_resizeWidth');\n        heightElement = elem.querySelector('#' + elem.id + '_resizeHeight');\n        if (widthElement && heightElement) {\n            var heightString = heightElement.value.replace(/,/g, '');\n            var widthString = widthElement.value.replace(/,/g, '');\n            if (heightString === '') {\n                heightString = heightElement.placeholder.replace(/,/g, '');\n            }\n            if (widthString === '') {\n                widthString = widthElement.placeholder.replace(/,/g, '');\n            }\n            height = parseFloat(heightString);\n            width = parseFloat(widthString);\n        }\n        if (obj) {\n            obj['width'] = width;\n            obj['height'] = height;\n        }\n        return { x: width, y: height };\n    };\n    Selection.prototype.isValueUpdated = function () {\n        var isValue = true;\n        var widthElement;\n        var heightElement;\n        widthElement = this.parent.element.querySelector('#' + this.parent.element.id + '_resizeWidth');\n        heightElement = this.parent.element.querySelector('#' + this.parent.element.id + '_resizeHeight');\n        if (widthElement && heightElement) {\n            if (heightElement.value.replace(/,/g, '') === '' && widthElement.value.replace(/,/g, '') === '') {\n                isValue = false;\n            }\n        }\n        return isValue;\n    };\n    Selection.prototype.allowOutofBound = function () {\n        var shapes = ['ellipse', 'rectangle', 'text', 'image', 'redact'];\n        // eslint-disable-next-line max-len\n        var allowOutofBound = (shapes.indexOf(this.parent.activeObj.shape) !== -1 && this.parent.activeObj.rotatedAngle === 0) ? false : true;\n        return allowOutofBound;\n    };\n    return Selection;\n}());\nexport { Selection };\n","/* eslint-disable no-constant-condition */\nimport { EventHandler, extend, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { ShapeType, RedactType } from '../index';\nvar Shape = /** @class */ (function () {\n    function Shape(parent) {\n        this.textSettings = { text: 'Enter Text', fontFamily: '', fontSize: null, fontRatio: null, bold: false, italic: false, underline: false };\n        this.strokeSettings = { strokeColor: '#fff', fillColor: '', strokeWidth: null, radius: null, outlineColor: '', outlineWidth: null };\n        this.keyHistory = ''; // text history\n        this.preventFrameAnnotation = false;\n        this.redactType = 'blur';\n        this.parent = parent;\n        this.addEventListener();\n    }\n    Shape.prototype.destroy = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.removeEventListener();\n    };\n    Shape.prototype.addEventListener = function () {\n        this.parent.on('shape', this.shape, this);\n        this.parent.on('destroyed', this.destroy, this);\n    };\n    Shape.prototype.removeEventListener = function () {\n        this.parent.off('shape', this.shape);\n        this.parent.off('destroyed', this.destroy);\n    };\n    Shape.prototype.shape = function (args) {\n        var parent = this.parent;\n        this.initShapePvtProps();\n        var uploader;\n        switch (args.prop) {\n            case 'drawEllipse':\n                this.drawEllipse(args.value['x'], args.value['y'], args.value['radiusX'], args.value['radiusY'], args.value['strokeWidth'], args.value['strokeColor'], args.value['fillColor'], args.value['degree'], args.value['isSelected']);\n                break;\n            case 'drawLine':\n                this.drawLine(args.value['startX'], args.value['startY'], args.value['endX'], args.value['endY'], args.value['strokeWidth'], args.value['strokeColor'], args.value['isSelected']);\n                break;\n            case 'drawArrow':\n                this.drawArrow(args.value['startX'], args.value['startY'], args.value['endX'], args.value['endY'], args.value['strokeWidth'], args.value['strokeColor'], args.value['arrowStart'], args.value['arrowEnd'], args.value['isSelected']);\n                break;\n            case 'drawPath':\n                this.drawPath(args.value['pointColl'], args.value['strokeWidth'], args.value['strokeColor'], args.value['isSelected']);\n                break;\n            case 'drawRectangle':\n                this.drawRectangle(args.value['x'], args.value['y'], args.value['width'], args.value['height'], args.value['strokeWidth'], args.value['strokeColor'], args.value['fillColor'], args.value['degree'], args.value['isSelected'], args.value['radius']);\n                break;\n            case 'drawText':\n                this.drawText(args.value['x'], args.value['y'], args.value['text'], args.value['fontFamily'], args.value['fontSize'], args.value['bold'], args.value['italic'], args.value['color'], args.value['isSelected'], args.value['degree'], args.value['fillColor'], args.value['outlineColor'], args.value['outlineWidth']);\n                break;\n            case 'redrawActObj':\n                this.redrawActObj(args.value['x'], args.value['y'], args.value['isMouseDown']);\n                break;\n            case 'apply':\n                this.apply(args.value['shape'], args.value['obj'], args.value['canvas']);\n                break;\n            case 'updateShapeChangeEventArgs':\n                this.updateShapeChangeEventArgs(args.value['shapeSettings'], args.value['allowShapeOverflow']);\n                break;\n            case 'updSelChangeEventArgs':\n                this.updSelChangeEventArgs(args.value['selectionSettings']);\n                break;\n            case 'iterateObjColl':\n                this.iterateObjColl();\n                break;\n            case 'updImgRatioForActObj':\n                this.updImgRatioForActObj();\n                break;\n            case 'redrawObj':\n                this.redrawObj(args.value['degree']);\n                break;\n            case 'redraw-text':\n                this.redrawText();\n                break;\n            case 'draw-shape':\n                this.drawShape(args.value['obj'], args.value['strokeWidth'], args.value['strokeColor'], args.value['fillColor'], args.value['start'], args.value['width'], args.value['height']);\n                break;\n            case 'renderTextArea':\n                this.renderTextArea(args.value['x'], args.value['y'], args.value['actObj']);\n                break;\n            case 'setTextBoxWidth':\n                this.setTextBoxWidth(args.value['e']);\n                break;\n            case 'findTextTarget':\n                this.findTextTarget(args.value['e']);\n                break;\n            case 'updateFontStyles':\n                this.updateFontStyles(args.value['isTextBox']);\n                break;\n            case 'applyFontStyle':\n                this.applyFontStyle(args.value['item']);\n                break;\n            case 'updateFontRatio':\n                this.updateFontRatio(args.value['obj'], args.value['isTextArea']);\n                break;\n            case 'updateFontSize':\n                this.updateFontSize(args.value['obj']);\n                break;\n            case 'pushActItemIntoObj':\n                this.pushActItemIntoObj();\n                break;\n            case 'clearActObj':\n                this.clearActObj();\n                break;\n            case 'refreshActiveObj':\n                this.refreshActiveObj();\n                break;\n            case 'applyActObj':\n                this.applyActObj(args.value['isMouseDown']);\n                break;\n            case 'wireEvent':\n                EventHandler.add(parent.upperCanvas, 'dblclick', this.findTextTarget, this);\n                EventHandler.add(parent.textArea, 'mousedown', this.findTextTarget, this);\n                uploader = document.getElementById(parent.element.id + '_fileUpload');\n                if (uploader) {\n                    EventHandler.add(uploader, 'change', this.fileChanged, this);\n                }\n                break;\n            case 'unWireEvent':\n                EventHandler.remove(parent.upperCanvas, 'dblclick', this.findTextTarget);\n                EventHandler.remove(parent.textArea, 'mousedown', this.findTextTarget);\n                uploader = document.getElementById(parent.element.id + '_fileUpload');\n                if (uploader) {\n                    EventHandler.remove(uploader, 'change', this.fileChanged);\n                }\n                break;\n            case 'getShapeSetting':\n                this.getShapeSetting(args.value['id'], args.value['obj']);\n                break;\n            case 'getShapeSettings':\n                this.getShapeSettings(args.value['obj']);\n                break;\n            case 'getRedactSettings':\n                this.getRedactSettings(args.value['obj']);\n                break;\n            case 'isPointsInRange':\n                this.isPointsInRange(args.value['x'], args.value['y'], args.value['obj']);\n                break;\n            case 'alignRotateFlipColl':\n                this.alignRotateFlipColl(args.value['collection'], args.value['isRotateFlipCollection'], args.value['obj']);\n                break;\n            case 'selectShape':\n                this.selectShape(args.value['id'], args.value['obj']);\n                break;\n            case 'deleteShape':\n                this.deleteShape(args.value['id']);\n                break;\n            case 'getMaxText':\n                this.getMaxText(args.value['isTextBox'], args.value['text'], args.value['obj']);\n                break;\n            case 'setPointCollForLineArrow':\n                args.value['obj'].pointColl = this.getLinePoints(args.value['obj'].activePoint.startX, args.value['obj'].activePoint.startY, args.value['obj'].activePoint.endX, args.value['obj'].activePoint.endY);\n                break;\n            case 'setPointCollForShapeRotation':\n                this.setPointCollForShapeRotation(args.value['obj']);\n                break;\n            case 'setTextSettings':\n                if (args.value['textSettings']) {\n                    this.textSettings = args.value['textSettings'];\n                }\n                else if (args.value['fontFamily']) {\n                    this.textSettings.fontFamily = args.value['fontFamily'];\n                }\n                else if (args.value['fontSize']) {\n                    this.textSettings.fontSize = args.value['fontSize'];\n                }\n                else if (args.value['radius']) {\n                    this.strokeSettings.radius = args.value['radius'];\n                }\n                break;\n            case 'setStrokeSettings':\n                if (args.value['strokeSettings']) {\n                    this.strokeSettings = args.value['strokeSettings'];\n                }\n                else if (args.value['strokeColor']) {\n                    this.strokeSettings.strokeColor = args.value['strokeColor'];\n                }\n                else if (args.value['fillColor']) {\n                    this.strokeSettings.fillColor = args.value['fillColor'];\n                }\n                else if (args.value['strokeWidth']) {\n                    this.strokeSettings.strokeWidth = args.value['strokeWidth'];\n                }\n                else if (args.value['outlineColor']) {\n                    this.strokeSettings.outlineColor = args.value['outlineColor'];\n                }\n                else if (args.value['radius']) {\n                    this.strokeSettings.radius = args.value['radius'];\n                }\n                else if (args.value['outlineWidth']) {\n                    this.strokeSettings.outlineWidth = args.value['outlineWidth'];\n                }\n                break;\n            case 'getStrokeSettings':\n                args.value['obj']['strokeSettings'] = this.strokeSettings;\n                break;\n            case 'setKeyHistory':\n                this.keyHistory = args.value['keyHistory'];\n                break;\n            case 'getKeyHistory':\n                args.value['obj']['keyHistory'] = this.keyHistory;\n                break;\n            case 'setTextBoxPos':\n                this.setTextBoxPos(args.value['actObj'], args.value['degree'], args.value['flip'], args.value['x'], args.value['y']);\n                break;\n            case 'setTextBoxPoints':\n                this.setTextBoxPoints(args.value['actObj'], args.value['degree'], args.value['flip'], args.value['x'], args.value['y']);\n                break;\n            case 'alignTextAreaIntoCanvas':\n                this.alignTextAreaIntoCanvas();\n                break;\n            case 'initializeTextShape':\n                this.initializeTextShape(args.value['text'], args.value['fontFamily'], args.value['fontSize'], args.value['bold'], args.value['italic'], args.value['strokeColor'], args.value['fillColor'], args.value['outlineColor'], args.value['outlineWidth']);\n                break;\n            case 'stopPathDrawing':\n                this.stopPathDrawing(args.value['e'], args.value['isApply']);\n                break;\n            case 'updateArrowRatio':\n                this.updateArrowRatio(args.value['obj']);\n                break;\n            case 'getSquarePointForRotatedShape':\n                this.getSquarePointForRotatedShape(args.value['obj'], args.value['object']);\n                break;\n            case 'drawImage':\n                this.drawImage(args.value['x'], args.value['y'], args.value['width'], args.value['height'], args.value['src'], args.value['degree'], args.value['isAspectRatio'], args.value['opacity'], args.value['isSelected']);\n                break;\n            case 'reset':\n                this.reset();\n                break;\n            case 'updateObj':\n                this.updateObj(args.value['dimObj'], args.value['x'], args.value['y']);\n                break;\n            case 'straightenShapes':\n                this.straightenShapes();\n                break;\n            case 'straightenShapePoints':\n                this.straightenShapePoints(args.value['obj'], args.value['isReverse']);\n                break;\n            case 'straightenPath':\n                this.straightenPath(args.value['obj']);\n                break;\n            case 'straightenFHD':\n                this.straightenFHD();\n                break;\n            case 'getTextBoxPosition':\n                this.getTextBoxPosition(args.value['obj'], args.value['object']);\n                break;\n            case 'setFlipState':\n                this.setFlipState(args.value['x'], args.value['y'], args.value['obj'], args.value['object']);\n                break;\n            case 'getNewShapeId':\n                args.value['obj']['id'] = this.getNewShapeId();\n                break;\n            case 'z-order':\n                this.updateZOrder(args.value['obj'], args.value['value']);\n                break;\n            case 'getSmallestIndex':\n                args.value['obj']['index'] = this.getSmallestIndex();\n                break;\n            case 'isIndexInObjColl':\n                args.value['obj']['bool'] = this.isIndexInObjColl(args.value['index']);\n                break;\n            case 'drawAnnotations':\n                this.drawAnnotations(args.value['ctx'], args.value['shape'], args.value['pen'], args.value['isPreventApply'], args.value['x'], args.value['y'], args.value['panRegion']);\n                break;\n            case 'updateShapeColl':\n                this.updateShapeColl();\n                break;\n            case 'getNewOrder':\n                args.value['obj']['order'] = this.getNewOrder();\n                break;\n            case 'getHighestOrder':\n                args.value['obj']['order'] = this.getHighestOrder();\n                break;\n            case 'getLowestOrder':\n                args.value['obj']['order'] = this.getLowestOrder();\n                break;\n            case 'drawRedact':\n                this.drawRedact(args.value['x'], args.value['y'], args.value['width'], args.value['height'], args.value['type'], args.value['value']);\n                break;\n            case 'setRedactType':\n                this.redactType = args.value['redactType'];\n                break;\n        }\n    };\n    Shape.prototype.getModuleName = function () {\n        return 'shape';\n    };\n    Shape.prototype.initShapePvtProps = function () {\n        var parent = this.parent;\n        if (parent.lowerCanvas) {\n            this.lowerContext = parent.lowerCanvas.getContext('2d');\n        }\n        if (parent.upperCanvas) {\n            this.upperContext = parent.upperCanvas.getContext('2d');\n        }\n        if (isNullOrUndefined(this.shapeImg)) {\n            this.shapeImg = parent.createElement('img', {\n                id: parent.element.id + '_shapeImg', attrs: { name: 'Image', crossorigin: 'anonymous' }\n            });\n        }\n        if (this.textSettings.fontFamily === '') {\n            this.textSettings.fontFamily = parent.fontFamily.default;\n        }\n    };\n    Shape.prototype.reset = function () {\n        this.textSettings =\n            { text: 'Enter Text', fontFamily: this.parent.fontFamily.default, fontSize: null, fontRatio: null, bold: false, italic: false, underline: false };\n        this.strokeSettings = { strokeColor: '#fff', fillColor: '', strokeWidth: null, radius: null, outlineColor: '', outlineWidth: null };\n        this.preventFrameAnnotation = false;\n    };\n    Shape.prototype.drawEllipse = function (x, y, radiusX, radiusY, strokeWidth, strokeColor, fillColor, degree, isSelected) {\n        this.initializeShape('ellipse');\n        var start = x && y ? { x: x, y: y } : null;\n        this.drawShape('ellipse', strokeWidth, strokeColor, fillColor, start, radiusX, radiusY, null, null, null, degree, null, isSelected);\n    };\n    Shape.prototype.drawLine = function (startX, startY, endX, endY, strokeWidth, strokeColor, isSelected) {\n        this.initializeShape('line');\n        var start = startX && startY ? { x: startX, y: startY } : null;\n        var width = endX - startX;\n        var height = endY - startY;\n        this.drawShape('line', strokeWidth, strokeColor, null, start, width, height, null, null, null, null, null, isSelected);\n    };\n    Shape.prototype.drawPath = function (pointColl, strokeWidth, strokeColor, isSelected) {\n        this.initializeShape('path');\n        if (pointColl) {\n            this.drawShape('path', strokeWidth, strokeColor, null, null, null, null, pointColl, null, null, null, null, isSelected);\n        }\n    };\n    Shape.prototype.drawArrow = function (startX, startY, endX, endY, strokeWidth, strokeColor, arrowStart, arrowEnd, isSelected) {\n        this.initializeShape('arrow');\n        var start = startX && startY ? { x: startX, y: startY } : null;\n        var width = endX - startX;\n        var height = endY - startY;\n        this.drawShape('arrow', strokeWidth, strokeColor, null, start, width, height, null, arrowStart, arrowEnd, null, null, isSelected);\n    };\n    Shape.prototype.drawRectangle = function (x, y, width, height, strokeWidth, strokeColor, fillColor, degree, isSelected, radius) {\n        this.initializeShape('rectangle');\n        var start = x && y ? { x: x, y: y } : null;\n        this.drawShape('rectangle', strokeWidth, strokeColor, fillColor, start, width, height, null, null, null, degree, null, isSelected, radius);\n    };\n    // eslint-disable-next-line @typescript-eslint/tslint/config\n    Shape.prototype.drawRedact = function (x, y, width, height, type, value) {\n        this.initializeShape('redact');\n        var start = x && y ? { x: x, y: y } : null;\n        this.drawShape('redact', null, null, null, start, width, height, null, null, null, null, null, null, null, type, value);\n    };\n    Shape.prototype.drawText = function (x, y, text, fontFamily, fontSize, bold, italic, color, isSelected, degree, fillColor, outlineColor, outlineWidth) {\n        this.drawShapeText(text, fontFamily, fontSize, bold, italic, color, x, y, isSelected, degree, fillColor, outlineColor, outlineWidth);\n    };\n    Shape.prototype.initializeShape = function (type) {\n        var parent = this.parent;\n        this.redrawActObj();\n        parent.activeObj.shape = type;\n        parent.currObjType.isCustomCrop = false;\n    };\n    Shape.prototype.updateWidthHeight = function (obj) {\n        obj.activePoint.width = obj.activePoint.endX - obj.activePoint.startX;\n        obj.activePoint.height = obj.activePoint.endY - obj.activePoint.startY;\n        return obj;\n    };\n    Shape.prototype.setDimension = function (width, height) {\n        var parent = this.parent;\n        var shape = parent.activeObj.shape;\n        if ((width && height) || ((shape === 'line' || shape === 'arrow') && (width || height))) {\n            parent.activeObj.activePoint.width = width;\n            parent.activeObj.activePoint.height = height;\n            if (parent.currObjType.shape.toLowerCase() === 'ellipse') {\n                parent.activeObj.activePoint.width = 2 * width;\n                parent.activeObj.activePoint.height = 2 * height;\n            }\n        }\n    };\n    Shape.prototype.getArrowType = function (type) {\n        var arrowType = type;\n        if (type) {\n            var typeToArrowType = { 'None': 'none', 'Arrow': 'arrow', 'SolidArrow': 'arrowSolid',\n                'Circle': 'circle', 'SolidCircle': 'circleSolid', 'Square': 'square', 'SolidSquare': 'squareSolid', 'Bar': 'bar' };\n            arrowType = typeToArrowType[\"\" + type];\n        }\n        return arrowType;\n    };\n    Shape.prototype.drawShape = function (type, strokeWidth, strokeColor, fillColor, start, width, height, pointColl, arrowStart, arrowEnd, degree, opacity, isSelected, radius, redactType, value) {\n        var parent = this.parent;\n        if (!parent.disabled && parent.isImageLoaded) {\n            parent.notify('draw', { prop: 'setImageEdited', onPropertyChange: false });\n            this.redrawActObj();\n            var objColl = extend([], parent.objColl, [], true);\n            parent.togglePen = false;\n            this.keyHistory = '';\n            parent.upperCanvas.style.display = 'block';\n            this.refreshActiveObj();\n            parent.currObjType.shape = type = type.toLowerCase();\n            if (type !== 'freehanddraw' && type !== '') {\n                parent.activeObj.shape = type;\n                var strokeSettings = parent.activeObj.strokeSettings;\n                this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                if (isNullOrUndefined(strokeSettings)) {\n                    strokeSettings = this.strokeSettings;\n                }\n                if (type === 'path' && pointColl) {\n                    parent.activeObj.pointColl = pointColl;\n                }\n                if (opacity !== null && opacity !== undefined) {\n                    parent.activeObj.opacity = opacity;\n                }\n                strokeSettings.strokeWidth = strokeWidth ? strokeWidth : strokeSettings.strokeWidth;\n                var shape = parent.activeObj.shape;\n                if ((shape === 'rectangle' || shape === 'ellipse') && strokeWidth === 0) {\n                    strokeSettings.strokeWidth = 0;\n                }\n                strokeSettings.strokeColor = strokeColor ? strokeColor : strokeSettings.strokeColor;\n                strokeSettings.fillColor = fillColor || fillColor === '' ? fillColor : strokeSettings.fillColor;\n                strokeSettings.radius = radius ? radius : strokeSettings.radius;\n                var tempWidth = parent.img.destWidth > 100 ? 100 : parent.img.destWidth / 2;\n                var tempHeight = parent.img.destHeight > 100 ? 100 : parent.img.destHeight / 2;\n                parent.activeObj.activePoint.width = tempWidth;\n                parent.activeObj.activePoint.height = tempHeight;\n                if (type === 'line' || type === 'arrow') {\n                    parent.activeObj.lineDraw = 'horizontal';\n                    parent.activeObj.activePoint.height = 0;\n                    if (type === 'arrow') {\n                        parent.activeObj.activePoint.width += 50;\n                        parent.activeObj.start = this.getArrowType(arrowStart);\n                        parent.activeObj.end = this.getArrowType(arrowEnd);\n                    }\n                }\n                else if (type === 'rectangle') {\n                    parent.activeObj.activePoint.width += parent.activeObj.activePoint.width / 2;\n                }\n                else if (type === 'redact') {\n                    if (redactType) {\n                        parent.activeObj.redactType = redactType.toLowerCase();\n                        if (redactType === RedactType.Blur) {\n                            if (value) {\n                                parent.activeObj.redactBlur = value;\n                            }\n                        }\n                        else {\n                            if (value) {\n                                parent.activeObj.redactPixelate = value;\n                            }\n                        }\n                        parent.activeObj.redactImage = parent.createElement('canvas');\n                    }\n                }\n                this.setDimension(width, height);\n                if (start) {\n                    parent.activeObj.activePoint.startX = start.x;\n                    parent.activeObj.activePoint.startY = start.y;\n                    parent.activeObj.activePoint.endX = parent.activeObj.activePoint.startX +\n                        parent.activeObj.activePoint.width;\n                    parent.activeObj.activePoint.endY = parent.activeObj.activePoint.startY +\n                        parent.activeObj.activePoint.height;\n                }\n                else {\n                    this.setCenterPoints();\n                }\n                this.setPointCollForLineAndArrow();\n                if (type === 'arrow') {\n                    parent.activeObj.triangleDirection = 'right';\n                }\n                parent.currObjType.isDragging = parent.currObjType.isCustomCrop = false;\n                this.initShapeProps();\n                var obj = { shapeSettingsObj: {} };\n                parent.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: obj } });\n                var shapeSettings = obj['shapeSettingsObj'];\n                var shapeChangingArgs = { cancel: false, action: 'insert', previousShapeSettings: shapeSettings,\n                    currentShapeSettings: shapeSettings };\n                parent.trigger('shapeChanging', shapeChangingArgs);\n                parent.editCompleteArgs = shapeChangingArgs;\n                this.updateShapeChangeEventArgs(shapeChangingArgs.currentShapeSettings, shapeChangingArgs.allowShapeOverflow);\n                this.setDimension(width, height);\n                parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate' } });\n                if (degree) {\n                    parent.activeObj.rotatedAngle = degree * (Math.PI / 180);\n                    parent.notify('selection', { prop: 'updPtCollForShpRot', onPropertyChange: false, value: { obj: parent.activeObj } });\n                }\n                parent.notify('toolbar', { prop: 'renderQAT', onPropertyChange: false, value: { isPenEdit: null } });\n                parent.notify('selection', { prop: 'isShapeInserted', onPropertyChange: false, value: { bool: true } });\n                parent.notify('undo-redo', { prop: 'updateUrObj', onPropertyChange: false, value: { objColl: objColl } });\n                if (type === 'redact') {\n                    parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'redact',\n                            isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                }\n                else {\n                    parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'shapes',\n                            isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                }\n                parent.notify('toolbar', { prop: 'update-toolbar-items', onPropertyChange: false });\n                if (parent.isPublicMethod && !isSelected) {\n                    parent.notify('undo-redo', { prop: 'updateUndoRedo', value: { operation: 'shapeInsert' }, onPropertyChange: false });\n                }\n                parent.isPublicMethod = false;\n            }\n        }\n    };\n    Shape.prototype.initShapeProps = function () {\n        var parent = this.parent;\n        parent.activeObj.shapeDegree = parent.transform.degree;\n        parent.activeObj.shapeFlip = parent.transform.currFlipState;\n        parent.activeObj.textFlip = parent.transform.currFlipState;\n        parent.activeObj.flipObjColl = [];\n        parent.activeObj.order = this.getNewOrder();\n    };\n    Shape.prototype.setPointCollForLineAndArrow = function () {\n        var parent = this.parent;\n        var shape = parent.activeObj.shape;\n        var _a = parent.activeObj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY;\n        if (shape === 'line' || shape === 'arrow') {\n            parent.activeObj.pointColl = this.getLinePoints(startX, startY, endX, endY);\n            if (parent.activeObj.pointColl) {\n                for (var i = 0, len = parent.activeObj.pointColl.length; i < len; i++) {\n                    parent.activeObj.pointColl[i].ratioX = (parent.activeObj.pointColl[i].x -\n                        parent.img.destLeft) / parent.img.destWidth;\n                    parent.activeObj.pointColl[i].ratioY = (parent.activeObj.pointColl[i].y -\n                        parent.img.destTop) / parent.img.destHeight;\n                }\n            }\n        }\n    };\n    Shape.prototype.prevObjColl = function () {\n        var parent = this.parent;\n        var object = { currObj: {} };\n        parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        this.prevObj = object['currObj'];\n        this.prevObj.objColl = extend([], parent.objColl, [], true);\n        this.prevObj.pointColl = extend([], parent.pointColl, [], true);\n        this.prevObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: selPointCollObj } });\n        this.prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n    };\n    Shape.prototype.drawShapeText = function (text, fontFamily, fontSize, bold, italic, strokeColor, x, y, isSelected, degree, fillColor, outlineColor, outlineWidth) {\n        var parent = this.parent;\n        if (!parent.disabled && parent.isImageLoaded) {\n            if (parent.currObjType.shape === 'freehanddraw') {\n                this.apply();\n                parent.upperCanvas.style.cursor = parent.cursor = 'default';\n                parent.currObjType.shape = '';\n            }\n            parent.notify('draw', { prop: 'setImageEdited', onPropertyChange: false });\n            parent.togglePen = false;\n            this.redrawActObj();\n            this.prevObjColl();\n            this.refreshActiveObj();\n            parent.activeObj.shape = parent.currObjType.shape = 'text';\n            parent.currObjType.isCustomCrop = false;\n            this.initializeTextShape(text, fontFamily, fontSize, bold, italic, strokeColor, fillColor, outlineColor, outlineWidth);\n            parent.currObjType.isText = parent.currObjType.isInitialText = true;\n            if (isNullOrUndefined(parent.activeObj.textSettings.fontSize)) {\n                parent.getFontSizes();\n                parent.activeObj.textSettings.fontSize = parseInt(parent.fontSizeColl[(parseInt('3', 10) - 1)].text, 10);\n            }\n            if (parent.img.destWidth < 100) {\n                parent.activeObj.textSettings.fontSize = Math.floor((parent.img.destWidth / 20));\n            }\n            else if (parent.img.destHeight < 100) {\n                parent.activeObj.textSettings.fontSize = Math.floor((parent.img.destHeight / 20));\n            }\n            parent.activeObj.shapeDegree = parent.transform.degree;\n            parent.activeObj.shapeFlip = parent.transform.currFlipState;\n            parent.activeObj.flipObjColl = [];\n            this.updateFontStyles();\n            parent.activeObj.order = this.getNewOrder();\n            var width = this.upperContext.measureText(parent.activeObj.textSettings.text).width +\n                parent.activeObj.textSettings.fontSize * 0.5;\n            var height = parent.activeObj.textSettings.fontSize;\n            if (!isNullOrUndefined(x) && !isNullOrUndefined(y)) {\n                parent.activeObj.activePoint.startX = x;\n                parent.activeObj.activePoint.startY = y;\n                parent.activeObj.activePoint.endX = parent.activeObj.activePoint.startX + width;\n                parent.activeObj.activePoint.endY = parent.activeObj.activePoint.startY + height;\n            }\n            else {\n                this.setCenterPoints(true, width, height);\n            }\n            var obj = { shapeSettingsObj: {} };\n            parent.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: obj } });\n            var shapeSettings = obj['shapeSettingsObj'];\n            var shapeChangingArgs = { cancel: false, action: 'insert', previousShapeSettings: shapeSettings,\n                currentShapeSettings: shapeSettings };\n            parent.trigger('shapeChanging', shapeChangingArgs);\n            parent.editCompleteArgs = shapeChangingArgs;\n            this.drawShapeTextEvent(shapeChangingArgs);\n            if (degree) {\n                parent.activeObj.rotatedAngle = degree * (Math.PI / 180);\n                parent.notify('selection', { prop: 'updPtCollForShpRot', onPropertyChange: false, value: { obj: parent.activeObj } });\n                this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: parent.activeObj, isCropRatio: null,\n                        points: null, isPreventDrag: true, saveContext: null, isPreventSelection: null } });\n                parent.notify('toolbar', { prop: 'destroy-qa-toolbar', onPropertyChange: false });\n                parent.notify('toolbar', { prop: 'renderQAT', onPropertyChange: false, value: { isPenEdit: null } });\n            }\n            if (text && text.indexOf('\\n') > -1 && parent.isPublicMethod) {\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                var fontSizeInd = String(parent.fontSizeColl.findIndex(function (item) { return item.text === String(parent.activeObj.textSettings.fontSize); }) + 1);\n                parent.noPushUndo = true;\n                parent.updateFontSize('5');\n                if (parseInt(fontSizeInd, 10) > 0) {\n                    parent.updateFontSize(fontSizeInd);\n                }\n                parent.noPushUndo = false;\n            }\n            if (parent.isPublicMethod && !isSelected) {\n                parent.notify('undo-redo', { prop: 'updateUndoRedo', value: { operation: 'shapeInsert' }, onPropertyChange: false });\n            }\n            parent.isPublicMethod = false;\n        }\n    };\n    Shape.prototype.drawShapeImageEvent = function (shapeChangingArgs, isSelect) {\n        var parent = this.parent;\n        this.updateShapeChangeEventArgs(shapeChangingArgs.currentShapeSettings, shapeChangingArgs.allowShapeOverflow);\n        parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate' } });\n        parent.objColl.push(parent.activeObj);\n        var prevCropObj = extend({}, parent.cropObj, {}, true);\n        parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n            value: { operation: 'shapeInsert', previousObj: this.prevObj, previousObjColl: this.prevObj.objColl,\n                previousPointColl: this.prevObj.pointColl, previousSelPointColl: this.prevObj.selPointColl, previousCropObj: prevCropObj,\n                previousText: null, currentText: null, previousFilter: null, isCircleCrop: null } });\n        parent.notify('selection', { prop: 'redrawShape', onPropertyChange: false,\n            value: { obj: parent.objColl[parent.objColl.length - 1] } });\n        if (isSelect) {\n            parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'shapes',\n                    isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n            parent.notify('toolbar', { prop: 'update-toolbar-items', onPropertyChange: false });\n            parent.notify('toolbar', { prop: 'renderQAT', onPropertyChange: false, value: { isPenEdit: null } });\n        }\n        else {\n            parent.okBtn(null, true);\n        }\n        parent.notify('selection', { prop: 'isShapeInserted', onPropertyChange: false, value: { bool: true } });\n    };\n    Shape.prototype.drawShapeTextEvent = function (shapeChangingArgs) {\n        var parent = this.parent;\n        this.updateShapeChangeEventArgs(shapeChangingArgs.currentShapeSettings, shapeChangingArgs.allowShapeOverflow);\n        this.addLetter(parent.activeObj.textSettings.text);\n        parent.activeObj.textFlip = parent.transform.currFlipState;\n        this.updateFontRatio(parent.activeObj);\n        parent.objColl.push(parent.activeObj);\n        var prevCropObj = extend({}, parent.cropObj, {}, true);\n        parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n            value: { operation: 'shapeInsert', previousObj: this.prevObj, previousObjColl: this.prevObj.objColl,\n                previousPointColl: this.prevObj.pointColl, previousSelPointColl: this.prevObj.selPointColl,\n                previousCropObj: prevCropObj, previousText: null, currentText: null, previousFilter: null, isCircleCrop: null } });\n        parent.notify('selection', { prop: 'redrawShape', onPropertyChange: false,\n            value: { obj: parent.objColl[parent.objColl.length - 1] } });\n        parent.notify('toolbar', { prop: 'renderQAT', onPropertyChange: false, value: { isPenEdit: null } });\n        parent.notify('selection', { prop: 'isShapeInserted', onPropertyChange: false, value: { bool: true } });\n        parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'text',\n                isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n        parent.notify('toolbar', { prop: 'update-toolbar-items', onPropertyChange: false });\n    };\n    Shape.prototype.initializeTextShape = function (text, fontFamily, fontSize, bold, italic, strokeColor, fillColor, outlineColor, outlineWidth) {\n        var parent = this.parent;\n        this.keyHistory = '';\n        parent.upperCanvas.style.display = 'block';\n        parent.activeObj.strokeSettings.strokeColor = strokeColor || parent.activeObj.strokeSettings.strokeColor;\n        parent.activeObj.strokeSettings.fillColor = fillColor || parent.activeObj.strokeSettings.fillColor;\n        parent.activeObj.textSettings.text = text || parent.activeObj.textSettings.text;\n        parent.activeObj.textSettings.fontFamily = fontFamily || parent.activeObj.textSettings.fontFamily;\n        parent.activeObj.textSettings.fontSize = fontSize || parent.activeObj.textSettings.fontSize;\n        parent.activeObj.textSettings.bold = bold || parent.activeObj.textSettings.bold;\n        parent.activeObj.textSettings.italic = italic || parent.activeObj.textSettings.italic;\n        parent.activeObj.strokeSettings.outlineColor = outlineColor || parent.activeObj.strokeSettings.outlineColor;\n        parent.activeObj.strokeSettings.outlineWidth = outlineWidth || parent.activeObj.strokeSettings.outlineWidth;\n    };\n    Shape.prototype.drawImage = function (x, y, width, height, src, degree, isAspectRatio, opacity, isSelected) {\n        this.initializeShape('image');\n        this.onLoadImgShape(x, y, width, height, src, null, degree, isAspectRatio, opacity, isSelected);\n    };\n    Shape.prototype.redrawActObj = function (x, y, isMouseDown) {\n        var splitWords;\n        var parent = this.parent;\n        if (parent.activeObj.shape) {\n            splitWords = parent.activeObj.shape.split('-');\n        }\n        if (parent.activeObj.horTopLine && (parent.activeObj.shape && splitWords[0] !== 'crop')) {\n            if (parent.textArea.style.display === 'block' || parent.textArea.style.display === 'inline-block') {\n                parent.notify('selection', { prop: 'setTextBoxStylesToActObj', onPropertyChange: false });\n                this.updateFontRatio(parent.activeObj, true);\n                if (x && y) {\n                    if ((x !== parent.activeObj.activePoint.startX) && (y !== parent.activeObj.activePoint.startY)) {\n                        this.updateTextFromTextArea();\n                    }\n                }\n                else {\n                    this.updateTextFromTextArea();\n                    parent.textArea.style.transform = '';\n                    parent.notify('toolbar', { prop: 'refresh-main-toolbar', onPropertyChange: false });\n                }\n                this.refreshActiveObj();\n            }\n            else {\n                this.applyActObj(isMouseDown);\n            }\n        }\n    };\n    Shape.prototype.apply = function (shape, obj, canvas) {\n        var parent = this.parent;\n        if (!parent.disabled) {\n            if (parent.togglePen && !parent.currObjType.isCustomCrop) {\n                var destLeft = parent.img.destLeft;\n                var destTop = parent.img.destTop;\n                var destWidth = parent.img.destWidth;\n                var destHeight = parent.img.destHeight;\n                parent.notify('draw', { prop: 'callUpdateCurrTransState', onPropertyChange: false });\n                var temp = this.lowerContext.filter;\n                this.lowerContext.filter = 'none';\n                parent.togglePen = false;\n                if (parent.isCircleCrop || (parent.currSelectionPoint &&\n                    parent.currSelectionPoint.shape === 'crop-circle')) {\n                    parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                        value: { context: this.lowerContext, isSave: null, isFlip: null } });\n                }\n                parent.img.destLeft = destLeft;\n                parent.img.destTop = destTop;\n                parent.img.destWidth = destWidth;\n                parent.img.destHeight = destHeight;\n                this.lowerContext.filter = temp;\n            }\n            else {\n                canvas = canvas ? canvas : 'original';\n                if (isNullOrUndefined(parent.activeObj.shape) && isNullOrUndefined(shape)) {\n                    parent.currObjType.shape = '';\n                }\n                else {\n                    parent.currObjType.shape = shape || parent.currObjType.shape;\n                }\n                if (parent.currObjType.shape !== '') {\n                    this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                    if (parent.activeObj.shape === 'text') {\n                        parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: canvas, obj: obj, isCropRatio: null,\n                                points: null, isPreventDrag: true, saveContext: null, isPreventSelection: null } });\n                    }\n                    else {\n                        parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: canvas, obj: obj } });\n                    }\n                    parent.activeObj.shape = parent.currObjType.shape.toLowerCase();\n                    if (!shape && parent.currObjType.shape !== '' && !parent.currObjType.isCustomCrop) {\n                        parent.objColl.push(extend({}, parent.activeObj, {}, true));\n                    }\n                    this.keyHistory = '';\n                }\n            }\n        }\n    };\n    Shape.prototype.setCenterPoints = function (text, width, height) {\n        var parent = this.parent;\n        var renderWidth;\n        var renderHeight;\n        if (text && width && height) {\n            renderWidth = width;\n            renderHeight = height;\n        }\n        else {\n            renderWidth = parent.activeObj.activePoint.width;\n            renderHeight = parent.activeObj.activePoint.height;\n        }\n        parent.activeObj.activePoint.startX = (parent.lowerCanvas.width / 2) - renderWidth / 2;\n        parent.activeObj.activePoint.startY = (parent.lowerCanvas.height / 2) - renderHeight / 2;\n        parent.activeObj.activePoint.endX = (parent.lowerCanvas.width / 2) + renderWidth / 2;\n        parent.activeObj.activePoint.endY = (parent.lowerCanvas.height / 2) + renderHeight / 2;\n    };\n    Shape.prototype.updSelChangeEventArgs = function (selectionSettings) {\n        var parent = this.parent;\n        parent.activeObj.activePoint = { startX: selectionSettings.startX, startY: selectionSettings.startY,\n            endX: parent.activeObj.activePoint.startX + parent.activeObj.activePoint.width,\n            endY: parent.activeObj.activePoint.startY + parent.activeObj.activePoint.height,\n            width: selectionSettings.width, height: selectionSettings.height };\n        parent.activeObj.activePoint.endX = parent.activeObj.activePoint.startX + parent.activeObj.activePoint.width;\n        parent.activeObj.activePoint.endY = parent.activeObj.activePoint.startY + parent.activeObj.activePoint.height;\n    };\n    Shape.prototype.updateShapeChangeEventArgs = function (shapeSettings, allowShapeOverflow) {\n        var parent = this.parent;\n        var shapeId;\n        if (shapeSettings.id && shapeSettings.id.indexOf('shape_') === -1 &&\n            shapeSettings.id.indexOf('pen_') === -1) {\n            if (parent.activeObj.currIndex) {\n                parent.activeObj.currIndex = 'shape_' + shapeSettings.id;\n            }\n            else {\n                parent.pointColl[shapeId].id = 'pen_' + shapeSettings.id;\n            }\n        }\n        if (shapeSettings.id && shapeSettings.id.split('_')[0] && shapeSettings.id.split('_')[0] === 'pen') {\n            shapeId = parseInt(shapeSettings.id.split('_')[1], 10) - 1;\n            parent.pointColl[shapeId].points = shapeSettings.points;\n            parent.pointColl[shapeId].strokeColor = shapeSettings.strokeColor;\n            parent.pointColl[shapeId].strokeWidth = shapeSettings.strokeWidth;\n            parent.pointColl[shapeId].opacity = shapeSettings.opacity;\n            parent.pointColl[shapeId].order = shapeSettings.index;\n        }\n        else {\n            parent.activeObj.activePoint.startX = shapeSettings.startX;\n            parent.activeObj.activePoint.startY = shapeSettings.startY;\n            if (shapeSettings.width && shapeSettings.height) {\n                parent.activeObj.activePoint.width = shapeSettings.width;\n                parent.activeObj.activePoint.height = shapeSettings.height;\n                parent.activeObj.activePoint.endX = parent.activeObj.activePoint.startX + parent.activeObj.activePoint.width;\n                parent.activeObj.activePoint.endY = parent.activeObj.activePoint.startY + parent.activeObj.activePoint.height;\n            }\n            parent.activeObj.strokeSettings.strokeColor = shapeSettings.strokeColor;\n            parent.activeObj.strokeSettings.fillColor = shapeSettings.fillColor;\n            parent.activeObj.strokeSettings.strokeWidth = shapeSettings.strokeWidth;\n            parent.activeObj.opacity = shapeSettings.opacity;\n            parent.activeObj.order = shapeSettings.index;\n            parent.activeObj.preventShapeDragOut = !allowShapeOverflow;\n            if (isNullOrUndefined(shapeSettings.degree)) {\n                shapeSettings.degree = 0;\n            }\n            switch (parent.activeObj.shape) {\n                case 'ellipse':\n                    parent.activeObj.activePoint.width = shapeSettings.radiusX * 2;\n                    parent.activeObj.activePoint.height = shapeSettings.radiusY * 2;\n                    parent.activeObj.activePoint.endX = parent.activeObj.activePoint.startX + parent.activeObj.activePoint.width;\n                    parent.activeObj.activePoint.endY = parent.activeObj.activePoint.startY + parent.activeObj.activePoint.height;\n                    if (shapeSettings.degree) {\n                        parent.activeObj.rotatedAngle = shapeSettings.degree * (Math.PI / 180);\n                    }\n                    break;\n                case 'line':\n                case 'arrow':\n                    parent.activeObj.activePoint.width = shapeSettings.length;\n                    parent.activeObj.activePoint.endX = shapeSettings.endX;\n                    parent.activeObj.activePoint.endY = shapeSettings.endY;\n                    parent.activeObj.activePoint.width = parent.activeObj.activePoint.startX + parent.activeObj.activePoint.width;\n                    parent.activeObj.activePoint.height = parent.activeObj.activePoint.startY + parent.activeObj.activePoint.height;\n                    if (parent.activeObj.shape === 'arrow') {\n                        parent.activeObj.start = this.getArrowType(shapeSettings.arrowHead);\n                        parent.activeObj.end = this.getArrowType(shapeSettings.arrowTail);\n                    }\n                    break;\n                case 'text':\n                    parent.activeObj.keyHistory = parent.activeObj.textSettings.text = shapeSettings.text;\n                    parent.activeObj.textSettings.fontSize = shapeSettings.fontSize;\n                    parent.activeObj.strokeSettings.strokeColor = shapeSettings.color;\n                    parent.activeObj.textSettings.fontFamily = shapeSettings.fontFamily;\n                    if (shapeSettings.degree) {\n                        parent.activeObj.rotatedAngle = shapeSettings.degree * (Math.PI / 180);\n                    }\n                    this.updateFontRatio(parent.activeObj);\n                    break;\n                case 'rectangle':\n                case 'image':\n                    if (shapeSettings.degree) {\n                        parent.activeObj.rotatedAngle = shapeSettings.degree * (Math.PI / 180);\n                    }\n                    // Prevented setting image src as it cannot be set in canvas\n                    break;\n                case 'path':\n                    parent.activeObj.pointColl = shapeSettings.points;\n                    break;\n            }\n            if (parent.activeObj.shape === 'text' && parent.activeObj.textSettings) {\n                parent.activeObj.textSettings.bold = false;\n                parent.activeObj.textSettings.italic = false;\n                parent.activeObj.textSettings.underline = false;\n                for (var i = 0; i < shapeSettings.fontStyle.length; i++) {\n                    switch (shapeSettings.fontStyle[i]) {\n                        case 'bold':\n                            parent.activeObj.textSettings.bold = true;\n                            break;\n                        case 'italic':\n                            parent.activeObj.textSettings.italic = true;\n                            break;\n                    }\n                }\n            }\n        }\n    };\n    Shape.prototype.addLetter = function (letter) {\n        var parent = this.parent;\n        if (parent.textArea.style.display === 'none' && (parent.currObjType.isText || parent.activeObj.shape === 'text')) {\n            var fontSize = parent.activeObj.textSettings.fontSize;\n            if (letter === 'Backspace') {\n                this.keyHistory = this.keyHistory.slice(0, -1);\n            }\n            else {\n                this.keyHistory += letter;\n            }\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            this.updateFontStyles();\n            var width = this.upperContext.measureText(this.keyHistory).width + fontSize * 0.5;\n            var height = fontSize;\n            this.upperContext.fillText(this.keyHistory, parent.activeObj.activePoint.startX, parent.activeObj.activePoint.startY + fontSize);\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            parent.currObjType.isText = true;\n            parent.notify('selection', { prop: 'setActivePoint', onPropertyChange: false,\n                value: { startX: width, startY: height } });\n        }\n    };\n    Shape.prototype.redrawText = function () {\n        var parent = this.parent;\n        var _a = parent.activeObj.textSettings, fontSize = _a.fontSize, fontFamily = _a.fontFamily, bold = _a.bold, italic = _a.italic;\n        var fontStyle = '';\n        if (bold) {\n            fontStyle += 'bold ';\n        }\n        if (italic) {\n            fontStyle += 'italic ';\n        }\n        this.upperContext.font = fontStyle + fontSize + 'px ' + fontFamily;\n        var rows = parent.activeObj.keyHistory.split('\\n');\n        var text = (parent.textArea.style.display === 'block' || parent.textArea.style.display === 'inline-block') ?\n            this.getMaxText(true) : this.getMaxText();\n        var width = this.upperContext.measureText(text).width + fontSize * 0.5;\n        var height = rows.length * fontSize;\n        if (rows.length > 1) {\n            height += (fontSize * 0.50);\n        }\n        parent.notify('selection', { prop: 'setTextSelection', onPropertyChange: false,\n            value: { width: width, height: height } });\n        parent.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: parent.activeObj.activePoint, obj: parent.activeObj,\n                isMouseMove: null, x: null, y: null } });\n        parent.notify('selection', { prop: 'redrawShape', onPropertyChange: false,\n            value: { obj: parent.activeObj } });\n    };\n    Shape.prototype.updateTextFromTextArea = function () {\n        var parent = this.parent;\n        var allowUndoRedo = false;\n        var fontSize = parent.activeObj.textSettings.fontSize;\n        var tempActiveObj = extend({}, parent.activeObj, {}, true);\n        var prevCropObj = extend({}, parent.cropObj, {}, true);\n        var object = { currObj: {} };\n        parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        var prevObj = object['currObj'];\n        prevObj.objColl = extend([], parent.objColl, [], true);\n        prevObj.pointColl = extend([], parent.pointColl, [], true);\n        prevObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: selPointCollObj } });\n        prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        if (parent.activeObj.keyHistory !== parent.textArea.value) {\n            allowUndoRedo = true;\n        }\n        parent.activeObj.keyHistory = parent.textArea.value;\n        parent.textArea.style.display = 'none';\n        parent.textArea.value = '';\n        this.updateFontStyles();\n        var width = this.upperContext.measureText(parent.activeObj.keyHistory).width + fontSize * 0.5;\n        var height = fontSize;\n        var rows = parent.activeObj.keyHistory.split('\\n');\n        if (rows.length > 1) {\n            height *= rows.length;\n            height += (fontSize * 0.1 * rows.length);\n            var widthColl = [];\n            for (var i = 0, len = rows.length; i < len; i++) {\n                widthColl.push(this.upperContext.measureText(rows[i]).width + fontSize * 0.5);\n            }\n            width = Math.max.apply(Math, widthColl);\n        }\n        parent.notify('selection', { prop: 'setTextSelection', onPropertyChange: false,\n            value: { width: width, height: height } });\n        if (parent.activeObj.rotatedAngle !== 0) {\n            var width_1 = parent.activeObj.activePoint.width - tempActiveObj.activePoint.width;\n            var height_1 = parent.activeObj.activePoint.height - tempActiveObj.activePoint.height;\n            var value = '';\n            if (width_1 > 0 && height_1 > 0) {\n                value = 'widthHeight';\n            }\n            else if (width_1 !== 0) {\n                value = 'width';\n            }\n            else if (height_1 !== 0) {\n                value = 'height';\n            }\n            parent.activeObj.activePoint = extend({}, tempActiveObj.activePoint, {}, true);\n            parent.notify('selection', { prop: 'adjustRotationPoints', onPropertyChange: false, value: { rectangle: parent.activeObj.activePoint,\n                    x: width_1, y: height_1, angle: parent.activeObj.rotatedAngle, type: 'text', elem: value } });\n            parent.notify('shape', { prop: 'updateFontSize', onPropertyChange: false,\n                value: { obj: parent.activeObj } });\n        }\n        parent.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: parent.activeObj.activePoint, obj: parent.activeObj,\n                isMouseMove: null, x: null, y: null } });\n        this.updImgRatioForActObj();\n        if (parent.activeObj.rotatedAngle !== 0) {\n            parent.notify('selection', { prop: 'updPtCollForShpRot', onPropertyChange: false, value: { obj: parent.activeObj } });\n        }\n        if (allowUndoRedo) {\n            this.apply(parent.activeObj.shape, parent.activeObj);\n            parent.objColl.push(extend({}, parent.activeObj, {}, true));\n            parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                value: { operation: 'text', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                    previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                    previousCropObj: prevCropObj, previousText: parent.activeObj.keyHistory,\n                    currentText: parent.textArea.value, previousFilter: null, isCircleCrop: null } });\n        }\n        else {\n            this.apply(parent.activeObj.shape, parent.activeObj);\n            parent.objColl.push(extend({}, parent.activeObj, {}, true));\n        }\n    };\n    Shape.prototype.iterateObjColl = function () {\n        var parent = this.parent;\n        if (parent.objColl.length > 0) {\n            var index = this.getSmallestIndex();\n            var objColl = extend([], parent.objColl, [], true);\n            while (objColl.length > 0) {\n                var found = false;\n                for (var i = 0; i < objColl.length; i++) {\n                    var currentObj = objColl[i];\n                    if (isNullOrUndefined(currentObj.order)) {\n                        objColl.splice(i, 1);\n                        i--;\n                        continue;\n                    }\n                    if (currentObj.order === index) {\n                        this.apply(currentObj.shape, currentObj);\n                        if (currentObj.shape === 'redact' && JSON.stringify(currentObj.activePoint) === JSON.stringify(parent.activeObj.activePoint) &&\n                            currentObj.redactImage !== parent.activeObj.redactImage) {\n                            currentObj.redactImage = parent.activeObj.redactImage;\n                            if (parent.objColl[i] && JSON.stringify(parent.objColl[i].activePoint) ===\n                                JSON.stringify(currentObj.activePoint)) {\n                                parent.objColl[i].redactImage = parent.activeObj.redactImage;\n                            }\n                        }\n                        this.refreshActiveObj();\n                        index++;\n                        if (!this.isIndexInObjColl(index)) {\n                            index++;\n                        }\n                        objColl.splice(i, 1);\n                        found = true;\n                        break; // Exit the loop to start from the beginning\n                    }\n                }\n                if (!found) {\n                    break; // If no matching order was found, exit the loop\n                }\n            }\n        }\n    };\n    Shape.prototype.getSmallestIndex = function () {\n        var parent = this.parent;\n        var smallestIndex;\n        for (var i = 0, len = parent.objColl.length; i < len; i++) {\n            var currentObj = parent.objColl[i];\n            if (isNullOrUndefined(currentObj.order)) {\n                continue;\n            }\n            if (isNullOrUndefined(smallestIndex) || currentObj.order < smallestIndex) {\n                smallestIndex = currentObj.order;\n            }\n        }\n        return smallestIndex;\n    };\n    Shape.prototype.isIndexInObjColl = function (index) {\n        var parent = this.parent;\n        for (var i = 0, len = parent.objColl.length; i < len; i++) {\n            var currentObj = parent.objColl[i];\n            if (isNullOrUndefined(currentObj.order)) {\n                continue;\n            }\n            if (currentObj.order === index) {\n                return true;\n            }\n        }\n        return false;\n    };\n    Shape.prototype.updImgRatioForActObj = function () {\n        var parent = this.parent;\n        var destPoints = { startX: parent.img.destLeft, startY: parent.img.destTop,\n            width: parent.img.destWidth, height: parent.img.destHeight };\n        this.straightenShapes();\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        var activePoint = parent.activeObj.activePoint;\n        parent.activeObj.imageRatio = { startX: ((activePoint.startX - destLeft) /\n                destWidth), startY: ((activePoint.startY - destTop) / destHeight),\n            endX: ((activePoint.endX - destLeft) / destWidth),\n            endY: ((activePoint.endY - destTop) / destHeight),\n            width: destWidth / activePoint.width, height: destHeight / activePoint.height };\n        if (parent.activeObj.rotationCirclePointColl) {\n            parent.activeObj.rotationCirclePointColl.ratioX = (parent.activeObj.rotationCirclePointColl.x -\n                destLeft) / destWidth;\n            parent.activeObj.rotationCirclePointColl.ratioY = (parent.activeObj.rotationCirclePointColl.y -\n                destTop) / destHeight;\n        }\n        if (parent.activeObj.shape === 'path') {\n            this.updatePathRatio(parent.activeObj);\n        }\n        else if (parent.activeObj.shape === 'arrow') {\n            this.updateArrowRatio(parent.activeObj);\n        }\n        parent.img.destLeft = destPoints.startX;\n        parent.img.destTop = destPoints.startY;\n        parent.img.destWidth = destPoints.width;\n        parent.img.destHeight = destPoints.height;\n    };\n    Shape.prototype.zoomObjColl = function (preventApply) {\n        var parent = this.parent;\n        var destPoints = { startX: parent.img.destLeft, startY: parent.img.destTop,\n            width: parent.img.destWidth, height: parent.img.destHeight };\n        this.straightenShapes();\n        if (parent.objColl.length > 0) {\n            for (var i = 0, len = parent.objColl.length; i < len; i++) {\n                var currObj = parent.objColl[i];\n                if (currObj.imageRatio) {\n                    currObj.activePoint.startX = (currObj.imageRatio.startX * parent.img.destWidth) + parent.img.destLeft;\n                    currObj.activePoint.startY = (currObj.imageRatio.startY * parent.img.destHeight) + parent.img.destTop;\n                    currObj.activePoint.endX = (currObj.imageRatio.endX * parent.img.destWidth) + parent.img.destLeft;\n                    currObj.activePoint.endY = (currObj.imageRatio.endY * parent.img.destHeight) + parent.img.destTop;\n                }\n                currObj = this.updateWidthHeight(currObj);\n                if (currObj.shape === 'text') {\n                    this.updateFontSize(currObj);\n                }\n                else if (currObj.shape === 'line' || currObj.shape === 'arrow') {\n                    currObj.pointColl = this.getLinePoints(currObj.activePoint.startX, currObj.activePoint.startY, currObj.activePoint.endX, currObj.activePoint.endY);\n                    for (var n = 0, len_1 = currObj.pointColl.length; n < len_1; n++) {\n                        currObj.pointColl[n].ratioX =\n                            (currObj.pointColl[n].x - parent.img.destLeft) / parent.img.destWidth;\n                        currObj.pointColl[n].ratioY =\n                            (currObj.pointColl[n].y - parent.img.destTop) / parent.img.destHeight;\n                    }\n                    if (currObj.shape === 'arrow') {\n                        this.updateArrowSize(currObj);\n                    }\n                    if (parent.transform.straighten !== 0 && (currObj.shape === 'line' || currObj.shape === 'arrow')) {\n                        this.straightenShapePoints(currObj);\n                    }\n                }\n                else if (currObj.shape === 'path') {\n                    for (var l = 0, len_2 = currObj.pointColl.length; l < len_2; l++) {\n                        currObj.pointColl[l].x = (currObj.pointColl[l].ratioX * parent.img.destWidth) +\n                            parent.img.destLeft;\n                        currObj.pointColl[l].y = (currObj.pointColl[l].ratioY * parent.img.destHeight) +\n                            parent.img.destTop;\n                    }\n                    this.updatePathRatio(currObj);\n                    if (parent.transform.straighten !== 0) {\n                        this.straightenPath(currObj);\n                    }\n                }\n                parent.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: currObj.activePoint,\n                        obj: currObj } });\n                if (currObj.shape !== 'line' && currObj.shape !== 'arrow' && currObj.shape !== 'path' && currObj.rotatedAngle !== 0) {\n                    this.setPointCollForShapeRotation(currObj);\n                    currObj.rotationCirclePoint.x =\n                        (currObj.rotationCirclePoint.ratioX * parent.img.destWidth) + parent.img.destLeft;\n                    currObj.rotationCirclePoint.y =\n                        (currObj.rotationCirclePoint.ratioY * parent.img.destHeight) + parent.img.destTop;\n                    if (currObj.rotationCirclePointColl) {\n                        currObj.rotationCirclePointColl.x =\n                            (currObj.rotationCirclePointColl.ratioX * parent.img.destWidth) + parent.img.destLeft;\n                        currObj.rotationCirclePointColl.y =\n                            (currObj.rotationCirclePointColl.ratioY * parent.img.destHeight) + parent.img.destTop;\n                    }\n                }\n            }\n            if (isNullOrUndefined(preventApply)) {\n                var temp = this.lowerContext.filter;\n                this.lowerContext.filter = 'none';\n                this.iterateObjColl();\n                this.lowerContext.filter = temp;\n            }\n        }\n        parent.img.destLeft = destPoints.startX;\n        parent.img.destTop = destPoints.startY;\n        parent.img.destWidth = destPoints.width;\n        parent.img.destHeight = destPoints.height;\n    };\n    Shape.prototype.straightenPath = function (obj) {\n        var point;\n        for (var j = 0, len = obj.pointColl.length; j < len; j++) {\n            point = this.straightenPoints(obj.pointColl[j].x, obj.pointColl[j].y);\n            obj.pointColl[j].x = point.x;\n            obj.pointColl[j].y = point.y;\n        }\n    };\n    Shape.prototype.straightenFHD = function () {\n        var parent = this.parent;\n        for (var i = 0, fLen = parent.freehandCounter; i < fLen; i++) {\n            parent.points = extend([], parent.pointColl[i].points, []);\n            var len = parent.points.length;\n            var point = void 0;\n            for (var l = 0; l < len; l++) {\n                point = this.straightenPoints(parent.points[l].x, parent.points[l].y);\n                parent.points[l].x = point.x;\n                parent.points[l].y = point.y;\n            }\n        }\n        var selPointCollObj = { selPointColl: null };\n        parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false, value: { obj: selPointCollObj } });\n        for (var i = 0, fLen = parent.freehandCounter; i < fLen; i++) {\n            if (selPointCollObj['selPointColl'][i] && selPointCollObj['selPointColl'][i].points) {\n                var len = selPointCollObj['selPointColl'][i].points.length;\n                var point = void 0;\n                for (var l = 0; l < len; l++) {\n                    point = this.straightenPoints(selPointCollObj['selPointColl'][i].points[l].x, selPointCollObj['selPointColl'][i].points[l].y);\n                    selPointCollObj['selPointColl'][i].points[l].x = point.x;\n                    selPointCollObj['selPointColl'][i].points[l].y = point.y;\n                }\n            }\n        }\n        var straightenObj = { straightenPoint: null };\n        parent.notify('freehand-draw', { prop: 'getStraightenPoint', onPropertyChange: false, value: { obj: straightenObj } });\n        if (straightenObj['straightenPoint']['x'] && straightenObj['straightenPoint']['y']) {\n            var obj = { angle: 0 };\n            parent.notify('freehand-draw', { prop: 'getStraightenPointAngle', onPropertyChange: false, value: { obj: obj } });\n            var angle = (((parent.transform.straighten === 360 ? 0 : parent.transform.straighten) - obj['angle']) * (Math.PI / 180));\n            var point = this.straightenPoints(straightenObj['straightenPoint']['x'], straightenObj['straightenPoint']['y'], angle);\n            if (angle === 0) {\n                point.x = straightenObj['straightenPoint']['x'];\n                point.y = straightenObj['straightenPoint']['y'];\n            }\n            parent.notify('freehand-draw', { prop: 'setStraightenPoint', onPropertyChange: false, value: { x: point.x, y: point.y } });\n        }\n    };\n    Shape.prototype.straightenPoints = function (x, y, angle) {\n        var parent = this.parent;\n        var center = { x: parent.img.destLeft + (parent.img.destWidth / 2), y: parent.img.destTop + (parent.img.destHeight / 2) };\n        angle = angle ? angle : ((parent.transform.straighten) * (Math.PI / 180));\n        var point = { x: Math.cos(angle) * (x - center.x) - Math.sin(angle) * (y - center.y) + center.x,\n            y: Math.sin(angle) * (x - center.x) + Math.cos(angle) * (y - center.y) + center.y };\n        return point;\n    };\n    Shape.prototype.straightenShapes = function () {\n        var parent = this.parent;\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        var straightenObj = { bool: parent.isStraightening };\n        if (!straightenObj['bool'] || parent.transform.straighten === 0) {\n            return;\n        }\n        parent.notify('draw', { prop: 'updateImgCanvasPoints' });\n        var object = { points: null };\n        parent.notify('draw', { prop: 'getImageCanvasPoints', value: { obj: object } });\n        var center = { x: destLeft + (destWidth / 2), y: destTop + (destHeight / 2) };\n        var angle = -((parent.transform.straighten) * (Math.PI / 180));\n        var p1 = { x: Math.cos(angle) * (object['points'][0]['x'] - center.x) - Math.sin(angle) *\n                (object['points'][0]['y'] - center.y) + center.x,\n            y: Math.sin(angle) * (object['points'][0]['x'] - center.x) + Math.cos(angle) *\n                (object['points'][0]['y'] - center.y) + center.y };\n        var p2 = { x: Math.cos(angle) * (object['points'][1]['x'] - center.x) - Math.sin(angle) *\n                (object['points'][1]['y'] - center.y) + center.x,\n            y: Math.sin(angle) * (object['points'][1]['x'] - center.x) + Math.cos(angle) * (object['points'][1]['y']\n                - center.y) + center.y };\n        var p3 = { x: Math.cos(angle) * (object['points'][2]['x'] - center.x) - Math.sin(angle) *\n                (object['points'][2]['y'] - center.y) + center.x,\n            y: Math.sin(angle) * (object['points'][2]['x'] - center.x) + Math.cos(angle) * (object['points'][2]['y']\n                - center.y) + center.y };\n        parent.img.destWidth = p2.x - p1.x;\n        parent.img.destHeight = p3.y - p2.y;\n        parent.img.destLeft = p1.x;\n        parent.img.destTop = p1.y;\n    };\n    Shape.prototype.straightenShapePoints = function (obj, isReverse) {\n        var parent = this.parent;\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        var straightenObj = { bool: parent.isStraightening };\n        if (!straightenObj['bool']) {\n            return;\n        }\n        if (obj.shape === 'line' || obj.shape === 'arrow') {\n            obj.activePoint.width = obj.activePoint.endX > obj.activePoint.startX ? obj.activePoint.endX -\n                obj.activePoint.startX : obj.activePoint.startX - obj.activePoint.endX;\n            obj.activePoint.height = obj.activePoint.endY > obj.activePoint.startY ? obj.activePoint.endY -\n                obj.activePoint.startY : obj.activePoint.startY - obj.activePoint.endY;\n            var center = { x: destLeft + (destWidth / 2), y: destTop + (destHeight / 2) };\n            var angle = (isReverse ? -parent.transform.straighten : parent.transform.straighten) * (Math.PI / 180);\n            var start = { x: Math.cos(angle) * (obj.activePoint.startX - center.x) - Math.sin(angle) *\n                    (obj.activePoint.startY - center.y) + center.x, y: Math.sin(angle) * (obj.activePoint.startX - center.x) + Math.cos(angle)\n                    * (obj.activePoint.startY - center.y) + center.y };\n            var end = { x: Math.cos(angle) * (obj.activePoint.endX - center.x) -\n                    Math.sin(angle) * (obj.activePoint.endY - center.y) + center.x, y: Math.sin(angle) * (obj.activePoint.endX - center.x) +\n                    Math.cos(angle) * (obj.activePoint.endY - center.y) + center.y };\n            obj.activePoint.startX = start.x;\n            obj.activePoint.startY = start.y;\n            obj.activePoint.endX = end.x;\n            obj.activePoint.endY = end.y;\n            obj.activePoint.width = obj.activePoint.endX > obj.activePoint.startX ? obj.activePoint.endX -\n                obj.activePoint.startX : obj.activePoint.startX - obj.activePoint.endX;\n            obj.activePoint.height = obj.activePoint.endY > obj.activePoint.startY ? obj.activePoint.endY -\n                obj.activePoint.startY : obj.activePoint.startY - obj.activePoint.endY;\n            parent.notify('selection', { prop: 'adjustActObjForLineArrow', onPropertyChange: false, value: { obj: obj } });\n        }\n    };\n    Shape.prototype.redrawObj = function (degree) {\n        var parent = this.parent;\n        var isShape = false;\n        if (parent.objColl.length > 0) {\n            if (degree === 'horizontal' || degree === 'vertical' || degree === 'Horizontal' || degree === 'Vertical' ||\n                degree === 'horizontalVertical' || degree === 'verticalHorizontal') {\n                this.updateCurrentActiveObjPoint(degree.toLowerCase());\n            }\n            else if (typeof (degree) === 'number') {\n                this.updateCurrentActiveObjPoint(degree);\n                var tempFilter = this.lowerContext.filter;\n                this.lowerContext.filter = 'brightness(' + 1 + ') ' + 'contrast(' + 100 + '%) ' + 'hue-rotate(' + 0 + 'deg) ' +\n                    'saturate(' + 100 + '%) ' + 'opacity(' + 1 + ') ' + 'blur(' + 0 + 'px) ' + 'sepia(0%) ' + 'grayscale(0%) ' + 'invert(0%)';\n                for (var i = 0, len = parent.objColl.length; i < len; i++) {\n                    var splitWords = parent.objColl[i].shape.split('-');\n                    if (splitWords[0] !== 'crop') {\n                        this.apply(parent.objColl[i].shape, parent.objColl[i]);\n                        isShape = true;\n                    }\n                }\n                if (isShape) {\n                    parent.notify('draw', { prop: 'applyFrame', value: { ctx: this.lowerContext, frame: parent.frameObj.type, preventImg: true } });\n                }\n                this.lowerContext.filter = tempFilter;\n            }\n        }\n    };\n    Shape.prototype.updateCurrentActiveObjPoint = function (degree) {\n        var parent = this.parent;\n        var currActObjIndex;\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        for (var index = 0, len = parent.objColl.length; index < len; index++) {\n            var currObj = parent.objColl[index];\n            if (parent.activeObj.shape === currObj.shape &&\n                parent.activeObj.activePoint.startX === currObj.activePoint.startX &&\n                parent.activeObj.activePoint.startY === currObj.activePoint.startY &&\n                parent.activeObj.activePoint.endX === currObj.activePoint.endX &&\n                parent.activeObj.activePoint.endY === currObj.activePoint.endY &&\n                parent.activeObj.currIndex === currObj.currIndex) {\n                currActObjIndex = index;\n                break;\n            }\n        }\n        if (degree === 'horizontal' || degree === 'vertical' || degree === 'Horizontal' || degree === 'Vertical' ||\n            degree === 'horizontalvertical' || degree === 'verticalhorizontal') {\n            if (degree === 'horizontal' || degree === 'Horizontal') {\n                for (var i = 0, len = parent.objColl.length; i < len; i++) {\n                    var currObj = parent.objColl[i];\n                    if (currObj.shapeFlip !== parent.transform.currFlipState) {\n                        if (currObj.activePoint.startX <= destLeft + (destWidth / 2)) {\n                            currObj.activePoint.endX = (destLeft + destWidth) - (currObj.activePoint.startX - destLeft);\n                            currObj.activePoint.startX = currObj.activePoint.endX - currObj.activePoint.width;\n                            parent.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: currObj.activePoint, obj: currObj } });\n                        }\n                        else if (currObj.activePoint.startX >= destLeft + (destWidth / 2)) {\n                            currObj.activePoint.startX = destLeft + (destLeft + destWidth - currObj.activePoint.endX);\n                            currObj.activePoint.endX = currObj.activePoint.startX + currObj.activePoint.width;\n                            parent.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: currObj.activePoint, obj: currObj } });\n                        }\n                        if (currObj.shape === 'line' || currObj.shape === 'arrow' || currObj.shape === 'path') {\n                            this.flipLineArrowObj(currObj, 'horizontal');\n                        }\n                        else if (currObj.rotatedAngle !== 0) {\n                            currObj.rotatedAngle = currObj.rotatedAngle + (Math.PI - currObj.rotatedAngle) * 2;\n                            if (currObj.rotationCirclePointColl.x <= destLeft + (destWidth / 2)) {\n                                currObj.rotationCirclePointColl.x = (destLeft + destWidth) -\n                                    (currObj.rotationCirclePointColl.x - destLeft);\n                            }\n                            else if (currObj.rotationCirclePointColl.x >= destLeft + (destWidth / 2)) {\n                                currObj.rotationCirclePointColl.x = destLeft +\n                                    (destLeft + destWidth - currObj.rotationCirclePointColl.x);\n                            }\n                            currObj.rotationCirclePointColl.ratioX =\n                                (currObj.rotationCirclePointColl.x - destLeft) / destWidth;\n                        }\n                        currObj.shapeFlip = parent.transform.currFlipState;\n                        currObj.imageRatio = { startX: ((currObj.activePoint.startX - destLeft) / destWidth),\n                            startY: ((currObj.activePoint.startY - destTop) / destHeight),\n                            endX: ((currObj.activePoint.endX - destLeft) / destWidth),\n                            endY: ((currObj.activePoint.endY - destTop) / destHeight),\n                            width: destWidth / currObj.activePoint.width,\n                            height: destHeight / currObj.activePoint.height };\n                    }\n                }\n            }\n            else if (degree === 'vertical' || degree === 'Vertical') {\n                for (var i = 0; i < parent.objColl.length; i++) {\n                    var currObj = parent.objColl[i];\n                    if (currObj.shapeFlip !== parent.transform.currFlipState) {\n                        if (currObj.activePoint.startY <= destTop + (destHeight / 2)) {\n                            currObj.activePoint.endY = (destTop + destHeight) - (currObj.activePoint.startY - destTop);\n                            currObj.activePoint.startY = currObj.activePoint.endY - currObj.activePoint.height;\n                            parent.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: currObj.activePoint,\n                                    obj: currObj } });\n                        }\n                        else if (currObj.activePoint.startY >= parent.lowerCanvas.height / 2) {\n                            currObj.activePoint.startY = destTop + (destTop + destHeight - currObj.activePoint.endY);\n                            currObj.activePoint.endY = currObj.activePoint.startY + currObj.activePoint.height;\n                            parent.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: currObj.activePoint,\n                                    obj: currObj } });\n                        }\n                        if (currObj.shape === 'line' || currObj.shape === 'arrow' ||\n                            currObj.shape === 'path') {\n                            this.flipLineArrowObj(currObj, 'vertical');\n                        }\n                        else if (currObj.rotatedAngle !== 0) {\n                            currObj.rotatedAngle = -currObj.rotatedAngle;\n                            if (currObj.rotationCirclePointColl.y <= destTop + (destHeight / 2)) {\n                                currObj.rotationCirclePointColl.y = (destTop + destHeight) - (currObj.rotationCirclePointColl.y - destTop);\n                            }\n                            else if (currObj.rotationCirclePointColl.y >= destTop +\n                                (destHeight / 2)) {\n                                currObj.rotationCirclePointColl.y = destTop + (destTop + destHeight - currObj.rotationCirclePointColl.y);\n                            }\n                            currObj.rotationCirclePointColl.ratioY =\n                                (currObj.rotationCirclePointColl.y - destTop) / destHeight;\n                        }\n                        currObj.shapeFlip = parent.transform.currFlipState;\n                        currObj.imageRatio = { startX: ((currObj.activePoint.startX - destLeft) / destWidth),\n                            startY: ((currObj.activePoint.startY - destTop) / destHeight),\n                            endX: ((currObj.activePoint.endX - destLeft) / destWidth),\n                            endY: ((currObj.activePoint.endY - destTop) / destHeight),\n                            width: destWidth / currObj.activePoint.width,\n                            height: destHeight / currObj.activePoint.height };\n                    }\n                }\n            }\n            else if (degree === 'verticalhorizontal' || degree === 'horizontalvertical') {\n                for (var i = 0, len = parent.objColl.length; i < len; i++) {\n                    var currObj = parent.objColl[i];\n                    if (currObj.shapeFlip !== parent.transform.currFlipState) {\n                        if (currObj.activePoint.startX <= destLeft + (destWidth / 2)) {\n                            currObj.activePoint.endX = (destLeft + destWidth) - (currObj.activePoint.startX -\n                                destLeft);\n                            currObj.activePoint.startX = currObj.activePoint.endX - currObj.activePoint.width;\n                            parent.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: currObj.activePoint, obj: currObj } });\n                        }\n                        else if (currObj.activePoint.startX >= destLeft + (destWidth / 2)) {\n                            currObj.activePoint.startX = destLeft + (destLeft +\n                                destWidth - currObj.activePoint.endX);\n                            currObj.activePoint.endX = currObj.activePoint.startX + currObj.activePoint.width;\n                            parent.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: currObj.activePoint, obj: currObj } });\n                        }\n                        if (currObj.activePoint.startY <= destTop + (destHeight / 2)) {\n                            currObj.activePoint.endY = (destTop + destHeight) -\n                                (currObj.activePoint.startY - destTop);\n                            currObj.activePoint.startY = currObj.activePoint.endY -\n                                currObj.activePoint.height;\n                            parent.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: currObj.activePoint, obj: currObj } });\n                        }\n                        else if (currObj.activePoint.startY >= parent.lowerCanvas.height / 2) {\n                            currObj.activePoint.startY = destTop + (destTop +\n                                destHeight - currObj.activePoint.endY);\n                            currObj.activePoint.endY = currObj.activePoint.startY +\n                                currObj.activePoint.height;\n                            parent.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: currObj.activePoint, obj: currObj } });\n                        }\n                        if (currObj.shape === 'line' || currObj.shape === 'arrow' || currObj.shape === 'path') {\n                            this.flipLineArrowObj(currObj, degree);\n                        }\n                        currObj.shapeFlip = parent.transform.currFlipState;\n                        currObj.imageRatio = { startX: ((currObj.activePoint.startX - destLeft) / destWidth),\n                            startY: ((currObj.activePoint.startY - destTop) / destHeight),\n                            endX: ((currObj.activePoint.endX - destLeft) / destWidth),\n                            endY: ((currObj.activePoint.endY - destTop) / destHeight),\n                            width: destWidth / currObj.activePoint.width,\n                            height: destHeight / currObj.activePoint.height };\n                    }\n                }\n            }\n            if (currActObjIndex !== undefined) {\n                parent.activeObj = extend({}, parent.objColl[currActObjIndex], {}, true);\n            }\n        }\n        else if (degree === 90) {\n            this.rotateObjColl();\n        }\n        else if (degree === -90) {\n            for (var i = 0; i < 3; i++) {\n                this.rotateObjColl();\n            }\n        }\n        else if (typeof (degree) === 'number') {\n            if (degree > 0) {\n                this.rotateObjColl();\n            }\n            else {\n                for (var i = 0; i < 3; i++) {\n                    this.rotateObjColl();\n                }\n            }\n        }\n    };\n    Shape.prototype.rotateObjColl = function () {\n        var parent = this.parent;\n        var _a = parent.img, destWidth = _a.destWidth, destHeight = _a.destHeight, destLeft = _a.destLeft, destTop = _a.destTop;\n        for (var i = 0, len = parent.objColl.length; i < len; i++) {\n            var currObj = parent.objColl[i];\n            var shape = currObj.shape;\n            currObj.activePoint.startY = destTop + (destHeight * currObj.imageRatio.startX);\n            currObj.activePoint.endY = destTop + (destHeight * currObj.imageRatio.endX);\n            currObj.activePoint.startX = (destLeft + destWidth) - (destWidth * currObj.imageRatio.endY);\n            currObj.activePoint.endX = (destLeft + destWidth) - (destWidth * currObj.imageRatio.startY);\n            currObj = this.updateWidthHeight(parent.objColl[i]);\n            this.updateFontSize(currObj);\n            if (shape === 'line' || shape === 'arrow' || shape === 'path') {\n                this.rotateLineArrowObj(currObj);\n                if (shape === 'arrow') {\n                    this.updateArrowSize(currObj);\n                }\n            }\n            else if (currObj.rotatedAngle !== 0) {\n                currObj.rotationCirclePointColl.y = destTop + (destHeight * currObj.rotationCirclePointColl.ratioX);\n                currObj.rotationCirclePointColl.x = (destLeft + destWidth) -\n                    (destWidth * currObj.rotationCirclePointColl.ratioY);\n                currObj.rotationCirclePointColl.ratioX = (currObj.rotationCirclePointColl.x - destLeft) / destWidth;\n                currObj.rotationCirclePointColl.ratioY = (currObj.rotationCirclePointColl.y - destTop) / destHeight;\n            }\n        }\n        for (var i = 0, len = parent.objColl.length; i < len; i++) {\n            parent.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: parent.objColl[i].activePoint, obj: parent.objColl[i] } });\n        }\n        for (var i = 0, len = parent.objColl.length; i < len; i++) {\n            var currObj = parent.objColl[i];\n            currObj.imageRatio = { startX: ((currObj.activePoint.startX - destLeft) / destWidth),\n                startY: ((currObj.activePoint.startY - destTop) / destHeight),\n                endX: ((currObj.activePoint.endX - destLeft) / destWidth),\n                endY: ((currObj.activePoint.endY - destTop) / destHeight),\n                width: destWidth / currObj.activePoint.width,\n                height: destHeight / currObj.activePoint.height };\n        }\n    };\n    Shape.prototype.rotateLineArrowObj = function (obj) {\n        if (isNullOrUndefined(obj.pointColl)) {\n            return;\n        }\n        var parent = this.parent;\n        var _a = parent.img, destWidth = _a.destWidth, destHeight = _a.destHeight, destLeft = _a.destLeft, destTop = _a.destTop;\n        if (obj.pointColl.length > 0) {\n            for (var n = 0; n < obj.pointColl.length; n++) {\n                obj.pointColl[n].y = destTop + (destHeight * obj.pointColl[n].ratioX);\n                obj.pointColl[n].x = (destLeft + destWidth) - (destWidth *\n                    obj.pointColl[n].ratioY);\n            }\n            for (var n = 0; n < obj.pointColl.length; n++) {\n                obj.pointColl[n].ratioX = (obj.pointColl[n].x - destLeft) / destWidth;\n                obj.pointColl[n].ratioY = (obj.pointColl[n].y - destTop) / destHeight;\n            }\n            var prevPoint = void 0;\n            if (isNullOrUndefined(obj.pointColl[obj.pointColl.length - 2])) {\n                prevPoint = { x: 0, y: 0 };\n            }\n            else {\n                prevPoint = { x: obj.pointColl[obj.pointColl.length - 2].x, y: obj.pointColl[obj.pointColl.length - 2].y };\n            }\n            var diffX = obj.pointColl[obj.pointColl.length - 1].x - prevPoint.x;\n            var diffY = obj.pointColl[obj.pointColl.length - 1].y - prevPoint.y;\n            obj.activePoint.startX = obj.pointColl[0].x;\n            obj.activePoint.startY = obj.pointColl[0].y;\n            obj.activePoint.endX = obj.pointColl[obj.pointColl.length - 1].x + (diffX / 2);\n            obj.activePoint.endY = obj.pointColl[obj.pointColl.length - 1].y + (diffY / 2);\n            obj = this.updateWidthHeight(obj);\n        }\n    };\n    Shape.prototype.flipLineArrowObj = function (obj, value) {\n        value = value.toLowerCase();\n        if (isNullOrUndefined(obj.pointColl)) {\n            return;\n        }\n        if (value === 'horizontal') {\n            this.lineArrowHorizontalFlip(obj);\n        }\n        else if (value === 'vertical') {\n            this.lineArrowVerticalFlip(obj);\n        }\n        else {\n            this.lineArrowHorizontalFlip(obj);\n            obj.shapeFlip = '';\n            this.lineArrowVerticalFlip(obj);\n        }\n        obj.activePoint.startX = obj.pointColl[0].x;\n        obj.activePoint.startY = obj.pointColl[0].y;\n        obj.activePoint.endX = obj.pointColl[obj.pointColl.length - 1].x;\n        obj.activePoint.endY = obj.pointColl[obj.pointColl.length - 1].y;\n        if (obj.activePoint.startX > obj.activePoint.endX) {\n            var temp = obj.activePoint.startX;\n            obj.activePoint.startX = obj.activePoint.endX;\n            obj.activePoint.endX = temp;\n            temp = obj.activePoint.startY;\n            obj.activePoint.startY = obj.activePoint.endY;\n            obj.activePoint.endY = temp;\n        }\n    };\n    Shape.prototype.lineArrowHorizontalFlip = function (obj) {\n        var parent = this.parent;\n        var _a = parent.img, destWidth = _a.destWidth, destHeight = _a.destHeight, destLeft = _a.destLeft, destTop = _a.destTop;\n        if (obj.shapeFlip !== parent.transform.currFlipState) {\n            for (var l = 0, len = obj.pointColl.length; l < len; l++) {\n                var currPoint = obj.pointColl[l];\n                if (currPoint.x <= destLeft + (destWidth / 2)) {\n                    currPoint.x = (destLeft + destWidth) - (currPoint.x - destLeft);\n                }\n                else if (currPoint.x >= destLeft + (destWidth / 2)) {\n                    currPoint.x = destLeft + (destLeft + destWidth - currPoint.x);\n                }\n                currPoint.ratioX = (currPoint.x - destLeft) / destWidth;\n                currPoint.ratioY = (currPoint.y - destTop) / destHeight;\n            }\n            if (obj.shape === 'arrow') {\n                var value = obj.start;\n                obj.start = obj.end;\n                obj.end = value;\n            }\n            obj.shapeFlip = parent.transform.currFlipState;\n        }\n    };\n    Shape.prototype.lineArrowVerticalFlip = function (obj) {\n        var parent = this.parent;\n        var _a = parent.img, destWidth = _a.destWidth, destHeight = _a.destHeight, destLeft = _a.destLeft, destTop = _a.destTop;\n        if (obj.shapeFlip !== parent.transform.currFlipState) {\n            for (var l = 0, len = obj.pointColl.length; l < len; l++) {\n                var currPoint = obj.pointColl[l];\n                if (currPoint.y <= destTop + (destHeight / 2)) {\n                    currPoint.y = (destTop + destHeight) - (currPoint.y - destTop);\n                }\n                else if (currPoint.y >= destTop + (destHeight / 2)) {\n                    currPoint.y = destTop + (destTop + destHeight - currPoint.y);\n                }\n                currPoint.ratioX = (currPoint.x - destLeft) / destWidth;\n                currPoint.ratioY = (currPoint.y - destTop) / destHeight;\n            }\n            obj.shapeFlip = parent.transform.currFlipState;\n        }\n    };\n    Shape.prototype.getRotDegOfShape = function (obj) {\n        var degree;\n        if (obj.shapeDegree === 0) {\n            degree = this.parent.transform.degree;\n        }\n        else {\n            degree = this.parent.transform.degree - obj.shapeDegree;\n        }\n        if (degree < 0) {\n            degree = 360 + degree;\n        }\n        return degree;\n    };\n    Shape.prototype.renderTextArea = function (x, y, actObj) {\n        var parent = this.parent;\n        var degree = this.getRotDegOfShape(parent.activeObj);\n        this.transformTextArea();\n        parent.notify('toolbar', { prop: 'destroy-qa-toolbar', onPropertyChange: false });\n        var zOrderElem = parent.element.querySelector('#' + parent.element.id + '_zOrderBtn');\n        var dupElem = parent.element.querySelector('#' + parent.element.id + '_duplicate');\n        var removeElem = parent.element.querySelector('#' + parent.element.id + '_remove');\n        var editTextElem = parent.element.querySelector('#' + parent.element.id + '_editText');\n        var shadowColor = actObj.strokeSettings.outlineColor;\n        var outlineWidth = actObj.strokeSettings.outlineWidth;\n        var shadows = [];\n        if (zOrderElem) {\n            zOrderElem.classList.add('e-overlay');\n        }\n        if (dupElem) {\n            dupElem.classList.add('e-overlay');\n        }\n        if (removeElem) {\n            removeElem.classList.add('e-overlay');\n        }\n        if (editTextElem) {\n            editTextElem.classList.add('e-overlay');\n        }\n        if (actObj.strokeSettings.fillColor !== '') {\n            parent.textArea.style.backgroundColor = actObj.strokeSettings.fillColor;\n        }\n        else {\n            parent.textArea.style.backgroundColor = 'transparent';\n        }\n        parent.textArea.style.display = 'block';\n        parent.textArea.style.left = x + 'px';\n        parent.textArea.style.top = y + 'px';\n        parent.textArea.style.fontFamily = actObj.textSettings.fontFamily;\n        parent.textArea.style.fontSize = actObj.textSettings.fontSize + 'px';\n        parent.textArea.style.color = actObj.strokeSettings.strokeColor;\n        var fontSize = actObj.textSettings.fontSize;\n        var baseWidth = Math.max(1, outlineWidth / 2);\n        var adjustedOutlineWidth = baseWidth * (Math.floor((fontSize - 1) / 16) * 0.5 + 0.5);\n        if (/^#([0-9A-Fa-f]{3}|[0-9A-Fa-f]{6}|[0-9A-Fa-f]{8})$|^[a-zA-Z]+$/.test(actObj.strokeSettings.outlineColor)) {\n            for (var x_1 = -adjustedOutlineWidth; x_1 <= adjustedOutlineWidth; x_1++) {\n                for (var y_1 = -adjustedOutlineWidth; y_1 <= adjustedOutlineWidth; y_1++) {\n                    if (x_1 !== 0 || y_1 !== 0) {\n                        shadows.push(x_1 / 2 + \"px \" + y_1 / 2 + \"px 0 \" + shadowColor);\n                    }\n                }\n            }\n            parent.textArea.style.textShadow = shadows.join(', ');\n        }\n        else {\n            parent.textArea.style.textShadow = null;\n        }\n        parent.textArea.style.fontWeight = actObj.textSettings.bold ? 'bold' : 'normal';\n        parent.textArea.style.fontStyle = actObj.textSettings.italic ? 'italic' : 'normal';\n        parent.textArea.style.border = '2px solid ' + parent.themeColl[parent.theme]['primaryColor'];\n        parent.textArea.value = actObj.keyHistory;\n        parent.textArea.style.overflow = 'hidden';\n        parent.textArea.style.width = 'auto';\n        parent.textArea.style.height = 'auto';\n        parent.textArea.focus();\n        var _a = actObj.activePoint, width = _a.width, height = _a.height;\n        if (degree % 90 === 0 && degree % 180 !== 0 && degree !== 0) {\n            parent.textArea.style.width = height + (height * 0.25) + 'px';\n            parent.textArea.style.height = width + (width * 0.25) + 'px';\n        }\n        else {\n            parent.textArea.style.width = width + (width * 0.25) + 'px';\n            parent.textArea.style.height = height + (height * 0.25) + 'px';\n        }\n        this.setTextBoxWidth();\n        var obj = { flipColl: null };\n        parent.notify('transform', { prop: 'getFlipColl', onPropertyChange: false, value: { obj: obj } });\n        if (obj['flipColl'].length <= 1) {\n            this.setTextBoxHeight();\n        }\n        if (parseFloat(parent.textArea.style.maxHeight) < parent.activeObj.textSettings.fontSize) {\n            parent.textArea.style.maxHeight = parent.activeObj.textSettings.fontSize + 'px';\n        }\n        if (degree % 90 === 0 && degree % 180 !== 0) {\n            if (parseFloat(parent.textArea.style.left) + parseFloat(parent.textArea.style.width) > parent.img.destTop +\n                parent.img.destHeight) {\n                this.alignTextAreaIntoCanvas();\n            }\n        }\n        else {\n            if (parseFloat(parent.textArea.style.left) + parseFloat(parent.textArea.style.width) > parent.img.destLeft +\n                parent.img.destWidth) {\n                this.alignTextAreaIntoCanvas();\n            }\n        }\n        // Limit text area\n        if (actObj.rotatedAngle !== 0) {\n            var tempLeft = parseFloat(parent.textArea.style.left);\n            var tempTop = parseFloat(parent.textArea.style.top);\n            if (actObj.flipObjColl.length > 0) {\n                var panObj = { panRegion: '' };\n                var _b = parent.lowerCanvas, clientWidth = _b.clientWidth, clientHeight = _b.clientHeight;\n                var center_1 = { x: 0, y: 0 };\n                parent.notify('crop', { prop: 'getCurrFlipState', onPropertyChange: false,\n                    value: { panObj: panObj } });\n                if (panObj['panRegion'] !== '') {\n                    if (panObj['panRegion'] === 'horizontal') {\n                        center_1.x = clientWidth - (clientWidth / 2);\n                        tempLeft = (center_1.x - tempLeft) + center_1.x;\n                    }\n                    else if (panObj['panRegion'] === 'vertical') {\n                        center_1.y = clientHeight - (clientHeight / 2);\n                        tempTop = (center_1.y - tempTop) + center_1.y;\n                    }\n                    else {\n                        center_1 = { x: clientWidth - (clientWidth / 2), y: clientHeight - (clientHeight / 2) };\n                        tempLeft = (center_1.x - tempLeft) + center_1.x;\n                        tempTop = (center_1.y - tempTop) + center_1.y;\n                    }\n                }\n            }\n            var left = tempLeft + parseFloat(parent.textArea.style.width);\n            var top_1 = tempTop + parseFloat(parent.textArea.style.height);\n            var width1 = parseFloat(parent.textArea.style.width);\n            var height1 = parseFloat(parent.textArea.style.height);\n            var center = { x: left - (width1 / 2), y: top_1 - (height1 / 2) };\n            var cosAngle = Math.cos(actObj.rotatedAngle);\n            var sinAngle = Math.sin(actObj.rotatedAngle);\n            var p1 = { x: cosAngle * (left - center.x) - sinAngle * (top_1 - center.y) + center.x,\n                y: sinAngle * (left - center.x) + cosAngle * (top_1 - center.y) + center.y };\n            if (p1.x > parent.img.destLeft && p1.x < parent.img.destLeft + parent.img.destWidth &&\n                // eslint-disable-next-line max-len\n                p1.y > parent.img.destTop && p1.y + parseFloat(parent.textArea.style.fontSize) < parent.img.destTop + parent.img.destHeight) {\n                // eslint-disable-next-line no-self-assign\n                parent.textArea.style.width = parent.textArea.style.width;\n            }\n            else {\n                var count = 0;\n                var width2 = parseFloat(parent.textArea.style.width);\n                while (true) {\n                    count++;\n                    width1 -= 1;\n                    left = tempLeft + width1;\n                    center = { x: left - (width1 / 2), y: top_1 - (height1 / 2) };\n                    p1 = { x: cosAngle * (left - center.x) - sinAngle * (top_1 - center.y) + center.x,\n                        y: sinAngle * (left - center.x) + cosAngle * (top_1 - center.y) + center.y };\n                    if ((p1.x > parent.img.destLeft && p1.x < parent.img.destLeft + parent.img.destWidth &&\n                        // eslint-disable-next-line max-len\n                        p1.y > parent.img.destTop && p1.y + parseFloat(parent.textArea.style.fontSize) < parent.img.destTop + parent.img.destHeight) ||\n                        count === width2) {\n                        parent.textArea.style.width = width1 + 'px';\n                        break;\n                    }\n                }\n            }\n        }\n        parent.notify('selection', { prop: 'clearUpperCanvas', onPropertyChange: false });\n    };\n    Shape.prototype.setTextBoxWidth = function (e) {\n        var parent = this.parent;\n        if (parent.activeObj.rotatedAngle !== 0) {\n            parent.textArea.style.whiteSpace = 'nowrap';\n            parent.textArea.style.textOverflow = 'ellipsis';\n            parent.textArea.style.display = 'inline-block';\n            return;\n        }\n        else {\n            parent.textArea.style.whiteSpace = '';\n            parent.textArea.style.textOverflow = '';\n            if (parent.textArea.style.display === 'inline-block') {\n                parent.textArea.style.display = 'block';\n            }\n        }\n        var text = this.getMaxText(true);\n        if (parent.textArea.style.display === 'block' || parent.textArea.style.display === 'inline-block') {\n            this.updateFontStyles(true);\n        }\n        else {\n            this.updateFontStyles();\n        }\n        var textAreaWidth = (this.upperContext.measureText(text).width + (parseFloat(parent.textArea.style.fontSize) / 2));\n        var letterWidth = e ? this.upperContext.measureText(String.fromCharCode(e.which)).width : 0;\n        var actObj = extend({}, parent.activeObj, {}, true);\n        var flip = '';\n        var degree = this.getRotDegOfShape(actObj);\n        if (actObj.shapeFlip !== parent.transform.currFlipState) {\n            flip = '';\n        }\n        else {\n            flip = parent.transform.currFlipState;\n        }\n        if ((e && parseFloat(parent.textArea.style.width) < (textAreaWidth + letterWidth)) || isNullOrUndefined(e)) {\n            if (degree === 0) {\n                if (flip.toLowerCase() === 'horizontal') {\n                    if ((parseFloat(parent.textArea.style.left) - parent.img.destLeft) - textAreaWidth - letterWidth > 0) {\n                        parent.textArea.style.width = (textAreaWidth + letterWidth) + 'px';\n                    }\n                }\n                else if ((parent.img.destWidth - (parseFloat(parent.textArea.style.left) -\n                    parent.img.destLeft)) > (textAreaWidth + letterWidth)) {\n                    parent.textArea.style.width = (textAreaWidth + letterWidth) + 'px';\n                }\n            }\n            else if (degree === 90) {\n                if (flip.toLowerCase() === 'vertical') {\n                    if ((parseFloat(parent.textArea.style.top) - parent.img.destTop) - textAreaWidth - letterWidth > 0) {\n                        parent.textArea.style.width = (textAreaWidth + letterWidth) + 'px';\n                    }\n                }\n                else if ((parent.img.destHeight - (parseFloat(parent.textArea.style.top) -\n                    parent.img.destTop)) > (textAreaWidth + letterWidth)) {\n                    parent.textArea.style.width = (textAreaWidth + letterWidth) + 'px';\n                }\n            }\n            else if (degree === 180) {\n                var textAreaLeft = parseFloat(parent.textArea.style.left);\n                var destLeft = parent.img.destLeft;\n                if (flip.toLowerCase() === 'horizontal') {\n                    var remainingWidth = parent.img.destWidth - (textAreaLeft - destLeft);\n                    if (remainingWidth > textAreaWidth + letterWidth) {\n                        parent.textArea.style.width = (textAreaWidth + letterWidth) + 'px';\n                    }\n                }\n                else {\n                    var distanceToLeft = textAreaLeft - destLeft;\n                    if (distanceToLeft - textAreaWidth - letterWidth > 0) {\n                        parent.textArea.style.width = (textAreaWidth + letterWidth) + 'px';\n                    }\n                }\n            }\n            else if (degree === 270) {\n                var textAreaTop = parseFloat(parent.textArea.style.top);\n                var destTop = parent.img.destTop;\n                if (flip.toLowerCase() === 'vertical') {\n                    var remainingHeight = parent.img.destHeight - (textAreaTop - destTop);\n                    if (remainingHeight > textAreaWidth + letterWidth) {\n                        parent.textArea.style.width = (textAreaWidth + letterWidth) + 'px';\n                    }\n                }\n                else {\n                    var distanceToTop = textAreaTop - destTop;\n                    if (distanceToTop - textAreaWidth - letterWidth > 0) {\n                        parent.textArea.style.width = (textAreaWidth + letterWidth) + 'px';\n                    }\n                }\n            }\n        }\n    };\n    Shape.prototype.setTextBoxHeight = function () {\n        var parent = this.parent;\n        var textAreaTop;\n        var actObj = extend({}, parent.activeObj, {}, true);\n        var flip = '';\n        var degree = this.getRotDegOfShape(actObj);\n        if (actObj.textFlip === parent.transform.currFlipState) {\n            flip = '';\n        }\n        else if (actObj.textFlip === '') {\n            flip = parent.transform.currFlipState;\n        }\n        else {\n            flip = actObj.textFlip;\n        }\n        switch (degree) {\n            case 0:\n                if (flip.toLowerCase() === 'vertical') {\n                    parent.textArea.style.maxHeight = (parent.img.destHeight - (parent.img.destHeight -\n                        parseFloat(parent.textArea.style.top))) + 'px';\n                }\n                else {\n                    textAreaTop = parseFloat(parent.textArea.style.top) - parent.img.destTop;\n                    parent.textArea.style.maxHeight = (parent.img.destHeight - textAreaTop) + 'px';\n                }\n                break;\n            case 90:\n                if (flip.toLowerCase() === 'horizontal') {\n                    parent.textArea.style.maxHeight = (parent.img.destWidth - (parseFloat(parent.textArea.style.left) -\n                        parent.img.destLeft)) + 'px';\n                }\n                else {\n                    parent.textArea.style.maxHeight = (parseFloat(parent.textArea.style.left) - parent.img.destLeft) + 'px';\n                }\n                break;\n            case 180:\n                if (flip.toLowerCase() === 'vertical') {\n                    textAreaTop = parseFloat(parent.textArea.style.top) - parent.img.destTop;\n                    parent.textArea.style.maxHeight = (parent.img.destHeight - textAreaTop) + 'px';\n                }\n                else {\n                    parent.textArea.style.maxHeight = (parseFloat(parent.textArea.style.top) - parent.img.destTop) + 'px';\n                }\n                break;\n            case 270:\n                if (flip.toLowerCase() === 'horizontal') {\n                    parent.textArea.style.maxHeight = (parseFloat(parent.textArea.style.left) - parent.img.destLeft) + 'px';\n                }\n                else {\n                    parent.textArea.style.maxHeight = parent.img.destWidth - (parseFloat(parent.textArea.style.left)\n                        - parent.img.destLeft) + 'px';\n                }\n                break;\n        }\n    };\n    Shape.prototype.updatePathRatio = function (obj) {\n        var parent = this.parent;\n        for (var i = 0, len = obj.pointColl.length; i < len; i++) {\n            var currPoint = obj.pointColl[i];\n            currPoint.ratioX = (currPoint.x - parent.img.destLeft) / parent.img.destWidth;\n            currPoint.ratioY = (currPoint.y - parent.img.destTop) / parent.img.destHeight;\n        }\n    };\n    Shape.prototype.stopPathDrawing = function (e, isApply) {\n        var parent = this.parent;\n        if (parent.activeObj.shape === 'path') {\n            var obj = { shape: null };\n            parent.notify('selection', { prop: 'getCurrentDrawingShape', value: { obj: obj } });\n            if (obj['shape'] === 'path') {\n                var prevCropObj = extend({}, parent.cropObj, {}, true);\n                var object = { currObj: {} };\n                parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n                var prevObj = object['currObj'];\n                prevObj.objColl = extend([], parent.objColl, [], true);\n                prevObj.pointColl = extend([], parent.pointColl, [], true);\n                prevObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n                var selPointCollObj = { selPointColl: null };\n                parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n                    value: { obj: selPointCollObj } });\n                prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n                parent.notify('selection', { prop: 'setCurrentDrawingShape', value: { value: '' } });\n                parent.currObjType.isDragging = false;\n                if (e && e.type !== 'touchstart' && isNullOrUndefined(isApply)) {\n                    parent.activeObj.pointColl.pop();\n                }\n                this.updatePathRatio(parent.activeObj);\n                if (isNullOrUndefined(parent.activeObj.imageRatio)) {\n                    parent.notify('shape', { prop: 'updImgRatioForActObj', onPropertyChange: false });\n                }\n                parent.objColl.push(parent.activeObj);\n                parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                    value: { operation: 'shapeTransform', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                        previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                        previousCropObj: prevCropObj, previousText: null,\n                        currentText: null, previousFilter: null, isCircleCrop: null } });\n                parent.objColl.pop();\n                if (e) {\n                    parent.notify('selection', { prop: 'mouseUpEventHandler', value: { e: e } });\n                    this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n                    parent.notify('draw', { prop: 'redrawImgWithObj', onPropertyChange: false });\n                    if (parent.objColl.length > 0) {\n                        var obj1 = parent.activeObj.activePoint;\n                        var obj2 = parent.objColl[parent.objColl.length - 1].activePoint;\n                        if (Math.floor(obj1.startX) === Math.floor(obj2.startX) &&\n                            Math.floor(obj1.startY) === Math.floor(obj2.startY) &&\n                            Math.floor(obj1.endX) === Math.floor(obj2.endX) &&\n                            Math.floor(obj1.endY) === Math.floor(obj2.endY)) {\n                            this.refreshActiveObj();\n                        }\n                    }\n                }\n                parent.notify('draw', { prop: 'setNewPath', value: { bool: true } });\n                if (parent.objColl[parent.objColl.length - 1]) {\n                    var shape = parent.drawingShape;\n                    parent.notify('selection', { prop: 'setCurrentDrawingShape', value: { value: '' } });\n                    parent.noRedact = true;\n                    parent.selectShape(parent.objColl[parent.objColl.length - 1].currIndex);\n                    parent.notify('selection', { prop: 'setCurrentDrawingShape', value: { value: 'path' } });\n                    parent.drawingShape = shape;\n                }\n                parent.notify('toolbar', { prop: 'renderQAT', onPropertyChange: false, value: { isPenEdit: null } });\n                var obj_1 = { shapeSettingsObj: {} };\n                parent.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: obj_1 } });\n                var shapeSettings = obj_1['shapeSettingsObj'];\n                var shapeResizingArgs = { cancel: false, action: 'draw-end', previousShapeSettings: shapeSettings };\n                var shapeMovingArgs = { cancel: false, action: 'move', previousShapeSettings: shapeSettings };\n                parent.notify('selection', { prop: 'triggerShapeChange', onPropertyChange: false,\n                    value: { shapeResizingArgs: shapeResizingArgs, shapeMovingArgs: shapeMovingArgs, type: 'mouse-up' } });\n                parent.notify('undo-redo', { prop: 'updateUndoRedoStack', onPropertyChange: false });\n            }\n        }\n    };\n    Shape.prototype.findTextTarget = function (e) {\n        var parent = this.parent;\n        if (!e) {\n            return;\n        }\n        if (parent.activeObj.shape !== 'text') {\n            if (parent.activeObj.shape === 'path') {\n                this.stopPathDrawing(e, null);\n                return;\n            }\n            else if (e.type === 'dblclick') {\n                parent.notify('selection', { prop: 'setPanDown', onPropertyChange: false, value: { panDown: null } });\n                var activeObj = extend({}, parent.activeObj, {}, true);\n                var objColl = extend([], parent.objColl, [], true);\n                var obj = { bool: null };\n                parent.notify('selection', { prop: 'findTargetObj', onPropertyChange: false,\n                    value: { x: e.clientX, y: e.clientY, isCrop: false, obj: obj } });\n                parent.objColl = objColl;\n                if (!obj['bool'] || parent.activeObj.shape !== 'text') {\n                    parent.activeObj = extend({}, activeObj, {}, true);\n                    return;\n                }\n            }\n            else {\n                return;\n            }\n        }\n        var x;\n        var y;\n        if (e.type === 'dblclick') {\n            x = e.clientX;\n            y = e.clientY;\n        }\n        else if (e.type === 'touchstart') {\n            x = e.touches[0].clientX;\n            y = e.touches[0].clientY;\n            parent.notify('selection', { prop: 'setTouchEndPoint', onPropertyChange: false,\n                value: { x: e.touches[0].clientX, y: e.touches[0].clientY } });\n        }\n        parent.notify('toolbar', { prop: 'setPreventZoomBtn', onPropertyChange: false, value: { isPrevent: true } });\n        parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'text',\n                isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n        parent.notify('toolbar', { prop: 'setPreventZoomBtn', onPropertyChange: false, value: { isPrevent: false } });\n        parent.notify('toolbar', { prop: 'update-toolbar-items', onPropertyChange: false });\n        if (!isNullOrUndefined(x) && !isNullOrUndefined(y)) {\n            var bbox = parent.lowerCanvas.getBoundingClientRect();\n            x -= bbox.left;\n            y -= bbox.top;\n            var flip = '';\n            var degree = this.getRotDegOfShape(parent.activeObj);\n            if (parent.activeObj.textFlip === '') {\n                if (parent.activeObj.textFlip === parent.transform.currFlipState) {\n                    flip = '';\n                }\n                else {\n                    flip = parent.transform.currFlipState;\n                }\n            }\n            else {\n                if (parent.activeObj.textFlip === parent.transform.currFlipState) {\n                    flip = '';\n                }\n                else if (parent.transform.currFlipState === '') {\n                    flip = parent.activeObj.textFlip;\n                }\n                else {\n                    flip = parent.transform.currFlipState;\n                }\n            }\n            var temp = void 0;\n            if (parent.textArea.style.display === 'none') {\n                temp = extend({}, parent.activeObj, {}, true);\n                for (var i = 0; i < parent.objColl.length; i++) {\n                    if (JSON.stringify(parent.activeObj) === JSON.stringify(parent.objColl[i])) {\n                        parent.objColl.splice(i, 1);\n                    }\n                }\n                this.refreshActiveObj();\n                this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                this.lowerContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                parent.notify('draw', { prop: 'redrawImgWithObj', onPropertyChange: false });\n                parent.notify('draw', { prop: 'redrawDownScale' });\n                parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n                parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.upperContext } });\n                if ((parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle') || parent.isCircleCrop) {\n                    parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                        value: { context: this.lowerContext, isSave: null, isFlip: null } });\n                }\n                parent.activeObj = temp;\n                this.updateFontStyles();\n                var actObj = extend({}, parent.activeObj, {}, true);\n                var radius = actObj.topLeftCircle.radius;\n                var _a = actObj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY, width = _a.width, height = _a.height;\n                var center = { x: startX + (width / 2), y: startY +\n                        (height / 2) };\n                var cosAngle = Math.cos(actObj.rotatedAngle);\n                var sinAngle = Math.sin(actObj.rotatedAngle);\n                var p1 = { x: cosAngle * (startX - center.x) - sinAngle * (startY - center.y) + center.x,\n                    y: sinAngle * (startX - center.x) + cosAngle * (startY - center.y) + center.y };\n                var p2 = { x: cosAngle * (endX - center.x) - sinAngle * (startY - center.y) + center.x,\n                    y: sinAngle * (endX - center.x) + cosAngle * (startY - center.y) + center.y };\n                var p3 = { x: cosAngle * (startX - center.x) - sinAngle * (endY - center.y) + center.x,\n                    y: sinAngle * (startX - center.x) + cosAngle * (endY - center.y) + center.y };\n                var p4 = { x: cosAngle * (endX - center.x) - sinAngle * (endY - center.y) + center.x,\n                    y: sinAngle * (endX - center.x) + cosAngle * (endY - center.y) + center.y };\n                var obj = { position: null, x: x, y: y, x1: p1.x, y1: p1.y, x2: p2.x, y2: p2.y,\n                    x3: p3.x, y3: p3.y, x4: p4.x, y4: p4.y };\n                parent.notify('draw', { prop: 'checkPointPosition', onPropertyChange: false, value: { obj: obj } });\n                if ((actObj.rotatedAngle !== 0 && (obj['position'] === 'inside' || obj['position'] === 'on')) ||\n                    (actObj.rotatedAngle === 0 && x >= (actObj.activePoint.startX - (radius * 2)) &&\n                        x <= (actObj.activePoint.endX + (radius * 2)) &&\n                        y >= (actObj.activePoint.startY - (radius * 2)) &&\n                        y <= (actObj.activePoint.endY + (radius * 2)))) {\n                    this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                    if (actObj.flipObjColl.length === 4) {\n                        actObj.flipObjColl = [];\n                        flip = '';\n                        actObj.shapeFlip = '';\n                    }\n                    if (flip === '' && actObj.flipObjColl.length > 1) {\n                        flip = actObj.flipObjColl[actObj.flipObjColl.length - 1];\n                    }\n                    if (actObj.flipObjColl.length <= 1) {\n                        var points = this.setTextBoxPos(actObj, degree, flip, x, y);\n                        x = points.x;\n                        y = points.y;\n                    }\n                    else {\n                        var points = this.setTextBoxPoints(actObj, degree, flip, x, y);\n                        x = points.x;\n                        y = points.y;\n                    }\n                    if (parent.activeObj.rotatedAngle !== 0) {\n                        var point = this.getTextBoxPosition(parent.activeObj);\n                        x = point.x;\n                        y = point.y;\n                        point = this.setFlipState(x, y, parent.activeObj);\n                        x = point.x;\n                        y = point.y;\n                    }\n                    this.renderTextArea(x, y, actObj);\n                }\n                else {\n                    this.applyActObj();\n                }\n            }\n        }\n        else if ((parent.textArea.style.display === 'block' || parent.textArea.style.display === 'inline-block')\n            && this.selectedText() !== '' && e.type === 'mousedown') {\n            var temp = parent.textArea.value;\n            parent.textArea.value += 'a';\n            parent.textArea.value = temp;\n        }\n        else if (parent.textArea.style.display === 'none') {\n            parent.textArea.style.display = 'block';\n        }\n    };\n    Shape.prototype.getTextBoxPosition = function (obj, object) {\n        var point = { x: 0, y: 0 };\n        var _a = obj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY, width = _a.width, height = _a.height;\n        var center = { x: startX + (width / 2), y: startY + (height / 2) };\n        var cosAngle = Math.cos(obj.rotatedAngle);\n        var sinAngle = Math.sin(obj.rotatedAngle);\n        var p1 = { x: cosAngle * (startX - center.x) - sinAngle * (startY - center.y) + center.x,\n            y: sinAngle * (startX - center.x) + cosAngle * (startY - center.y) + center.y };\n        var p2 = { x: cosAngle * (endX - center.x) - sinAngle * (startY - center.y) + center.x,\n            y: sinAngle * (endX - center.x) + cosAngle * (startY - center.y) + center.y };\n        var p3 = { x: cosAngle * (startX - center.x) - sinAngle * (endY - center.y) + center.x,\n            y: sinAngle * (startX - center.x) + cosAngle * (endY - center.y) + center.y };\n        var p4 = { x: cosAngle * (endX - center.x) - sinAngle * (endY - center.y) + center.x,\n            y: sinAngle * (endX - center.x) + cosAngle * (endY - center.y) + center.y };\n        var degree = this.getRotDegOfShape(obj);\n        if (degree === 0 || degree === 360) {\n            point = { x: p1.x, y: p1.y };\n        }\n        else if (degree === 90 || degree === -270) {\n            point = { x: p2.x, y: p2.y };\n        }\n        else if (degree === 180 || degree === -180) {\n            point = { x: p4.x, y: p4.y };\n        }\n        else if (degree === 270 || degree === -90) {\n            point = { x: p3.x, y: p3.y };\n        }\n        if (object) {\n            object['x'] = point.x;\n            object['y'] = point.y;\n        }\n        return point;\n    };\n    Shape.prototype.setFlipState = function (x, y, obj, object) {\n        var parent = this.parent;\n        var panObj = { panRegion: '' };\n        var _a = parent.lowerCanvas, clientWidth = _a.clientWidth, clientHeight = _a.clientHeight;\n        var center = { x: 0, y: 0 };\n        parent.notify('crop', { prop: 'getCurrFlipState', onPropertyChange: false,\n            value: { panObj: panObj } });\n        if (panObj['panRegion'] !== '') {\n            if (panObj['panRegion'] === 'horizontal') {\n                center.x = clientWidth - (clientWidth / 2);\n                x = (center.x - x) + center.x;\n            }\n            else if (panObj['panRegion'] === 'vertical') {\n                center.y = clientHeight - (clientHeight / 2);\n                y = (center.y - y) + center.y;\n            }\n            else {\n                center = { x: clientWidth - (clientWidth / 2), y: clientHeight - (clientHeight / 2) };\n                x = (center.x - x) + center.x;\n                y = (center.y - y) + center.y;\n            }\n        }\n        if (object) {\n            object['x'] = x;\n            object['y'] = y;\n        }\n        return { x: x, y: y };\n    };\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    Shape.prototype.fileChanged = function (e) {\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var filesData = e.target.files[0];\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var fileData = filesData;\n        var fileExtension = fileData.name && fileData.name.split('.').pop().toLowerCase();\n        if (fileExtension && ['jpg', 'jpeg', 'png', 'svg'].indexOf(fileExtension) === -1) {\n            this.refreshActiveObj();\n            return;\n        }\n        // eslint-disable-next-line @typescript-eslint/tslint/config, @typescript-eslint/no-explicit-any\n        var URL = window.URL;\n        var url = URL.createObjectURL(e.target.files[0]);\n        this.onLoadImgShape(null, null, null, null, url.toString(), true);\n        document.getElementById(this.parent.element.id + '_fileUpload').value = '';\n    };\n    Shape.prototype.onLoadImgShape = function (x, y, width, height, url, isSelect, degree, isAspectRatio, opacity, isSelected) {\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        var proxy = this;\n        var parent = this.parent;\n        if (typeof (url) === 'string') {\n            this.shapeImg.src = url;\n        }\n        else {\n            parent.inMemoryCanvas.width = url.width;\n            parent.inMemoryCanvas.height = url.height;\n            parent.inMemoryCanvas.getContext('2d').putImageData(url, 0, 0);\n            this.shapeImg.src = parent.inMemoryCanvas.toDataURL();\n        }\n        this.prevObjColl();\n        parent.activeObj.shape = 'image';\n        this.initShapeProps();\n        this.shapeImg.onload = function () {\n            proxy.upperContext.drawImage(proxy.shapeImg, 0, 0, proxy.shapeImg.width, proxy.shapeImg.height);\n            proxy.updateImgCanvas(isSelect, x, y, width, height, degree, isAspectRatio, opacity, isSelected);\n        };\n    };\n    Shape.prototype.updateImgCanvas = function (isSelect, x, y, width, height, degree, isAspectRatio, opacity, isSelected) {\n        var parent = this.parent;\n        parent.activeObj.imageElement = this.shapeImg;\n        parent.activeObj.imageCanvas = parent.createElement('canvas');\n        var dimObj = { width: 0, height: 0 };\n        parent.notify('transform', { prop: 'calcMaxDimension', onPropertyChange: false,\n            value: { width: this.shapeImg.width, height: this.shapeImg.height, obj: dimObj, isImgShape: null } });\n        if (width && height) {\n            if (isAspectRatio) {\n                var obj_2 = { ratio: null };\n                parent.notify('selection', { prop: 'findImageRatio', onPropertyChange: false,\n                    value: { width: this.shapeImg.width, height: this.shapeImg.height, obj: obj_2 } });\n                dimObj = this.resizeImage(width, obj_2['ratio']);\n            }\n            else {\n                dimObj = { width: width, height: height };\n            }\n        }\n        this.updateObj(dimObj, x, y);\n        parent.notify('draw', { prop: 'downScaleImgCanvas', onPropertyChange: false,\n            value: { ctx: parent.activeObj.imageCanvas.getContext('2d'), isImgAnnotation: true, isHFlip: null, isVFlip: null } });\n        parent.notify('transform', { prop: 'calcMaxDimension', onPropertyChange: false,\n            value: { width: this.shapeImg.width, height: this.shapeImg.height, obj: dimObj, isImgShape: true } });\n        if (width && height) {\n            if (isAspectRatio) {\n                var obj_3 = { ratio: null };\n                parent.notify('selection', { prop: 'findImageRatio', onPropertyChange: false,\n                    value: { width: this.shapeImg.width, height: this.shapeImg.height, obj: obj_3 } });\n                dimObj = this.resizeImage(width, obj_3['ratio']);\n            }\n            else {\n                dimObj = { width: width, height: height };\n            }\n        }\n        if (opacity !== null && opacity !== undefined) {\n            parent.activeObj.opacity = opacity;\n        }\n        this.updateObj(dimObj, x, y);\n        parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate' } });\n        this.shapeImg = null;\n        if (degree) {\n            parent.activeObj.rotatedAngle = degree * (Math.PI / 180);\n            parent.notify('selection', { prop: 'updPtCollForShpRot', onPropertyChange: false, value: { obj: parent.activeObj } });\n        }\n        var obj = { shapeSettingsObj: {} };\n        parent.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: obj } });\n        var shapeSettings = obj['shapeSettingsObj'];\n        var shapeChangingArgs = { cancel: false, action: 'insert', previousShapeSettings: shapeSettings,\n            currentShapeSettings: shapeSettings };\n        parent.trigger('shapeChanging', shapeChangingArgs);\n        parent.editCompleteArgs = shapeChangingArgs;\n        isSelect = isSelect ? isSelect : isSelected;\n        this.drawShapeImageEvent(shapeChangingArgs, isSelect);\n        if (parent.isPublicMethod && !isSelected) {\n            parent.notify('undo-redo', { prop: 'updateUndoRedo', onPropertyChange: false });\n        }\n        else if (!parent.isPublicMethod) {\n            parent.notify('undo-redo', { prop: 'updateUndoRedoStack', onPropertyChange: false });\n        }\n        parent.isPublicMethod = false;\n    };\n    Shape.prototype.updateObj = function (dimObj, x, y) {\n        var parent = this.parent;\n        parent.activeObj.activePoint.width = dimObj['width'];\n        parent.activeObj.activePoint.height = dimObj['height'];\n        parent.activeObj.activePoint.startX = x ? x : (parent.lowerCanvas.width / 2) - (dimObj['width'] / 2);\n        parent.activeObj.activePoint.startY = y ? y : (parent.lowerCanvas.height / 2) - (dimObj['height'] / 2);\n        parent.activeObj.activePoint.endX = parent.activeObj.activePoint.startX + dimObj['width'];\n        parent.activeObj.activePoint.endY = parent.activeObj.activePoint.startY + dimObj['height'];\n    };\n    Shape.prototype.resizeImage = function (newWidth, aspectRatio) {\n        var aspectRatioArray = aspectRatio.split(':');\n        var aspectRatioWidth = parseInt(aspectRatioArray[0], 10);\n        var aspectRatioHeight = parseInt(aspectRatioArray[1], 10);\n        var newHeight = Math.round((newWidth * aspectRatioHeight) / aspectRatioWidth);\n        return { width: newWidth, height: newHeight };\n    };\n    Shape.prototype.setTextBoxPos = function (actObj, degree, flip, x, y) {\n        var point = { x: x, y: y };\n        var _a = actObj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY;\n        flip = flip.toLowerCase();\n        switch (degree) {\n            case 0:\n                if (flip === 'horizontal') {\n                    point.x = endX;\n                    point.y = startY;\n                }\n                else if (flip === 'vertical') {\n                    point.x = startX;\n                    point.y = endY;\n                }\n                else {\n                    point.x = startX;\n                    point.y = startY;\n                }\n                break;\n            case 90:\n                if (flip === 'horizontal') {\n                    point.x = startX;\n                    point.y = startY;\n                }\n                else if (flip === 'vertical') {\n                    point.x = endX;\n                    point.y = endY;\n                }\n                else {\n                    point.x = endX;\n                    point.y = startY;\n                }\n                break;\n            case 180:\n                if (flip === 'horizontal') {\n                    point.x = startX;\n                    point.y = endY;\n                }\n                else if (flip === 'vertical') {\n                    point.x = endX;\n                    point.y = startY;\n                }\n                else {\n                    point.x = endX;\n                    point.y = endY;\n                }\n                break;\n            case 270:\n                if (flip === 'horizontal') {\n                    point.x = endX;\n                    point.y = endY;\n                }\n                else if (flip === 'vertical') {\n                    point.x = startX;\n                    point.y = startY;\n                }\n                else {\n                    point.x = startX;\n                    point.y = endY;\n                }\n                break;\n        }\n        return point;\n    };\n    Shape.prototype.setTextBoxPoints = function (actObj, degree, flip, x, y) {\n        var point = { x: x, y: y };\n        var _a = actObj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY;\n        flip = flip.toLowerCase();\n        switch (degree) {\n            case 0:\n                if (actObj.flipObjColl[0] && actObj.flipObjColl[0].toLowerCase() === 'horizontal') {\n                    if (flip === 'horizontal') {\n                        point.x = startX;\n                        point.y = startY;\n                    }\n                    else if (flip === 'vertical') {\n                        point.x = endX;\n                        point.y = endY;\n                    }\n                }\n                else {\n                    if (flip === 'horizontal') {\n                        point.x = endX;\n                        point.y = endY;\n                    }\n                    else if (flip === 'vertical') {\n                        point.x = endX;\n                        point.y = startY;\n                    }\n                }\n                break;\n            case 90:\n                if (actObj.flipObjColl[0] && actObj.flipObjColl[0].toLowerCase() === 'horizontal') {\n                    if (flip === 'horizontal') {\n                        point.x = endX;\n                        point.y = endY;\n                    }\n                    else if (flip === 'vertical') {\n                        point.x = startX;\n                        point.y = endY;\n                    }\n                }\n                else {\n                    if (flip === 'horizontal') {\n                        point.x = startX;\n                        point.y = endY;\n                    }\n                    else if (flip === 'vertical') {\n                        point.x = startX;\n                        point.y = startY;\n                    }\n                }\n                break;\n            case 180:\n                if (actObj.flipObjColl[0] && actObj.flipObjColl[0].toLowerCase() === 'horizontal') {\n                    if (flip === 'horizontal') {\n                        point.x = startX;\n                        point.y = startY;\n                    }\n                    else if (flip === 'vertical') {\n                        point.x = startX;\n                        point.y = startY;\n                    }\n                }\n                else {\n                    if (flip === 'horizontal') {\n                        point.x = startX;\n                        point.y = startY;\n                    }\n                    else if (flip === 'vertical') {\n                        point.x = startX;\n                        point.y = endY;\n                    }\n                }\n                break;\n            case 270:\n                if (actObj.flipObjColl[0] && actObj.flipObjColl[0].toLowerCase() === 'horizontal') {\n                    if (flip === 'horizontal') {\n                        point.x = startX;\n                        point.y = startY;\n                    }\n                    else if (flip === 'vertical') {\n                        point.x = endX;\n                        point.y = startY;\n                    }\n                }\n                else {\n                    if (flip === 'horizontal') {\n                        point.x = endX;\n                        point.y = startY;\n                    }\n                    else if (flip === 'vertical') {\n                        point.x = endX;\n                        point.y = endY;\n                    }\n                }\n                break;\n        }\n        return point;\n    };\n    Shape.prototype.selectedText = function () {\n        var parent = this.parent;\n        var start = parent.textArea.selectionStart;\n        var finish = parent.textArea.selectionEnd;\n        return parent.textArea.value.substring(start, finish);\n    };\n    Shape.prototype.panObjColl = function (xDiff, yDiff, panRegion) {\n        var parent = this.parent;\n        if (parent.objColl.length > 0) {\n            for (var i = 0, len = parent.objColl.length; i < len; i++) {\n                var currObj = parent.objColl[i];\n                if (panRegion === '') {\n                    currObj.activePoint.startX += xDiff;\n                    currObj.activePoint.endX += xDiff;\n                    if (currObj.rotationCirclePointColl) {\n                        currObj.rotationCirclePointColl.x += xDiff;\n                    }\n                    if (currObj.shape === 'path') {\n                        for (var l = 0, len_3 = currObj.pointColl.length; l < len_3; l++) {\n                            currObj.pointColl[l].x += xDiff;\n                        }\n                    }\n                    currObj.activePoint.startY += yDiff;\n                    currObj.activePoint.endY += yDiff;\n                    if (currObj.rotationCirclePointColl) {\n                        currObj.rotationCirclePointColl.y += yDiff;\n                    }\n                    if (currObj.shape === 'path') {\n                        for (var l = 0; l < currObj.pointColl.length; l++) {\n                            currObj.pointColl[l].y += yDiff;\n                        }\n                    }\n                }\n                currObj = this.updateWidthHeight(currObj);\n                parent.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: currObj.activePoint,\n                        obj: currObj } });\n                if (currObj.shape === 'line' || currObj.shape === 'arrow') {\n                    currObj.pointColl = this.getLinePoints(currObj.activePoint.startX, currObj.activePoint.startY, currObj.activePoint.endX, currObj.activePoint.endY);\n                    for (var j = 0, len_4 = currObj.pointColl.length; j < len_4; j++) {\n                        currObj.pointColl[j].ratioX =\n                            (currObj.pointColl[j].x - parent.img.destLeft) / parent.img.destWidth;\n                        currObj.pointColl[j].ratioY =\n                            (currObj.pointColl[j].y - parent.img.destTop) / parent.img.destHeight;\n                    }\n                }\n                this.refreshActiveObj();\n            }\n            var temp = this.lowerContext.filter;\n            this.lowerContext.filter = 'none';\n            this.iterateObjColl();\n            this.lowerContext.filter = temp;\n            this.refreshActiveObj();\n            parent.notify('draw', { prop: 'applyFrame', value: { ctx: this.lowerContext, frame: parent.frameObj.type, preventImg: true } });\n        }\n    };\n    Shape.prototype.updateFontStyles = function (isTextBox) {\n        var parent = this.parent;\n        this.upperContext.strokeStyle = parent.activeObj.strokeSettings.strokeColor;\n        this.upperContext.fillStyle = parent.activeObj.strokeSettings.strokeColor;\n        var textStyle = '';\n        if (parent.activeObj.textSettings.bold) {\n            textStyle = 'bold ';\n        }\n        if (parent.activeObj.textSettings.italic) {\n            textStyle = 'italic ';\n        }\n        if (parent.activeObj.textSettings.bold && parent.activeObj.textSettings.italic) {\n            textStyle = 'italic bold ';\n        }\n        var fontSize = isTextBox ? parseFloat(parent.textArea.style.fontSize) : parent.activeObj.textSettings.fontSize;\n        var fontFamily = (parent.textArea.style.display === 'block' || parent.textArea.style.display === 'inline-block') ?\n            parent.textArea.style.fontFamily : parent.activeObj.textSettings.fontFamily;\n        this.upperContext.font = textStyle + fontSize + 'px' + ' ' + fontFamily;\n    };\n    Shape.prototype.applyFontStyle = function (item) {\n        var parent = this.parent;\n        var obj = { shapeSettingsObj: {} };\n        parent.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: obj } });\n        var shapeSettings = obj['shapeSettingsObj'];\n        this.pushActItemIntoObj();\n        var objColl = extend([], parent.objColl, [], true);\n        parent.objColl.pop();\n        if (parent.textArea.style.display === 'none') {\n            this.updateFontRatio(parent.activeObj);\n        }\n        else {\n            this.updateFontRatio(parent.activeObj, true);\n        }\n        switch (item) {\n            case 'default':\n                this.updateFontStyle(item, objColl, 'normal', 'normal');\n                break;\n            case 'bold':\n                this.updateFontStyle(item, objColl, 'bold', 'normal');\n                break;\n            case 'italic':\n                this.updateFontStyle(item, objColl, 'normal', 'italic');\n                break;\n            case 'bolditalic':\n                this.updateFontStyle(item, objColl, 'bold', 'italic');\n                break;\n        }\n        var shapeChangedArgs = { action: 'font-style', currentShapeSettings: extend({}, shapeSettings, {}, true) };\n        shapeChangedArgs.currentShapeSettings.fontStyle = [item];\n        parent.trigger('shapeChange', shapeChangedArgs);\n        parent.editCompleteArgs = shapeChangedArgs;\n    };\n    Shape.prototype.updateFontStyle = function (item, objColl, fontWeight, fontStyle) {\n        var parent = this.parent;\n        var style = parent.textArea.style;\n        if (style.display === 'block' || style.display === 'inline-block') {\n            if (style.fontWeight === 'normal' && fontWeight === 'bold') {\n                style.fontWeight = 'bold';\n            }\n            else if (style.fontWeight === 'bold' && fontWeight === 'bold') {\n                style.fontWeight = 'normal';\n            }\n            if (style.fontStyle === 'normal' && fontStyle === 'italic') {\n                style.fontStyle = 'italic';\n            }\n            else if (style.fontStyle === 'italic' && fontStyle === 'italic') {\n                style.fontStyle = 'normal';\n            }\n            var value = (style.fontWeight === 'normal' && style.fontStyle === 'normal' ? 'default' :\n                (style.fontWeight === 'bold' && style.fontStyle === 'normal' ? 'bold' :\n                    (style.fontWeight === 'normal' && style.fontStyle === 'italic' ? 'italic' : 'bolditalic')));\n            var width = this.getTextAreaWidth(value);\n            style.width = width + 'px';\n            this.updateObjColl(item, objColl);\n        }\n        else {\n            this.textSettings.bold = parent.activeObj.textSettings.bold = fontWeight === 'normal' ? false : true;\n            this.textSettings.italic = parent.activeObj.textSettings.italic = fontStyle === 'normal' ? false : true;\n            if (parent.activeObj.activePoint.width !== 0 || parent.activeObj.activePoint.height !== 0) {\n                this.redrawText();\n            }\n            parent.notify('undo-redo', { prop: 'updateUrObj', onPropertyChange: false, value: { objColl: objColl } });\n        }\n    };\n    Shape.prototype.updateArrowRatio = function (obj) {\n        var parent = this.parent;\n        var object = { arrowDimension: null };\n        parent.notify('draw', { prop: 'getArrowDimension', onPropertyChange: false, value: { obj: object } });\n        var length;\n        if (Math.abs(obj.activePoint.width) > Math.abs(obj.activePoint.height)) {\n            length = Math.abs(obj.activePoint.width);\n        }\n        else {\n            length = Math.abs(obj.activePoint.height);\n        }\n        var dimension;\n        var dimensions = ['bar', 'arrow', 'arrowSolid', 'circle', 'square'];\n        for (var _i = 0, dimensions_1 = dimensions; _i < dimensions_1.length; _i++) {\n            dimension = dimensions_1[_i];\n            var ratioX = length / object['arrowDimension'][dimension]['width'];\n            var ratioY = length / object['arrowDimension'][dimension]['height'];\n            object['arrowDimension'][dimension]['ratioX'] = ratioX;\n            object['arrowDimension'][dimension]['ratioY'] = ratioY;\n        }\n    };\n    Shape.prototype.updateArrowSize = function (obj) {\n        var object = { arrowDimension: null };\n        this.parent.notify('draw', { prop: 'getArrowDimension', onPropertyChange: false, value: { obj: object } });\n        var length;\n        if (Math.abs(obj.activePoint.width) > Math.abs(obj.activePoint.height)) {\n            length = Math.abs(obj.activePoint.width);\n        }\n        else {\n            length = Math.abs(obj.activePoint.height);\n        }\n        var dimension;\n        var dimensions = ['bar', 'arrow', 'arrowSolid', 'circle', 'square'];\n        for (var _i = 0, dimensions_2 = dimensions; _i < dimensions_2.length; _i++) {\n            dimension = dimensions_2[_i];\n            var ratioX = object['arrowDimension'][dimension]['ratioX'];\n            var ratioY = object['arrowDimension'][dimension]['ratioY'];\n            object['arrowDimension'][dimension]['width'] = length / ratioX;\n            object['arrowDimension'][dimension]['height'] = length / ratioY;\n        }\n    };\n    Shape.prototype.updateFontRatio = function (obj, isTextArea) {\n        var parent = this.parent;\n        var text = this.getMaxText(isTextArea);\n        var width = this.upperContext.measureText(text).width +\n            parent.activeObj.textSettings.fontSize * 0.5;\n        var height = parent.activeObj.textSettings.fontSize;\n        var degree = this.getRotDegOfShape(obj);\n        if (isNullOrUndefined(isTextArea)) {\n            if (degree === 0 || Math.abs(degree) === 180) {\n                obj.textSettings.fontRatio = width / obj.textSettings.fontSize;\n            }\n            else {\n                obj.textSettings.fontRatio = height / obj.textSettings.fontSize;\n            }\n        }\n        else if (isTextArea) {\n            obj.textSettings.fontRatio = width / parseFloat(parent.textArea.style.fontSize);\n        }\n    };\n    Shape.prototype.updateFontSize = function (obj) {\n        var degree = this.getRotDegOfShape(obj);\n        if (degree === 0 || Math.abs(degree) === 180) {\n            obj.textSettings.fontSize = (obj.activePoint.width / obj.textSettings.fontRatio);\n        }\n        else {\n            obj.textSettings.fontSize = (obj.activePoint.height / obj.textSettings.fontRatio);\n        }\n    };\n    Shape.prototype.updateObjColl = function (item, objColl) {\n        var parent = this.parent;\n        var prevCropObj = extend({}, parent.cropObj, {}, true);\n        var object = { currObj: {} };\n        parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        var prevObj = object['currObj'];\n        prevObj.objColl = objColl;\n        prevObj.pointColl = extend([], parent.pointColl, [], true);\n        prevObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: selPointCollObj } });\n        prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        var tempBold = parent.activeObj.textSettings.bold;\n        var tempItalic = parent.activeObj.textSettings.italic;\n        switch (item) {\n            case 'default':\n                parent.activeObj.textSettings.bold = false;\n                parent.activeObj.textSettings.italic = false;\n                break;\n            case 'bold':\n                parent.activeObj.textSettings.bold = true;\n                parent.activeObj.textSettings.italic = false;\n                break;\n            case 'italic':\n                parent.activeObj.textSettings.bold = false;\n                parent.activeObj.textSettings.italic = true;\n                break;\n            case 'bolditalic':\n                parent.activeObj.textSettings.bold = true;\n                parent.activeObj.textSettings.italic = true;\n                break;\n        }\n        parent.objColl.push(parent.activeObj);\n        parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n            value: { operation: 'textAreaCustomization', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                previousCropObj: prevCropObj, previousText: null,\n                currentText: null, previousFilter: null, isCircleCrop: null } });\n        parent.objColl.pop();\n        parent.activeObj.textSettings.bold = tempBold;\n        parent.activeObj.textSettings.italic = tempItalic;\n    };\n    Shape.prototype.pushActItemIntoObj = function () {\n        var parent = this.parent;\n        if (parent.textArea.style.display === 'none') {\n            if (parent.activeObj.activePoint.width !== 0 || parent.activeObj.activePoint.height !== 0) {\n                parent.objColl.push(parent.activeObj);\n            }\n        }\n        else {\n            var temp = extend({}, parent.activeObj, {}, true);\n            parent.notify('selection', { prop: 'setTextBoxStylesToActObj', onPropertyChange: false });\n            parent.objColl.push(parent.activeObj);\n            parent.activeObj = temp;\n        }\n    };\n    Shape.prototype.clearActObj = function () {\n        var parent = this.parent;\n        if (parent.textArea.style.display === 'none') {\n            this.refreshActiveObj();\n            this.applyActObj();\n            this.refreshActiveObj();\n            parent.currObjType.isCustomCrop = false;\n        }\n    };\n    Shape.prototype.refreshActiveObj = function () {\n        var parent = this.parent;\n        parent.activeObj = {};\n        parent.activeObj.activePoint = { startX: 0, startY: 0, endX: 0, endY: 0, width: 0, height: 0 };\n        parent.activeObj.triangle = [];\n        parent.activeObj.triangleRatio = [];\n        parent.activeObj.order = null;\n        parent.activeObj.flipObjColl = [];\n        parent.activeObj.strokeSettings = this.strokeSettings;\n        parent.activeObj.textSettings = this.textSettings;\n        parent.activeObj.rotatedAngle = 0;\n        parent.activeObj.opacity = 1;\n        parent.activeObj.redactType = this.redactType;\n        parent.activeObj.redactBlur = parent.tempRedactBlur;\n        parent.activeObj.redactPixelate = parent.tempRedactPixel;\n    };\n    Shape.prototype.applyActObj = function (isMouseDown) {\n        var parent = this.parent;\n        var isActObj = false;\n        if (parent.activeObj.shape !== undefined && parent.activeObj.shape === 'text' && parent.activeObj.keyHistory === '') {\n            this.refreshActiveObj();\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        }\n        else {\n            var splitWords = void 0;\n            var isCropSelection = false;\n            if (parent.activeObj.shape !== undefined) {\n                splitWords = parent.activeObj.shape.split('-');\n            }\n            if (splitWords === undefined && parent.currObjType.isCustomCrop) {\n                isCropSelection = true;\n            }\n            else if (splitWords !== undefined && splitWords[0] === 'crop') {\n                isCropSelection = true;\n            }\n            if (parent.activeObj.shape && !isCropSelection && parent.activeObj.shape !== 'shape') {\n                for (var i = 0; i < parent.objColl.length; i++) {\n                    if (JSON.stringify(parent.activeObj) === JSON.stringify(parent.objColl[i])) {\n                        isActObj = true;\n                        break;\n                    }\n                }\n                if (!isActObj) {\n                    if (isNullOrUndefined(parent.activeObj.currIndex)) {\n                        parent.activeObj.currIndex = this.getNewShapeId();\n                    }\n                    if (isNullOrUndefined(parent.activeObj.order)) {\n                        parent.activeObj.order = this.getNewOrder();\n                    }\n                    this.updImgRatioForActObj();\n                    var splitWords_1 = parent.activeObj.currIndex.split('_');\n                    var tempObjColl = parent.objColl.splice(0, parseInt(splitWords_1[1], 10) - 1);\n                    tempObjColl.push(extend({}, parent.activeObj, {}, true));\n                    for (var i = 0; i < parent.objColl.length; i++) {\n                        tempObjColl.push(parent.objColl[i]);\n                    }\n                    parent.objColl = tempObjColl;\n                    tempObjColl = [];\n                    this.refreshActiveObj();\n                    this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n                    parent.notify('draw', { prop: 'redrawImgWithObj', onPropertyChange: false });\n                    parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n                    parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.upperContext } });\n                    parent.currObjType.shape = '';\n                    this.refreshActiveObj();\n                    if (parent.isCircleCrop) {\n                        parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                            value: { context: this.lowerContext, isSave: null, isFlip: null } });\n                    }\n                    parent.notify('toolbar', { prop: 'destroy-qa-toolbar', onPropertyChange: false });\n                    if (isNullOrUndefined(isMouseDown)) {\n                        parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n                        parent.notify('draw', { prop: 'setPrevActObj', onPropertyChange: false, value: { prevActObj: null } });\n                    }\n                }\n            }\n        }\n    };\n    Shape.prototype.getNewShapeId = function () {\n        var parent = this.parent;\n        var value = parent.objColl.length + 1;\n        for (var i = 0; i < parent.objColl.length; i++) {\n            if (parent.objColl[i].currIndex === 'shape_' + value) {\n                value++;\n                i = -1;\n            }\n        }\n        return 'shape_' + value;\n    };\n    Shape.prototype.getNewOrder = function () {\n        var parent = this.parent;\n        this.updateShapeColl();\n        var value = parent.shapeColl.length + 1;\n        for (var i = 0; i < parent.shapeColl.length; i++) {\n            if (parent.shapeColl[i].order === value) {\n                value++;\n                i = -1;\n            }\n        }\n        return value;\n    };\n    Shape.prototype.getHighestOrder = function () {\n        var parent = this.parent;\n        this.updateShapeColl();\n        var value = 0;\n        for (var i = 0; i < parent.shapeColl.length; i++) {\n            if (parent.shapeColl[i].order > value) {\n                value = parent.shapeColl[i].order;\n            }\n        }\n        return value;\n    };\n    Shape.prototype.getLowestOrder = function () {\n        var parent = this.parent;\n        this.updateShapeColl();\n        var value = 1;\n        for (var i = 0; i < parent.shapeColl.length; i++) {\n            if (parent.shapeColl[i].order < value) {\n                value = parent.shapeColl[i].order;\n            }\n        }\n        return value;\n    };\n    Shape.prototype.alignTextAreaIntoCanvas = function () {\n        var parent = this.parent;\n        var letters = parent.textArea.value;\n        parent.textArea.value = '';\n        for (var i = 0, len = letters.length; i < len; i++) {\n            parent.textArea.value += letters[i];\n            parent.textArea.style.height = 'auto';\n            parent.textArea.style.height = parent.textArea.scrollHeight + 'px';\n            this.setTextBoxWidth();\n        }\n    };\n    Shape.prototype.transformTextArea = function () {\n        var parent = this.parent;\n        if (parent.activeObj.shape === 'text') {\n            parent.textArea.style.transformOrigin = '0 0';\n            var rotatedDegree = parent.activeObj.rotatedAngle * (180 / Math.PI);\n            var scale = '';\n            var degree = this.getRotDegOfShape(parent.activeObj);\n            if (parent.activeObj.flipObjColl.length > 0) {\n                for (var i = 0; i < parent.activeObj.flipObjColl.length; i++) {\n                    if (degree !== 0 && degree % 90 === 0 && degree !== 180) {\n                        scale += parent.activeObj.flipObjColl[i].toLowerCase() === 'horizontal' ? 'scale(1, -1)' :\n                            'scale(-1, 1)';\n                    }\n                    else {\n                        scale += parent.activeObj.flipObjColl[i].toLowerCase() === 'horizontal' ? 'scale(-1, 1)' :\n                            'scale(1, -1)';\n                    }\n                    degree += rotatedDegree;\n                    if (parent.activeObj.flipObjColl[i].toLowerCase() === 'horizontal') {\n                        parent.textArea.style.transform = 'rotate(' + degree + 'deg)' + scale;\n                    }\n                    else if (parent.activeObj.flipObjColl[i].toLowerCase() === 'vertical') {\n                        parent.textArea.style.transform = 'rotate(' + degree + 'deg)' + scale;\n                    }\n                }\n            }\n            else {\n                degree += rotatedDegree;\n                parent.textArea.style.transform = 'rotate(' + degree + 'deg)';\n            }\n        }\n    };\n    Shape.prototype.getTextAreaWidth = function (item) {\n        var parent = this.parent;\n        var tempBold = parent.activeObj.textSettings.bold;\n        var tempItalic = parent.activeObj.textSettings.italic;\n        switch (item) {\n            case 'default':\n                parent.activeObj.textSettings.bold = false;\n                parent.activeObj.textSettings.italic = false;\n                break;\n            case 'bold':\n                parent.activeObj.textSettings.bold = true;\n                parent.activeObj.textSettings.italic = false;\n                break;\n            case 'italic':\n                parent.activeObj.textSettings.bold = false;\n                parent.activeObj.textSettings.italic = true;\n                break;\n            case 'bolditalic':\n                parent.activeObj.textSettings.bold = true;\n                parent.activeObj.textSettings.italic = true;\n                break;\n        }\n        var isTextArea = parent.textArea.style.display === 'none' ? false : true;\n        this.updateFontStyles(isTextArea);\n        var width;\n        if (!isTextArea) {\n            width = this.upperContext.measureText(parent.activeObj.keyHistory).width +\n                parent.activeObj.textSettings.fontSize * 0.5;\n        }\n        else {\n            width = this.upperContext.measureText(parent.textArea.value).width +\n                parent.activeObj.textSettings.fontSize * 0.5;\n        }\n        parent.activeObj.textSettings.bold = tempBold;\n        parent.activeObj.textSettings.italic = tempItalic;\n        return width;\n    };\n    Shape.prototype.getRedactObjDetails = function (obj) {\n        var parent = this.parent;\n        var redactDetails = {};\n        redactDetails.id = obj.currIndex;\n        redactDetails.type = parent.toPascalCase(obj.redactType);\n        redactDetails.startX = obj.activePoint.startX;\n        redactDetails.startY = obj.activePoint.startY;\n        redactDetails.width = obj.activePoint.width;\n        redactDetails.height = obj.activePoint.height;\n        switch (obj.redactType) {\n            case 'blur':\n                redactDetails.blurIntensity = obj.redactBlur;\n                break;\n            case 'pixelate':\n                redactDetails.pixelSize = obj.redactPixelate;\n                break;\n        }\n        return redactDetails;\n    };\n    Shape.prototype.getObjDetails = function (obj) {\n        var parent = this.parent;\n        var shapeDetails = {};\n        shapeDetails.id = obj.currIndex;\n        shapeDetails.type = parent.toPascalCase(obj.shape);\n        shapeDetails.startX = obj.activePoint.startX;\n        shapeDetails.startY = obj.activePoint.startY;\n        shapeDetails.index = obj.order;\n        switch (obj.shape) {\n            case 'rectangle':\n                shapeDetails.width = obj.activePoint.width;\n                shapeDetails.height = obj.activePoint.height;\n                shapeDetails.strokeColor = obj.strokeSettings.strokeColor;\n                shapeDetails.fillColor = obj.strokeSettings.fillColor;\n                shapeDetails.strokeWidth = obj.strokeSettings.strokeWidth;\n                shapeDetails.degree = obj.rotatedAngle * (180 / Math.PI);\n                break;\n            case 'ellipse':\n                shapeDetails.radius = obj.activePoint.width / 2;\n                shapeDetails.strokeColor = obj.strokeSettings.strokeColor;\n                shapeDetails.fillColor = obj.strokeSettings.fillColor;\n                shapeDetails.strokeWidth = obj.strokeSettings.strokeWidth;\n                shapeDetails.radiusX = obj.activePoint.width / 2;\n                shapeDetails.radiusY = obj.activePoint.height / 2;\n                shapeDetails.degree = obj.rotatedAngle * (180 / Math.PI);\n                break;\n            case 'line':\n            case 'arrow':\n                shapeDetails.length = obj.activePoint.width;\n                shapeDetails.strokeColor = obj.strokeSettings.strokeColor;\n                shapeDetails.strokeWidth = obj.strokeSettings.strokeWidth;\n                shapeDetails.endX = obj.activePoint.endX;\n                shapeDetails.endY = obj.activePoint.endY;\n                if (obj.shape === 'arrow') {\n                    var arrowObj = { type: null };\n                    parent.notify('selection', { prop: 'getArrowType', onPropertyChange: false, value: { type: obj.start, obj: arrowObj } });\n                    shapeDetails.arrowHead = arrowObj['type'];\n                    parent.notify('selection', { prop: 'getArrowType', onPropertyChange: false, value: { type: obj.end, obj: arrowObj } });\n                    shapeDetails.arrowTail = arrowObj['type'];\n                }\n                break;\n            case 'text':\n                shapeDetails.text = obj.keyHistory;\n                shapeDetails.fontSize = obj.textSettings.fontSize;\n                shapeDetails.fontFamily = obj.textSettings.fontFamily;\n                shapeDetails.color = obj.strokeSettings.strokeColor;\n                shapeDetails.fontStyle = [];\n                if (obj.textSettings.bold) {\n                    shapeDetails.fontStyle.push('bold');\n                }\n                if (obj.textSettings.italic) {\n                    shapeDetails.fontStyle.push('italic');\n                }\n                shapeDetails.degree = obj.rotatedAngle * (180 / Math.PI);\n                break;\n            case 'path':\n                shapeDetails.strokeColor = obj.strokeSettings.strokeColor;\n                shapeDetails.strokeWidth = obj.strokeSettings.strokeWidth;\n                shapeDetails.points = obj.pointColl;\n                break;\n            case 'image':\n                shapeDetails.imageData = obj.imageCanvas.toDataURL();\n                shapeDetails.degree = obj.rotatedAngle * (180 / Math.PI);\n                shapeDetails.width = obj.activePoint.width;\n                shapeDetails.height = obj.activePoint.height;\n                shapeDetails.opacity = obj.opacity;\n                break;\n        }\n        return shapeDetails;\n    };\n    Shape.prototype.getFreehandDrawDetails = function (index) {\n        var parent = this.parent;\n        var shapeDetails = {};\n        shapeDetails.id = parent.pointColl[index].id;\n        shapeDetails.type = ShapeType.FreehandDraw;\n        shapeDetails.points = extend([], parent.pointColl[index].points);\n        shapeDetails.strokeColor = parent.pointColl[index].strokeColor;\n        shapeDetails.strokeWidth = parent.pointColl[index].strokeWidth;\n        shapeDetails.index = parent.pointColl[index].order;\n        return shapeDetails;\n    };\n    Shape.prototype.getShapeSetting = function (id, obj) {\n        var parent = this.parent;\n        var shapeDetails;\n        if (!parent.disabled && parent.isImageLoaded) {\n            if (parent.textArea.style.display !== 'none') {\n                parent.okBtn(null, true);\n            }\n            else {\n                this.applyActObj(true);\n            }\n            if (id.split('_')[0] === 'shape') {\n                var obj_4;\n                for (var i = 0, len = parent.objColl.length; i < len; i++) {\n                    if (parent.objColl[i].currIndex === id) {\n                        obj_4 = extend({}, parent.objColl[i], {}, true);\n                        break;\n                    }\n                }\n                shapeDetails = this.getObjDetails(obj_4);\n            }\n            else if (id.split('_')[0] === 'pen') {\n                shapeDetails = this.getFreehandDrawDetails(parseInt(id.split('_')[1], 10) - 1);\n            }\n        }\n        obj['shapeDetails'] = shapeDetails;\n    };\n    Shape.prototype.getShapeSettings = function (obj) {\n        var parent = this.parent;\n        var shapeDetailsColl = [];\n        if (!parent.disabled && parent.isImageLoaded) {\n            if (parent.textArea.style.display !== 'none') {\n                parent.okBtn(null, true);\n            }\n            else {\n                this.applyActObj(true);\n            }\n            for (var i = 0, len = parent.objColl.length; i < len; i++) {\n                var shapeDetails = this.getObjDetails(parent.objColl[i]);\n                shapeDetailsColl.push(shapeDetails);\n            }\n            for (var i = 0; i < parent.freehandCounter; i++) {\n                var shapeDetails = this.getFreehandDrawDetails(i);\n                shapeDetailsColl.push(shapeDetails);\n            }\n        }\n        obj['shapeDetailsColl'] = shapeDetailsColl;\n    };\n    Shape.prototype.getRedactSettings = function (obj) {\n        var parent = this.parent;\n        var RedactDetailsColl = [];\n        if (!parent.disabled && parent.isImageLoaded) {\n            if (parent.textArea.style.display !== 'none') {\n                parent.okBtn(null, true);\n            }\n            else {\n                this.applyActObj(true);\n            }\n            for (var i = 0, len = parent.objColl.length; i < len; i++) {\n                var redactDetails = this.getRedactObjDetails(parent.objColl[i]);\n                RedactDetailsColl.push(redactDetails);\n            }\n        }\n        obj['shapeDetailsColl'] = RedactDetailsColl;\n    };\n    Shape.prototype.isPointsInRange = function (x, y, obj) {\n        var inRange = false;\n        var parent = this.parent;\n        if (!isNullOrUndefined(x) && !isNullOrUndefined(y) && x >= parent.img.destLeft && y >= parent.img.destTop &&\n            x <= parent.img.destLeft + parent.img.destWidth && y <= parent.img.destTop + parent.img.destHeight) {\n            inRange = true;\n        }\n        obj['inRange'] = inRange;\n    };\n    Shape.prototype.alignRotateFlipColl = function (collection, isRotateFlipCollection, obj) {\n        collection = this.popForDefaultTransformedState(collection);\n        collection = this.popForDefaultFlipState(collection);\n        collection = this.popForDefaultRotateState(collection);\n        if (collection.length === 0 && isRotateFlipCollection) {\n            this.parent.transform.degree = 0;\n            this.parent.transform.currFlipState = '';\n        }\n        obj['collection'] = collection;\n        return collection;\n    };\n    Shape.prototype.popForDefaultTransformedState = function (collection) {\n        var rotateRight = 0;\n        var rotateleft = 0;\n        var horizontal = 0;\n        var vertical = 0;\n        for (var i = 0; i < collection.length; i++) {\n            if (collection[i] === 90 || collection[i] === 'rotateRight') {\n                rotateRight++;\n                rotateleft = 0;\n                horizontal = 0;\n                vertical = 0;\n                if (rotateRight === 4) {\n                    collection.pop();\n                    collection.pop();\n                    collection.pop();\n                    collection.pop();\n                }\n            }\n            else if (collection[i] === -90 || collection[i] === 'rotateLeft') {\n                rotateleft++;\n                rotateRight = 0;\n                horizontal = 0;\n                vertical = 0;\n                if (rotateleft === 4) {\n                    collection.pop();\n                    collection.pop();\n                    collection.pop();\n                    collection.pop();\n                }\n            }\n            else if (collection[i] === 'horizontal' || collection[i] === 'Horizontal'\n                || collection[i] === 'horizontalflip') {\n                horizontal++;\n                rotateleft = 0;\n                rotateRight = 0;\n                vertical = 0;\n                if (horizontal === 2) {\n                    collection.pop();\n                    collection.pop();\n                }\n            }\n            else if (collection[i] === 'vertical' || collection[i] === 'Vertical'\n                || collection[i] === 'verticalflip') {\n                vertical++;\n                horizontal = 0;\n                rotateleft = 0;\n                rotateRight = 0;\n                if (vertical === 2) {\n                    collection.pop();\n                    collection.pop();\n                }\n            }\n        }\n        return collection;\n    };\n    Shape.prototype.popForDefaultFlipState = function (collection) {\n        for (var i = 0, iLen = collection.length - 3; i < iLen; i++) {\n            var isHorizontal = collection[i] === 'horizontal' || collection[i] === 'Horizontal'\n                || collection[i] === 'horizontalFlip';\n            var isVertical = collection[i] === 'vertical' || collection[i] === 'Vertical' ||\n                collection[i] === 'verticalFlip';\n            var isNextHorizontal = collection[i + 1] === 'horizontal' || collection[i + 1] === 'Horizontal' ||\n                collection[i + 1] === 'horizontalFlip';\n            var isNextVertical = collection[i + 1] === 'vertical' || collection[i + 1] === 'Vertical' ||\n                collection[i + 1] === 'verticalFlip';\n            var isNextToNextHorizontal = collection[i + 2] === 'horizontal' || collection[i + 2] === 'Horizontal' ||\n                collection[i + 2] === 'horizontalFlip';\n            var isNextToNextVertical = collection[i + 2] === 'vertical' || collection[i + 2] === 'Vertical' ||\n                collection[i + 2] === 'verticalFlip';\n            var isNextToNextToNextHorizontal = collection[i + 3] === 'horizontal' || collection[i + 3] === 'Horizontal' ||\n                collection[i + 3] === 'horizontalFlip';\n            if ((isHorizontal && isNextVertical && isNextToNextHorizontal && isNextToNextVertical) ||\n                (isVertical && isNextHorizontal && isNextToNextVertical && isNextToNextToNextHorizontal)) {\n                collection.splice(i, 4);\n                i -= 4;\n            }\n        }\n        return collection;\n    };\n    Shape.prototype.popForDefaultRotateState = function (collection) {\n        for (var i = 0; i < collection.length - 1; i++) {\n            var curr = collection[i];\n            var next = collection[i + 1];\n            if ((curr === 90 || curr === 'rotateRight') && (next === -90 || next === 'rotateLeft')) {\n                collection.splice(i, 2);\n                i -= 2;\n            }\n            else if ((curr === -90 || curr === 'rotateLeft') && (next === 90 || next === 'rotateRight')) {\n                collection.splice(i, 2);\n                i -= 2;\n            }\n        }\n        return collection;\n    };\n    Shape.prototype.selectShape = function (id, obj) {\n        var parent = this.parent;\n        var isSelected = false;\n        if (!parent.disabled && parent.isImageLoaded) {\n            this.applyActObj();\n            if (id.split('_')[0] === 'shape') {\n                var obj_5;\n                for (var i = 0, len = parent.objColl.length; i < len; i++) {\n                    if (parent.objColl[i].currIndex === id) {\n                        obj_5 = extend({}, parent.objColl[i], {}, true);\n                        break;\n                    }\n                }\n                if (isNullOrUndefined(obj_5)) {\n                    isSelected = false;\n                }\n                else {\n                    isSelected = true;\n                    parent.activeObj = obj_5;\n                    var object = { canvasFilter: null };\n                    parent.notify('toolbar', { prop: 'getCanvasFilter', onPropertyChange: false, value: { obj: object } });\n                    this.lowerContext.filter = object['canvasFilter'];\n                    parent.notify('selection', { prop: 'redrawShape', onPropertyChange: false,\n                        value: { obj: parent.activeObj } });\n                    if (parent.activeObj.shape === 'text') {\n                        parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'text',\n                                isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                    }\n                    else if (parent.activeObj.shape === 'pen') {\n                        parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'pen',\n                                isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                    }\n                    else if (parent.activeObj.shape === 'redact') {\n                        parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'redact',\n                                isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                    }\n                    else {\n                        parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'shapes',\n                                isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                    }\n                    parent.notify('toolbar', { prop: 'update-toolbar-items', onPropertyChange: false });\n                    parent.notify('toolbar', { prop: 'renderQAT', onPropertyChange: false, value: { isPenEdit: null } });\n                }\n            }\n            else if (id.split('_')[0] === 'pen') {\n                var object = { bool: false };\n                parent.notify('selection', { prop: 'getFreehandDrawEditing', onPropertyChange: false, value: { obj: object } });\n                if (object['bool']) {\n                    parent.okBtn(null, true);\n                }\n                var obj_6 = { isIndex: false };\n                parent.notify('freehand-draw', { prop: 'isFHDIdx', value: { index: parseInt(id.split('_')[1], 10) - 1, obj: obj_6 } });\n                if (obj_6['isIndex']) {\n                    isSelected = true;\n                    parent.notify('freehand-draw', { prop: 'selectFhd', value: { id: id } });\n                    parent.notify('toolbar', { prop: 'renderQAT', onPropertyChange: false, value: { isPenEdit: true } });\n                    parent.notify('toolbar', { prop: 'update-toolbar-items', onPropertyChange: false });\n                }\n                else {\n                    isSelected = false;\n                }\n            }\n        }\n        obj['isSelected'] = isSelected;\n    };\n    Shape.prototype.deleteShape = function (id) {\n        var parent = this.parent;\n        if (!parent.disabled && parent.isImageLoaded) {\n            if (parent.activeObj.currIndex && parent.activeObj.currIndex === id) {\n                parent.notify('selection', { prop: 'deleteItem', onPropertyChange: false });\n            }\n            else {\n                this.applyActObj();\n                if (id.split('_')[0] === 'shape') {\n                    for (var i = 0, len = parent.objColl.length; i < len; i++) {\n                        if (parent.objColl[i].currIndex === id) {\n                            parent.objColl.splice(i, 1);\n                            break;\n                        }\n                    }\n                }\n                else if (id.split('_')[0] === 'pen') {\n                    parent.notify('freehand-draw', { prop: 'handle-freehand-draw', value: { id: id } });\n                }\n            }\n            var object = { canvasFilter: null };\n            parent.notify('toolbar', { prop: 'getCanvasFilter', onPropertyChange: false, value: { obj: object } });\n            this.lowerContext.filter = object['canvasFilter'];\n            this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n            parent.notify('draw', { prop: 'redrawImgWithObj', onPropertyChange: false });\n            parent.notify('toolbar', { prop: 'refresh-main-toolbar', onPropertyChange: false });\n        }\n    };\n    Shape.prototype.getMaxText = function (isTextBox, text, obj) {\n        if (isNullOrUndefined(text)) {\n            text = isTextBox ? this.parent.textArea.value : this.parent.activeObj.keyHistory;\n        }\n        var maxi;\n        var rows = text.split('\\n');\n        var maxStr = rows[0].length;\n        var maxText = rows[0];\n        for (var i = 1; i < rows.length; i++) {\n            maxi = rows[i].length;\n            if (maxi > maxStr) {\n                maxText = rows[i];\n                maxStr = maxi;\n            }\n        }\n        if (obj) {\n            obj['maxText'] = maxText;\n        }\n        return maxText;\n    };\n    Shape.prototype.getLinePoints = function (x1, y1, x2, y2) {\n        var points = [];\n        var i;\n        var j;\n        if (x1 === x2) {\n            if (y1 < y2) {\n                i = [x1, y1];\n                j = [x2, y2];\n            }\n            else {\n                j = [x1, y1];\n                i = [x2, y2];\n            }\n            var m = this.getSlope(i, j, true);\n            var b = this.getIntercept(i, m);\n            for (var y = i[1]; y <= j[1]; y++) {\n                var x = m * y + b;\n                points.push({ x: x, y: y });\n            }\n        }\n        else {\n            if (x1 < x2) {\n                i = [x1, y1];\n                j = [x2, y2];\n            }\n            else {\n                j = [x1, y1];\n                i = [x2, y2];\n            }\n            var m = this.getSlope(i, j, false);\n            var b = this.getIntercept(i, m);\n            for (var x = i[0]; x <= j[0]; x++) {\n                var y = m * x + b;\n                points.push({ x: x, y: y });\n            }\n        }\n        if (Math.floor(x1) === Math.floor(x2) || (points.length < 10 && (y2 - y1 > 10 || y1 - y2 > 10))) {\n            points = [];\n            var lesserY = Math.min(y1, y2);\n            for (var i_1 = 0; i_1 < Math.abs(Math.floor(y2) - Math.floor(y1)); i_1++) {\n                points.push({ x: x1, y: lesserY + i_1 });\n            }\n            if (points.length > 1) {\n                var prev = void 0;\n                if (isNullOrUndefined(points[points.length - 2])) {\n                    prev = { x: 0, y: 0 };\n                }\n                else {\n                    prev = points[points.length - 2];\n                }\n                var diffX = points[points.length - 1]['x'] - prev.x;\n                var diffY = points[points.length - 1]['y'] - prev.y;\n                points.push({ x: points[points.length - 1]['x'] + (diffX / 2), y: points[points.length - 1]['y'] + (diffY / 2) });\n            }\n        }\n        else if (Math.floor(y1) === Math.floor(y2) || (points.length < 10 && (x2 - x1 > 10 || x1 - x2 > 10))) {\n            points = [];\n            var lesserX = Math.min(x1, x2);\n            for (var i_2 = 0; i_2 < Math.abs(Math.floor(x2) - Math.floor(x1)); i_2++) {\n                points.push({ x: lesserX + i_2, y: y1 });\n            }\n            if (points.length > 1) {\n                var prev = void 0;\n                if (isNullOrUndefined(points[points.length - 2])) {\n                    prev = { x: 0, y: 0 };\n                }\n                else {\n                    prev = points[points.length - 2];\n                }\n                var diffX = points[points.length - 1]['x'] - prev.x;\n                var diffY = points[points.length - 1]['y'] - prev.y;\n                points.push({ x: points[points.length - 1]['x'] + (diffX / 2), y: points[points.length - 1]['y'] + (diffY / 2) });\n            }\n        }\n        return points;\n    };\n    Shape.prototype.getSlope = function (a, b, isSameAxis) {\n        var slope;\n        if (isSameAxis) {\n            if (a[1] === b[1]) {\n                return null;\n            }\n            slope = (b[0] - a[0]) / (b[1] - a[1]);\n        }\n        else {\n            if (a[0] === b[0]) {\n                return null;\n            }\n            slope = (b[1] - a[1]) / (b[0] - a[0]);\n        }\n        return slope;\n    };\n    Shape.prototype.getIntercept = function (point, getSlope) {\n        if (getSlope === null) {\n            return point[0];\n        }\n        return point[1] - getSlope * point[0];\n    };\n    Shape.prototype.setPointCollForShapeRotation = function (obj) {\n        var parent = this.parent;\n        var _a = obj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY, width = _a.width, height = _a.height;\n        var center = { x: startX + (width / 2), y: startY +\n                (height / 2) };\n        var cosAngle = Math.cos(obj.rotatedAngle);\n        var sinAngle = Math.sin(obj.rotatedAngle);\n        var p1 = { x: cosAngle * (startX - center.x) - sinAngle * (startY - center.y) + center.x,\n            y: sinAngle * (startX - center.x) + cosAngle * (startY - center.y) + center.y };\n        var p2 = { x: cosAngle * (endX - center.x) - sinAngle * (startY - center.y) + center.x,\n            y: sinAngle * (endX - center.x) + cosAngle * (startY - center.y) + center.y };\n        var p3 = { x: cosAngle * (startX - center.x) - sinAngle * (endY - center.y) + center.x,\n            y: sinAngle * (startX - center.x) + cosAngle * (endY - center.y) + center.y };\n        var p4 = { x: cosAngle * (endX - center.x) - sinAngle * (endY - center.y) + center.x,\n            y: sinAngle * (endX - center.x) + cosAngle * (endY - center.y) + center.y };\n        obj.horTopLinePointColl = this.getLinePoints(p1.x, p1.y, p2.x, p2.y);\n        obj.horTopLinePointColl = this.getLinePoints(p1.x, p1.y, p2.x, p2.y);\n        obj.horBottomLinePointColl = this.getLinePoints(p3.x, p3.y, p4.x, p4.y);\n        obj.verLeftLinePointColl = this.getLinePoints(p1.x, p1.y, p3.x, p3.y);\n        obj.verRightLinePointColl = this.getLinePoints(p2.x, p2.y, p4.x, p4.y);\n        obj.verLeftLinePointColl.reverse();\n        obj.verRightLinePointColl.reverse();\n        for (var i = 0; i < obj.horTopLinePointColl.length; i++) {\n            obj.horTopLinePointColl[i].ratioX = (obj.horTopLinePointColl[i].x -\n                this.parent.img.destLeft) / this.parent.img.destWidth;\n            obj.horTopLinePointColl[i].ratioY = (obj.horTopLinePointColl[i].y -\n                this.parent.img.destTop) / this.parent.img.destHeight;\n        }\n        for (var i = 0; i < obj.horBottomLinePointColl.length; i++) {\n            obj.horBottomLinePointColl[i].ratioX = (obj.horBottomLinePointColl[i].x -\n                this.parent.img.destLeft) / this.parent.img.destWidth;\n            obj.horBottomLinePointColl[i].ratioY = (obj.horBottomLinePointColl[i].y -\n                this.parent.img.destTop) / this.parent.img.destHeight;\n        }\n        for (var i = 0; i < obj.verLeftLinePointColl.length; i++) {\n            obj.verLeftLinePointColl[i].ratioX = (obj.verLeftLinePointColl[i].x -\n                this.parent.img.destLeft) / this.parent.img.destWidth;\n            obj.verLeftLinePointColl[i].ratioY = (obj.verLeftLinePointColl[i].y -\n                this.parent.img.destTop) / this.parent.img.destHeight;\n        }\n        for (var i = 0; i < obj.verRightLinePointColl.length; i++) {\n            obj.verRightLinePointColl[i].ratioX = (obj.verRightLinePointColl[i].x -\n                this.parent.img.destLeft) / this.parent.img.destWidth;\n            obj.verRightLinePointColl[i].ratioY = (obj.verRightLinePointColl[i].y -\n                this.parent.img.destTop) / this.parent.img.destHeight;\n        }\n        if (parent.upperCanvas.style.cursor !== 'move') {\n            var object = { rotationCirclePoint: null };\n            parent.notify('selection', { prop: 'getTransRotationPoint', value: { obj: obj, object: object } });\n            var rotationCirclePoint = object['rotationCirclePoint'];\n            if (rotationCirclePoint) {\n                obj.rotationCirclePointColl = { x: cosAngle * (rotationCirclePoint.x - center.x) -\n                        sinAngle * (rotationCirclePoint.y - center.y) + center.x,\n                    y: sinAngle * (rotationCirclePoint.x - center.x) + cosAngle\n                        * (rotationCirclePoint.y - center.y) + center.y };\n                obj.rotationCirclePointColl.ratioX = (obj.rotationCirclePointColl.x - parent.img.destLeft) /\n                    parent.img.destWidth;\n                obj.rotationCirclePointColl.ratioY = (obj.rotationCirclePointColl.y - parent.img.destTop) /\n                    parent.img.destHeight;\n            }\n        }\n    };\n    Shape.prototype.getSquarePointForRotatedShape = function (obj, object) {\n        var point = { startX: 0, startY: 0, endX: 0, endY: 0, width: 0, height: 0 };\n        var _a = obj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY, width = _a.width, height = _a.height;\n        var center = { x: startX + (width / 2), y: startY + (height / 2) };\n        var cosAngle = Math.cos(obj.rotatedAngle);\n        var sinAngle = Math.sin(obj.rotatedAngle);\n        var p1 = { x: cosAngle * (startX - center.x) - sinAngle * (startY - center.y) + center.x,\n            y: sinAngle * (startX - center.x) + cosAngle * (startY - center.y) + center.y };\n        var p2 = { x: cosAngle * (endX - center.x) - sinAngle * (startY - center.y) + center.x,\n            y: sinAngle * (endX - center.x) + cosAngle * (startY - center.y) + center.y };\n        var p3 = { x: cosAngle * (startX - center.x) - sinAngle * (endY - center.y) + center.x,\n            y: sinAngle * (startX - center.x) + cosAngle * (endY - center.y) + center.y };\n        var p4 = { x: cosAngle * (endX - center.x) - sinAngle * (endY - center.y) + center.x,\n            y: sinAngle * (endX - center.x) + cosAngle * (endY - center.y) + center.y };\n        point.startX = p1.x;\n        point.startY = p1.y;\n        point.endX = p1.x;\n        point.endY = p1.y;\n        if (point.startX > p2.x) {\n            point.startX = p2.x;\n        }\n        if (point.startX > p3.x) {\n            point.startX = p3.x;\n        }\n        if (point.startX > p4.x) {\n            point.startX = p4.x;\n        }\n        if (point.startY > p2.y) {\n            point.startY = p2.y;\n        }\n        if (point.startY > p3.y) {\n            point.startY = p3.y;\n        }\n        if (point.startY > p4.y) {\n            point.startY = p4.y;\n        }\n        if (point.endX < p2.x) {\n            point.endX = p2.x;\n        }\n        if (point.endX < p3.x) {\n            point.endX = p3.x;\n        }\n        if (point.endX < p4.x) {\n            point.endX = p4.x;\n        }\n        if (point.endY < p2.y) {\n            point.endY = p2.y;\n        }\n        if (point.endY < p3.y) {\n            point.endY = p3.y;\n        }\n        if (point.endY < p4.y) {\n            point.endY = p4.y;\n        }\n        point.width = point.endX - point.startX;\n        point.height = point.endY - point.startY;\n        if (object) {\n            object['activePoint'] = point;\n        }\n        return point;\n    };\n    Shape.prototype.updateZOrder = function (obj, value) {\n        var parent = this.parent;\n        value = value.toLowerCase();\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        var object = obj;\n        if (isNullOrUndefined(object.order)) {\n            return;\n        }\n        var index;\n        var prevIndex;\n        var highestOrder = this.getHighestOrder();\n        this.updateShapeColl();\n        if (parent.shapeColl.length === 0) {\n            return;\n        }\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        var coll;\n        for (var i = 0; i < parent.shapeColl.length; i++) {\n            coll = parent.shapeColl[i];\n            if (object.id && object.id.indexOf('pen') > -1) {\n                if (coll.id && coll.id === object.id) {\n                    parent.shapeColl.splice(i, 1);\n                }\n            }\n            else if (coll.shape && coll.shape.indexOf('crop-') > -1) {\n                parent.shapeColl.splice(i, 1);\n            }\n        }\n        switch (value) {\n            case 'sendtoback':\n                prevIndex = object.order;\n                index = object.order;\n                object.order = 1;\n                break;\n            case 'sendbackward':\n                object.order -= 1;\n                index = object.order;\n                break;\n            case 'bringtofront':\n                prevIndex = object.order;\n                index = highestOrder;\n                object.order = index;\n                break;\n            case 'bringforward':\n                object.order += 1;\n                index = object.order;\n                break;\n        }\n        this.reArrangeObjColl(index, value, prevIndex);\n        if (object.id && object.id.indexOf('pen') > -1) {\n            this.reUpdateShapeColl(object);\n        }\n    };\n    Shape.prototype.reArrangeObjColl = function (index, value, prevIndex) {\n        var parent = this.parent;\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        var obj;\n        switch (value) {\n            case 'sendtoback':\n                for (var i = 0, len = parent.shapeColl.length; i < len; i++) {\n                    obj = parent.shapeColl[i];\n                    if (obj.order < prevIndex && obj.order <= index) {\n                        obj.order += 1;\n                        this.reUpdateShapeColl(obj);\n                    }\n                }\n                break;\n            case 'sendbackward':\n                for (var i = 0, len = parent.shapeColl.length; i < len; i++) {\n                    obj = parent.shapeColl[i];\n                    if (obj.order === index) {\n                        obj.order += 1;\n                        this.reUpdateShapeColl(obj);\n                        break;\n                    }\n                }\n                break;\n            case 'bringtofront':\n                for (var i = 0, len = parent.shapeColl.length; i < len; i++) {\n                    obj = parent.shapeColl[i];\n                    if (obj.order > prevIndex && obj.order <= index) {\n                        obj.order -= 1;\n                        this.reUpdateShapeColl(obj);\n                    }\n                }\n                break;\n            case 'bringforward':\n                for (var i = 0, len = parent.shapeColl.length; i < len; i++) {\n                    obj = parent.shapeColl[i];\n                    if (obj.order === index) {\n                        obj.order -= 1;\n                        this.reUpdateShapeColl(obj);\n                        break;\n                    }\n                }\n                break;\n        }\n    };\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    Shape.prototype.reorderRedact = function (tempObjColl) {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        var nonRedact = tempObjColl.filter(function (item) { return item.shape !== 'redact'; });\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        var redact = tempObjColl.filter(function (item) { return item.shape === 'redact'; });\n        return redact.concat(nonRedact);\n    };\n    Shape.prototype.updateShapeColl = function () {\n        var parent = this.parent;\n        var isOrdered = false;\n        var tempOrder = 1;\n        var tempObjColl = extend([], parent.objColl, [], true);\n        tempObjColl = this.reorderRedact(tempObjColl);\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        var tempPointColl = extend([], parent.pointColl, [], true);\n        if (parent.shapeColl.length > 0 &&\n            parent.shapeColl.length === parent.objColl.length + parent.pointColl.length) {\n            for (var i = 0; i < parent.shapeColl.length; i++) {\n                if (parent.shapeColl[i].order === tempOrder) {\n                    isOrdered = true;\n                    tempOrder++;\n                }\n                else {\n                    isOrdered = false;\n                    break;\n                }\n            }\n            if (isOrdered) {\n                for (var i = 0; i < parent.shapeColl.length; i++) {\n                    if (parent.shapeColl[i].currIndex &&\n                        parent.shapeColl[i].currIndex.indexOf('shape') > -1) {\n                        for (var j = 0; j < tempObjColl.length; j++) {\n                            if (parent.shapeColl[i].currIndex === tempObjColl[j].currIndex) {\n                                parent.shapeColl[i] = extend({}, tempObjColl[j], {}, true);\n                                tempObjColl.splice(j, 1);\n                                break;\n                            }\n                        }\n                    }\n                    else if (parent.shapeColl[i].id && parent.shapeColl[i].id.indexOf('pen') > -1) {\n                        for (var j = 0; j < tempPointColl.length; j++) {\n                            if (parent.shapeColl[i].id === tempPointColl[j].id) {\n                                parent.shapeColl[i] = extend([], tempPointColl[j], [], true);\n                                tempPointColl.splice(j, 1);\n                                break;\n                            }\n                        }\n                    }\n                }\n                return;\n            }\n        }\n        tempObjColl = extend([], parent.objColl, [], true);\n        tempPointColl = extend([], parent.pointColl, [], true);\n        parent.shapeColl = [];\n        var order = 1;\n        var isBreak;\n        var isCrop = false;\n        while (tempObjColl.length !== 0 || tempPointColl.length !== 0) {\n            isBreak = isCrop = false;\n            for (var i = 0; i < tempObjColl.length; i++) {\n                if (tempObjColl[i].order === order ||\n                    (!tempObjColl[i].order && tempObjColl[i].shape &&\n                        tempObjColl[i].shape.indexOf('crop-') > -1)) {\n                    parent.shapeColl.push(extend({}, tempObjColl[i], {}, true));\n                    if (tempObjColl[i].shape && tempObjColl[i].shape.indexOf('crop-') > -1) {\n                        isCrop = true;\n                    }\n                    tempObjColl.splice(i, 1);\n                    isBreak = true;\n                    break;\n                }\n            }\n            if (!isBreak) {\n                for (var i = 0; i < tempPointColl.length; i++) {\n                    if (tempPointColl[i].order === order) {\n                        parent.shapeColl.push(extend([], tempPointColl[i], [], true));\n                        tempPointColl.splice(i, 1);\n                        isBreak = true;\n                        break;\n                    }\n                }\n            }\n            if (!isCrop) {\n                order++;\n            }\n        }\n    };\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    Shape.prototype.reUpdateShapeColl = function (obj) {\n        var parent = this.parent;\n        if (obj.id && obj.id.indexOf('pen') > -1) {\n            if (parent.freehandCounter > 0) {\n                for (var i = 0; i < parent.freehandCounter; i++) {\n                    if (parent.pointColl[i].id === obj.id) {\n                        parent.pointColl[i].order = obj.order;\n                    }\n                }\n            }\n        }\n        else if (obj.currIndex && obj.currIndex.indexOf('shape') > -1) {\n            for (var i = 0; i < parent.objColl.length; i++) {\n                if (parent.objColl[i].currIndex === obj.currIndex) {\n                    parent.objColl[i].order = obj.order;\n                }\n            }\n        }\n    };\n    Shape.prototype.drawAnnotations = function (ctx, shape, pen, isPreventApply, x, y, panRegion) {\n        var parent = this.parent;\n        var activeObj = extend({}, parent.activeObj, {}, true);\n        var tempObjColl = extend([], parent.objColl, [], true);\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        var tempPointColl = extend([], parent.pointColl, [], true);\n        var tempSelPointCollObj = { selPointColl: null };\n        parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: tempSelPointCollObj } });\n        var selPointCollObj = { selPointColl: null };\n        parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: selPointCollObj } });\n        this.updateShapeColl();\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        var tempShapeColl = extend([], parent.shapeColl, [], true);\n        tempShapeColl = this.reorderRedact(tempShapeColl);\n        var isPrevented = false;\n        if (!this.preventFrameAnnotation) {\n            this.preventFrameAnnotation = isPrevented = true;\n        }\n        for (var i = 0; i < tempShapeColl.length; i++) {\n            var isPenId = tempShapeColl[i].id;\n            if ((tempShapeColl[i].order) ||\n                (!tempShapeColl[i].order && tempShapeColl[i].shape && tempShapeColl[i].shape.indexOf('crop-') > -1) ||\n                (!tempShapeColl[i].order && tempShapeColl[i].shape === 'path' && parent.drawingShape === 'path')) {\n                if (tempShapeColl[i].currIndex && tempShapeColl[i].currIndex.indexOf('shape') > -1) {\n                    parent.objColl = [];\n                    parent.objColl.push(extend({}, tempShapeColl[i], {}, true));\n                    if (shape === 'iterate') {\n                        var temp = this.lowerContext.filter;\n                        this.lowerContext.filter = 'none';\n                        this.iterateObjColl();\n                        this.lowerContext.filter = temp;\n                    }\n                    else if (shape === 'zoom' || shape === 'pan') {\n                        var tempObjCollIndex = -1;\n                        for (var i_3 = 0; i_3 < tempObjColl.length; i_3++) {\n                            if (JSON.stringify(tempObjColl[i_3]) === JSON.stringify(parent.objColl[0])) {\n                                tempObjCollIndex = i_3;\n                                break;\n                            }\n                        }\n                        if (shape === 'zoom') {\n                            this.zoomObjColl(isPreventApply);\n                        }\n                        else {\n                            this.panObjColl(x, y, panRegion);\n                        }\n                        if (tempObjCollIndex > -1) {\n                            tempObjColl[tempObjCollIndex] = extend({}, parent.objColl[0], {}, true);\n                        }\n                    }\n                }\n                else if (tempShapeColl[i].id && tempShapeColl[i].id.indexOf('pen') > -1) {\n                    parent.pointColl = [];\n                    parent.freehandCounter = 0;\n                    parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false, value: { obj: { selPointColl: [] } } });\n                    parent.pointColl.push(extend({}, tempShapeColl[i], {}, true));\n                    parent.notify('freehand-draw', { prop: 'pushSelPointColl', onPropertyChange: false,\n                        value: { obj: { selPointColl: selPointCollObj['selPointColl'][i] } } });\n                    parent.freehandCounter = parent.pointColl.length;\n                    if (pen === 'iterate') {\n                        parent.notify('freehand-draw', { prop: 'freehandRedraw', onPropertyChange: false,\n                            value: { context: ctx, points: null } });\n                    }\n                    else if (pen === 'zoom' || pen === 'pan') {\n                        if (pen === 'zoom') {\n                            parent.notify('freehand-draw', { prop: 'zoomFHDColl', onPropertyChange: false,\n                                value: { isPreventApply: isPreventApply } });\n                        }\n                        else {\n                            parent.notify('freehand-draw', { prop: 'panFHDColl', onPropertyChange: false,\n                                value: { xDiff: x, yDiff: y, panRegion: panRegion } });\n                        }\n                        for (var i_4 = 0; i_4 < tempPointColl.length; i_4++) {\n                            if (tempPointColl[i_4].id === parent.pointColl[0].id) {\n                                tempPointColl[i_4] = extend({}, parent.pointColl[0], {}, true);\n                                break;\n                            }\n                        }\n                        for (var i_5 = 0, len = tempSelPointCollObj['selPointColl'].length; i_5 < len; i_5++) {\n                            if (tempSelPointCollObj['selPointColl'][i_5].id === selPointCollObj['selPointColl'][i_5].id) {\n                                tempSelPointCollObj['selPointColl'][i_5] = extend({}, selPointCollObj['selPointColl'][i_5], {}, true);\n                                break;\n                            }\n                        }\n                    }\n                }\n            }\n            else if ((!tempShapeColl[i].shape && !isPenId) ||\n                (!tempShapeColl[i].currIndex && !isPenId)) {\n                tempShapeColl.splice(i, 1);\n            }\n        }\n        if (pen && pen === 'zoom') {\n            parent.pointColl = [];\n            parent.freehandCounter = 0;\n            parent.notify('freehand-draw', { prop: 'zoomFHDColl', onPropertyChange: false, value: { isPreventApply: isPreventApply } });\n        }\n        parent.objColl = tempObjColl;\n        parent.pointColl = tempPointColl;\n        parent.freehandCounter = parent.pointColl.length;\n        parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false, value: { obj: { selPointColl: tempSelPointCollObj['selPointColl'] } } });\n        if (isPrevented && this.preventFrameAnnotation) {\n            parent.notify('draw', { prop: 'applyFrame', value: { ctx: this.lowerContext, frame: parent.frameObj.type, preventImg: true } });\n            this.preventFrameAnnotation = false;\n        }\n        parent.activeObj = activeObj;\n    };\n    return Shape;\n}());\nexport { Shape };\n","/* eslint-disable prefer-const */\nimport { Browser, extend, getComponent, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { Direction } from '../index';\nimport { hideSpinner, showSpinner } from '@syncfusion/ej2-popups';\nvar Transform = /** @class */ (function () {\n    function Transform(parent) {\n        this.isReverseFlip = false; // True when rotate method is called from iteration\n        this.disablePan = false; // auto enable / disable pan while zooming\n        this.isReverseRotate = false; // True when rotate method is called from iteration\n        this.flipColl = []; // To store flip order\n        this.prevZoomValue = 1;\n        this.cropDimension = { width: 0, height: 0 };\n        this.isPreventSelect = false;\n        this.preventDownScale = false;\n        this.resizedImgAngle = null;\n        this.parent = parent;\n        this.addEventListener();\n    }\n    Transform.prototype.destroy = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.removeEventListener();\n    };\n    Transform.prototype.addEventListener = function () {\n        this.parent.on('transform', this.transform, this);\n        this.parent.on('destroyed', this.destroy, this);\n    };\n    Transform.prototype.removeEventListener = function () {\n        this.parent.off('transform', this.transform);\n        this.parent.off('destroyed', this.destroy);\n    };\n    Transform.prototype.transform = function (args) {\n        this.initTransformPvtVar();\n        switch (args.prop) {\n            case 'flipImage':\n                this.flipImage(args.value['direction']);\n                break;\n            case 'setDestPointsForFlipState':\n                this.setDestPointsForFlipState();\n                break;\n            case 'zoomAction':\n                this.zoomAction(args.value['zoomFactor'], args.value['zoomPoint'], args.value['isResize']);\n                break;\n            case 'disableZoomOutBtn':\n                this.disableZoomOutBtn(args.value['isZoomOut']);\n                break;\n            case 'rotatedFlip':\n                this.rotatedFlip();\n                break;\n            case 'drawPannedImage':\n                this.drawPannedImage(args.value['xDiff'], args.value['yDiff']);\n                break;\n            case 'drawPannImage':\n                this.drawPannImage(args.value['point']);\n                break;\n            case 'performTransformation':\n                this.performTransformation(args.value['text']);\n                break;\n            case 'updateTransform':\n                this.updateTransform(args.value['text']);\n                break;\n            case 'rotatePan':\n                this.rotatePan(args.value['isCropSelection'], args.value['isDefaultZoom']);\n                break;\n            case 'resetZoom':\n                this.resetZoom();\n                break;\n            case 'pan':\n                this.pan(args.value['value'], args.value['x'], args.value['y']);\n                break;\n            case 'zoom':\n                this.zoom(args.value['zoomFactor'], args.value['zoomPoint']);\n                break;\n            case 'setCurrPanRegion':\n                this.setCurrPanRegion(args.value['region'], args.value['type'], args.value['obj']);\n                break;\n            case 'rotate':\n                this.rotate(args.value['degree'], args.value['obj']);\n                break;\n            case 'flip':\n                this.flip(args.value['direction']);\n                break;\n            case 'update':\n                this.update();\n                break;\n            case 'calcMaxDimension':\n                this.calcMaxDimension(args.value['width'], args.value['height'], args.value['obj'], args.value['isImgShape']);\n                break;\n            case 'getPanMove':\n                args.value['obj']['panMove'] = this.panMove;\n                break;\n            case 'setPanMove':\n                this.panMove = args.value['point'];\n                break;\n            case 'getTempPanMove':\n                args.value['obj']['tempPanMove'] = this.tempPanMove;\n                break;\n            case 'setTempPanMove':\n                this.tempPanMove = args.value['point'];\n                break;\n            case 'setReverseFlip':\n                this.isReverseFlip = args.value['isReverseFlip'];\n                break;\n            case 'setDisablePan':\n                this.disablePan = args.value['bool'];\n                break;\n            case 'setCurrDestinationPoint':\n                this.currDestPoint = args.value['point'];\n                this.currDestPoint.startX -= this.parent.cropObj.totalPannedPoint.x;\n                this.currDestPoint.startY -= this.parent.cropObj.totalPannedPoint.y;\n                break;\n            case 'setReverseRotate':\n                this.isReverseRotate = args.value['bool'];\n                break;\n            case 'getFlipColl':\n                args.value['obj']['flipColl'] = this.flipColl;\n                break;\n            case 'setFlipColl':\n                this.flipColl = args.value['flipColl'];\n                break;\n            case 'getPreviousZoomValue':\n                args.value['obj']['previousZoomValue'] = this.prevZoomValue;\n                break;\n            case 'setPreviousZoomValue':\n                this.prevZoomValue = args.value['previousZoomValue'];\n                break;\n            case 'getCropDimension':\n                args.value['obj']['cropDimension'] = this.cropDimension;\n                break;\n            case 'setCropDimension':\n                this.cropDimension.width = args.value['width'];\n                this.cropDimension.height = args.value['height'];\n                break;\n            case 'getPreventSelect':\n                args.value['obj']['bool'] = this.isPreventSelect;\n                break;\n            case 'setPreventSelect':\n                this.isPreventSelect = args.value['bool'];\n                break;\n            case 'resizeImage':\n                this.resizeImage(args.value['width'], args.value['height']);\n                break;\n            case 'resizeCrop':\n                this.resizeCrop(args.value['width'], args.value['height']);\n                break;\n            case 'updateResize':\n                this.updateResize();\n                break;\n            case 'resize':\n                this.resize(args.value['width'], args.value['height'], args.value['isAspectRatio']);\n                break;\n            case 'straightenImage':\n                this.straightenImage(args.value['degree']);\n                break;\n            case 'reset':\n                this.reset();\n                break;\n            case 'cropZoom':\n                args.value['obj']['maxDimension'] = this.cropZoom(args.value['value'], args.value['selectionObj']);\n                break;\n            case 'setResizedImgAngle':\n                this.resizedImgAngle = args.value['angle'];\n                break;\n        }\n    };\n    Transform.prototype.getModuleName = function () {\n        return 'transform';\n    };\n    Transform.prototype.initTransformPvtVar = function () {\n        if (this.parent.lowerCanvas) {\n            this.lowerContext = this.parent.lowerCanvas.getContext('2d');\n        }\n        if (this.parent.upperCanvas) {\n            this.upperContext = this.parent.upperCanvas.getContext('2d');\n        }\n    };\n    Transform.prototype.reset = function () {\n        this.zoomBtnHold = null;\n        this.tempPanMove = null;\n        this.panMove = null;\n        this.disablePan = false;\n        this.currDestPoint = null;\n        this.isReverseRotate = false;\n        this.flipColl = [];\n        this.resizedImgAngle = null;\n        this.transCurrObj = null;\n        this.prevZoomValue = 1;\n        this.isPreventSelect = this.preventDownScale = false;\n    };\n    Transform.prototype.rotateImage = function (degree) {\n        var parent = this.parent;\n        var transitionArgs = { cancel: false, previousDegree: parent.transform.degree,\n            currentDegree: Math.abs(parent.transform.degree + degree) === 360 ? 0 : parent.transform.degree + degree };\n        if (!this.isPreventSelect) {\n            parent.trigger('rotating', transitionArgs);\n            parent.editCompleteArgs = transitionArgs;\n        }\n        this.rotateEvent(transitionArgs, degree);\n    };\n    Transform.prototype.rotateEvent = function (transitionArgs, degree) {\n        var parent = this.parent;\n        if (!transitionArgs.cancel) {\n            var prevObj = void 0;\n            if (isNullOrUndefined(this.transCurrObj)) {\n                var object = { currObj: {} };\n                parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n                prevObj = object['currObj'];\n                prevObj.objColl = extend([], parent.objColl, null, true);\n                prevObj.pointColl = extend({}, parent.pointColl, null, true);\n                prevObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n                var selPointCollObj = { selPointColl: null };\n                parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false, value: { obj: selPointCollObj } });\n                prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n            }\n            parent.afterCropActions.push(degree === 90 ? 'rotateRight' : 'rotateLeft');\n            var splitWords = [];\n            var activeObjShape = void 0;\n            if (parent.activeObj.activePoint && parent.activeObj.shape) {\n                if (parent.activeObj.shape !== undefined) {\n                    splitWords = parent.activeObj.shape.split('-');\n                }\n                if (parent.currObjType.isCustomCrop || splitWords[0] === 'crop') {\n                    activeObjShape = parent.currObjType.isCustomCrop ? 'custom' : splitWords[1];\n                    parent.notify('shape', { prop: 'updImgRatioForActObj', onPropertyChange: false });\n                    parent.objColl.push(parent.activeObj);\n                    parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                }\n            }\n            parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n                value: { x: null, y: null, isMouseDown: true } });\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            this.drawRotatedImage(degree);\n            parent.notify('draw', { prop: 'setImageEdited', onPropertyChange: false });\n            parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n            parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.upperContext } });\n            if (parent.isCircleCrop) {\n                parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                    value: { context: this.lowerContext, isSave: null, isFlip: null } });\n            }\n            if (activeObjShape) {\n                this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                parent.activeObj = extend({}, parent.objColl[parent.objColl.length - 1], {}, true);\n                parent.objColl.pop();\n                parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: parent.activeObj } });\n            }\n            parent.isUndoRedo = false;\n            var obj = { collection: parent.rotateFlipColl };\n            parent.notify('shape', { prop: 'alignRotateFlipColl', onPropertyChange: false,\n                value: { collection: parent.rotateFlipColl, isRotateFlipCollection: true, obj: obj } });\n            parent.rotateFlipColl = obj['collection'];\n            if (parent.cropObj.activeObj.shape && !this.isPreventSelect) {\n                parent.notify('draw', { prop: 'setIsCropSelect', value: { bool: true } });\n                this.isPreventSelect = true;\n                parent.notify('draw', { prop: 'select', onPropertyChange: false,\n                    value: { type: 'custom', startX: null, startY: null, width: null, height: null } });\n                this.isPreventSelect = false;\n                parent.setProperties({ zoomSettings: { zoomFactor: 1 } }, true);\n                this.prevZoomValue = parent.zoomSettings.zoomFactor;\n            }\n        }\n        else {\n            parent.notify('draw', { prop: 'setCurrentObj', onPropertyChange: false, value: { obj: parent.prevEventObjPoint } });\n            parent.activeObj = parent.prevEventSelectionPoint;\n            parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: parent.activeObj } });\n        }\n    };\n    Transform.prototype.drawRotatedImage = function (degree) {\n        var parent = this.parent;\n        if (degree === 0) {\n            parent.transform.degree = 0;\n        }\n        else {\n            parent.transform.degree += degree;\n        }\n        if (Math.abs(parent.transform.degree) === 360) {\n            parent.transform.degree = 0;\n        }\n        parent.notify('draw', { prop: 'setDestPoints', onPropertyChange: false });\n        var tempObjColl = extend([], parent.objColl, [], true);\n        var tempActiveObj = extend({}, parent.activeObj, {}, true);\n        parent.objColl = [];\n        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        if (!this.isReverseRotate) {\n            parent.notify('draw', { prop: 'updateCurrTransState', onPropertyChange: false,\n                value: { type: 'initial', isPreventDestination: null, isRotatePan: null } });\n        }\n        this.rotateDegree(degree);\n        if (!this.isReverseRotate) {\n            parent.notify('draw', { prop: 'updateCurrTransState', onPropertyChange: false,\n                value: { type: 'reverse', isPreventDestination: null, isRotatePan: null } });\n            parent.rotateFlipColl.push(degree);\n        }\n        parent.objColl = extend([], tempObjColl, [], true);\n        parent.activeObj = extend({}, tempActiveObj, {}, true);\n        if (parent.isCircleCrop) {\n            parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                value: { context: this.lowerContext, isSave: null, isFlip: null } });\n        }\n        parent.notify('shape', { prop: 'redrawObj', onPropertyChange: false, value: { degree: degree } });\n        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        if (degree > 0) {\n            parent.notify('freehand-draw', { prop: 'rotateFhdColl', onPropertyChange: false });\n        }\n        else {\n            for (var i = 0; i < 3; i++) {\n                parent.notify('freehand-draw', { prop: 'rotateFhdColl', onPropertyChange: false });\n            }\n        }\n        parent.notify('freehand-draw', { prop: 'freehandRedraw', onPropertyChange: false,\n            value: { context: this.lowerContext, points: null } });\n        this.updateCurrSelectionPoint(degree);\n    };\n    Transform.prototype.rotateDegree = function (degree) {\n        var parent = this.parent;\n        this.lowerContext.save();\n        this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        this.lowerContext.translate(parent.lowerCanvas.width / 2, parent.lowerCanvas.height / 2);\n        this.lowerContext.rotate(Math.PI / 180 * degree);\n        this.lowerContext.translate(-parent.lowerCanvas.width / 2, -parent.lowerCanvas.height / 2);\n        var temp = this.lowerContext.filter;\n        parent.notify('draw', { prop: 'drawImage', onPropertyChange: false });\n        this.lowerContext.filter = temp;\n        this.lowerContext.translate(parent.lowerCanvas.width / 2, parent.lowerCanvas.height / 2);\n        this.lowerContext.rotate(Math.PI / 180 * -degree);\n        this.lowerContext.translate(-parent.lowerCanvas.width / 2, -parent.lowerCanvas.height / 2);\n        this.lowerContext.restore();\n    };\n    Transform.prototype.updateCurrSelectionPoint = function (degree) {\n        var parent = this.parent;\n        if (parent.currSelectionPoint && this.currDestPoint) {\n            var activeObj = extend({}, parent.activeObj, {}, true);\n            var objColl = extend([], parent.objColl, [], true);\n            var srcPoints = { startX: parent.img.srcLeft, startY: parent.img.srcTop, width: parent.img.srcWidth,\n                height: parent.img.srcHeight };\n            var destPoints = { startX: parent.img.destLeft, startY: parent.img.destTop, width: parent.img.destWidth,\n                height: parent.img.destHeight };\n            parent.objColl = [];\n            parent.objColl.push(extend({}, parent.currSelectionPoint, {}, true));\n            parent.img = { srcLeft: 0, srcTop: 0, srcWidth: parent.baseImgCanvas.width, srcHeight: parent.baseImgCanvas.height,\n                destLeft: this.currDestPoint.startX, destTop: this.currDestPoint.startY, destWidth: this.currDestPoint.width,\n                destHeight: this.currDestPoint.height };\n            if (typeof (degree) === 'number') {\n                parent.notify('draw', { prop: 'setDestPoints', onPropertyChange: false });\n                parent.notify('draw', { prop: 'setClientTransDim', onPropertyChange: false,\n                    value: { isPreventDimension: null } });\n            }\n            parent.notify('shape', { prop: 'redrawObj', onPropertyChange: false, value: { degree: degree } });\n            parent.currSelectionPoint = extend({}, parent.objColl[0], {}, true);\n            this.currDestPoint = { startX: parent.img.destLeft, startY: parent.img.destTop, width: parent.img.destWidth,\n                height: parent.img.destHeight };\n            parent.objColl = objColl;\n            parent.activeObj = activeObj;\n            parent.img = { srcLeft: srcPoints.startX, srcTop: srcPoints.startY, srcWidth: srcPoints.width, srcHeight: srcPoints.height,\n                destLeft: destPoints.startX, destTop: destPoints.startY, destWidth: destPoints.width, destHeight: destPoints.height };\n        }\n    };\n    Transform.prototype.flipImage = function (direction) {\n        var parent = this.parent;\n        var transitionArgs = { direction: direction, cancel: false,\n            previousDirection: parent.toPascalCase(parent.transform.currFlipState || direction) };\n        if (!this.isPreventSelect) {\n            parent.trigger('flipping', transitionArgs);\n            parent.editCompleteArgs = transitionArgs;\n        }\n        this.flipEvent(transitionArgs, direction);\n    };\n    Transform.prototype.flipEvent = function (transitionArgs, direction) {\n        var parent = this.parent;\n        if (transitionArgs.cancel) {\n            parent.notify('draw', { prop: 'setCurrentObj', onPropertyChange: false, value: { obj: parent.prevEventObjPoint } });\n            parent.activeObj = parent.prevEventSelectionPoint;\n            parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: parent.activeObj } });\n            return;\n        }\n        var prevObj;\n        if (isNullOrUndefined(this.transCurrObj)) {\n            var object = { currObj: {} };\n            parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n            prevObj = object['currObj'];\n            prevObj.objColl = extend([], parent.objColl, null, true);\n            prevObj.pointColl = extend({}, parent.pointColl, null, true);\n            prevObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n            var selPointCollObj = { selPointColl: null };\n            parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n                value: { obj: selPointCollObj } });\n            prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        }\n        parent.afterCropActions.push(direction.toLowerCase() === 'horizontal' ? 'horizontalflip' : 'verticalflip');\n        var splitWords = [];\n        var activeObjShape;\n        if (parent.activeObj.activePoint) {\n            if (parent.activeObj.shape !== undefined) {\n                splitWords = parent.activeObj.shape.split('-');\n            }\n            if (parent.currObjType.isCustomCrop || splitWords[0] === 'crop') {\n                activeObjShape = parent.currObjType.isCustomCrop ? 'custom' : splitWords[1];\n                parent.notify('shape', { prop: 'updImgRatioForActObj', onPropertyChange: false });\n                parent.objColl.push(parent.activeObj);\n                parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            }\n        }\n        parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n            value: { x: null, y: null, isMouseDown: true } });\n        parent.clearContext(this.lowerContext);\n        parent.clearContext(this.upperContext);\n        var tempObjColl = extend([], parent.objColl, [], true);\n        var tempActiveObj = extend({}, parent.activeObj, {}, true);\n        parent.objColl = [];\n        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        if (!this.isReverseFlip) {\n            parent.notify('draw', { prop: 'updateCurrTransState', onPropertyChange: false,\n                value: { type: 'initial', isPreventDestination: null, isRotatePan: null } });\n        }\n        var lowercaseDirection = direction.toLowerCase();\n        this.updateFlipState(lowercaseDirection);\n        var flipState = parent.transform.currFlipState.toLowerCase();\n        parent.transform.currFlipState = (lowercaseDirection === 'horizontal' && flipState === 'horizontal') ||\n            (lowercaseDirection === 'vertical' && flipState === 'vertical') ? '' : lowercaseDirection;\n        var selObj = { isSelected: null };\n        parent.notify('draw', { prop: 'getRotatedFlipCropSelection', onPropertyChange: false, value: { bool: selObj } });\n        if (selObj['isSelected']) {\n            parent.img.destLeft += parent.panPoint.totalPannedInternalPoint.x;\n            parent.img.destTop += parent.panPoint.totalPannedInternalPoint.y;\n        }\n        var temp = this.lowerContext.filter;\n        parent.notify('draw', { prop: 'drawImage', onPropertyChange: false });\n        this.lowerContext.filter = temp;\n        parent.notify('draw', { prop: 'setImageEdited', onPropertyChange: false });\n        this.updateFlipState(direction.toLowerCase());\n        if (!this.isReverseFlip) {\n            parent.notify('draw', { prop: 'updateCurrTransState', onPropertyChange: false,\n                value: { type: 'reverse', isPreventDestination: null, isRotatePan: null } });\n            this.updateFlipColl(direction.toLocaleLowerCase());\n            parent.rotateFlipColl.push(direction.toLowerCase());\n        }\n        if (parent.rotateFlipColl.length === 1) {\n            var panObj = { panRegion: '' };\n            parent.notify('crop', { prop: 'getCurrFlipState', onPropertyChange: false,\n                value: { panObj: panObj } });\n            if (panObj['panRegion'] === '') {\n                parent.notify('draw', { prop: 'setClientTransDim', onPropertyChange: false,\n                    value: { isPreventDimension: null } });\n            }\n            else {\n                this.setDestPointsForFlipState();\n            }\n        }\n        if (parent.isCircleCrop) {\n            parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                value: { context: this.lowerContext, isSave: null, isFlip: null } });\n        }\n        parent.objColl = extend([], tempObjColl, [], true);\n        parent.activeObj = extend({}, tempActiveObj, {}, true);\n        for (var i = 0, len = parent.objColl.length; i < len; i++) {\n            var flipObjColl = parent.objColl[i].flipObjColl;\n            if (flipObjColl.length === 0) {\n                flipObjColl.push(direction);\n            }\n            else if (flipObjColl[flipObjColl.length - 1] === direction) {\n                flipObjColl.pop();\n            }\n            else {\n                flipObjColl.push(direction);\n            }\n        }\n        parent.notify('shape', { prop: 'redrawObj', onPropertyChange: false, value: { degree: direction.toLowerCase() } });\n        var tempFilter = this.lowerContext.filter;\n        this.lowerContext.filter = 'brightness(' + 1 + ') ' + 'contrast(' + 100 + '%) ' + 'hue-rotate(' + 0 + 'deg) ' +\n            'saturate(' + 100 + '%) ' + 'opacity(' + 1 + ') ' + 'blur(' + 0 + 'px) ' + 'sepia(0%) ' + 'grayscale(0%) ' + 'invert(0%)';\n        parent.notify('shape', { prop: 'iterateObjColl', onPropertyChange: false });\n        var dir = direction.toLowerCase();\n        if (dir === 'horizontal' || dir === 'vertical') {\n            parent.notify('freehand-draw', { prop: 'flipFHDColl', onPropertyChange: false,\n                value: { value: dir } });\n            parent.notify('freehand-draw', { prop: 'freehandRedraw', onPropertyChange: false,\n                value: { context: this.lowerContext, points: null } });\n        }\n        else {\n            parent.notify('freehand-draw', { prop: 'freehandRedraw', onPropertyChange: false,\n                value: { context: this.lowerContext, points: null } });\n        }\n        this.lowerContext.filter = tempFilter;\n        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        this.updateCurrSelectionPoint(dir);\n        parent.isUndoRedo = false;\n        parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n        parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.upperContext } });\n        if (parent.isCircleCrop) {\n            parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                value: { context: this.lowerContext, isSave: null, isFlip: null } });\n        }\n        if (activeObjShape) {\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            parent.activeObj = extend({}, parent.objColl[parent.objColl.length - 1], {}, true);\n            parent.objColl.pop();\n            parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: parent.activeObj } });\n        }\n        var obj = { collection: parent.rotateFlipColl };\n        parent.notify('shape', { prop: 'alignRotateFlipColl', onPropertyChange: false,\n            value: { collection: parent.rotateFlipColl, isRotateFlipCollection: true, obj: obj } });\n        parent.rotateFlipColl = obj['collection'];\n        if (parent.cropObj.activeObj.shape && !this.isPreventSelect) {\n            parent.notify('draw', { prop: 'setIsCropSelect', value: { bool: true } });\n            this.isPreventSelect = true;\n            parent.notify('draw', { prop: 'select', onPropertyChange: false,\n                value: { type: 'custom', startX: null, startY: null, width: null, height: null } });\n            this.isPreventSelect = false;\n            parent.setProperties({ zoomSettings: { zoomFactor: 1 } }, true);\n            this.prevZoomValue = parent.zoomSettings.zoomFactor;\n        }\n    };\n    Transform.prototype.updateFlipState = function (direction) {\n        var degree = this.parent.transform.degree;\n        if (direction === 'horizontal') {\n            if (degree % 90 === 0 && degree % 180 !== 0) {\n                this.verticalFlip();\n            }\n            else {\n                this.horizontalFlip();\n            }\n        }\n        else if (direction === 'vertical') {\n            if (degree % 90 === 0 && degree % 180 !== 0) {\n                this.horizontalFlip();\n            }\n            else {\n                this.verticalFlip();\n            }\n        }\n    };\n    Transform.prototype.horizontalFlip = function () {\n        this.lowerContext.translate(this.lowerContext.canvas.width, 0);\n        this.lowerContext.scale(-1, 1);\n        this.upperContext.translate(this.upperContext.canvas.width, 0);\n        this.upperContext.scale(-1, 1);\n    };\n    Transform.prototype.verticalFlip = function () {\n        this.lowerContext.translate(0, this.lowerContext.canvas.height);\n        this.lowerContext.scale(1, -1);\n        this.upperContext.translate(0, this.upperContext.canvas.height);\n        this.upperContext.scale(1, -1);\n    };\n    Transform.prototype.updateFlipColl = function (direction) {\n        if (this.isPreventSelect) {\n            return;\n        }\n        if (this.flipColl.length === 0 || this.flipColl[this.flipColl.length - 1] !== direction) {\n            this.flipColl.push(direction);\n        }\n        else {\n            this.flipColl.pop();\n        }\n        if (this.flipColl.length >= 4) {\n            var lastFourItems = this.flipColl.slice(-4);\n            if ((lastFourItems[0] === 'horizontal' && lastFourItems[1] === 'vertical' &&\n                lastFourItems[2] === 'horizontal' && lastFourItems[3] === 'vertical') ||\n                (lastFourItems[0] === 'vertical' && lastFourItems[1] === 'horizontal' &&\n                    lastFourItems[2] === 'vertical' && lastFourItems[3] === 'horizontal')) {\n                this.flipColl.splice(-4);\n            }\n        }\n    };\n    Transform.prototype.setDestPointsForFlipState = function () {\n        var parent = this.parent;\n        var panObj = { panRegion: '' };\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        var _b = parent.lowerCanvas, clientWidth = _b.clientWidth, clientHeight = _b.clientHeight;\n        parent.notify('crop', { prop: 'getCurrFlipState', onPropertyChange: false,\n            value: { panObj: panObj } });\n        if (panObj['panRegion'] !== '') {\n            if (panObj['panRegion'] === 'horizontal') {\n                parent.img.destLeft = clientWidth - (destWidth + destLeft);\n            }\n            else if (panObj['panRegion'] === 'vertical') {\n                parent.img.destTop = clientHeight - (destHeight + destTop);\n            }\n            else {\n                parent.img.destLeft = clientWidth - (destWidth + destLeft);\n                parent.img.destTop = clientHeight - (destHeight + destTop);\n            }\n        }\n    };\n    Transform.prototype.zoomAction = function (zoomFactor, zoomPoint, isResize, isPreventApply) {\n        var parent = this.parent;\n        if (!parent.disabled && parent.isImageLoaded) {\n            if (isNullOrUndefined(isResize) && (parent.zoomSettings.zoomFactor >= parent.zoomSettings.maxZoomFactor && zoomFactor > 0 ||\n                (parent.zoomSettings.zoomFactor > parent.zoomSettings.minZoomFactor && zoomFactor < 0 && this.disableZoomOutBtn(true)) ||\n                (parent.zoomSettings.zoomFactor <= parent.zoomSettings.minZoomFactor && zoomFactor < 0))) {\n                parent.notify('toolbar', { prop: 'zoom-up-handler', onPropertyChange: false });\n                return;\n            }\n            parent.notify('draw', { prop: 'setImageEdited', onPropertyChange: false });\n            var tempZoomFactor = zoomFactor;\n            zoomFactor = tempZoomFactor > 0 ? 0.1 : -0.1;\n            for (var i = 0; i < Math.round(Math.abs(tempZoomFactor / 0.1)); i++) {\n                if (this.prevZoomValue === 1) {\n                    this.prevZoomValue += zoomFactor > 0 ? zoomFactor * 10 : (zoomFactor * 10) / 10;\n                }\n                else if (this.prevZoomValue > 1) {\n                    this.prevZoomValue += (zoomFactor * 10);\n                }\n                else if (this.prevZoomValue < 1) {\n                    this.prevZoomValue += (zoomFactor * 10) / 10;\n                    var powerOften = Math.pow(10, 1);\n                    this.prevZoomValue = (Math.round(this.prevZoomValue * powerOften) / powerOften);\n                }\n            }\n            zoomFactor = tempZoomFactor;\n            parent.setProperties({ zoomSettings: { zoomFactor: this.prevZoomValue } }, true);\n            var splitWords = void 0;\n            this.tempActiveObj = null;\n            this.isShape = false;\n            if (parent.activeObj.shape !== undefined) {\n                if (parent.activeObj.shape === 'shape') {\n                    parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                }\n                else {\n                    splitWords = parent.activeObj.shape.split('-');\n                }\n            }\n            if (splitWords !== undefined && splitWords[0] === 'crop') {\n                this.tempActiveObj = extend({}, parent.activeObj, {}, true);\n                parent.isCropTab = true;\n            }\n            else if (parent.activeObj.shape && splitWords[0] !== 'crop' &&\n                (parent.activeObj.activePoint.width !== 0 || parent.activeObj.activePoint.height !== 0) ||\n                (parent.activeObj.shape === 'path' && parent.activeObj.pointColl.length > 0)) {\n                this.isShape = true;\n            }\n            var obj = { zoomType: null };\n            parent.notify('selection', { prop: 'getZoomType', onPropertyChange: false, value: { obj: obj } });\n            if (isNullOrUndefined(zoomPoint)) {\n                if (parent.isCropTab && this.tempActiveObj) {\n                    zoomPoint = { x: parent.activeObj.activePoint.startX + (parent.activeObj.activePoint.width / 2),\n                        y: parent.activeObj.activePoint.startY + (parent.activeObj.activePoint.height / 2) };\n                }\n                else {\n                    zoomPoint = { x: parent.lowerCanvas.clientWidth / 2, y: parent.lowerCanvas.clientHeight / 2 };\n                }\n                if (obj['zoomType'] === 'MouseWheel' || obj['zoomType'] === 'Pinch') {\n                    zoomPoint = { x: parent.zoomSettings.zoomPoint.x, y: parent.zoomSettings.zoomPoint.y };\n                }\n            }\n            var previousZoomFactor = parent.zoomSettings.zoomFactor - (zoomFactor * 10);\n            var zoomEventArgs = { zoomPoint: zoomPoint, cancel: false, previousZoomFactor: previousZoomFactor,\n                currentZoomFactor: parent.zoomSettings.zoomFactor, zoomTrigger: obj['zoomType'] };\n            if (!parent.isCropToolbar && parent.isZoomBtnClick) {\n                parent.trigger('zooming', zoomEventArgs);\n                parent.editCompleteArgs = zoomEventArgs;\n            }\n            this.zoomEvent(zoomEventArgs, zoomFactor, isPreventApply);\n        }\n    };\n    Transform.prototype.zoomEvent = function (zoomEventArgs, zoomFact, isPreventApply) {\n        var parent = this.parent;\n        var shapeId;\n        var _a = parent.zoomSettings, zoomFactor = _a.zoomFactor, minZoomFactor = _a.minZoomFactor;\n        if (zoomEventArgs.cancel) {\n            parent.isZoomBtnClick = false;\n            return;\n        }\n        if (this.parent.activeObj.redactType !== 'blur' && this.parent.activeObj.redactType !== 'pixelate') {\n            parent.notify('toolbar', { prop: 'close-contextual-toolbar', onPropertyChange: false });\n        }\n        if (!parent.isCropTab && parent.activeObj.shape) {\n            shapeId = parent.activeObj.currIndex;\n        }\n        parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n            value: { x: null, y: null, isMouseDown: true } });\n        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        this.upperContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        var object = { canvasFilter: parent.canvasFilter };\n        this.lowerContext.filter = object['canvasFilter'];\n        parent.upperCanvas.style.cursor = parent.cursor = 'default';\n        var objColl = extend([], parent.objColl, [], true);\n        if (!parent.isCropTab) {\n            if (parent.transform.degree !== 0) {\n                parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false, value: { x: null, y: null, isMouseDown: null } });\n                parent.panPoint.currentPannedPoint = { x: 0, y: 0 };\n                var temp = parent.allowDownScale;\n                parent.allowDownScale = false;\n                this.rotatePan(true, true);\n                parent.allowDownScale = temp;\n            }\n            else if (parent.transform.currFlipState !== '') {\n                parent.panPoint.totalPannedPoint = { x: 0, y: 0 };\n            }\n            if (parent.transform.straighten === 0 && !this.isPreventSelect) {\n                parent.notify('freehand-draw', { prop: 'updateFHDColl', onPropertyChange: false, value: { isPreventApply: isPreventApply } });\n            }\n        }\n        if (parent.transform.degree === 0) {\n            this.drawZoomImgToCanvas(zoomFact, this.tempActiveObj);\n            var panObj_1 = { panRegion: '' };\n            parent.notify('crop', { prop: 'getCurrFlipState', onPropertyChange: false, value: { panObj: panObj_1 } });\n            if (panObj_1['panRegion'] !== '') {\n                parent.notify('crop', { prop: 'setTempFlipPanPoint', onPropertyChange: false, value: { point: parent.panPoint.totalPannedPoint, isAdd: true } });\n                objColl = extend([], parent.objColl, [], true);\n                parent.objColl = [];\n                var destLeft = parent.img.destLeft;\n                var destTop = parent.img.destTop;\n                this.setDestPointsForFlipState();\n                this.rotatedFlip();\n                parent.img.destLeft = destLeft;\n                parent.img.destTop = destTop;\n                parent.objColl = objColl;\n                parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n                    value: { ctx: this.lowerContext, shape: 'zoom', pen: 'zoom', isPreventApply: isPreventApply } });\n                if (parent.transform.straighten === 0 && !this.isPreventSelect) {\n                    parent.notify('freehand-draw', { prop: 'updateFHDColl', onPropertyChange: false, value: { isPreventApply: isPreventApply } });\n                }\n            }\n            if (zoomFactor <= minZoomFactor && !parent.isCropTab) {\n                parent.panPoint.totalPannedPoint = { x: 0, y: 0 };\n            }\n        }\n        else {\n            if (parent.transform.straighten === 0 && !this.isPreventSelect) {\n                parent.notify('freehand-draw', { prop: 'updateFHDColl', onPropertyChange: false, value: { isPreventApply: isPreventApply } });\n            }\n            parent.panPoint.totalPannedClientPoint = { x: 0, y: 0 };\n            parent.panPoint.totalPannedInternalPoint = { x: 0, y: 0 };\n            this.rotateZoom(zoomFact);\n            var panObj_2 = { panRegion: '' };\n            parent.notify('crop', { prop: 'getCurrFlipState', onPropertyChange: false, value: { panObj: panObj_2 } });\n            if (panObj_2['panRegion'] !== '') {\n                var temp = this.lowerContext.filter;\n                this.lowerContext.filter = 'none';\n                parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n                    value: { ctx: this.lowerContext, shape: 'zoom', pen: 'zoom', isPreventApply: isPreventApply } });\n                this.lowerContext.filter = temp;\n            }\n        }\n        var powerOften = Math.pow(10, 1);\n        if (zoomFactor <= minZoomFactor ||\n            (Math.round(parent.transform.zoomFactor * powerOften) / powerOften) === 2) {\n            clearInterval(this.zoomBtnHold);\n            this.zoomBtnHold = 0;\n        }\n        var panObj = { panRegion: '' };\n        parent.notify('crop', { prop: 'getCurrFlipState', onPropertyChange: false, value: { panObj: panObj } });\n        if (panObj['panRegion'] === '') {\n            var temp = this.lowerContext.filter;\n            this.lowerContext.filter = 'none';\n            parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n                value: { ctx: this.lowerContext, shape: 'zoom', pen: 'zoom', isPreventApply: isPreventApply } });\n            this.lowerContext.filter = temp;\n        }\n        if ((parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle') || parent.isCircleCrop) {\n            parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                value: { context: this.lowerContext, isSave: null, isFlip: null } });\n        }\n        parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        if (this.tempActiveObj) {\n            parent.activeObj = extend({}, this.tempActiveObj, {}, true);\n            parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: parent.activeObj } });\n            if (zoomFactor <= minZoomFactor) {\n                parent.currSelectionPoint = null;\n            }\n        }\n        parent.isUndoRedo = false;\n        var zoomOut;\n        zoomOut = document.querySelector('#' + parent.element.id + '_zoomOut');\n        if (zoomOut && zoomFactor <= minZoomFactor) {\n            zoomOut.classList.add('e-disabled');\n            zoomOut.parentElement.classList.add('e-overlay');\n        }\n        else if (zoomOut) {\n            zoomOut.classList.remove('e-disabled');\n            zoomOut.parentElement.classList.remove('e-overlay');\n        }\n        var drawingShape = parent.drawingShape;\n        this.autoEnablePan();\n        parent.drawingShape = drawingShape;\n        if (this.tempActiveObj) {\n            parent.activeObj = extend({}, this.tempActiveObj, {}, true);\n        }\n        if (parent.activeObj.shape === 'crop-custom') {\n            parent.currObjType.isCustomCrop = true;\n        }\n        if (this.isShape) {\n            if (shapeId) {\n                for (var i = 0, len = parent.objColl.length; i < len; i++) {\n                    if (parent.objColl[i].currIndex === shapeId) {\n                        parent.activeObj = extend({}, parent.objColl[i], {}, true);\n                        parent.objColl.splice(i, 1);\n                        break;\n                    }\n                }\n            }\n            else {\n                parent.activeObj = extend({}, parent.objColl[parent.objColl.length - 1], {}, true);\n                parent.objColl.pop();\n            }\n            parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: parent.activeObj, isCropRatio: null,\n                    points: null, isPreventDrag: true, saveContext: null, isPreventSelection: null } });\n            parent.notify('toolbar', { prop: 'update-toolbar-items', onPropertyChange: false });\n            parent.notify('toolbar', { prop: 'renderQAT', onPropertyChange: false, value: { isPenEdit: null } });\n        }\n        parent.notify('toolbar', { prop: 'enable-disable-btns', onPropertyChange: false });\n        parent.notify('selection', { prop: 'setZoomType', onPropertyChange: false, value: { zoomType: 'Toolbar' } });\n        // eslint-disable-next-line max-len\n        zoomEventArgs = { zoomPoint: zoomEventArgs.zoomPoint, previousZoomFactor: zoomEventArgs.previousZoomFactor, currentZoomFactor: zoomEventArgs.currentZoomFactor, zoomTrigger: zoomEventArgs.zoomTrigger };\n        if (!parent.isCropToolbar && parent.isZoomBtnClick) {\n            parent.isZoomBtnClick = false;\n        }\n        if (parent.drawingShape) {\n            var activeObj = extend({}, parent.activeObj, {}, true);\n            parent.enableShapeDrawing(parent.toPascalCase(parent.drawingShape), true);\n            parent.activeObj = activeObj;\n            if (activeObj.activePoint.width > 0 || activeObj.activePoint.height > 0 ||\n                (activeObj.pointColl && activeObj.pointColl.length > 0)) {\n                if (activeObj.shape === 'redact') {\n                    parent.notify('toolbar', { prop: 'renderQAT', onPropertyChange: false, value: { isPenEdit: null } });\n                }\n                var zOrderElem = parent.element.querySelector('#' + parent.element.id + '_zOrderBtn');\n                var dupElem = parent.element.querySelector('#' + parent.element.id + '_duplicate');\n                var removeElem = parent.element.querySelector('#' + parent.element.id + '_remove');\n                var editTextElem = parent.element.querySelector('#' + parent.element.id + '_editText');\n                if (zOrderElem) {\n                    zOrderElem.classList.remove('e-overlay');\n                }\n                if (dupElem) {\n                    dupElem.classList.remove('e-overlay');\n                }\n                if (removeElem) {\n                    removeElem.classList.remove('e-overlay');\n                }\n                if (editTextElem) {\n                    editTextElem.classList.remove('e-overlay');\n                }\n            }\n        }\n        else if (parent.activeObj.shape && parent.activeObj.shape === 'redact') {\n            parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'redact',\n                    isApplyBtn: false, isCropping: false } });\n            parent.notify('toolbar', { prop: 'renderQAT', onPropertyChange: false, value: { isPenEdit: null } });\n        }\n    };\n    Transform.prototype.disableZoomOutBtn = function (isZoomOut) {\n        var parent = this.parent;\n        var _a = parent.zoomSettings, zoomFactor = _a.zoomFactor, minZoomFactor = _a.minZoomFactor;\n        var isDisabled = false;\n        var zoomOut;\n        if (!isNullOrUndefined(isZoomOut)) {\n            parent.transform.zoomFactor -= 0.1;\n        }\n        zoomOut = parent.element.querySelector('#' + parent.element.id + '_zoomOut');\n        var destPoints = { destLeft: parent.img.destLeft, destTop: parent.img.destTop,\n            destWidth: parent.img.destWidth, destHeight: parent.img.destHeight };\n        if (parent.activeObj.shape) {\n            var maxDimension = this.setZoomDimension(-0.1, parent.activeObj);\n            if (!isNullOrUndefined(zoomOut)) {\n                var actPoint = parent.activeObj.activePoint;\n                if (parent.transform.straighten === 0) {\n                    if (parent.img.destLeft > actPoint.startX || parent.img.destTop >\n                        actPoint.startY || parent.img.destLeft + parent.img.destWidth <\n                        actPoint.endX || parent.img.destTop + parent.img.destHeight < actPoint.endY\n                        || zoomFactor === minZoomFactor) {\n                        zoomOut.classList.add('e-disabled');\n                        zoomOut.parentElement.classList.add('e-overlay');\n                        isDisabled = true;\n                    }\n                    else {\n                        zoomOut.classList.remove('e-disabled');\n                        zoomOut.parentElement.classList.remove('e-overlay');\n                        isDisabled = false;\n                    }\n                }\n                else {\n                    parent.img.destWidth = maxDimension.width;\n                    parent.img.destHeight = maxDimension.height;\n                    var obj = { isIntersect: null };\n                    parent.notify('draw', { prop: 'updateImgCanvasPoints', onPropertyChange: false });\n                    parent.notify('draw', { prop: 'isLinesIntersect', onPropertyChange: false, value: { obj: obj } });\n                    if (obj['isIntersect'] ||\n                        zoomFactor === minZoomFactor) {\n                        zoomOut.classList.add('e-disabled');\n                        zoomOut.parentElement.classList.add('e-overlay');\n                        isDisabled = true;\n                    }\n                    else {\n                        zoomOut.classList.remove('e-disabled');\n                        zoomOut.parentElement.classList.remove('e-overlay');\n                        isDisabled = false;\n                    }\n                }\n            }\n        }\n        else {\n            this.setZoomDimension(-0.1, null);\n        }\n        if (!isNullOrUndefined(isZoomOut)) {\n            parent.transform.zoomFactor += 0.1;\n        }\n        parent.img.destLeft = destPoints['destLeft'];\n        parent.img.destTop = destPoints['destTop'];\n        parent.img.destWidth = destPoints['destWidth'];\n        parent.img.destHeight = destPoints['destHeight'];\n        return isDisabled;\n    };\n    Transform.prototype.drawZoomImgToCanvas = function (value, selectionObj) {\n        var parent = this.parent;\n        var powerOften = Math.pow(10, 1);\n        var zmFactor = Math.round(parent.transform.zoomFactor * powerOften) / powerOften;\n        if ((zmFactor === 0.1 && value === -0.1) || zmFactor === 0 && value === -0.025) {\n            parent.transform.zoomFactor = 0;\n        }\n        else {\n            parent.transform.zoomFactor += value;\n        }\n        parent.transform[parent.isCropTab ? 'cropZoomFactor' : 'defaultZoomFactor'] = parent.transform.zoomFactor;\n        var maxDimension = { width: 0, height: 0 };\n        if (parent.isCropTab) {\n            maxDimension = this.cropZoom(value, selectionObj);\n        }\n        else {\n            maxDimension = this.calcMaxDimension(parent.img.srcWidth, parent.img.srcHeight);\n            maxDimension.width += (maxDimension.width * parent.transform.zoomFactor);\n            maxDimension.height += (maxDimension.height * parent.transform.zoomFactor);\n            parent.img.destLeft = (parent.lowerCanvas.clientWidth - maxDimension.width) / 2;\n            parent.img.destTop = (parent.lowerCanvas.clientHeight - maxDimension.height + 1) / 2;\n        }\n        parent.notify('draw', { prop: 'draw-image-to-canvas', value: { dimension: maxDimension } });\n        maxDimension.width = this.cropDimension.width;\n        maxDimension.height = this.cropDimension.height;\n        maxDimension.width += (maxDimension.width * parent.transform.zoomFactor);\n        maxDimension.height += (maxDimension.height * parent.transform.zoomFactor);\n        parent.notify('draw', { prop: 'setZoomCropWidth', value: { width: maxDimension.width, height: maxDimension.height } });\n    };\n    Transform.prototype.rotatedFlip = function () {\n        var parent = this.parent;\n        this.isReverseFlip = true;\n        var tempCurrFlipState = parent.transform.currFlipState;\n        var tempFlipColl = this.flipColl;\n        var tempObjColl = extend([], parent.objColl, [], true);\n        var tempActiveObj = extend({}, parent.activeObj, {}, true);\n        this.flipColl = [];\n        parent.objColl = [];\n        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        parent.notify('draw', { prop: 'currTransState', onPropertyChange: false,\n            value: { type: 'initial', isPreventDestination: null, context: null, isPreventCircleCrop: null } });\n        var temp = this.lowerContext.filter;\n        parent.notify('draw', { prop: 'drawImage', onPropertyChange: false });\n        this.lowerContext.filter = temp;\n        parent.notify('draw', { prop: 'currTransState', onPropertyChange: false,\n            value: { type: 'reverse', isPreventDestination: true, context: null, isPreventCircleCrop: null } });\n        if (tempCurrFlipState === '' && parent.transform.currFlipState !== '') {\n            tempCurrFlipState = parent.transform.currFlipState;\n        }\n        parent.transform.currFlipState = tempCurrFlipState;\n        this.flipColl = tempFlipColl;\n        parent.objColl = extend([], tempObjColl, [], true);\n        this.lowerContext.filter = 'none';\n        parent.notify('shape', { prop: 'iterateObjColl', onPropertyChange: false });\n        this.lowerContext.filter = temp;\n        if (tempActiveObj.activePoint.width !== 0) {\n            parent.activeObj = extend({}, tempActiveObj, {}, true);\n        }\n        this.isReverseFlip = false;\n    };\n    Transform.prototype.rotateZoom = function (value) {\n        var parent = this.parent;\n        var powerOften = Math.pow(10, 1);\n        var zmFactor = Math.round(parent.transform.zoomFactor * powerOften) / powerOften;\n        if ((zmFactor === 0.1 && value === -0.1) || zmFactor === 0 && value === -0.025) {\n            parent.transform.zoomFactor = 0;\n        }\n        else {\n            parent.transform.zoomFactor += value;\n        }\n        if (parent.isCropTab) {\n            parent.transform.cropZoomFactor = parent.transform.zoomFactor;\n        }\n        else {\n            parent.transform.defaultZoomFactor = parent.transform.zoomFactor;\n        }\n        var tempObjColl = extend([], parent.objColl, [], true);\n        var tempActiveObj = extend({}, parent.activeObj, {}, true);\n        parent.objColl = [];\n        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        parent.notify('draw', { prop: 'updateCurrTransState', onPropertyChange: false,\n            value: { type: 'initial', isPreventDestination: null, isRotatePan: null } });\n        parent.notify('draw', { prop: 'setRotateZoom', onPropertyChange: false, value: { isRotateZoom: true } });\n        parent.notify('draw', { prop: 'setDestPoints', onPropertyChange: false });\n        var temp = this.lowerContext.filter;\n        parent.notify('draw', { prop: 'drawImage', onPropertyChange: false });\n        this.lowerContext.filter = temp;\n        parent.notify('draw', { prop: 'setRotateZoom', onPropertyChange: false, value: { isRotateZoom: false } });\n        parent.notify('draw', { prop: 'updateCurrTransState', onPropertyChange: false,\n            value: { type: 'reverse', isPreventDestination: null, isRotatePan: null } });\n        parent.objColl = tempObjColl;\n        parent.activeObj = tempActiveObj;\n        var maxDimension = { width: this.cropDimension.width, height: this.cropDimension.height };\n        maxDimension.width += (maxDimension.width * parent.transform.zoomFactor);\n        maxDimension.height += (maxDimension.height * parent.transform.zoomFactor);\n        parent.notify('draw', { prop: 'setZoomCropWidth', value: { width: maxDimension.width, height: maxDimension.height } });\n    };\n    Transform.prototype.autoEnablePan = function () {\n        var parent = this.parent;\n        if (parent.transform.zoomFactor <= 0) {\n            parent.togglePan = false;\n            parent.notify('selection', { prop: 'setDragCanvas', value: { bool: false } });\n            parent.pan(false);\n            this.disablePan = false;\n        }\n        else {\n            parent.pan(!this.disablePan);\n        }\n    };\n    Transform.prototype.cropZoom = function (value, selectionObj) {\n        var parent = this.parent;\n        var destLeft = parent.img.destLeft;\n        var destTop = parent.img.destTop;\n        var maxDimension = { width: 0, height: 0 };\n        if (parent.transform.degree % 90 === 0 && parent.transform.degree % 180 !== 0) {\n            maxDimension = this.calcMaxDimension(parent.img.srcHeight, parent.img.srcWidth);\n        }\n        else {\n            maxDimension = this.calcMaxDimension(parent.img.srcWidth, parent.img.srcHeight);\n        }\n        maxDimension.width += (maxDimension.width * parent.transform.zoomFactor);\n        maxDimension.height += (maxDimension.height * parent.transform.zoomFactor);\n        parent.img.destLeft = destLeft - ((maxDimension.width - parent.img.destWidth) / 2);\n        parent.img.destTop = destTop - ((maxDimension.height - parent.img.destHeight) / 2);\n        destLeft = parent.img.destLeft;\n        destTop = parent.img.destTop;\n        if (selectionObj && parent.transform.straighten === 0) {\n            if (parent.img.destLeft > selectionObj.activePoint.startX) {\n                parent.img.destLeft = selectionObj.activePoint.startX;\n                if (parent.transform.degree === 0) {\n                    parent.panPoint.totalPannedPoint.x -= (destLeft - parent.img.destLeft);\n                }\n            }\n            if (parent.img.destTop > selectionObj.activePoint.startY) {\n                parent.img.destTop = selectionObj.activePoint.startY;\n                if (parent.transform.degree === 0) {\n                    parent.panPoint.totalPannedPoint.y -= (destTop - parent.img.destTop);\n                }\n            }\n            if (parent.img.destLeft + maxDimension.width < selectionObj.activePoint.endX) {\n                parent.img.destLeft = selectionObj.activePoint.endX - maxDimension.width;\n                if (parent.transform.degree === 0) {\n                    parent.panPoint.totalPannedPoint.x -= (destLeft - parent.img.destLeft);\n                }\n            }\n            if (parent.img.destTop + maxDimension.height < selectionObj.activePoint.endY) {\n                parent.img.destTop = selectionObj.activePoint.endY - maxDimension.height;\n                if (parent.transform.degree === 0) {\n                    parent.panPoint.totalPannedPoint.y -= (destTop - parent.img.destTop);\n                }\n            }\n        }\n        return maxDimension;\n    };\n    Transform.prototype.setZoomDimension = function (value, selectionObj) {\n        var parent = this.parent;\n        var degree = parent.transform.degree;\n        var maxDimension = { width: 0, height: 0 };\n        if (degree % 90 === 0 && degree % 180 !== 0) {\n            maxDimension = this.calcMaxDimension(parent.img.srcHeight, parent.img.srcWidth);\n        }\n        else {\n            maxDimension = this.calcMaxDimension(parent.img.srcWidth, parent.img.srcHeight);\n        }\n        maxDimension.width += (maxDimension.width * parent.transform.zoomFactor);\n        maxDimension.height += (maxDimension.height * parent.transform.zoomFactor);\n        parent.img.destLeft += ((parent.img.destWidth - maxDimension.width) / 2);\n        parent.img.destTop += ((parent.img.destHeight - maxDimension.height) / 2);\n        // While zoom out limit image to draw inside the selection range\n        if (value < 0 && selectionObj) {\n            var startX = selectionObj.activePoint.startX;\n            var startY = selectionObj.activePoint.startY;\n            var width = selectionObj.activePoint.width;\n            var height = selectionObj.activePoint.height;\n            var maxDestLeft = parent.img.destLeft + maxDimension.width;\n            var maxDestTop = parent.img.destTop + maxDimension.height;\n            if (parent.img.destLeft > startX) {\n                parent.img.destLeft = startX;\n            }\n            if (parent.img.destTop > startY) {\n                parent.img.destTop = startY;\n            }\n            if (maxDestLeft < startX + width) {\n                parent.img.destLeft = startX + width - maxDimension.width;\n            }\n            if (maxDestTop < startY + height) {\n                parent.img.destTop = startY + height - maxDimension.height;\n            }\n        }\n        else if (value < 0 && isNullOrUndefined(selectionObj)) {\n            if (parent.img.destLeft > 0) {\n                parent.img.destLeft = 0;\n            }\n            if (parent.img.destTop > 0) {\n                parent.img.destTop = 0;\n            }\n            if (parent.img.destLeft + maxDimension.width < parent.lowerCanvas.clientWidth) {\n                parent.img.destLeft = parent.lowerCanvas.clientWidth - parent.img.destWidth;\n            }\n            if (parent.img.destTop + maxDimension.height < parent.lowerCanvas.clientHeight) {\n                parent.img.destTop = parent.lowerCanvas.clientHeight - parent.img.destHeight;\n            }\n        }\n        return maxDimension;\n    };\n    Transform.prototype.drawPannedImage = function (xDiff, yDiff) {\n        var parent = this.parent;\n        var obj = { panDown: null };\n        parent.notify('selection', { prop: 'getPanDown', onPropertyChange: false, value: { obj: obj } });\n        var panEventArgs = { startPoint: obj['panDown'], endPoint: this.panMove, cancel: false };\n        parent.trigger('panning', panEventArgs);\n        if (panEventArgs.cancel) {\n            return;\n        }\n        this.panEvent(xDiff, yDiff);\n    };\n    Transform.prototype.panEvent = function (xDiff, yDiff, isPanMethod) {\n        var parent = this.parent;\n        var isObjCreated = false;\n        if (parent.activeObj.shape && parent.activeObj.shape === 'shape') {\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        }\n        if (isNullOrUndefined(parent.activeObj.shape)) {\n            isObjCreated = true;\n            var actPoint = parent.activeObj.activePoint = { startX: parent.img.destLeft, startY: parent.img.destTop,\n                endX: parent.img.destLeft + parent.img.destWidth, endY: parent.img.destTop + parent.img.destHeight };\n            var startX = actPoint.startX;\n            var startY = actPoint.startY;\n            var endX = actPoint.endX;\n            var endY = actPoint.endY;\n            if (startX < 0) {\n                actPoint.startX = 0;\n            }\n            if (startY < 0) {\n                actPoint.startY = 0;\n            }\n            if (endX > parent.lowerCanvas.width) {\n                actPoint.endX = parent.lowerCanvas.width;\n            }\n            if (endY > parent.lowerCanvas.height) {\n                actPoint.endY = parent.lowerCanvas.height;\n            }\n            actPoint.width = actPoint.endX - actPoint.startX;\n            actPoint.height = actPoint.endY - actPoint.startY;\n            parent.activeObj.shape = 'crop-custom';\n            var obj = { strokeSettings: {} };\n            parent.notify('shape', { prop: 'getStrokeSettings', onPropertyChange: false, value: { obj: obj } });\n            parent.activeObj.strokeSettings = obj['strokeSettings'];\n            parent.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: actPoint, obj: parent.activeObj,\n                    isMouseMove: null, x: null, y: null } });\n            parent.isCropTab = true;\n        }\n        if (parent.transform.degree === 0) {\n            var point = void 0;\n            if ((isNullOrUndefined(xDiff) && isNullOrUndefined(yDiff)) || isPanMethod) {\n                if (isPanMethod) {\n                    point = this.updatePanPoints(xDiff, yDiff);\n                }\n                else {\n                    point = this.updatePanPoints();\n                }\n            }\n            else {\n                point = { x: xDiff, y: yDiff };\n            }\n            parent.panPoint.totalPannedPoint.x += point.x;\n            parent.panPoint.totalPannedPoint.y += point.y;\n            var tempSelectionObj = extend({}, parent.activeObj, {}, true);\n            var temp = this.lowerContext.filter;\n            this.drawPannImage(point, isObjCreated);\n            this.lowerContext.filter = temp;\n            this.tempPanMove = extend({}, this.panMove, {}, true);\n            parent.activeObj = extend({}, tempSelectionObj, {}, true);\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            if (parent.activeObj.shape) {\n                parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: parent.activeObj } });\n            }\n        }\n        else {\n            var tempFlipState = parent.transform.currFlipState;\n            parent.isCropTab = true;\n            if ((isNullOrUndefined(xDiff) && isNullOrUndefined(yDiff)) || isPanMethod) {\n                if (isPanMethod) {\n                    parent.panPoint.currentPannedPoint = this.updatePanPoints(xDiff, yDiff);\n                }\n                else {\n                    parent.panPoint.currentPannedPoint = this.updatePanPoints();\n                }\n            }\n            else {\n                parent.panPoint.currentPannedPoint = { x: xDiff, y: yDiff };\n            }\n            parent.transform.currFlipState = tempFlipState;\n            this.rotatePan(null, null, isObjCreated);\n            parent.isCropTab = false;\n            this.tempPanMove = extend({}, this.panMove, {}, true);\n        }\n        if (isObjCreated) {\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            parent.isCropTab = false;\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        }\n    };\n    Transform.prototype.drawPannImage = function (point, isObjCreated) {\n        var parent = this.parent;\n        var filter = this.lowerContext.filter;\n        var destPoints = { startX: parent.img.destLeft, startY: parent.img.destTop, width: parent.img.destWidth,\n            height: parent.img.destHeight };\n        this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        parent.notify('draw', { prop: 'updateCurrTransState', onPropertyChange: false,\n            value: { type: 'initial', isPreventDestination: null, isRotatePan: null } });\n        parent.img.destLeft = destPoints.startX;\n        parent.img.destTop = destPoints.startY;\n        parent.img.destWidth = destPoints.width;\n        parent.img.destHeight = destPoints.height;\n        this.setDestPointsForFlipState();\n        if (isObjCreated) {\n            parent.isCropTab = false;\n        }\n        parent.notify('draw', { prop: 'drawImage', onPropertyChange: false });\n        if (isObjCreated) {\n            parent.isCropTab = true;\n        }\n        if ((parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle') || parent.isCircleCrop) {\n            parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                value: { context: this.lowerContext, isSave: null, isFlip: true } });\n        }\n        this.lowerContext.filter = filter;\n        parent.notify('draw', { prop: 'updateCurrTransState', onPropertyChange: false,\n            value: { type: 'reverse', isPreventDestination: null, isRotatePan: null } });\n        parent.img.destLeft = destPoints.startX;\n        parent.img.destTop = destPoints.startY;\n        parent.img.destWidth = destPoints.width;\n        parent.img.destHeight = destPoints.height;\n        var temp = this.lowerContext.filter;\n        this.lowerContext.filter = 'none';\n        if (isObjCreated) {\n            parent.isCropTab = false;\n        }\n        parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n            value: { ctx: this.lowerContext, shape: 'pan', pen: 'pan', x: point.x,\n                y: point.y, panRegion: '' } });\n        if (isObjCreated) {\n            parent.isCropTab = true;\n        }\n        this.lowerContext.filter = temp;\n        parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n        if (parent.isCircleCrop) {\n            parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                value: { context: this.lowerContext, isSave: null, isFlip: true } });\n        }\n    };\n    Transform.prototype.resetZoom = function () {\n        var parent = this.parent;\n        if (parent.transform.defaultZoomFactor !== 0) {\n            var isUndoRedo = parent.isUndoRedo;\n            var object = { currObj: {} };\n            parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n            this.transCurrObj = object['currObj'];\n            this.transCurrObj.objColl = extend([], parent.objColl, null, true);\n            this.transCurrObj.pointColl = extend({}, parent.pointColl, null, true);\n            this.transCurrObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n            var selPointCollObj = { selPointColl: null };\n            parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n                value: { obj: selPointCollObj } });\n            this.transCurrObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n            parent.isUndoRedo = parent.isCropToolbar = true;\n            var zmFactor = parent.transform.defaultZoomFactor;\n            if (zmFactor > 0) {\n                this.zoomAction(-zmFactor);\n            }\n            else {\n                this.zoomAction(Math.abs(zmFactor));\n            }\n            parent.isCropToolbar = false;\n            parent.isUndoRedo = isUndoRedo;\n        }\n    };\n    Transform.prototype.performTransformation = function (text) {\n        var parent = this.parent;\n        this.resetZoom();\n        this.updateTransform(text);\n        for (var i = 0, len = parent.objColl.length; i < len; i++) {\n            if (parent.objColl[i].flipObjColl.length > 0) {\n                var flipObjColl = { collection: parent.objColl[i].flipObjColl };\n                parent.notify('shape', { prop: 'alignRotateFlipColl', onPropertyChange: false,\n                    value: { collection: flipObjColl['collection'], isRotateFlipCollection: null, obj: flipObjColl } });\n                parent.objColl[i].flipObjColl = flipObjColl['collection'];\n                if (parent.objColl[i].flipObjColl.length === 0) {\n                    parent.objColl[i].shapeFlip = '';\n                }\n            }\n        }\n    };\n    Transform.prototype.updateTransform = function (text) {\n        switch (text.toLowerCase()) {\n            case 'rotateleft':\n                this.rotateImage(-90);\n                break;\n            case 'rotateright':\n                this.rotateImage(90);\n                break;\n            case 'horizontalflip':\n                this.flipImage(Direction.Horizontal);\n                break;\n            case 'verticalflip':\n                this.flipImage(Direction.Vertical);\n                break;\n        }\n    };\n    Transform.prototype.rotatePan = function (isCropSelection, isDefaultZoom, isObjCreated) {\n        var parent = this.parent;\n        this.isReverseRotate = true;\n        var tempDegree = parent.transform.degree;\n        var rotatePanActiveObj;\n        var object = { selPointColl: null };\n        if (parent.activeObj.activePoint && parent.activeObj.shape) {\n            rotatePanActiveObj = extend({}, parent.activeObj, {}, true);\n        }\n        var tempObjColl = extend([], parent.objColl, [], true);\n        var tempPointColl = extend([], parent.pointColl, [], true);\n        parent.objColl = [];\n        parent.pointColl = [];\n        parent.freehandCounter = 0;\n        parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false, value: { obj: object } });\n        var cropSelPointColl = object['selPointColl'];\n        parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false, value: { obj: { selPointColl: [] } } });\n        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        parent.notify('draw', { prop: 'setRotateZoom', onPropertyChange: false, value: { isRotateZoom: true } });\n        parent.notify('draw', { prop: 'updateCurrTransState', onPropertyChange: false,\n            value: { type: 'initial', isPreventDestination: null, isRotatePan: null } });\n        var initialDestLeft = parent.img.destLeft;\n        var initialDestTop = parent.img.destTop;\n        var intPan = parent.panPoint.totalPannedInternalPoint;\n        if (parent.isCropTab) {\n            parent.img.destLeft += intPan.x;\n            parent.img.destTop += intPan.y;\n        }\n        parent.notify('crop', { prop: 'updateRotatePan', onPropertyChange: false });\n        if (parent.isCropTab) {\n            parent.panPoint.totalPannedInternalPoint.x = parent.img.destLeft - initialDestLeft;\n            parent.panPoint.totalPannedInternalPoint.y = parent.img.destTop - initialDestTop;\n        }\n        var temp = this.lowerContext.filter;\n        if (isObjCreated) {\n            parent.isCropTab = false;\n        }\n        parent.notify('draw', { prop: 'drawImage', onPropertyChange: false });\n        if (isObjCreated) {\n            parent.isCropTab = true;\n        }\n        parent.notify('draw', { prop: 'setRotateZoom', onPropertyChange: false, value: { isRotateZoom: false } });\n        parent.notify('draw', { prop: 'updateCurrTransState', onPropertyChange: false,\n            value: { type: 'reverse', isPreventDestination: true, isRotatePan: true } });\n        var destLeft = parent.img.destLeft;\n        var destTop = parent.img.destTop;\n        parent.img.destLeft += parent.panPoint.totalPannedClientPoint.x;\n        parent.img.destTop += parent.panPoint.totalPannedClientPoint.y;\n        parent.img.destLeft += parent.panPoint.currentPannedPoint.x;\n        parent.img.destTop += parent.panPoint.currentPannedPoint.y;\n        parent.panPoint.totalPannedClientPoint.x = parent.img.destLeft - destLeft;\n        parent.panPoint.totalPannedClientPoint.y = parent.img.destTop - destTop;\n        parent.objColl = tempObjColl;\n        parent.pointColl = tempPointColl;\n        parent.freehandCounter = parent.pointColl.length;\n        parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false,\n            value: { obj: { selPointColl: cropSelPointColl } } });\n        parent.transform.degree = tempDegree;\n        this.lowerContext.filter = 'none';\n        if (isCropSelection) {\n            if (isDefaultZoom) {\n                parent.panPoint.totalPannedClientPoint.x = -parent.panPoint.totalPannedClientPoint.x;\n                parent.panPoint.totalPannedClientPoint.y = -parent.panPoint.totalPannedClientPoint.y;\n                parent.panPoint.currentPannedPoint = extend({}, parent.panPoint.totalPannedClientPoint, {}, true);\n                parent.panPoint.totalPannedClientPoint = { x: 0, y: 0 };\n                parent.img.destLeft += parent.panPoint.currentPannedPoint.x;\n                parent.img.destTop += parent.panPoint.currentPannedPoint.y;\n            }\n            else {\n                parent.panPoint.currentPannedPoint = extend({}, parent.panPoint.totalPannedClientPoint, {}, true);\n            }\n        }\n        if (isObjCreated) {\n            parent.isCropTab = false;\n        }\n        parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n            value: { ctx: this.lowerContext, shape: 'pan', pen: 'pan', x: parent.panPoint.currentPannedPoint.x,\n                y: parent.panPoint.currentPannedPoint.y, panRegion: '' } });\n        if (isObjCreated) {\n            parent.isCropTab = true;\n        }\n        this.lowerContext.filter = temp;\n        parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        parent.activeObj = extend({}, rotatePanActiveObj, {}, true);\n        if (parent.activeObj.activePoint) {\n            parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: parent.activeObj, isCropRatio: null,\n                    points: null, isPreventDrag: true, saveContext: null, isPreventSelection: null } });\n        }\n        this.isReverseRotate = false;\n    };\n    Transform.prototype.limitPan = function () {\n        var parent = this.parent;\n        var _a = parent.activeObj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY;\n        var img = parent.img;\n        if (parent.activeObj.activePoint) {\n            if (img.destLeft > startX) {\n                parent.img.destLeft = startX;\n            }\n            if (img.destTop > startY) {\n                parent.img.destTop = startY;\n            }\n            if (img.destLeft + img.destWidth < endX) {\n                parent.img.destLeft = endX - img.destWidth;\n            }\n            if (img.destTop + img.destHeight < endY) {\n                parent.img.destTop = endY - img.destHeight;\n            }\n        }\n    };\n    Transform.prototype.pan = function (value, x, y) {\n        var parent = this.parent;\n        if (!parent.disabled && parent.isImageLoaded) {\n            if (value) {\n                parent.togglePan = true;\n                parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n                    value: { x: null, y: null, isMouseDown: null } });\n                parent.notify('selection', { prop: 'setDragCanvas', value: { bool: true } });\n                parent.lowerCanvas.style.cursor = parent.upperCanvas.style.cursor = parent.cursor = 'grab';\n                parent.notify('selection', { prop: 'setPanDown', onPropertyChange: false, value: { panDown: null } });\n                if (x || y) {\n                    x = x ? x : 0;\n                    y = y ? y : 0;\n                    if (isNullOrUndefined(this.panMove)) {\n                        this.panMove = { x: x, y: y };\n                    }\n                    if (isNullOrUndefined(this.tempPanMove)) {\n                        this.tempPanMove = { x: this.panMove.x, y: this.panMove.y };\n                    }\n                    this.panEvent(x, y, true);\n                    this.tempPanMove = null;\n                }\n            }\n            else {\n                parent.togglePan = parent.currObjType.isCustomCrop = false;\n                parent.notify('selection', { prop: 'setDragCanvas', value: { bool: false } });\n                parent.lowerCanvas.style.cursor = parent.upperCanvas.style.cursor = parent.cursor = 'default';\n            }\n        }\n    };\n    Transform.prototype.zoom = function (zoomFactor, zoomPoint) {\n        var parent = this.parent;\n        if (!parent.disabled && parent.isImageLoaded) {\n            var value = this.getCurrentZoomFactor(zoomFactor);\n            if (isNullOrUndefined(zoomPoint)) {\n                this.zoomAction(value, zoomPoint);\n            }\n            else {\n                var type = value > 0 ? 'zoomIn' : 'zoomOut';\n                var absValue = Math.abs(value) * 10;\n                for (var i = 0; i < absValue; i++) {\n                    parent.notify('draw', { prop: 'performPointZoom', onPropertyChange: false,\n                        value: { x: zoomPoint.x, y: zoomPoint.y, type: type, isResize: null } });\n                }\n            }\n            var actionArgs = { action: value > 0 ? 'zoom-in' : 'zoom-out',\n                actionEventArgs: parent.editCompleteArgs };\n            parent.triggerEditCompleteEvent(actionArgs);\n        }\n    };\n    Transform.prototype.getCurrentZoomFactor = function (zoomFactor) {\n        return zoomFactor >= 1 ? (this.prevZoomValue < 1 ? (zoomFactor - this.prevZoomValue) : (zoomFactor - this.prevZoomValue) * 0.1) :\n            (zoomFactor - this.prevZoomValue);\n    };\n    Transform.prototype.setCurrPanRegion = function (region, type, obj) {\n        var panRegion = region;\n        if (region === '') {\n            panRegion = type === 'horizontal' ? 'horizontal' : type === 'vertical' ? 'vertical' : region;\n        }\n        else if (region === 'horizontal') {\n            panRegion = type === 'horizontal' ? 'horizontalVertical' : type === 'vertical' ? 'verticalHorizontal' : type === 90 ?\n                'vertical' : type === -90 ? 'horizontal' : region;\n        }\n        else if (region === 'vertical') {\n            panRegion = type === 'horizontal' ? 'horizontalVertical' : type === 'vertical' ? 'verticalHorizontal' : type === 90 ?\n                'horizontal' : type === -90 ? 'vertical' : region;\n        }\n        else {\n            panRegion = type === 'horizontal' ? 'vertical' : type === 'vertical' ? 'horizontal' : region;\n        }\n        obj['panRegion'] = panRegion;\n    };\n    Transform.prototype.rotate = function (degree, obj) {\n        var parent = this.parent;\n        var isRotate = false;\n        if (!parent.disabled && parent.isImageLoaded && (degree % 90 === 0)) {\n            this.rotateImage(degree);\n        }\n        obj['isRotate'] = isRotate;\n    };\n    Transform.prototype.flip = function (direction) {\n        var parent = this.parent;\n        if (!parent.disabled && parent.isImageLoaded) {\n            this.flipImage(direction);\n        }\n    };\n    Transform.prototype.update = function () {\n        var parent = this.parent;\n        var toolbarHeight = 0;\n        var isActiveObj = false;\n        var freehandObj = { bool: false };\n        var straightenObj = { bool: parent.isStraightening };\n        var cxtTbarHeight = 0;\n        var ctToolbar = parent.element.querySelector('#' + parent.element.id + '_contextualToolbar');\n        var ctWrapper = parent.element.querySelector('.e-contextual-toolbar-wrapper');\n        var hdWrapper = parent.element.querySelector('#' + parent.element.id + '_headWrapper');\n        if (parent.isImageLoaded) {\n            var isCropSelection = false;\n            var splitWords = void 0;\n            if (Browser.isDevice) {\n                if (parent.activeObj.shape) {\n                    splitWords = parent.activeObj.shape.split('-');\n                }\n                if (parent.currObjType.isCustomCrop) {\n                    isCropSelection = true;\n                }\n                else if (splitWords && splitWords[0] === 'crop') {\n                    isCropSelection = true;\n                }\n            }\n            var frameObj = { bool: null };\n            parent.notify('toolbar', { prop: 'getFrameToolbar', onPropertyChange: false, value: { obj: frameObj } });\n            if (!straightenObj['bool'] && ((ctToolbar && !ctToolbar.parentElement.classList.contains('e-hide')) ||\n                (hdWrapper && !hdWrapper.parentElement.classList.contains('e-hide')))) {\n                ctWrapper.classList.add('e-hide');\n                if (!isCropSelection) {\n                    parent.okBtn(null, true);\n                }\n                parent.notify('toolbar', { prop: 'refresh-main-toolbar', onPropertyChange: false });\n                parent.notify('toolbar', { prop: 'destroy-qa-toolbar', onPropertyChange: false });\n            }\n            parent.notify('selection', { prop: 'getFreehandDrawEditing', onPropertyChange: false, value: { obj: freehandObj } });\n            if (freehandObj['bool']) {\n                parent.notify('toolbar', { prop: 'destroy-qa-toolbar', onPropertyChange: false });\n            }\n            var actPoint = extend({}, parent.activeObj.activePoint, {}, true);\n            if (parent.activeObj.shape && (actPoint.width !== 0 || actPoint.height !== 0)) {\n                isActiveObj = true;\n                if (parent.textArea.style.display === 'block' || parent.textArea.style.display === 'inline-block') {\n                    parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n                        value: { x: null, y: null, isMouseDown: null } });\n                    parent.notify('toolbar', { prop: 'destroy-qa-toolbar', onPropertyChange: false });\n                }\n                else {\n                    parent.notify('shape', { prop: 'updImgRatioForActObj', onPropertyChange: false });\n                    parent.objColl.push(parent.activeObj);\n                }\n                parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            }\n        }\n        var tempFilter = this.lowerContext.filter;\n        var canvasWrapper = parent.element.querySelector('#' + parent.element.id + '_canvasWrapper');\n        if (canvasWrapper) {\n            canvasWrapper.style.width = parent.element.offsetWidth - 2 + 'px';\n        }\n        parent.lowerCanvas.width = parent.upperCanvas.width = parent.maskCanvas.width = parent.element.offsetWidth - 2;\n        if (parent.toolbarTemplate) {\n            toolbarHeight = parent.element.querySelector('#' + parent.element.id + '_toolbarArea').clientHeight;\n        }\n        else if (parent.element.querySelector('#' + parent.element.id + '_toolbar')) {\n            toolbarHeight = parent.element.querySelector('#' + parent.element.id + '_toolbar').clientHeight;\n            if (toolbarHeight === 0 && parent.toolbar && parent.toolbar.length > 0 && parent.toolbar.indexOf('Open') === -1) {\n                var obj = { toolbarHeight: 0 };\n                parent.notify('toolbar', { prop: 'getToolbarHeight', value: { obj: obj } });\n                toolbarHeight = obj['toolbarHeight'];\n            }\n        }\n        var ctxTbarArea = parent.element.querySelector('#' + parent.element.id + '_contextualToolbarArea');\n        if (Browser.isDevice && straightenObj['bool'] && ctxTbarArea) {\n            cxtTbarHeight = ctxTbarArea.clientHeight;\n        }\n        parent.notify('toolbar', { prop: 'setToolbarHeight', value: { height: toolbarHeight } });\n        if (Browser.isDevice) {\n            if (canvasWrapper) {\n                canvasWrapper.style.height = parent.element.offsetHeight - ((2 * toolbarHeight) + cxtTbarHeight) - 4 + 'px';\n            }\n        }\n        else {\n            if (canvasWrapper) {\n                canvasWrapper.style.height = parent.element.offsetHeight - toolbarHeight - 2 + 'px';\n            }\n        }\n        parent.lowerCanvas.height = parent.upperCanvas.height = parseFloat(canvasWrapper.style.height);\n        this.lowerContext.filter =\n            'brightness(' + 1 + ') ' + 'contrast(' + 100 + '%) ' + 'hue-rotate(' + 0 + 'deg) ' +\n                'saturate(' + 100 + '%) ' + 'opacity(' + 1 + ') ' + 'blur(' + 0 + 'px) ' + 'sepia(0%) ' + 'grayscale(0%) ' + 'invert(0%)';\n        parent.notify('filter', { prop: 'setAdjustmentValue', onPropertyChange: false, value: { adjustmentValue: this.lowerContext.filter } });\n        parent.canvasFilter = this.lowerContext.filter;\n        parent.initialAdjustmentValue = this.lowerContext.filter;\n        parent.clearContext(this.lowerContext);\n        parent.clearContext(this.upperContext);\n        if (parent.isImageLoaded) {\n            parent.notify('shape', { prop: 'applyActObj', onPropertyChange: false, value: { isMouseDown: null } });\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            this.lowerContext.filter = tempFilter;\n            parent.initialAdjustmentValue = tempFilter;\n            parent.canvasFilter = this.lowerContext.filter;\n            if (parent.isImageLoaded) {\n                showSpinner(parent.element);\n                parent.element.style.opacity = '0.5';\n            }\n            this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            if (canvasWrapper) {\n                canvasWrapper.style.width = parent.element.offsetWidth - 2 + 'px';\n                canvasWrapper.style.height = parent.element.offsetHeight + 'px';\n                var obj_1 = { toolbarHeight: 0 };\n                parent.notify('toolbar', { prop: 'getToolbarHeight', value: { obj: obj_1 } });\n                if (Browser.isDevice) {\n                    canvasWrapper.style.height = (parseFloat(canvasWrapper.style.height) - (2 * obj_1['toolbarHeight']) - cxtTbarHeight) - 4 + 'px';\n                }\n                else {\n                    canvasWrapper.style.height = (parseFloat(canvasWrapper.style.height) - obj_1['toolbarHeight']) - 2 + 'px';\n                }\n            }\n            parent.lowerCanvas.width = parent.upperCanvas.width = parent.maskCanvas.width =\n                parseFloat(canvasWrapper.style.width);\n            parent.lowerCanvas.height = parent.upperCanvas.height = parent.maskCanvas.height =\n                parseFloat(canvasWrapper.style.height);\n            this.lowerContext.filter = tempFilter;\n            var obj = { width: 0, height: 0 };\n            this.calcMaxDimension(parent.img.srcWidth, parent.img.srcHeight, obj);\n            var maxDimension = obj;\n            if (straightenObj['bool'] && parent.transform.cropZoomFactor !== 0) {\n                maxDimension.width += (maxDimension.width * parent.transform.cropZoomFactor);\n                maxDimension.height += (maxDimension.height * parent.transform.cropZoomFactor);\n            }\n            else if (parent.transform.defaultZoomFactor > 0) {\n                maxDimension.width += (maxDimension.width * parent.transform.defaultZoomFactor);\n                maxDimension.height += (maxDimension.height * parent.transform.defaultZoomFactor);\n            }\n            parent.img.destLeft = (parent.lowerCanvas.clientWidth - maxDimension.width) / 2;\n            parent.img.destTop = (parent.lowerCanvas.clientHeight - maxDimension.height + 1) / 2;\n            if (parent.transform.degree === 0 && parent.transform.currFlipState === '') {\n                if (parent.transform.defaultZoomFactor > 0) {\n                    parent.img.destLeft += parent.panPoint.totalPannedPoint.x;\n                    parent.img.destTop += parent.panPoint.totalPannedPoint.y;\n                }\n                parent.notify('draw', { prop: 'draw-image-to-canvas', value: { dimension: maxDimension } });\n            }\n            else {\n                parent.notify('draw', { prop: 'draw-image-to-canvas', value: { dimension: maxDimension } });\n                parent.notify('draw', { prop: 'updateCurrTransState', onPropertyChange: false,\n                    value: { type: 'initial', isPreventDestination: null, isRotatePan: null } });\n                var temp = this.lowerContext.filter;\n                parent.notify('draw', { prop: 'drawImage', onPropertyChange: false });\n                this.lowerContext.filter = temp;\n                parent.notify('draw', { prop: 'updateCurrTransState', onPropertyChange: false,\n                    value: { type: 'reverse', isPreventDestination: null, isRotatePan: null } });\n            }\n            parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n                value: { ctx: this.lowerContext, shape: 'zoom', pen: 'zoom', isPreventApply: null } });\n            parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n            parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.upperContext } });\n            if (parent.isCircleCrop) {\n                parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                    value: { context: this.lowerContext, isSave: null, isFlip: null } });\n            }\n            hideSpinner(parent.element);\n            parent.element.style.opacity = '1';\n            var obj1 = { defToolbarItems: null };\n            parent.notify('toolbar', { prop: 'getDefToolbarItems', value: { obj: obj1 } });\n            if (obj1['defToolbarItems'] && obj1['defToolbarItems'].length > 0 && document.getElementById(parent.element.id + '_toolbar')) {\n                /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                var toolbar_1 = getComponent(parent.element.id + '_toolbar', 'toolbar');\n                if (toolbar_1) {\n                    toolbar_1.refreshOverflow();\n                }\n                if (ctWrapper && !straightenObj['bool']) {\n                    ctWrapper.classList.add('e-hide');\n                }\n            }\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            if (isActiveObj) {\n                var activeObj = extend({}, parent.objColl[parent.objColl.length - 1], null, true);\n                parent.objColl.pop();\n                if (activeObj.activePoint.width !== 0 && activeObj.activePoint.height !== 0) {\n                    this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n                    parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: null } });\n                    parent.objColl.push(activeObj);\n                    parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n                        value: { ctx: this.lowerContext, shape: 'zoom', pen: 'zoom', isPreventApply: null } });\n                    activeObj = extend({}, parent.objColl[parent.objColl.length - 1], null, true);\n                    parent.objColl.pop();\n                    this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n                    parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: null } });\n                    parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: activeObj } });\n                    if (straightenObj['bool']) {\n                        parent.notify('draw', { prop: 'setStraightenActObj', value: { activeObj: activeObj } });\n                    }\n                    if (parent.activeObj.shape === 'rectangle' || parent.activeObj.shape === 'ellipse' || parent.activeObj.shape === 'text' ||\n                        parent.activeObj.shape === 'line' || parent.activeObj.shape === 'arrow' || parent.activeObj.shape === 'path' ||\n                        parent.activeObj.shape === 'image') {\n                        parent.notify('toolbar', { prop: 'renderQAT', onPropertyChange: false, value: { isPenEdit: null } });\n                    }\n                }\n            }\n            if (freehandObj['bool']) {\n                parent.notify('toolbar', { prop: 'renderQAT', onPropertyChange: false, value: { isPenEdit: true } });\n            }\n            if (parent.isResize) {\n                parent.aspectWidth = Math.ceil(parent.img.destWidth);\n                parent.aspectHeight = Math.ceil(parent.img.destHeight);\n                parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'resize',\n                        isApplyBtn: false, isCropping: false } });\n                parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'resize',\n                        isApplyBtn: false, isCropping: false } });\n            }\n            if ((parent.transform.degree !== 0 || parent.transform.currFlipState !== '') && parent.transform.defaultZoomFactor > 0) {\n                var totalPannedPoint = extend({}, parent.panPoint.totalPannedPoint, null, true);\n                var totalPannedInternalPoint = extend({}, parent.panPoint.totalPannedInternalPoint, null, true);\n                var totalPannedClientPoint = extend({}, parent.panPoint.totalPannedClientPoint, null, true);\n                this.zoomAction(.1);\n                this.zoomAction(-.1);\n                if (parent.transform.degree === 0) {\n                    parent.img.destLeft += totalPannedPoint.x;\n                    parent.img.destTop += totalPannedPoint.y;\n                    parent.panPoint.totalPannedPoint = totalPannedPoint;\n                    parent.notify('draw', { prop: 'updateFlipPan', value: { tempSelectionObj: null } });\n                }\n                else {\n                    parent.panPoint.totalPannedInternalPoint = totalPannedInternalPoint;\n                    parent.panPoint.totalPannedClientPoint = totalPannedClientPoint;\n                    parent.panPoint.currentPannedPoint = { x: 0, y: 0 };\n                    parent.isCropTab = true;\n                    this.rotatePan();\n                    parent.isCropTab = false;\n                }\n            }\n            else if (parent.transform.degree !== 0 && parent.transform.cropZoomFactor > 0) {\n                parent.transform.zoomFactor = 0;\n                parent.transform.cropZoomFactor = null;\n                parent.notify('toolbar', { prop: 'enable-disable-btns', onPropertyChange: false });\n            }\n        }\n    };\n    Transform.prototype.calcMaxDimension = function (width, height, obj, isImgShape) {\n        var object = { toolbarHeight: 0 };\n        var parent = this.parent;\n        parent.notify('toolbar', { prop: 'getToolbarHeight', value: { obj: object } });\n        var canvasMaxWidth = isImgShape ? parent.element.clientWidth / 3 :\n            parent.element.clientWidth;\n        var canvasMaxHeight = isImgShape ? (parent.element.clientHeight - object['toolbarHeight']) / 3 :\n            parent.element.clientHeight - (object['toolbarHeight']); // 1px border\n        canvasMaxHeight = Browser.isDevice ? canvasMaxHeight - (object['toolbarHeight']) : canvasMaxHeight; // 1px border\n        if (Browser.isDevice && parent.isStraightening) {\n            var cxtTbar = parent.element.querySelector('#' + parent.element.id + '_contextualToolbarArea');\n            canvasMaxHeight -= cxtTbar ? cxtTbar.clientHeight : 0;\n        }\n        if (!isImgShape && parent.element.clientHeight === 0) {\n            canvasMaxHeight = 0;\n        }\n        if (isNullOrUndefined(isImgShape)) {\n            if (canvasMaxWidth > 30) {\n                canvasMaxWidth -= 30;\n            }\n            if (canvasMaxHeight > 30) {\n                canvasMaxHeight -= 30;\n            }\n        }\n        var widthScale = canvasMaxWidth / width;\n        var heightScale = canvasMaxHeight / height;\n        var cssMaxWidth = Math.min(width, canvasMaxWidth);\n        var cssMaxHeight = Math.min(height, canvasMaxHeight);\n        if (widthScale < 1 && widthScale < heightScale) {\n            cssMaxWidth = width * widthScale;\n            cssMaxHeight = height * widthScale;\n        }\n        else if (heightScale < 1 && heightScale < widthScale) {\n            cssMaxWidth = width * heightScale;\n            cssMaxHeight = height * heightScale;\n        }\n        if (isNullOrUndefined(isImgShape)) {\n            var cropObj = { bool: null };\n            parent.notify('crop', { prop: 'getPreventScaling', onPropertyChange: false,\n                value: { obj: cropObj } });\n            if (cropObj['bool'] && parent.cropObj.activeObj.activePoint &&\n                parent.cropObj.activeObj.activePoint.width !== 0 && parent.cropObj.activeObj.activePoint.height !== 0) {\n                cssMaxWidth = parent.cropObj.activeObj.activePoint.width;\n                cssMaxHeight = parent.cropObj.activeObj.activePoint.height;\n            }\n        }\n        if (obj) {\n            obj['width'] = cssMaxWidth;\n            obj['height'] = cssMaxHeight;\n        }\n        return { width: cssMaxWidth, height: cssMaxHeight };\n    };\n    Transform.prototype.updatePanPoints = function (x, y) {\n        var parent = this.parent;\n        var tempActObj = extend({}, parent.activeObj, {}, true);\n        var tempDestLeft = parent.img.destLeft;\n        var tempDestTop = parent.img.destTop;\n        if (isNullOrUndefined(this.tempPanMove)) {\n            this.tempPanMove = { x: this.panMove.x, y: this.panMove.y };\n        }\n        var xDiff = this.panMove.x - this.tempPanMove.x;\n        var yDiff = this.panMove.y - this.tempPanMove.y;\n        if (x || y) {\n            xDiff = x;\n            yDiff = y;\n        }\n        parent.img.destLeft += xDiff;\n        parent.img.destTop += yDiff;\n        this.limitPan();\n        var obj = { bool: null };\n        var object = { isIntersect: null };\n        parent.notify('draw', { prop: 'updateImgCanvasPoints', onPropertyChange: false });\n        parent.notify('draw', { prop: 'isLinesIntersect', onPropertyChange: false, value: { obj: object } });\n        parent.notify('draw', { prop: 'isSelOutsideImg', onPropertyChange: false, value: { obj: obj } });\n        var count = 0;\n        while (parent.transform.straighten !== 0 && (object['isIntersect'] || obj['bool'])) {\n            count++;\n            parent.img.destLeft = tempDestLeft;\n            parent.img.destTop = tempDestTop;\n            if (xDiff !== 0 && xDiff > 0) {\n                xDiff -= 1;\n            }\n            else if (xDiff !== 0 && xDiff < 0) {\n                xDiff += 1;\n            }\n            if (yDiff !== 0 && yDiff > 0) {\n                yDiff -= 1;\n            }\n            else if (yDiff !== 0 && yDiff < 0) {\n                yDiff += 1;\n            }\n            if ((xDiff === 0 && yDiff === 0) || count === 200) {\n                break;\n            }\n            parent.img.destLeft += xDiff;\n            parent.img.destTop += yDiff;\n            this.limitPan();\n            parent.notify('draw', { prop: 'updateImgCanvasPoints', onPropertyChange: false });\n            parent.notify('draw', { prop: 'isLinesIntersect', onPropertyChange: false, value: { obj: object } });\n            parent.notify('draw', { prop: 'isSelOutsideImg', onPropertyChange: false, value: { obj: obj } });\n        }\n        parent.activeObj = tempActObj;\n        return { x: parent.img.destLeft - tempDestLeft, y: parent.img.destTop - tempDestTop };\n    };\n    Transform.prototype.resizeImage = function (width, height) {\n        var parent = this.parent;\n        var temp = true;\n        var temp1 = true;\n        parent.allowDownScale = false;\n        parent.img.srcLeft = 0;\n        parent.img.srcTop = 0;\n        parent.isAspectRatio = true;\n        var minimum = [];\n        parent.img.srcWidth = parent.baseImgCanvas.width;\n        parent.img.srcHeight = parent.baseImgCanvas.height;\n        if (parent.resizeSrc && parent.resizeSrc.width !== 0 && parent.resizeSrc.height !== 0) {\n            parent.img.srcLeft = parent.resizeSrc.startX;\n            parent.img.srcTop = parent.resizeSrc.startY;\n            parent.img.srcWidth = parent.resizeSrc.width;\n            parent.img.srcHeight = parent.resizeSrc.height;\n        }\n        while ((width < parent.img.destWidth || height < parent.img.destHeight) && temp1) {\n            this.zoomAction(-.1, null, true, true);\n            if (width > parent.img.destWidth || height > parent.img.destHeight) {\n                while (width > parent.img.destWidth || height > parent.img.destHeight) {\n                    this.zoomAction(0.0125, null, true, true);\n                    temp1 = false;\n                    minimum.push(parent.img.destWidth);\n                }\n            }\n        }\n        while ((width > parent.img.destWidth || height > parent.img.destHeight) && temp1 && temp) {\n            this.zoomAction(.1, null, true, true);\n            if (width < parent.img.destWidth || height < parent.img.destHeight) {\n                while (width < parent.img.destWidth) {\n                    this.zoomAction(-.0125, null, true, true);\n                    temp = false;\n                    minimum.push(parent.img.destWidth);\n                }\n            }\n        }\n        var nearestNumber = minimum[0];\n        var smallestDifference = Math.abs(parent.img.destWidth - nearestNumber);\n        for (var _i = 0, minimum_1 = minimum; _i < minimum_1.length; _i++) {\n            var num = minimum_1[_i];\n            var difference = Math.abs(width - num);\n            if (difference < smallestDifference) {\n                nearestNumber = num;\n                smallestDifference = difference;\n            }\n        }\n        if (nearestNumber < width && temp) {\n            this.zoomAction(-.0125, null, true, true);\n            temp = false;\n        }\n        if (nearestNumber > width && !temp) {\n            this.zoomAction(.0125, null, true, true);\n            temp = false;\n        }\n        this.zoomAction(.0125, null, true);\n        parent.allowDownScale = true;\n        this.zoomAction(-.0125, null, true);\n        var prevCropObj = extend({}, parent.cropObj, {}, true);\n        var prevObj = extend({}, this.prevResizeCurrObj, {}, true);\n        parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false, value: { operation: 'resize',\n                previousObj: prevObj, previousObjColl: prevObj.objColl, previousPointColl: prevObj.pointColl,\n                previousSelPointColl: prevObj.selPointColl, previousCropObj: prevCropObj, previousText: null, currentText: null,\n                previousFilter: null, isCircleCrop: parent.isCircleCrop } });\n        parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n    };\n    Transform.prototype.resizeCrop = function (width, height) {\n        var parent = this.parent;\n        var temp = true;\n        var obj1 = { prevObj: parent.prevObj };\n        parent.cropObj = extend({}, parent.prevCropObj, {}, true);\n        parent.allowDownScale = false;\n        parent.notify('toolbar', { prop: 'getPrevObj', onPropertyChange: false, value: { obj: obj1 } });\n        var activeObj = extend({}, obj1['prevObj']['activeObj'], {}, true);\n        obj1['prevObj']['activeObj'] = extend({}, parent.activeObj, {}, true);\n        parent.notify('draw', { prop: 'setCurrentObj', onPropertyChange: false, value: { obj: obj1['prevObj'] } });\n        parent.objColl = extend([], obj1['prevObj']['objColl'], [], true);\n        parent.pointColl = extend([], obj1['prevObj']['pointColl'], [], true);\n        parent.transform.straighten = 0;\n        parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n            value: { ctx: this.lowerContext, shape: 'zoom', pen: 'zoom', isPreventApply: null } });\n        if (parent.transform.straighten === 0 && !this.isPreventSelect) {\n            parent.notify('freehand-draw', { prop: 'updateFHDColl', onPropertyChange: false });\n        }\n        var tempwidth = width;\n        var tempheight = height;\n        var tempZoom = false;\n        if (height >= width && height <= Math.ceil(parent.img.destHeight)) {\n            while ((height <= Math.ceil(parent.img.destHeight)) && temp) {\n                this.zoomAction(-.1, null, true, true);\n                if (width > parent.img.destWidth || height > parent.img.destHeight) {\n                    while (width > parent.img.destWidth || height > parent.img.destHeight) {\n                        this.zoomAction(.0125, null, true, true);\n                        temp = false;\n                    }\n                }\n            }\n        }\n        else if (height <= width && width < parent.img.destWidth) {\n            while ((width < parent.img.destWidth) && temp) {\n                this.zoomAction(-.1, null, true, true);\n                if (width > parent.img.destWidth || height > parent.img.destHeight) {\n                    while (width > parent.img.destWidth || height > parent.img.destHeight) {\n                        this.zoomAction(.0125, null, true, true);\n                        temp = false;\n                    }\n                }\n            }\n        }\n        else if (height >= width && height >= parent.img.destHeight) {\n            while ((height >= parent.img.destHeight) && temp) {\n                this.zoomAction(.1, null, true, true);\n            }\n        }\n        else if (width >= height && width >= parent.img.destWidth) {\n            while ((width >= parent.img.destWidth) && temp) {\n                this.zoomAction(.1, null, true, true);\n            }\n            if (width < parent.img.destWidth && height < parent.img.destHeight) {\n                while (width < parent.img.destWidth && height < parent.img.destHeight) {\n                    this.zoomAction(-.0125, null, true, true);\n                    temp = false;\n                }\n                this.zoomAction(.0125, null, true, true);\n            }\n        }\n        else if (height > parent.img.destHeight && width > parent.img.destWidth) {\n            while ((height > parent.img.destHeight) && (width > parent.img.destWidth) && temp) {\n                this.zoomAction(.1, null, true, true);\n            }\n            if (width < parent.img.destWidth && height < parent.img.destHeight) {\n                while (width < parent.img.destWidth && height < parent.img.destHeight) {\n                    this.zoomAction(-.0125, null, true, true);\n                    temp = false;\n                }\n                this.zoomAction(.0125, null, true, true);\n            }\n        }\n        this.resizeImg(activeObj, width, height);\n        width = tempwidth;\n        height = tempheight;\n        if ((height !== parent.img.destHeight || width !== parent.img.destWidth)) {\n            while ((height > parent.img.destHeight || width > parent.img.destWidth)) {\n                this.zoomAction(.0125, null, true, true);\n                tempZoom = true;\n            }\n            if (tempZoom) {\n                this.zoomAction(-.0125, null, true, true);\n                tempZoom = false;\n            }\n        }\n        if ((height !== parent.img.destHeight || width !== parent.img.destWidth)) {\n            while ((height < parent.img.destHeight || width < parent.img.destWidth)) {\n                this.zoomAction(-.0125, null, true, true);\n                tempZoom = true;\n            }\n            if (tempZoom) {\n                this.zoomAction(-.0125, null, true, true);\n                tempZoom = false;\n            }\n        }\n        obj1['prevObj']['activeObj'] = extend({}, activeObj, {}, true);\n        this.zoomAction(.0125, null, true);\n        parent.allowDownScale = this.preventDownScale ? false : true;\n        parent.isCropTab = false;\n        this.zoomAction(-.0125, null, true);\n        parent.aspectWidth = width;\n        parent.aspectHeight = height;\n    };\n    Transform.prototype.resizeImg = function (activeObj, width, height) {\n        var parent = this.parent;\n        var widthRatio = width / parent.img.destWidth;\n        var heightRatio = height / parent.img.destHeight;\n        if (activeObj.shape) {\n            parent.currSelectionPoint = activeObj;\n            parent.notify('crop', { prop: 'setInitCrop', onPropertyChange: false, value: { bool: true } });\n        }\n        else if (parent.img.srcWidth === parent.baseImgCanvas.width && parent.img.srcHeight === parent.baseImgCanvas.height) {\n            parent.currSelectionPoint = null;\n            parent.notify('draw', { prop: 'select', onPropertyChange: false,\n                value: { type: 'custom', startX: null, startY: null, width: null, height: null } });\n        }\n        if (isNullOrUndefined(parent.currSelectionPoint)) {\n            parent.notify('draw', { prop: 'select', onPropertyChange: false,\n                value: { type: 'custom', startX: parent.img.destLeft, startY: parent.img.destTop,\n                    width: parent.img.destWidth, height: parent.img.destHeight } });\n        }\n        else {\n            parent.notify('draw', { prop: 'select', onPropertyChange: false,\n                value: { type: 'custom', startX: null, startY: null, width: null, height: null } });\n        }\n        width = parent.activeObj.activePoint.width * widthRatio;\n        height = parent.activeObj.activePoint.height * heightRatio;\n        var sx = (parent.activeObj.activePoint.startX + (parent.activeObj.activePoint.width / 2)) - (width / 2);\n        var sy = (parent.activeObj.activePoint.startY + (parent.activeObj.activePoint.height / 2)) - (height / 2);\n        var count = 0;\n        while (Browser.isDevice && count < 500 && (sx < 0 || sy < 0 || (sx + width) > parent.img.destWidth\n            || (sy + height) > parent.img.destHeight)) {\n            count++;\n            width -= 1;\n            height -= 1;\n            sx = (parent.activeObj.activePoint.startX + (parent.activeObj.activePoint.width / 2)) - (width / 2);\n            sy = (parent.activeObj.activePoint.startY + (parent.activeObj.activePoint.height / 2)) - (height / 2);\n        }\n        parent.transform.defaultZoomFactor = 0;\n        parent.notify('draw', { prop: 'setResizeSelect', value: { bool: true } });\n        parent.notify('draw', { prop: 'setIsCropSelect', value: { bool: true } });\n        parent.notify('draw', { prop: 'select', onPropertyChange: false,\n            value: { type: 'custom', startX: sx, startY: sy, width: width, height: height } });\n        parent.notify('draw', { prop: 'setResizeSelect', value: { bool: false } });\n        if (parent.transform.straighten !== 0) {\n            var obj = { isIntersect: null, arr: null };\n            parent.notify('draw', { prop: 'updateImgCanvasPoints', onPropertyChange: false });\n            parent.notify('draw', { prop: 'isLinesIntersect', onPropertyChange: false, value: { obj: obj } });\n            while (obj['arr'][0] || obj['arr'][1] || obj['arr'][2] || obj['arr'][3]) {\n                this.zoomAction(.0125, null, true);\n                parent.notify('draw', { prop: 'updateImgCanvasPoints', onPropertyChange: false });\n                parent.notify('draw', { prop: 'isLinesIntersect', onPropertyChange: false, value: { obj: obj } });\n            }\n        }\n        parent.isCropToolbar = true;\n        parent.crop();\n        parent.isCropToolbar = false;\n    };\n    Transform.prototype.updateResize = function () {\n        var parent = this.parent;\n        parent.prevCropObj = extend({}, parent.cropObj, {}, true);\n        var currObject = { currObj: {} };\n        parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: currObject } });\n        parent.prevObj = currObject['currObj'];\n        if (parent.currSelectionPoint && parent.prevCropObj.activeObj.shape) {\n            parent.prevObj.activeObj = extend({}, parent.prevCropObj.activeObj, {}, true);\n        }\n        parent.prevObj.objColl = extend([], parent.objColl, [], true);\n        parent.prevObj.pointColl = extend([], parent.pointColl, [], true);\n        parent.prevObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: selPointCollObj } });\n        parent.prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        parent.resizeSrc = { startX: parent.img.srcLeft, startY: parent.img.srcTop, width: parent.img.srcWidth,\n            height: parent.img.srcHeight };\n    };\n    Transform.prototype.resize = function (width, height, isAspectRatio) {\n        var parent = this.parent;\n        var aspectHeight;\n        parent.isResize = true;\n        if (isNullOrUndefined(parent.prevCropObj) && isNullOrUndefined(parent.prevObj)) {\n            parent.notify('transform', { prop: 'updateResize', value: { bool: false } });\n        }\n        var aspectIcon = parent.element.querySelector('#' + parent.element.id + '_aspectratio');\n        var nonAspectIcon = parent.element.querySelector('#' + parent.element.id + '_nonaspectratio');\n        if (aspectIcon && nonAspectIcon) {\n            parent.notify('toolbar', { prop: 'initResizeToolbar' });\n            if (Browser.isDevice) {\n                parent.notify('toolbar', { prop: 'init-main-toolbar', value: { isApplyBtn: false, isDevice: true, isOkBtn: true, isResize: true } });\n            }\n        }\n        var aspectRatioHeight = parent.element.querySelector('#' + parent.element.id + '_resizeHeight');\n        if (aspectRatioHeight) {\n            aspectHeight = aspectRatioHeight.value === '' ? aspectRatioHeight.placeholder : aspectRatioHeight.value;\n        }\n        else {\n            aspectHeight = height + 'px';\n        }\n        var resizeEventArgs = { cancel: false, previousWidth: Math.ceil(parent.img.destWidth),\n            previousHeight: Math.ceil(parent.img.destHeight), width: Math.ceil(width), height: height && height !== 0 ? Math.ceil(height) :\n                (isAspectRatio ? Math.ceil(parseFloat(aspectHeight)) : Math.ceil(parent.img.destHeight)),\n            isAspectRatio: isAspectRatio ? isAspectRatio : false };\n        parent.trigger('resizing', resizeEventArgs);\n        parent.editCompleteArgs = resizeEventArgs;\n        if (!resizeEventArgs.cancel) {\n            this.resizeEventHandler(resizeEventArgs);\n        }\n        else if (parent.aspectHeight && parent.aspectWidth) {\n            parent.aspectHeight = resizeEventArgs.previousHeight;\n            parent.aspectWidth = resizeEventArgs.previousWidth;\n        }\n    };\n    Transform.prototype.resizeEventHandler = function (args) {\n        var parent = this.parent;\n        var isRotate;\n        var aspectRatioWidth = parent.element.querySelector('#' + parent.element.id + '_resizeWidth');\n        var aspectRatioHeight = parent.element.querySelector('#' + parent.element.id + '_resizeHeight');\n        if (args.isAspectRatio) {\n            if (this.resizedImgAngle == null || this.resizedImgAngle !== parent.transform.degree) {\n                this.resizedImgAngle = parent.transform.degree;\n                isRotate = true;\n            }\n            if (isRotate) {\n                parent.notify('transform', { prop: 'resizeImage', value: { width: args.width, height: 0 } });\n                var originalWidth = parent.img.destWidth;\n                var originalHeight = parent.img.destHeight;\n                var aspectRatioWidthValue = void 0;\n                if (aspectRatioHeight) {\n                    aspectRatioWidthValue = parseFloat(aspectRatioWidth.value === '' ? aspectRatioWidth.placeholder : aspectRatioWidth.value);\n                    var value = aspectRatioWidthValue / (originalWidth / originalHeight);\n                    // eslint-disable-next-line max-len\n                    var height = value % 1 >= 0.5 || value % 1 <= -0.5 ? Math.round(value) : (value < 0) ? Math.ceil(value) : Math.floor(value);\n                    getComponent(aspectRatioHeight, 'numerictextbox').value = height;\n                    aspectRatioHeight.value = height.toString() + ' px';\n                    parent.aspectHeight = height;\n                    if (aspectRatioWidth && aspectRatioWidth.value === '') {\n                        var aspectRatioHeightValue = parseFloat(aspectRatioHeight.value === '' ? aspectRatioHeight.placeholder :\n                            aspectRatioHeight.value);\n                        value = aspectRatioHeightValue / (originalHeight / originalWidth);\n                        // eslint-disable-next-line max-len\n                        var width = value % 1 >= 0.5 || value % 1 <= -0.5 ? Math.round(value) : (value < 0) ? Math.ceil(value) : Math.floor(value);\n                        getComponent(aspectRatioWidth, 'numerictextbox').value = width;\n                        aspectRatioWidth.value = width.toString() + ' px';\n                        parent.aspectWidth = width;\n                    }\n                }\n            }\n            else {\n                parent.notify('transform', { prop: 'resizeImage', value: { width: args.width, height: null } });\n            }\n        }\n        else {\n            if (this.resizedImgAngle !== null && this.resizedImgAngle !== parent.transform.degree) {\n                this.resizedImgAngle = parent.transform.degree;\n                isRotate = true;\n            }\n            if (isRotate) {\n                parent.notify('transform', { prop: 'setPreventDownScale', value: { bool: true } });\n                parent.notify('transform', { prop: 'resizeCrop', value: { width: args.width, height: args.height } });\n                parent.notify('undo-redo', { prop: 'setPreventUR', value: { bool: true } });\n                parent.okBtn(null, true);\n                parent.notify('undo-redo', { prop: 'setPreventUR', value: { bool: false } });\n                parent.resizeSrc = { startX: parent.img.srcLeft, startY: parent.img.srcTop, width: parent.img.srcWidth,\n                    height: parent.img.srcHeight };\n                parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'resize',\n                        isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                parent.notify('transform', { prop: 'setPreventDownScale', value: { bool: false } });\n                parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'resize',\n                        isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n            }\n            else {\n                parent.notify('transform', { prop: 'resizeCrop', value: { width: args.width, height: args.height } });\n            }\n        }\n        this.resizedImgAngle = parent.transform.degree;\n    };\n    Transform.prototype.straightenImage = function (degree) {\n        var parent = this.parent;\n        if (parent.toolbar && parent.toolbar.length === 0) {\n            parent.notify('draw', { prop: 'select', onPropertyChange: false,\n                value: { type: 'custom', startX: null, startY: null, width: null, height: null } });\n        }\n        parent.notify('toolbar', { prop: 'performCropTransformClick', value: { shape: null } });\n        parent.setStraighten(degree);\n        parent.okBtn();\n    };\n    return Transform;\n}());\nexport { Transform };\n","import { isNullOrUndefined, extend } from '@syncfusion/ej2-base';\nvar UndoRedo = /** @class */ (function () {\n    function UndoRedo(parent) {\n        this.undoRedoStep = 0;\n        this.undoRedoColl = [];\n        this.appliedUndoRedoColl = [];\n        this.tempUndoRedoColl = [];\n        this.tempUndoRedoStep = 0;\n        this.isPreventing = false;\n        this.parent = parent;\n        this.addEventListener();\n    }\n    UndoRedo.prototype.destroy = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.removeEventListener();\n    };\n    UndoRedo.prototype.addEventListener = function () {\n        this.parent.on('undo-redo', this.undoRedo, this);\n        this.parent.on('destroyed', this.destroy, this);\n    };\n    UndoRedo.prototype.removeEventListener = function () {\n        this.parent.off('undo-redo', this.undoRedo);\n        this.parent.off('destroyed', this.destroy);\n    };\n    UndoRedo.prototype.initializeUrPvtProp = function () {\n        if (this.parent.lowerCanvas) {\n            this.lowerContext = this.parent.lowerCanvas.getContext('2d');\n        }\n        if (this.parent.upperCanvas) {\n            this.upperContext = this.parent.upperCanvas.getContext('2d');\n        }\n    };\n    UndoRedo.prototype.undoRedo = function (args) {\n        this.initializeUrPvtProp();\n        switch (args.prop) {\n            case 'updateUndoRedoColl':\n                this.updateUrc(args.value['operation'], args.value['previousObj'], args.value['previousObjColl'], args.value['previousPointColl'], args.value['previousSelPointColl'], args.value['previousCropObj'], args.value['previousText'], args.value['currentText'], args.value['previousFilter'], args.value['isCircleCrop']);\n                break;\n            case 'refreshUrc':\n                this.refreshUrc(args.value['bool']);\n                break;\n            case 'updateCurrUrc':\n                this.updateCurrUrc(args.value['type'], args.value['isCancel']);\n                break;\n            case 'call-undo':\n                this.callUndo();\n                break;\n            case 'call-redo':\n                this.callRedo();\n                break;\n            case 'undo':\n                this.undo();\n                break;\n            case 'redo':\n                this.redo();\n                break;\n            case 'updateUrObj':\n                this.updateUrObj(args.value['objColl'], args.value['operation']);\n                break;\n            case 'updateUndoRedo':\n                this.updateUndoRedo(args.value ? args.value['operation'] : null);\n                break;\n            case 'getAppliedUndoRedoColl':\n                args.value['obj']['appliedUndoRedoColl'] = this.appliedUndoRedoColl;\n                break;\n            case 'getUndoRedoStep':\n                args.value['obj']['undoRedoStep'] = this.undoRedoStep;\n                break;\n            case 'setUndoRedoStep':\n                this.undoRedoStep = args.value['step'];\n                break;\n            case 'undoDefault':\n                this.undoDefault(args.value['obj']);\n                break;\n            case 'setPreventUR':\n                this.isPreventing = args.value['bool'];\n                break;\n            case 'updateUndoRedoStack':\n                if (args.value && args.value['isPenDraw']) {\n                    this.updateUndoRedoStack(args.value['isPenDraw']);\n                }\n                else {\n                    this.updateUndoRedoStack();\n                }\n                break;\n            case 'reset':\n                this.reset();\n                break;\n        }\n    };\n    UndoRedo.prototype.getModuleName = function () {\n        return 'undo-redo';\n    };\n    UndoRedo.prototype.reset = function () {\n        this.tempCurrSelPoint = null;\n        this.undoRedoStep = 0;\n        this.undoRedoColl = [];\n        this.appliedUndoRedoColl = [];\n        this.tempActObj = null;\n        this.tempUndoRedoColl = [];\n        this.tempUndoRedoStep = 0;\n        this.isPreventing = false;\n    };\n    UndoRedo.prototype.refreshUrc = function (refreshToolbar) {\n        var parent = this.parent;\n        if (parent.isImageUpdated) {\n            return;\n        }\n        refreshToolbar = refreshToolbar ? refreshToolbar : false;\n        if (refreshToolbar) {\n            parent.notify('toolbar', { prop: 'setEnableDisableUndoRedo', value: { isPrevent: true } });\n            this.tempUndoRedoColl = extend([], this.appliedUndoRedoColl, [], true);\n            this.tempUndoRedoStep = this.undoRedoStep;\n        }\n        parent.notify('toolbar', { prop: 'setEnableDisableUndoRedo', value: { isPrevent: false } });\n        this.undoRedoColl = this.undoRedoColl.slice(0, this.undoRedoStep);\n        this.appliedUndoRedoColl = this.appliedUndoRedoColl.slice(0, this.undoRedoStep);\n        parent.isUndoRedo = parent.currObjType.isUndoAction = false;\n        parent.notify('toolbar', { prop: 'enable-disable-btns' });\n    };\n    UndoRedo.prototype.updateCurrUrc = function (type, isCancel) {\n        var parent = this.parent;\n        if (parent.isResize || this.isPreventing || parent.noPushUndo) {\n            return;\n        }\n        parent.notify('toolbar', { prop: 'setEnableDisableUndoRedo', value: { isPrevent: false } });\n        if (type === 'ok') {\n            parent.notify('draw', { prop: 'setShapeTextInsert', onPropertyChange: false, value: { bool: false } });\n            var collection = this.tempUndoRedoColl.length > 0 ?\n                extend([], this.tempUndoRedoColl, [], true) :\n                extend([], this.undoRedoColl, [], true);\n            var prevObj = this.undoRedoColl[this.undoRedoColl.length - 1];\n            var appliedURColl = this.appliedUndoRedoColl[this.appliedUndoRedoColl.length - 1];\n            var prevTransform = prevObj ? extend({}, prevObj.previousObj, {}, true)\n                : null;\n            if (isNullOrUndefined(appliedURColl)) {\n                if (this.undoRedoColl[0]) {\n                    prevObj.previousCropObj = collection[0].previousCropObj;\n                    prevObj.previousObj = collection[0].previousObj;\n                    prevObj.previousObjColl = collection[0].previousObjColl;\n                    prevObj.previousPointColl = collection[0].previousPointColl;\n                    prevObj.previousText = collection[0].previousText;\n                }\n            }\n            else if (prevObj.operation !== 'imageHFlip' && prevObj.operation !== 'imageVFlip') {\n                prevObj.previousCropObj = appliedURColl.currentCropObj;\n                prevObj.previousObj = appliedURColl.currentObj;\n                prevObj.previousObjColl = appliedURColl.currentObjColl;\n                prevObj.previousPointColl = appliedURColl.currentPointColl;\n                prevObj.previousText = appliedURColl.currentText;\n                if (prevObj.operation === 'frame' && prevObj.previousObj && prevTransform) {\n                    prevObj.previousObj.defaultZoom = prevTransform.defaultZoom;\n                    prevObj.previousObj.zoomFactor = prevTransform.zoomFactor;\n                    prevObj.previousObj.cropZoom = prevTransform.cropZoom;\n                }\n            }\n            if (prevObj) {\n                if (prevObj.operation !== 'imageHFlip' && prevObj.operation !== 'imageVFlip') {\n                    var obj = this.getZeroZoomObjPointValue(prevObj.currentObjColl, prevObj.currentPointColl);\n                    prevObj.currentObjColl = obj['obj'];\n                    prevObj.currentPointColl = obj['point'];\n                    var adjObj = { adjustmentLevel: null };\n                    parent.notify('filter', { prop: 'getAdjustmentLevel', onPropertyChange: false, value: { obj: adjObj } });\n                    prevObj.currentObj.adjustmentLevel = extend({}, adjObj['adjustmentLevel'], {}, true);\n                    parent.notify('filter', { prop: 'setTempAdjVal' });\n                    prevObj.currentObj.currentFilter = parent.currentFilter;\n                }\n                this.appliedUndoRedoColl.push(prevObj);\n                if (!isCancel) {\n                    this.triggerActionCompletedEvent(prevObj.operation);\n                }\n            }\n            this.tempUndoRedoColl = [];\n            this.tempUndoRedoStep = 0;\n        }\n        else if (this.tempUndoRedoColl.length > 0) {\n            this.appliedUndoRedoColl = extend([], this.tempUndoRedoColl, [], true);\n            this.undoRedoStep = this.tempUndoRedoStep;\n            this.tempUndoRedoColl = [];\n            this.tempUndoRedoStep = 0;\n        }\n        var lastObj = this.appliedUndoRedoColl[this.appliedUndoRedoColl.length - 1];\n        var lastPrevObj = this.appliedUndoRedoColl[this.appliedUndoRedoColl.length - 2];\n        if (this.appliedUndoRedoColl.length > 16) {\n            this.appliedUndoRedoColl.splice(0, 1);\n        }\n        else if (!isCancel && lastObj && lastPrevObj) {\n            if ((((lastObj.operation === 'shapeTransform' && lastPrevObj.operation === 'shapeTransform') ||\n                (lastObj.operation === 'shapeInsert' && lastPrevObj.operation === 'shapeInsert')) &&\n                JSON.stringify(lastObj.currentObjColl) === JSON.stringify(lastPrevObj.currentObjColl)) ||\n                (lastObj.operation === 'freehand-draw' && lastPrevObj.operation === 'freehand-draw' &&\n                    JSON.stringify(lastObj.currentPointColl) === JSON.stringify(lastPrevObj.currentPointColl)) ||\n                (lastObj.operation === 'freehanddrawCustomized' && lastPrevObj.operation === 'freehanddrawCustomized' &&\n                    JSON.stringify(lastObj.currentPointColl) === JSON.stringify(lastPrevObj.currentPointColl))) {\n                this.appliedUndoRedoColl.splice(this.appliedUndoRedoColl.length - 1, 1);\n            }\n            else if (this.undoRedoStep !== this.appliedUndoRedoColl.length - 1) {\n                lastObj = this.appliedUndoRedoColl[this.appliedUndoRedoColl.length - 1];\n                lastPrevObj = this.appliedUndoRedoColl[this.undoRedoStep];\n                if (lastObj && lastPrevObj && lastObj.operation === 'shapeTransform' &&\n                    lastPrevObj.operation === 'shapeTransform' &&\n                    JSON.stringify(lastObj.currentObjColl) === JSON.stringify(lastPrevObj.previousObjColl)) {\n                    this.appliedUndoRedoColl.splice(this.appliedUndoRedoColl.length - 1, 1);\n                    this.undoRedoColl = [];\n                    this.undoRedoColl = extend([], this.appliedUndoRedoColl, [], true);\n                    return;\n                }\n            }\n        }\n        this.undoRedoColl = [];\n        this.undoRedoColl = extend([], this.appliedUndoRedoColl, [], true);\n        if (type === 'ok') {\n            this.undoRedoStep = this.undoRedoColl.length;\n            parent.notify('toolbar', { prop: 'enable-disable-btns' });\n        }\n        if (parent.transform.zoomFactor > 0) {\n            parent.togglePan = true;\n            parent.notify('selection', { prop: 'setDragCanvas', value: { bool: true } });\n        }\n    };\n    UndoRedo.prototype.triggerActionCompletedEvent = function (action) {\n        var parent = this.parent;\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var actionMap = { 'brightness': 'fine-tune', 'contrast': 'fine-tune', 'hue': 'fine-tune',\n            'saturation': 'fine-tune', 'opacity': 'fine-tune', 'blur': 'fine-tune', 'exposure': 'fine-tune',\n            'default': 'filter', 'chrome': 'filter', 'cold': 'filter', 'warm': 'filter',\n            'grayscale': 'filter', 'sepia': 'filter', 'invert': 'filter',\n            'deleteObj': 'shape-delete', 'deleteFreehandDrawing': 'freehand-draw-delete',\n            'shapeInsert': 'shape-insert', 'shapeTransform': 'shape-customize',\n            'freehanddrawCustomized': 'freehand-draw-customize'\n        };\n        var actionResult = actionMap[action] || action;\n        var actionArgs = { action: actionResult, actionEventArgs: parent.editCompleteArgs };\n        parent.triggerEditCompleteEvent(actionArgs);\n    };\n    UndoRedo.prototype.getUndoRedoAction = function (action) {\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var actionMap = { 'brightness': 'fine-tune', 'contrast': 'fine-tune', 'hue': 'fine-tune',\n            'saturation': 'fine-tune', 'opacity': 'fine-tune', 'blur': 'fine-tune', 'exposure': 'fine-tune',\n            'default': 'filter', 'chrome': 'filter', 'cold': 'filter', 'warm': 'filter',\n            'grayscale': 'filter', 'sepia': 'filter', 'invert': 'filter',\n            'deleteObj': 'shape-delete', 'deleteFreehandDrawing': 'freehand-drawing-delete',\n            'shapeInsert': 'shape-insert', 'shapeTransform': 'shape-customize', 'imageRotate': 'shape-customize',\n            'freehanddraw': 'freehand-draw', 'freehanddrawCustomized': 'freehand-draw-customize',\n            'textAreaCustomization': 'text-area-customization', 'imageHFlip': 'shape-customize',\n            'imageVFlip': 'shape-customize', 'bgColor': 'background-color', 'updateImage': 'image-update'\n        };\n        return actionMap[action] || action;\n    };\n    UndoRedo.prototype.cancelCropSelection = function () {\n        var parent = this.parent;\n        var isCropSelection = false;\n        var splitWords;\n        if (parent.activeObj.shape) {\n            splitWords = parent.activeObj.shape.split('-');\n        }\n        if (parent.currObjType.isCustomCrop || (splitWords && splitWords[0] === 'crop')) {\n            isCropSelection = true;\n        }\n        if (isCropSelection) {\n            parent.notify('draw', { prop: 'performCancel', value: { isContextualToolbar: null } });\n        }\n        if (this.tempUndoRedoColl.length !== 0 || this.tempUndoRedoStep !== 0) {\n            this.appliedUndoRedoColl = extend([], this.tempUndoRedoColl, [], true);\n            this.undoRedoColl = extend([], this.tempUndoRedoColl, [], true);\n            this.undoRedoStep = this.tempUndoRedoStep;\n            this.tempUndoRedoColl = [];\n            this.tempUndoRedoStep = 0;\n            parent.notify('toolbar', { prop: 'setEnableDisableUndoRedo', value: { isPrevent: false } });\n        }\n    };\n    UndoRedo.prototype.refreshToolbarActions = function () {\n        var parent = this.parent;\n        if (parent.activeObj.shape) {\n            parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'shapes',\n                    isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n            parent.notify('toolbar', { prop: 'update-toolbar-items', onPropertyChange: false });\n        }\n        else {\n            parent.notify('toolbar', { prop: 'refresh-main-toolbar', onPropertyChange: false });\n        }\n    };\n    UndoRedo.prototype.applyCurrentChanges = function () {\n        var parent = this.parent;\n        parent.currObjType.isFiltered = false;\n        if (parent.transform.zoomFactor === 0) {\n            parent.togglePan = false;\n            parent.notify('selection', { prop: 'setDragCanvas', value: { bool: false } });\n        }\n        if (parent.element.querySelector('.e-contextual-toolbar-wrapper')) {\n            parent.element.querySelector('.e-contextual-toolbar-wrapper').classList.add('e-hide');\n        }\n        if (parent.togglePen) {\n            parent.togglePen = false;\n            parent.upperCanvas.style.cursor = parent.cursor = 'default';\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        }\n        if (this.appliedUndoRedoColl.length > 0) {\n            this.undoRedoColl = extend([], this.appliedUndoRedoColl, [], true);\n        }\n    };\n    UndoRedo.prototype.callUndo = function () {\n        this.applyCurrentChanges();\n        this.undo();\n    };\n    UndoRedo.prototype.callRedo = function () {\n        this.applyCurrentChanges();\n        this.redo();\n    };\n    UndoRedo.prototype.undo = function () {\n        var parent = this.parent;\n        this.cancelCropSelection();\n        parent.notify('draw', { prop: 'resetFrameZoom', onPropertyChange: false, value: { isOk: false } });\n        if (!parent.disabled && parent.isImageLoaded) {\n            if (this.undoRedoStep > 0) {\n                this.refreshToolbarActions();\n                if (parent.activeObj.activePoint && parent.activeObj.activePoint.width !== 0) {\n                    this.tempActObj = parent.activeObj;\n                }\n                parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                this.undoRedoStep--;\n                parent.notify('toolbar', { prop: 'enable-disable-btns' });\n                if (parent.element.querySelector('.e-contextual-toolbar-wrapper')) {\n                    parent.element.querySelector('.e-contextual-toolbar-wrapper').classList.add('e-hide');\n                }\n                parent.isUndoRedo = true;\n                var obj = this.undoRedoColl[this.undoRedoStep];\n                if (this.undoRedoColl.length === this.undoRedoStep) {\n                    parent.currObjType.isUndoAction = false;\n                }\n                else {\n                    parent.currObjType.isUndoAction = true;\n                }\n                if (obj.operation !== 'textAreaCustomization' &&\n                    (parent.textArea.style.display === 'block' || parent.textArea.style.display === 'inline-block')) {\n                    parent.textArea.style.display = 'none';\n                }\n                parent.notify('draw', { prop: 'setCancelAction', onPropertyChange: false, value: { bool: true } });\n                var activeObj = void 0;\n                parent.cropObj = extend({}, obj.previousCropObj, {}, true);\n                parent.afterCropActions = obj.previousObj.afterCropActions;\n                this.lowerContext.filter = obj.previousObj.filter;\n                parent.notify('filter', { prop: 'setAdjustmentLevel', onPropertyChange: false, value: { adjustmentLevel: obj.previousObj.adjustmentLevel } });\n                parent.notify('filter', { prop: 'setTempAdjVal' });\n                parent.currentFilter = obj.previousObj.currentFilter;\n                parent.notify('filter', { prop: 'setTempFilVal' });\n                parent.canvasFilter = this.lowerContext.filter;\n                parent.initialAdjustmentValue = this.lowerContext.filter;\n                parent.notify('filter', { prop: 'setBevelFilter', onPropertyChange: false, value: { bevelFilter: this.lowerContext.filter } });\n                var editCompleteArgs = { action: this.getUndoRedoAction(obj.operation) };\n                switch (obj.operation) {\n                    case 'shapeTransform':\n                    case 'brightness':\n                    case 'contrast':\n                    case 'hue':\n                    case 'saturation':\n                    case 'opacity':\n                    case 'blur':\n                    case 'exposure':\n                    case 'default':\n                    case 'chrome':\n                    case 'cold':\n                    case 'warm':\n                    case 'grayscale':\n                    case 'blackandwhite':\n                    case 'sepia':\n                    case 'invert':\n                    case 'sharpen':\n                    case 'imageRotate':\n                    case 'shapeInsert':\n                        this.shapeTransform(obj.previousObjColl, obj.previousPointColl);\n                        break;\n                    case 'freehanddraw':\n                    case 'freehand-draw':\n                        this.updateFreehandDraw(obj.previousPointColl, obj.previousSelPointColl);\n                        parent.notify('freehand-draw', { prop: 'setCurrentFreehandDrawIndex',\n                            value: { value: parent.pointColl.length } });\n                        break;\n                    case 'freehanddrawCustomized':\n                        this.updateFreehandDrawCustomized(obj.previousObjColl, obj.previousPointColl);\n                        break;\n                    case 'deleteFreehandDrawing':\n                    case 'deleteObj':\n                        this.updateDelete(obj.operation, obj.previousObjColl, obj.previousPointColl, obj.previousSelPointColl);\n                        break;\n                    case 'textAreaCustomization':\n                        this.shapeTransform(obj.previousObjColl, obj.previousPointColl);\n                        this.updateTextAreaCustomization(activeObj, obj.previousObjColl);\n                        break;\n                    case 'text':\n                        this.updateText(obj.previousObjColl, true);\n                        break;\n                    case 'frame':\n                        parent.transform.zoomFactor = parent.transform.defaultZoomFactor = obj.previousObj.defaultZoom;\n                        parent.setProperties({ zoomSettings: { zoomFactor: obj.previousObj.zoomFactor } }, true);\n                        parent.notify('transform', { prop: 'setPreviousZoomValue', onPropertyChange: false,\n                            value: { previousZoomValue: parent.zoomSettings.zoomFactor } });\n                        extend(parent.frameObj, obj.previousObj.frameObj);\n                        parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: true, isPreventClearRect: null, isFrame: true } });\n                        break;\n                    case 'imageHFlip':\n                        this.imageFlip('horizontal', obj.previousObjColl);\n                        break;\n                    case 'imageVFlip':\n                        this.imageFlip('vertical', obj.previousObjColl);\n                        break;\n                    case 'bgColor':\n                        parent.notify('draw', { prop: 'imageBackgroundColor', onPropertyChange: false, value: { color: obj.previousObj.bgColor } });\n                        parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: false } });\n                        break;\n                    case 'updateImage':\n                        parent.isImageUpdated = true;\n                        parent.baseImg.src = obj.previousObj.imageSource;\n                        setTimeout(function () {\n                            if (parent.cropObj.straighten !== 0) {\n                                parent.notify('toolbar', { prop: 'performCropTransformClick', value: { shape: 'crop-' + 'custom' } });\n                                parent.noPushUndo = true;\n                                parent.crop();\n                                parent.noPushUndo = false;\n                            }\n                            else {\n                                parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: false } });\n                            }\n                            parent.isImageUpdated = false;\n                        });\n                        break;\n                    default:\n                        this.undoDefault(obj, true);\n                        parent.notify('filter', { prop: 'set-adjustment', value: { operation: obj.operation } });\n                        parent.notify('filter', { prop: 'update-filter', value: { operation: obj.operation, filter: obj.filter } });\n                        break;\n                }\n                if (obj.operation === 'crop') {\n                    if (obj.previousObj.currSelectionPoint) {\n                        parent.currSelectionPoint = extend({}, obj.previousObj.currSelectionPoint, {}, true);\n                        if (parent.currSelectionPoint && isNullOrUndefined(parent.currSelectionPoint.shape)) {\n                            parent.currSelectionPoint = null;\n                        }\n                    }\n                    parent.updateCropTransformItems();\n                    parent.notify('draw', { prop: 'select', onPropertyChange: false,\n                        value: { type: 'custom', startX: null, startY: null, width: null, height: null } });\n                    if (parent.isCircleCrop) {\n                        parent.isCircleCrop = false;\n                        this.tempCurrSelPoint = extend({}, parent.currSelectionPoint, {}, true);\n                        parent.currSelectionPoint = null;\n                    }\n                    var tempCircleCrop = parent.cancelCropSelection.isCircleCrop;\n                    parent.cancelCropSelection.isCircleCrop = false;\n                    parent.notify('draw', { prop: 'performCancel', value: { isContextualToolbar: null, isUndoRedo: true } });\n                    parent.cancelCropSelection.isCircleCrop = tempCircleCrop;\n                    parent.currObjType.isActiveObj = false;\n                    if (parent.transform.straighten !== 0) {\n                        parent.notify('draw', { prop: 'setStraightenActObj', value: { activeObj: null } });\n                    }\n                }\n                else if (obj.operation === 'resize' && parent.cropObj && parent.cropObj.activeObj) {\n                    parent.currSelectionPoint = extend({}, parent.cropObj.activeObj, {}, true);\n                }\n                if ((this.undoRedoColl[this.undoRedoStep - 1]\n                    && this.undoRedoColl[this.undoRedoStep - 1].isCircleCrop)) {\n                    parent.isCircleCrop = true;\n                    parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                        value: { context: this.lowerContext, isSave: null, isFlip: null } });\n                }\n                this.endUndoRedo(obj.operation, true);\n                var action = { action: 'undo', actionEventArgs: editCompleteArgs };\n                parent.triggerEditCompleteEvent(action);\n            }\n        }\n    };\n    UndoRedo.prototype.redo = function () {\n        var parent = this.parent;\n        this.cancelCropSelection();\n        parent.notify('draw', { prop: 'resetFrameZoom', onPropertyChange: false, value: { isOk: false } });\n        if (!parent.disabled && parent.isImageLoaded) {\n            if (this.undoRedoStep < this.appliedUndoRedoColl.length) {\n                this.refreshToolbarActions();\n                this.undoRedoStep++;\n                parent.notify('toolbar', { prop: 'enable-disable-btns' });\n                parent.isUndoRedo = true;\n                var obj = this.undoRedoColl[this.undoRedoStep - 1];\n                if (this.undoRedoColl.length === this.undoRedoStep) {\n                    parent.currObjType.isUndoAction = false;\n                }\n                else {\n                    parent.currObjType.isUndoAction = true;\n                }\n                if (obj.operation !== 'textAreaCustomization' &&\n                    (parent.textArea.style.display === 'block' || parent.textArea.style.display === 'inline-block')) {\n                    parent.textArea.style.display = 'none';\n                }\n                parent.notify('draw', { prop: 'setCancelAction', onPropertyChange: false, value: { bool: true } });\n                parent.cropObj = extend({}, obj.currentCropObj, {}, true);\n                parent.afterCropActions = obj.currentObj.afterCropActions;\n                this.lowerContext.filter = obj.currentObj.filter;\n                if (parent.element.querySelector('.e-contextual-toolbar-wrapper')) {\n                    parent.element.querySelector('.e-contextual-toolbar-wrapper').classList.add('e-hide');\n                }\n                parent.notify('filter', { prop: 'setAdjustmentLevel', onPropertyChange: false, value: { adjustmentLevel: obj.currentObj.adjustmentLevel } });\n                parent.notify('filter', { prop: 'setTempAdjVal' });\n                parent.currentFilter = obj.currentObj.currentFilter;\n                parent.notify('filter', { prop: 'setTempFilVal' });\n                parent.canvasFilter = this.lowerContext.filter;\n                parent.initialAdjustmentValue = this.lowerContext.filter;\n                parent.notify('filter', { prop: 'setBevelFilter', onPropertyChange: false, value: { bevelFilter: this.lowerContext.filter } });\n                var activeObj = void 0;\n                var editCompleteArgs = { action: this.getUndoRedoAction(obj.operation) };\n                switch (obj.operation) {\n                    case 'shapeTransform':\n                    case 'brightness':\n                    case 'contrast':\n                    case 'hue':\n                    case 'saturation':\n                    case 'opacity':\n                    case 'blur':\n                    case 'exposure':\n                    case 'default':\n                    case 'chrome':\n                    case 'cold':\n                    case 'warm':\n                    case 'grayscale':\n                    case 'blackandwhite':\n                    case 'sepia':\n                    case 'invert':\n                    case 'sharpen':\n                    case 'imageRotate':\n                    case 'shapeInsert':\n                        this.shapeTransform(obj.currentObjColl, obj.currentPointColl);\n                        break;\n                    case 'freehanddraw':\n                    case 'freehand-draw':\n                        this.updateFreehandDraw(obj.currentPointColl, obj.currentSelPointColl);\n                        parent.notify('freehand-draw', { prop: 'setCurrentFreehandDrawIndex',\n                            value: { value: parent.pointColl.length } });\n                        break;\n                    case 'freehanddrawCustomized':\n                        this.updateFreehandDrawCustomized(obj.currentObjColl, obj.currentPointColl);\n                        break;\n                    case 'deleteFreehandDrawing':\n                    case 'deleteObj':\n                        this.updateDelete(obj.operation, obj.currentObjColl, obj.currentPointColl, obj.currentSelPointColl);\n                        break;\n                    case 'textAreaCustomization':\n                        this.shapeTransform(obj.currentObjColl, obj.currentPointColl);\n                        this.updateTextAreaCustomization(activeObj, obj.currentObjColl);\n                        break;\n                    case 'text':\n                        this.updateText(obj.currentObjColl, false);\n                        break;\n                    case 'frame':\n                        extend(parent.frameObj, obj.currentObj.frameObj);\n                        parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: true, isPreventClearRect: null, isFrame: true } });\n                        break;\n                    case 'imageHFlip':\n                        this.imageFlip('horizontal', obj.currentObjColl);\n                        break;\n                    case 'imageVFlip':\n                        this.imageFlip('vertical', obj.currentObjColl);\n                        break;\n                    case 'bgColor':\n                        parent.notify('draw', { prop: 'imageBackgroundColor', onPropertyChange: false, value: { color: obj.currentObj.bgColor } });\n                        parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: false } });\n                        break;\n                    case 'updateImage':\n                        parent.isImageUpdated = true;\n                        parent.baseImg.src = obj.currentObj.imageSource;\n                        setTimeout(function () {\n                            if (parent.cropObj.straighten !== 0) {\n                                parent.notify('toolbar', { prop: 'performCropTransformClick', value: { shape: 'crop-' + 'custom' } });\n                                parent.noPushUndo = true;\n                                parent.crop();\n                                parent.noPushUndo = false;\n                            }\n                            else {\n                                parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: false } });\n                            }\n                            parent.isImageUpdated = false;\n                        });\n                        break;\n                    default:\n                        parent.objColl = [];\n                        parent.pointColl = [];\n                        parent.freehandCounter = 0;\n                        parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false,\n                            value: { obj: { selPointColl: [] } } });\n                        parent.notify('draw', { prop: 'setCurrentObj', onPropertyChange: false, value: { obj: obj.currentObj, isUndoRedo: true } });\n                        parent.img.destLeft = obj.currentObj.destPoints.startX;\n                        parent.img.destTop = obj.currentObj.destPoints.startY;\n                        activeObj = extend({}, parent.activeObj, {}, true);\n                        parent.objColl = extend([], obj.currentObjColl, [], true);\n                        parent.pointColl = extend([], obj.currentPointColl, [], true);\n                        parent.freehandCounter = parent.pointColl.length;\n                        parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false,\n                            value: { obj: { selPointColl: extend([], obj.currentSelPointColl, [], true) } } });\n                        parent.transform.straighten = 0;\n                        this.lowerContext.filter = 'none';\n                        parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n                            value: { ctx: this.lowerContext, shape: 'zoom', pen: 'zoom', isPreventApply: null } });\n                        this.lowerContext.filter = obj.currentObj.filter;\n                        parent.prevStraightenedDegree = parent.transform.straighten;\n                        parent.activeObj = activeObj;\n                        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                        if (parent.activeObj.activePoint.width !== 0 && parent.activeObj.activePoint.height !== 0) {\n                            parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate' } });\n                        }\n                        parent.notify('filter', { prop: 'set-adjustment', value: { operation: obj.operation } });\n                        parent.notify('filter', { prop: 'update-filter', value: { operation: obj.operation } });\n                        break;\n                }\n                if (obj.operation === 'crop' && obj.isCircleCrop) {\n                    parent.isCircleCrop = true;\n                    parent.currSelectionPoint = extend({}, this.tempCurrSelPoint, {}, true);\n                    this.tempCurrSelPoint = null;\n                }\n                if (obj.operation === 'crop' && !obj.isCircleCrop) {\n                    parent.isCircleCrop = false;\n                }\n                if (obj.operation === 'crop' && obj.currentObj.currSelectionPoint) {\n                    parent.currSelectionPoint = extend({}, obj.currentObj.currSelectionPoint, {}, true);\n                    parent.notify('draw', { prop: 'setStraightenActObj', value: { activeObj: parent.currSelectionPoint } });\n                }\n                if (parent.currSelectionPoint && isNullOrUndefined(parent.currSelectionPoint.shape)) {\n                    parent.currSelectionPoint = null;\n                }\n                if (obj.operation === 'resize' && parent.cropObj && parent.cropObj.activeObj) {\n                    parent.currSelectionPoint = extend({}, parent.cropObj.activeObj, {}, true);\n                }\n                this.endUndoRedo(obj.operation, false);\n                var action = { action: 'redo', actionEventArgs: editCompleteArgs };\n                parent.triggerEditCompleteEvent(action);\n            }\n        }\n    };\n    UndoRedo.prototype.imageFlip = function (type, objColl) {\n        var parent = this.parent;\n        this.shapeTransform(objColl, null);\n        parent.activeObj = extend({}, parent.objColl[parent.objColl.length - 1], {}, true);\n        var _a = parent.activeObj, shape = _a.shape, isHorImageFlip = _a.isHorImageFlip, isVerImageFlip = _a.isVerImageFlip;\n        parent.objColl.pop();\n        if (shape && shape === 'image') {\n            if (type === 'horizontal') {\n                if (isNullOrUndefined(isHorImageFlip) && isVerImageFlip) {\n                    parent.activeObj.isHorImageFlip = true;\n                    parent.activeObj.isVerImageFlip = null;\n                    parent.horizontalFlip(this.upperContext, true);\n                }\n                else {\n                    if (isNullOrUndefined(isHorImageFlip) || !isHorImageFlip) {\n                        parent.activeObj.isHorImageFlip = true;\n                    }\n                    else {\n                        parent.activeObj.isHorImageFlip = null;\n                    }\n                    parent.horizontalFlip(this.upperContext, true);\n                }\n            }\n            else if (type === 'vertical') {\n                if (isNullOrUndefined(isVerImageFlip) && isHorImageFlip) {\n                    parent.activeObj.isVerImageFlip = true;\n                    parent.activeObj.isHorImageFlip = null;\n                    parent.verticalFlip(this.upperContext, true);\n                }\n                else {\n                    if (isNullOrUndefined(isVerImageFlip) || !isVerImageFlip) {\n                        parent.activeObj.isVerImageFlip = true;\n                    }\n                    else {\n                        parent.activeObj.isVerImageFlip = null;\n                    }\n                    parent.verticalFlip(this.upperContext, true);\n                }\n            }\n            parent.notify('shape', { prop: 'applyActObj', onPropertyChange: false, value: { isMouseDown: true } });\n        }\n        else {\n            parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: true } });\n        }\n    };\n    UndoRedo.prototype.shapeTransform = function (objColl, pointColl) {\n        var parent = this.parent;\n        parent.objColl = extend([], objColl, [], true);\n        if (pointColl) {\n            parent.pointColl = extend([], pointColl, [], true);\n            parent.freehandCounter = parent.pointColl.length;\n        }\n        parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n            value: { ctx: this.lowerContext, shape: 'zoom', pen: 'zoom', isPreventApply: null } });\n        this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        parent.isUndoRedo = true;\n        parent.notify('draw', { prop: 'redrawImgWithObj', onPropertyChange: false });\n        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n    };\n    UndoRedo.prototype.updateFreehandDraw = function (pointColl, selPointColl) {\n        var parent = this.parent;\n        parent.pointColl = pointColl;\n        parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false,\n            value: { obj: { selPointColl: selPointColl } } });\n        parent.freehandCounter = parent.pointColl.length;\n        parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n            value: { ctx: this.lowerContext, shape: 'zoom', pen: 'zoom', isPreventApply: null } });\n        this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        parent.isUndoRedo = true;\n        parent.notify('draw', { prop: 'redrawImgWithObj', onPropertyChange: false });\n    };\n    UndoRedo.prototype.updateFreehandDrawCustomized = function (objColl, pointColl) {\n        var parent = this.parent;\n        parent.objColl = extend([], objColl, [], true);\n        parent.pointColl = pointColl;\n        parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n            value: { ctx: this.lowerContext, shape: 'zoom', pen: 'zoom', isPreventApply: null } });\n        this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        parent.isUndoRedo = true;\n        parent.notify('draw', { prop: 'redrawImgWithObj', onPropertyChange: false });\n    };\n    UndoRedo.prototype.updateDelete = function (operation, objColl, pointColl, selPointColl) {\n        var parent = this.parent;\n        if (operation === 'deleteFreehandDrawing') {\n            parent.pointColl = pointColl;\n            parent.freehandCounter = parent.pointColl.length;\n            parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false,\n                value: { obj: { selPointColl: selPointColl } } });\n            parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n                value: { ctx: this.lowerContext, shape: 'zoom', pen: 'zoom', isPreventApply: null } });\n        }\n        else if (operation === 'deleteObj') {\n            parent.objColl = objColl;\n            parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n                value: { ctx: this.lowerContext, shape: 'zoom', pen: 'zoom', isPreventApply: null } });\n        }\n        this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        parent.isUndoRedo = true;\n        parent.notify('draw', { prop: 'redrawImgWithObj', onPropertyChange: false });\n    };\n    UndoRedo.prototype.updateTextAreaCustomization = function (activeObj, objColl) {\n        var parent = this.parent;\n        parent.objColl = extend([], objColl, [], true);\n        parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n            value: { ctx: this.lowerContext, shape: 'zoom', pen: 'zoom', isPreventApply: null } });\n        this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        parent.isUndoRedo = true;\n        parent.notify('draw', { prop: 'redrawImgWithObj', onPropertyChange: false });\n        for (var i = 0, len = objColl.length; i < len; i++) {\n            if (this.tempActObj) {\n                if (this.tempActObj.currIndex === objColl[i].currIndex) {\n                    activeObj = extend({}, objColl[i], {}, true);\n                    parent.objColl.splice(i, 1);\n                    break;\n                }\n            }\n            else {\n                activeObj = extend({}, objColl[objColl.length - 1], {}, true);\n                parent.objColl.splice(i, 1);\n                break;\n            }\n        }\n        if (activeObj) {\n            this.updateTextBox(activeObj);\n        }\n        if (parent.textArea.style.display === 'block' || parent.textArea.style.display === 'inline-block') {\n            parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n                value: { x: null, y: null, isMouseDown: null } });\n        }\n    };\n    UndoRedo.prototype.updateText = function (objColl, allowActiveObj) {\n        var parent = this.parent;\n        if (this.tempActObj) {\n            parent.activeObj = extend({}, this.tempActObj, {}, true);\n        }\n        if (objColl.length === 0 && parent.objColl.length === 1) {\n            this.tempActObj = extend({}, parent.objColl[0], {}, true);\n        }\n        else {\n            for (var i = 0, iLen = parent.objColl.length; i < iLen; i++) {\n                if (parent.objColl[i] && isNullOrUndefined(objColl[i])) {\n                    this.tempActObj = extend({}, parent.objColl[i], {}, true);\n                    break;\n                }\n                if (objColl[i].currIndex !== parent.objColl[i].currIndex) {\n                    this.tempActObj = extend({}, parent.objColl[i], {}, true);\n                    break;\n                }\n            }\n        }\n        if (allowActiveObj) {\n            parent.activeObj = extend({}, this.tempActObj, {}, true);\n        }\n        parent.objColl = extend([], objColl, [], true);\n        parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n            value: { ctx: this.lowerContext, shape: 'zoom', pen: 'zoom', isPreventApply: true } });\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        parent.isUndoRedo = true;\n        parent.notify('draw', { prop: 'redrawImgWithObj', onPropertyChange: false });\n        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n    };\n    UndoRedo.prototype.updateTextBox = function (obj) {\n        var parent = this.parent;\n        this.upperContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        parent.notify('draw', { prop: 'redrawImgWithObj', onPropertyChange: false });\n        parent.notify('toolbar', { prop: 'destroy-qa-toolbar', onPropertyChange: false });\n        var textArea = parent.textArea;\n        textArea.style.display = 'block';\n        textArea.style.fontFamily = obj.textSettings.fontFamily;\n        textArea.style.fontSize = obj.textSettings.fontSize + 'px';\n        textArea.style.color = obj.strokeSettings.strokeColor;\n        textArea.style.fontWeight = obj.textSettings.bold ? 'bold' : 'normal';\n        textArea.style.fontStyle = obj.textSettings.italic ? 'italic' : 'normal';\n        textArea.style.border = '2px solid ' + parent.themeColl[parent.theme]['primaryColor'];\n        textArea.value = obj.keyHistory;\n        parent.activeObj = extend({}, obj, {}, true);\n        parent.notify('shape', { prop: 'updateFontStyles', onPropertyChange: false,\n            value: { isTextBox: null } });\n        parent.textArea.style.width = parent.activeObj.activePoint.width + 'px';\n    };\n    UndoRedo.prototype.undoDefault = function (obj, isUndoRedo) {\n        this.lowerContext.filter = obj.previousObj.filter;\n        var parent = this.parent;\n        parent.objColl = [];\n        parent.pointColl = [];\n        parent.freehandCounter = 0;\n        parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false,\n            value: { obj: { selPointColl: [] } } });\n        var isCircleCrop = !isUndoRedo ? obj.isCircleCrop : false;\n        parent.notify('draw', { prop: 'setCurrentObj', onPropertyChange: false, value: { obj: obj.previousObj, isUndoRedo: isUndoRedo, isCircleCrop: isCircleCrop } });\n        parent.prevStraightenedDegree = parent.transform.straighten;\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        parent.img.destLeft = obj.previousObj.destPoints.startX;\n        parent.img.destTop = obj.previousObj.destPoints.startY;\n        var activeObj = extend({}, parent.activeObj, {}, true);\n        parent.objColl = extend([], obj.previousObjColl, [], true);\n        parent.pointColl = extend([], obj.previousPointColl, [], true);\n        parent.freehandCounter = parent.pointColl.length;\n        parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false,\n            value: { obj: { selPointColl: extend([], obj.previousSelPointColl, [], true) } } });\n        parent.transform.straighten = 0;\n        this.lowerContext.filter = 'none';\n        parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n            value: { ctx: this.lowerContext, shape: 'zoom', pen: 'zoom', isPreventApply: null } });\n        this.lowerContext.filter = obj.previousObj.filter;\n        parent.activeObj = activeObj;\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        if (parent.activeObj.activePoint.width !== 0 && parent.activeObj.activePoint.height !== 0) {\n            parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate' } });\n        }\n    };\n    UndoRedo.prototype.endUndoRedo = function (operation, isUndo) {\n        var parent = this.parent;\n        var frameObj = { type: 'none', color: '#fff', size: 20, inset: 20, offset: 20, radius: 0, amount: 1, border: 'solid', gradientColor: '' };\n        if (((parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle') || parent.isCircleCrop) &&\n            JSON.stringify(parent.frameObj) !== JSON.stringify(frameObj)) {\n            parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: true } });\n        }\n        parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n        if (parent.isCircleCrop && ((isUndo && operation !== 'crop') || !isUndo)) {\n            parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                value: { context: this.lowerContext, isSave: null, isFlip: null } });\n        }\n        if (parent.transform.zoomFactor > 0) {\n            parent.notify('selection', { prop: 'setDragCanvas', value: { bool: true } });\n        }\n        parent.notify('draw', { prop: 'setCancelAction', onPropertyChange: false, value: { bool: false } });\n        if (parent.activeObj.shape && parent.activeObj.shape.split('-')[0] === 'crop') {\n            parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'main',\n                    isApplyBtn: true, isCropping: true, isZooming: null, cType: null } });\n        }\n        else {\n            parent.notify('toolbar', { prop: 'refresh-main-toolbar', onPropertyChange: false });\n        }\n        parent.notify('toolbar', { prop: 'enable-disable-btns' });\n        if (document.getElementById(parent.element.id + '_quickAccessToolbarArea')) {\n            document.getElementById(parent.element.id + '_quickAccessToolbarArea').style.display = 'none';\n        }\n        parent.notify('toolbar', { prop: 'enable-disable-btns' });\n        if (parent.transform.degree !== 0) {\n            parent.notify('transform', { prop: 'drawPannedImage', onPropertyChange: false,\n                value: { xDiff: 0, yDiff: 0 } });\n        }\n        parent.notify('filter', { prop: 'setAdjustmentValue', onPropertyChange: false, value: { adjustmentValue: this.lowerContext.filter } });\n        parent.currObjType.isCustomCrop = false;\n    };\n    UndoRedo.prototype.updateUrc = function (operation, previousObj, previousObjColl, previousPointColl, previousSelPointColl, previousCropObj, previousText, currentText, previousFilter, isCircleCrop) {\n        var parent = this.parent;\n        if (parent.isResize || this.isPreventing) {\n            return;\n        }\n        var obj = { isInitialLoaded: false };\n        if (parent.currObjType.isUndoAction) {\n            this.refreshUrc(true);\n        }\n        parent.notify('draw', { prop: 'isInitialLoaded', onPropertyChange: false, value: { object: obj } });\n        if (!obj['isInitialLoaded'] && parent.allowUndoRedo) {\n            var object = { currObj: {} };\n            parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n            var currentObj = object['currObj'];\n            currentObj.objColl = extend([], parent.objColl, [], true);\n            currentObj.pointColl = extend([], parent.pointColl, [], true);\n            currentObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n            var selPointCollObj = { selPointColl: null };\n            parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n                value: { obj: selPointCollObj } });\n            currentObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n            if (operation === 'crop') {\n                currentObj.currSelectionPoint = extend({}, parent.currSelectionPoint, {}, true);\n            }\n            else if (operation === 'frame') {\n                previousObj.destPoints = { startX: parent.frameDestPoints.destLeft, startY: parent.frameDestPoints.destTop,\n                    width: parent.frameDestPoints.destWidth, height: parent.frameDestPoints.destHeight };\n                currentObj.destPoints = { startX: parent.frameDestPoints.destLeft, startY: parent.frameDestPoints.destTop,\n                    width: parent.frameDestPoints.destWidth, height: parent.frameDestPoints.destHeight };\n                if (!isNullOrUndefined(parent.tempFrameZoomLevel)) {\n                    previousObj.defaultZoom = currentObj.defaultZoom = parent.tempFrameZoomLevel;\n                }\n            }\n            else if ((operation === 'imageHFlip' || operation === 'imageVFlip') && this.appliedUndoRedoColl.length > 0) {\n                var index = previousObjColl[previousObjColl.length - 1].currIndex;\n                previousObjColl = this.appliedUndoRedoColl[this.appliedUndoRedoColl.length - 1].currentObjColl;\n                if (index) {\n                    for (var i = 0, len = previousObjColl.length; i < len; i++) {\n                        if (previousObjColl[i].currIndex === index) {\n                            var actObj = extend({}, previousObjColl[i], {}, true);\n                            previousObjColl.splice(i, 1);\n                            previousObjColl.push(actObj);\n                            break;\n                        }\n                    }\n                }\n            }\n            this.undoRedoColl.push({ operation: operation, previousObj: previousObj, currentObj: currentObj,\n                previousObjColl: previousObjColl, currentObjColl: currentObj.objColl,\n                previousPointColl: previousPointColl, currentPointColl: currentObj.pointColl,\n                previousSelPointColl: previousSelPointColl, currentSelPointColl: currentObj.selPointColl,\n                previousCropObj: previousCropObj, currentCropObj: extend({}, parent.cropObj, {}, true),\n                previousText: previousText, currentText: currentText, filter: previousFilter, isCircleCrop: isCircleCrop });\n            parent.notify('toolbar', { prop: 'enable-disable-btns', onPropertyChange: false });\n        }\n    };\n    UndoRedo.prototype.updateUrObj = function (objColl, operation) {\n        var parent = this.parent;\n        if (parent.allowUndoRedo) {\n            if (parent.currObjType.isUndoAction && !parent.isShapeDrawing) {\n                this.refreshUrc(true);\n            }\n            if (isNullOrUndefined(parent.activeObj.imageRatio)) {\n                parent.notify('shape', { prop: 'updImgRatioForActObj', onPropertyChange: false });\n            }\n            parent.objColl.push(parent.activeObj);\n            var cropObj = extend({}, parent.cropObj, {}, true);\n            var object = { currObj: {} };\n            parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n            var obj = object['currObj'];\n            obj.objColl = extend([], parent.objColl, [], true);\n            obj.pointColl = extend([], parent.pointColl, [], true);\n            obj.afterCropActions = extend([], parent.afterCropActions, [], true);\n            var selPointCollObj = { selPointColl: null };\n            parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n                value: { obj: selPointCollObj } });\n            obj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n            var oper = operation ? operation : 'shapeTransform';\n            this.undoRedoColl.push({ operation: oper, previousObj: obj, currentObj: obj,\n                previousObjColl: objColl, currentObjColl: obj.objColl,\n                previousPointColl: obj.pointColl, currentPointColl: obj.pointColl,\n                previousSelPointColl: obj.selPointColl, currentSelPointColl: obj.selPointColl,\n                previousCropObj: cropObj, currentCropObj: cropObj });\n            parent.notify('selection', { prop: 'redrawShape', onPropertyChange: false,\n                value: { obj: parent.objColl[parent.objColl.length - 1] } });\n        }\n    };\n    UndoRedo.prototype.updateUndoRedo = function (operation) {\n        var parent = this.parent;\n        var prevCropObj = extend({}, parent.cropObj, {}, true);\n        var object = { currObj: {} };\n        parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        var prevObj = object['currObj'];\n        prevObj.objColl = extend([], parent.objColl, [], true);\n        prevObj.pointColl = extend([], parent.pointColl, [], true);\n        prevObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: selPointCollObj } });\n        prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        if (isNullOrUndefined(parent.activeObj.imageRatio)) {\n            parent.notify('shape', { prop: 'updImgRatioForActObj', onPropertyChange: false });\n        }\n        parent.objColl.push(parent.activeObj);\n        var oper = operation ? operation : 'shapeTransform';\n        this.updateUrc(oper, prevObj, prevObj.objColl, prevObj.pointColl, prevObj.selPointColl, prevCropObj);\n        parent.objColl.pop();\n        parent.notify('shape', { prop: 'applyActObj', onPropertyChange: false, value: { isMouseDown: null } });\n        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'shapes',\n                isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n        parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'main',\n                isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n    };\n    UndoRedo.prototype.getZeroZoomObjPointValue = function (obj, point) {\n        var parent = this.parent;\n        this.updateObjColl();\n        var object = { currObj: {} };\n        parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        var currentObj = object['currObj'];\n        currentObj.objColl = extend([], parent.objColl, [], true);\n        currentObj.pointColl = extend([], parent.pointColl, [], true);\n        currentObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: selPointCollObj } });\n        currentObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        var cropDimensionObj = { cropDimension: null };\n        parent.notify('transform', { prop: 'getCropDimension', onPropertyChange: false, value: { obj: cropDimensionObj } });\n        var getZeroZoomObjColl = extend([], parent.objColl, [], true);\n        var getZeroZoomPointColl = extend([], parent.pointColl, [], true);\n        var arrowObj = { arrowDimension: null };\n        this.parent.notify('draw', { prop: 'getArrowDimension', onPropertyChange: false, value: { obj: arrowObj } });\n        var tempArrowObj = extend({}, arrowObj['arrowDimension'], {}, true);\n        if (parent.transform.zoomFactor > 0 && (obj.length > 0 || point.length > 0)) {\n            if (obj.length > 0) {\n                for (var i = 0; i < obj.length; i++) {\n                    if (obj[i].currIndex) {\n                        continue;\n                    }\n                    else {\n                        obj[i].currIndex = 'shape_' + (i + 1);\n                    }\n                }\n            }\n            parent.objColl = obj;\n            parent.pointColl = point;\n            var isUndoRedo = parent.isUndoRedo;\n            var isCropTab = parent.isCropTab;\n            if (parent.transform.zoomFactor !== 0) {\n                parent.isUndoRedo = true;\n                parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n                    value: { ctx: this.lowerContext, shape: 'zoom', pen: 'zoom', isPreventApply: true } });\n                parent.notify('freehand-draw', { prop: 'updateFHDColl', onPropertyChange: false });\n                parent.isCropTab = true;\n                var zoomSettings = extend({}, parent.zoomSettings, null, true);\n                if (parent.transform.zoomFactor > 0) {\n                    parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                        value: { zoomFactor: -parent.transform.zoomFactor, zoomPoint: null, isResize: null } });\n                }\n                else {\n                    parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                        value: { zoomFactor: Math.abs(parent.transform.zoomFactor), zoomPoint: null, isResize: null } });\n                }\n                parent.zoomSettings = zoomSettings;\n                parent.isCropTab = isCropTab;\n                parent.isUndoRedo = isUndoRedo;\n                getZeroZoomObjColl = extend([], parent.objColl, [], true);\n                getZeroZoomPointColl = extend([], parent.pointColl, [], true);\n                parent.objColl = [];\n                parent.pointColl = [];\n                parent.freehandCounter = 0;\n                parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false,\n                    value: { obj: { selPointColl: [] } } });\n                parent.notify('transform', { prop: 'setCropDimension', onPropertyChange: false,\n                    value: { width: cropDimensionObj['cropDimension']['width'], height: cropDimensionObj['cropDimension']['height'] } });\n                var maxDimension = { width: cropDimensionObj['cropDimension']['width'], height: cropDimensionObj['cropDimension']['height'] };\n                maxDimension.width += (maxDimension.width * currentObj.defaultZoom);\n                maxDimension.height += (maxDimension.height * currentObj.defaultZoom);\n                parent.notify('draw', { prop: 'setZoomCropWidth', value: { width: maxDimension.width, height: maxDimension.height } });\n                parent.notify('draw', { prop: 'setCurrentObj', onPropertyChange: false, value: { obj: currentObj } });\n                parent.img.destLeft = currentObj.destPoints.startX;\n                parent.img.destTop = currentObj.destPoints.startY;\n                parent.panPoint.totalPannedPoint = currentObj.totalPannedPoint;\n                parent.panPoint.totalPannedClientPoint = currentObj.totalPannedClientPoint;\n                parent.panPoint.totalPannedInternalPoint = currentObj.totalPannedInternalPoint;\n                parent.objColl = extend([], currentObj.objColl, [], true);\n                parent.pointColl = extend([], currentObj.pointColl, [], true);\n                parent.freehandCounter = parent.pointColl.length;\n                parent.notify('draw', { prop: 'setArrowDimension', onPropertyChange: false, value: { arrowDimension: tempArrowObj } });\n                parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false,\n                    value: { obj: { selPointColl: extend([], currentObj.selPointColl, [], true) } } });\n                this.lowerContext.filter = 'none';\n                parent.transform.straighten = 0;\n                this.applyImgTranform();\n                parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n                    value: { ctx: this.lowerContext, shape: 'iterate', pen: 'iterate', isPreventApply: null } });\n                parent.notify('freehand-draw', { prop: 'updateFHDCurPts', onPropertyChange: false });\n                this.lowerContext.filter = currentObj.filter;\n                if (parent.transform.degree !== 0) {\n                    parent.notify('transform', { prop: 'drawPannedImage', onPropertyChange: false,\n                        value: { xDiff: 0, yDiff: 0 } });\n                }\n                parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n                if (parent.isCircleCrop || (parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle')) {\n                    parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                        value: { context: this.lowerContext, isSave: null, isFlip: null } });\n                }\n            }\n        }\n        return { obj: getZeroZoomObjColl, point: getZeroZoomPointColl };\n    };\n    UndoRedo.prototype.updateObjColl = function () {\n        var parent = this.parent;\n        for (var i = 0; i < parent.objColl.length; i++) {\n            var obj = parent.objColl[i];\n            var isUpdated = false;\n            if (obj.shape === 'line' || obj.shape === 'arrow') {\n                if (obj.activePoint.width < 0) {\n                    obj.activePoint.width = Math.abs(obj.activePoint.width);\n                    isUpdated = true;\n                }\n                if (obj.activePoint.height < 0) {\n                    obj.activePoint.height = Math.abs(obj.activePoint.height);\n                    isUpdated = true;\n                }\n                if (isUpdated) {\n                    var activeObj = extend({}, parent.activeObj, {}, true);\n                    parent.activeObj = obj;\n                    parent.notify('shape', { prop: 'updImgRatioForActObj', onPropertyChange: false });\n                    obj = parent.activeObj;\n                    parent.activeObj = activeObj;\n                }\n            }\n        }\n    };\n    UndoRedo.prototype.applyImgTranform = function () {\n        var parent = this.parent;\n        var obj = extend({}, parent.activeObj, {}, true);\n        for (var i = 0, len = parent.objColl.length; i < len; i++) {\n            if (parent.objColl[i].shape === 'image') {\n                parent.activeObj = extend({}, parent.objColl[i], {}, true);\n                var ctx = parent.objColl[i].imageCanvas.getContext('2d');\n                parent.notify('selection', { prop: 'applyTransformToImg', onPropertyChange: false, value: { ctx: ctx } });\n                this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                parent.notify('selection', { prop: 'setImageClarity', onPropertyChange: false, value: { bool: true } });\n            }\n        }\n        parent.activeObj = obj;\n    };\n    UndoRedo.prototype.updateUndoRedoStack = function (isPenDraw) {\n        var parent = this.parent;\n        if ((parent.activeObj.currIndex && parent.activeObj.activePoint.width !== 0 ||\n            parent.activeObj.activePoint.height !== 0 || (parent.activeObj.pointColl &&\n            parent.activeObj.pointColl.length > 0)) || isPenDraw) {\n            var isTextArea = parent.textArea.style.display === 'none' ? false : true;\n            var temp = parent.noPushUndo;\n            parent.noPushUndo = false;\n            parent.isUndoRedoStack = true;\n            if (isPenDraw) {\n                var tempTogglePen = parent.togglePen;\n                var obj = { freehandDrawSelectedId: null };\n                parent.notify('freehand-draw', { prop: 'getFreehandDrawSelectedId', onPropertyChange: false, value: { obj: obj } });\n                parent.okBtn();\n                parent.noPushUndo = temp;\n                if (obj['freehandDrawSelectedId']) {\n                    parent.noRedact = true;\n                    parent.selectShape(obj['freehandDrawSelectedId']);\n                }\n                else {\n                    parent.freeHandDraw(true);\n                }\n                parent.togglePen = tempTogglePen;\n            }\n            else if (parent.activeObj.currIndex) {\n                var shapeId = parent.activeObj.currIndex;\n                parent.okBtn();\n                parent.noPushUndo = temp;\n                parent.noRedact = true;\n                parent.selectShape(shapeId);\n                if (parent.drawingShape) {\n                    parent.notify('selection', { prop: 'setCurrentDrawingShape', onPropertyChange: false, value: { value: parent.drawingShape.toLowerCase() } });\n                }\n                if (isTextArea) {\n                    parent.enableTextEditing();\n                }\n            }\n            parent.isUndoRedoStack = false;\n        }\n    };\n    return UndoRedo;\n}());\nexport { UndoRedo };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n/* eslint-disable max-len */\nimport { Component, NotifyPropertyChanges, Property, addClass, removeClass, extend } from '@syncfusion/ej2-base';\nimport { Event, EventHandler, getComponent, isNullOrUndefined, getUniqueID, setValue } from '@syncfusion/ej2-base';\nimport { Dialog, createSpinner } from '@syncfusion/ej2-popups';\nimport { Complex, Browser, ChildProperty, compile as templateCompiler, compile } from '@syncfusion/ej2-base';\nimport { ToolbarModule, Crop, Draw, Filter, FreehandDrawing, Selection, Shape, Transform, UndoRedo, Export, FrameLineStyle, ShapeType } from './../index';\nimport { ZoomTrigger, ImageFinetuneOption } from './../index';\nimport { Uploader } from '@syncfusion/ej2-inputs';\n/**\n * This interface is used to specify settings for finetuning operations on images, including brightness, contrast, hue, saturation, exposure, opacity, and blur. It includes properties for setting minimum and maximum values for each of these options, as well as a default value.\n */\nvar FinetuneSettings = /** @class */ (function (_super) {\n    __extends(FinetuneSettings, _super);\n    function FinetuneSettings() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property(null)\n    ], FinetuneSettings.prototype, \"brightness\", void 0);\n    __decorate([\n        Property(null)\n    ], FinetuneSettings.prototype, \"contrast\", void 0);\n    __decorate([\n        Property(null)\n    ], FinetuneSettings.prototype, \"hue\", void 0);\n    __decorate([\n        Property(null)\n    ], FinetuneSettings.prototype, \"saturation\", void 0);\n    __decorate([\n        Property(null)\n    ], FinetuneSettings.prototype, \"exposure\", void 0);\n    __decorate([\n        Property(null)\n    ], FinetuneSettings.prototype, \"opacity\", void 0);\n    __decorate([\n        Property(null)\n    ], FinetuneSettings.prototype, \"blur\", void 0);\n    return FinetuneSettings;\n}(ChildProperty));\nexport { FinetuneSettings };\n/**\n * An interface used to define the settings such as minimum, maximum, and default zoom factors, and the type of zooming which are available in the image editor control.\n */\nvar ZoomSettings = /** @class */ (function (_super) {\n    __extends(ZoomSettings, _super);\n    function ZoomSettings() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property(null)\n    ], ZoomSettings.prototype, \"zoomTrigger\", void 0);\n    __decorate([\n        Property(1)\n    ], ZoomSettings.prototype, \"minZoomFactor\", void 0);\n    __decorate([\n        Property(10)\n    ], ZoomSettings.prototype, \"maxZoomFactor\", void 0);\n    __decorate([\n        Property(1)\n    ], ZoomSettings.prototype, \"zoomFactor\", void 0);\n    __decorate([\n        Property(null)\n    ], ZoomSettings.prototype, \"zoomPoint\", void 0);\n    return ZoomSettings;\n}(ChildProperty));\nexport { ZoomSettings };\n/**\n * This interface is used to specify settings for selection operations on images, including visibility, stroke color and fill color.\n */\nvar SelectionSettings = /** @class */ (function (_super) {\n    __extends(SelectionSettings, _super);\n    function SelectionSettings() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property(true)\n    ], SelectionSettings.prototype, \"showCircle\", void 0);\n    __decorate([\n        Property(null)\n    ], SelectionSettings.prototype, \"strokeColor\", void 0);\n    __decorate([\n        Property(null)\n    ], SelectionSettings.prototype, \"fillColor\", void 0);\n    return SelectionSettings;\n}(ChildProperty));\nexport { SelectionSettings };\n/**\n * Predefine the font families that populate in font family dropdown list from the toolbar.\n */\nvar FontFamily = /** @class */ (function (_super) {\n    __extends(FontFamily, _super);\n    function FontFamily() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('Arial')\n    ], FontFamily.prototype, \"default\", void 0);\n    __decorate([\n        Property(null)\n    ], FontFamily.prototype, \"items\", void 0);\n    return FontFamily;\n}(ChildProperty));\nexport { FontFamily };\n/**\n * The Image Editor is a graphical user interface for editing images.\n *\n * {% codeBlock src='image-editor/default/index.md' %}{% endcodeBlock %}\n *\n * @remarks\n * The Image Editor component provides various image editing features such as zooming, cropping, rotating, inserting text and shapes (rectangles, ellipses, and lines), drawing freehand on top of an image, undo/redo, and more.\n *\n */\nvar ImageEditor = /** @class */ (function (_super) {\n    __extends(ImageEditor, _super);\n    /**\n     *\n     * Constructor for creating the widget\n     *\n     * @param  {ImageEditorModel} options - Specifies the image editor model\n     * @param  {string|HTMLDivElement} element - Specifies the target element\n     */\n    function ImageEditor(options, element) {\n        var _this = _super.call(this, options) || this;\n        /**\n         *\n         * Image Editor Private Properties\n         */\n        /** @hidden */\n        _this.isImageLoaded = false;\n        /** @hidden */\n        _this.activeObj = { activePoint: { startX: 0, startY: 0, endX: 0, endY: 0, width: 0, height: 0 },\n            flipObjColl: [], triangle: [], triangleRatio: [], rotatedAngle: 0, opacity: 1, order: null };\n        // current object's ui interaction properties\n        /** @hidden */\n        _this.currObjType = { shape: '', isDragging: false, isActiveObj: false, isText: false, isInitialText: false, isLine: false, isInitialLine: false,\n            isCustomCrop: false, isZoomed: false, isUndoZoom: false, isUndoAction: false, isFiltered: false, isSave: false, isResize: false, isRedact: false };\n        /** @hidden */\n        _this.objColl = [];\n        /** @hidden */\n        // eslint-disable-next-line\n        _this.pointColl = {};\n        /** @hidden */\n        _this.freehandCounter = 0;\n        /** @hidden */\n        _this.points = [];\n        /** @hidden */\n        _this.togglePen = false;\n        /** @hidden */\n        _this.togglePan = false;\n        /** @hidden */\n        _this.img = { destLeft: 0, destTop: 0, destWidth: 0, destHeight: 0, srcLeft: 0, srcTop: 0, srcWidth: 0, srcHeight: 0 };\n        /** @hidden */\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        _this.rotateFlipColl = [];\n        // All prop values saved while cropping (to restore the image to its original state)\n        /** @hidden */\n        _this.cropObj = { cropZoom: 0, defaultZoom: 0, totalPannedPoint: { x: 0, y: 0 }, totalPannedClientPoint: { x: 0, y: 0 },\n            totalPannedInternalPoint: { x: 0, y: 0 }, tempFlipPanPoint: { x: 0, y: 0 }, activeObj: {}, rotateFlipColl: [],\n            degree: 0, currFlipState: '', straighten: 0, destPoints: { startX: 0, startY: 0, width: 0, height: 0 },\n            srcPoints: { startX: 0, startY: 0, width: 0, height: 0 }, filter: '', isBrightAdjust: false,\n            zoomFactor: 0, previousZoomValue: 0, aspectWidth: null, aspectHeight: null, frame: 'none', straightenZoom: 0,\n            adjustmentLevel: { brightness: 0, contrast: 0, hue: 0, opacity: 100, saturation: 0, blur: 0,\n                exposure: 0, transparency: 100, sharpen: false, bw: false }, currentFilter: '' };\n        // Stored transformations performed after cropping\n        /** @hidden */\n        _this.afterCropActions = [];\n        /** @hidden */\n        _this.transform = { degree: 0, currFlipState: '', zoomFactor: 0, cropZoomFactor: null, defaultZoomFactor: 0, straighten: 0 };\n        /** @hidden */\n        _this.panPoint = { currentPannedPoint: { x: 0, y: 0 }, totalPannedPoint: { x: 0, y: 0 }, totalPannedInternalPoint: { x: 0, y: 0 },\n            totalPannedClientPoint: { x: 0, y: 0 } };\n        /** @hidden */\n        _this.isUndoRedo = false;\n        /** @hidden */\n        _this.isCropTab = false;\n        /** @hidden */\n        _this.isCircleCrop = false;\n        /** @hidden */\n        _this.fontSizeColl = [];\n        /** @hidden */\n        _this.initialAdjustmentValue = '';\n        /** @hidden */\n        _this.currentFilter = '';\n        /** @hidden */\n        _this.canvasFilter = 'brightness(' + 1 + ') ' + 'contrast(' + 100 + '%) ' + 'hue-rotate(' + 0 + 'deg) ' +\n            'saturate(' + 100 + '%) ' + 'opacity(' + 1 + ') ' + 'blur(' + 0 + 'px) ' + 'sepia(0%) ' + 'grayscale(0%) ' + 'invert(0%)';\n        /** @hidden */\n        _this.toolbarHeight = 0;\n        /** @hidden */\n        _this.isPublicMethod = false;\n        /** @hidden */\n        _this.isCropToolbar = false;\n        /** @hidden */\n        _this.cursor = 'default';\n        /** @hidden */\n        _this.resizeSrc = { startX: _this.img.srcLeft, startY: _this.img.srcTop, width: _this.img.srcWidth, height: _this.img.srcHeight };\n        /** @hidden */\n        _this.isResize = false;\n        /** @hidden */\n        _this.isAspectRatio = false;\n        /** @hidden */\n        _this.frameObj = { type: 'none', color: '#fff', size: 20, inset: 20, offset: 20, radius: 0, amount: 1, border: 'solid', gradientColor: '' };\n        /** @hidden */\n        _this.tempFrameObj = { type: 'none', color: '#fff', size: 20, inset: 20, offset: 20, radius: 0, amount: 1, border: 'solid', gradientColor: '' };\n        /** @hidden */\n        _this.allowDownScale = true;\n        /** @hidden */\n        _this.gradientColor = '';\n        /** @hidden */\n        _this.size = 20;\n        /** @hidden */\n        _this.inset = 0;\n        /** @hidden */\n        _this.offset = 0;\n        /** @hidden */\n        _this.borderRadius = 0;\n        /** @hidden */\n        _this.lineCount = 0;\n        /** @hidden */\n        _this.prevStraightenedDegree = 0;\n        /** @hidden */\n        _this.tempStraighten = 0;\n        /** @hidden */\n        _this.isStraightening = false;\n        /** @hidden */\n        _this.isFinetuning = false;\n        /** @hidden */\n        _this.isZoomBtnClick = false;\n        /** @hidden */\n        _this.isFinetuneBtnClick = false;\n        /** @hidden */\n        _this.isFilterCanvasClick = false;\n        /** @hidden */\n        _this.isFrameBtnClick = false;\n        /** @hidden */\n        _this.isChangesSaved = false;\n        /** @hidden */\n        _this.isShapeDrawing = false;\n        /** @hidden */\n        _this.noPushUndo = false;\n        /** @hidden */\n        _this.isUndoRedoStack = false;\n        /** @hidden */\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        _this.shapeColl = [];\n        /** @hidden */\n        _this.isKBDNavigation = false;\n        /** @hidden */\n        _this.isMaskImage = false;\n        /** @hidden */\n        _this.tempObjColl = [];\n        /** @hidden */\n        _this.tempPointColl = [];\n        /** @hidden */\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        _this.tempShapeColl = [];\n        /** @hidden */\n        _this.isImageUpdated = false;\n        /** @hidden */\n        _this.noRedact = false;\n        /** @hidden */\n        _this.tempRedactBlur = 50;\n        /** @hidden */\n        _this.tempRedactPixel = 40;\n        _this.tempToolbarHeight = 0;\n        _this.tempToolbar = [];\n        ImageEditor_1.Inject(Crop, Draw, Selection, Transform, Export, ToolbarModule);\n        ImageEditor_1.Inject(UndoRedo);\n        ImageEditor_1.Inject(Filter);\n        ImageEditor_1.Inject(Shape);\n        ImageEditor_1.Inject(FreehandDrawing);\n        if (element) {\n            _this.appendTo(element);\n        }\n        return _this;\n    }\n    ImageEditor_1 = ImageEditor;\n    /**\n     * To provide the array of modules needed for component rendering.\n     *\n     * @returns {ModuleDeclaration[]} - To provide the array of modules needed for component rendering.\n     * @hidden\n     */\n    ImageEditor.prototype.requiredModules = function () {\n        var modules = [];\n        modules.push({ member: 'crop', args: [this] });\n        modules.push({ member: 'draw', args: [this] });\n        modules.push({ member: 'selection', args: [this] });\n        modules.push({ member: 'transform', args: [this] });\n        modules.push({ member: 'export', args: [this] });\n        modules.push({ member: 'toolbar-module', args: [this] });\n        modules.push({ member: 'undo-redo', args: [this] });\n        modules.push({ member: 'filter', args: [this] });\n        modules.push({ member: 'shape', args: [this] });\n        modules.push({ member: 'freehand-draw', args: [this] });\n        return modules;\n    };\n    ImageEditor.prototype.preRender = function () {\n        // pre render code snippets\n        this.element.id = this.element.id || getUniqueID('ej2-image-editor');\n        this.isSafari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);\n        if (Browser.isDevice) {\n            this.element.classList.add('e-device');\n        }\n        this.initializeThemeColl();\n    };\n    /**\n     *\n     * To Initialize the component rendering\n     *\n     * @private\n     * @returns {void}\n     */\n    ImageEditor.prototype.render = function () {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        if (this.isAngular) {\n            var originalElement = this.element;\n            var clonedElement = originalElement.cloneNode(true);\n            originalElement.parentNode.replaceChild(clonedElement, originalElement);\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            this.element = clonedElement;\n            setValue('ej2_instances', [this], this.element);\n        }\n        this.initialize();\n    };\n    /**\n     * To get component name.\n     *\n     * @returns {string} - Module Name\n     * @private\n     */\n    ImageEditor.prototype.getModuleName = function () {\n        return 'image-editor';\n    };\n    /**\n     *\n     * To get the properties to be maintained in the persisted state.\n     *\n     * @returns {string} - Persist data\n     * @private\n     */\n    ImageEditor.prototype.getPersistData = function () {\n        return this.addOnPersist([]);\n    };\n    /**\n     *\n     * Called internally if any of the property value changed.\n     *\n     * @param {ImageEditorModel} newProperties - Specifies new properties\n     * @param {ImageEditorModel} oldProperties - Specifies old properties\n     * @returns {void}\n     * @private\n     */\n    ImageEditor.prototype.onPropertyChanged = function (newProperties, oldProperties) {\n        var indexObj;\n        for (var _i = 0, _a = Object.keys(newProperties); _i < _a.length; _i++) {\n            var prop = _a[_i];\n            switch (prop) {\n                case 'cssClass':\n                    if (oldProperties.cssClass) {\n                        removeClass([this.element], oldProperties.cssClass.replace(/\\s+/g, ' ').trim().split(' '));\n                    }\n                    if (newProperties.cssClass) {\n                        addClass([this.element], newProperties.cssClass.replace(/\\s+/g, ' ').trim().split(' '));\n                    }\n                    break;\n                case 'disabled':\n                    if (newProperties.disabled) {\n                        this.element.classList.add('e-disabled');\n                        this.unwireEvent();\n                    }\n                    else {\n                        this.element.classList.remove('e-disabled');\n                        this.wireEvent();\n                    }\n                    break;\n                case 'height':\n                    this.element.style.height = newProperties.height;\n                    this.update();\n                    break;\n                case 'width':\n                    this.element.style.width = newProperties.width;\n                    this.update();\n                    break;\n                case 'theme':\n                    if (newProperties.theme) {\n                        if (this.theme && this.theme !== '') {\n                            this.theme = this.toPascalCase(this.theme);\n                        }\n                        else {\n                            this.theme = 'Bootstrap5';\n                        }\n                        this.upperContext.strokeStyle = this.themeColl[this.theme]['primaryColor'];\n                        this.upperContext.fillStyle = this.themeColl[this.theme]['secondaryColor'];\n                        this.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'main',\n                                isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                    }\n                    break;\n                case 'finetuneSettings':\n                    if (newProperties.finetuneSettings) {\n                        this.finetuneSettings = newProperties.finetuneSettings;\n                        this.notify('filter', { prop: 'update-finetunes' });\n                    }\n                    break;\n                case 'locale':\n                    if (newProperties.locale) {\n                        this.notify('toolbar', { prop: 'setLocale', onPropertyChange: false, value: { locale: newProperties.locale } });\n                        this.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'main',\n                                isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                    }\n                    break;\n                case 'allowUndoRedo':\n                    if (newProperties.allowUndoRedo) {\n                        this.allowUndoRedo = true;\n                    }\n                    else {\n                        this.allowUndoRedo = false;\n                    }\n                    this.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'main',\n                            isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                    break;\n                case 'showQuickAccessToolbar':\n                    if (newProperties.showQuickAccessToolbar) {\n                        this.showQuickAccessToolbar = true;\n                        this.notify('toolbar', { prop: 'create-qa-toolbar', onPropertyChange: false });\n                        indexObj = { freehandSelectedIndex: null };\n                        this.notify('freehand-draw', { prop: 'getFreehandSelectedIndex', onPropertyChange: false, value: { obj: indexObj } });\n                        if (this.activeObj.shape) {\n                            this.notify('toolbar', { prop: 'renderQAT', onPropertyChange: false, value: { isPenEdit: null } });\n                        }\n                        else if (indexObj['freehandSelectedIndex']) {\n                            this.notify('toolbar', { prop: 'renderQAT', onPropertyChange: false, value: { isPenEdit: true } });\n                        }\n                    }\n                    else {\n                        this.showQuickAccessToolbar = false;\n                        this.notify('toolbar', { prop: 'destroy-qa-toolbar', onPropertyChange: false });\n                    }\n                    break;\n                case 'zoomSettings':\n                    if (newProperties.zoomSettings) {\n                        this.zoomSettings.zoomTrigger = newProperties.zoomSettings.zoomTrigger;\n                    }\n                    if (isNullOrUndefined(this.zoomSettings.zoomTrigger)) {\n                        this.zoomSettings.zoomTrigger = (ZoomTrigger.MouseWheel | ZoomTrigger.Pinch | ZoomTrigger.Toolbar |\n                            ZoomTrigger.Commands);\n                        this.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'main',\n                                isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                    }\n                    else if ((newProperties.zoomSettings.zoomTrigger & ZoomTrigger.Toolbar) === ZoomTrigger.Toolbar) {\n                        this.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'main',\n                                isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                    }\n                    break;\n                case 'selectionSettings':\n                    if (newProperties.selectionSettings) {\n                        this.selectionSettings = newProperties.selectionSettings;\n                        if (this.activeObj.shape) {\n                            this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n                            this.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: this.activeObj } });\n                        }\n                    }\n                    break;\n                case 'toolbar':\n                    if (newProperties.toolbar) {\n                        this.toolbar = newProperties.toolbar;\n                        this.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'main',\n                                isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                    }\n                    break;\n                case 'toolbarTemplate':\n                    if (newProperties.toolbarTemplate) {\n                        this.notify('toolbar', { prop: 'destroy-bottom-toolbar', onPropertyChange: false });\n                        this.notify('toolbar', { prop: 'destroy-top-toolbar', onPropertyChange: false });\n                        this.element.appendChild(this.createElement('div', {\n                            id: this.element.id + '_toolbarArea', className: 'e-toolbar-area'\n                        }));\n                        this.toolbarTemplateFn();\n                    }\n                    break;\n                case 'quickAccessToolbarTemplate':\n                    if (newProperties.quickAccessToolbarTemplate) {\n                        this.notify('toolbar', { prop: 'destroy-qa-toolbar', onPropertyChange: false });\n                        this.quickAccessToolbarTemplateFn();\n                    }\n                    break;\n            }\n        }\n    };\n    ImageEditor.prototype.destroy = function () {\n        var classList = [];\n        this.element.removeAttribute('tabindex');\n        var saveDialog = this.element.querySelector('#' + this.element.id + '_saveDialog');\n        if (saveDialog && saveDialog.style.display === 'block') {\n            getComponent(document.getElementById(this.element.id + '_saveDialog'), 'dialog').destroy();\n        }\n        if (this.cssClass) {\n            classList = classList.concat(this.cssClass.replace(/\\s+/g, ' ').trim().split(' '));\n        }\n        removeClass([this.element], classList);\n        if (!this.element.getAttribute('class')) {\n            this.element.removeAttribute('class');\n        }\n        this.unwireEvent();\n        this.notify('toolbar', { prop: 'destroySubComponents', onPropertyChange: false });\n        this.notify('destroyed', null);\n        _super.prototype.destroy.call(this);\n        this.element.innerHTML = '';\n    };\n    ImageEditor.prototype.initialize = function () {\n        if (this.toolbarTemplate) {\n            this.element.appendChild(this.createElement('div', {\n                id: this.element.id + '_toolbarArea', className: 'e-toolbar-area'\n            }));\n            this.toolbarTemplateFn();\n        }\n        else {\n            this.notify('toolbar', { prop: 'create-toolbar', onPropertyChange: false });\n            this.notify('toolbar', { prop: 'create-contextual-toolbar', onPropertyChange: false });\n        }\n        this.createCanvas();\n        if (this.element.offsetWidth > 359 && this.element.querySelector('.e-ie-min-drop-content') && this.element.querySelector('.e-ie-drop-content')) {\n            this.element.querySelector('.e-ie-min-drop-content').style.display = 'none';\n            this.element.querySelector('.e-ie-drop-content').style.display = 'block';\n        }\n        this.createDropUploader();\n        if (this.showQuickAccessToolbar) {\n            var canvasWrapper = document.querySelector('#' + this.element.id + '_canvasWrapper');\n            canvasWrapper.appendChild(this.createElement('div', {\n                id: this.element.id + '_quickAccessToolbarArea', className: 'e-quick-access-toolbar-area'\n            }));\n            var quickAccessToolbar = document.getElementById(this.element.id + '_quickAccessToolbarArea');\n            quickAccessToolbar.style.position = 'absolute';\n            quickAccessToolbar.style.display = 'none';\n            if (this.activeObj) {\n                quickAccessToolbar.style.left = this.activeObj.activePoint.startX + 'px';\n                quickAccessToolbar.style.top = this.activeObj.activePoint.startY + 'px';\n            }\n            quickAccessToolbar.style.width = '100%';\n        }\n        if (this.quickAccessToolbarTemplate) {\n            this.quickAccessToolbarTemplateFn();\n        }\n        else {\n            this.notify('toolbar', { prop: 'create-qa-toolbar', onPropertyChange: false });\n        }\n        this.wireEvent();\n        this.lowerContext = this.lowerCanvas.getContext('2d');\n        this.upperContext = this.upperCanvas.getContext('2d');\n        this.inMemoryContext = this.inMemoryCanvas.getContext('2d');\n        this.lowerContext.filter = this.getDefaultFilter();\n        this.notify('filter', { prop: 'setAdjustmentValue', onPropertyChange: false, value: { adjustmentValue: this.lowerContext.filter } });\n        this.canvasFilter = this.lowerContext.filter;\n        this.notify('toolbar', { prop: 'setInitialAdjustmentValue', onPropertyChange: false, value: { value: this.lowerContext.filter } });\n        if (this.cssClass) {\n            addClass([this.element], this.cssClass.replace(/\\s+/g, ' ').trim().split(' '));\n        }\n        if (this.element) {\n            createSpinner({\n                target: this.element\n            });\n        }\n        this.initializeZoomSettings();\n        if (this.imgSrc) {\n            this.open(this.imgSrc);\n        }\n    };\n    ImageEditor.prototype.createDropUploader = function () {\n        var _this = this;\n        var uploadObj = new Uploader({\n            dropArea: this.element.getElementsByClassName('e-canvas-wrapper')[0],\n            allowedExtensions: '.jpg, .jpeg, .png,.svg',\n            multiple: false,\n            selected: function (args) {\n                if (args.event.type === 'change' || args.event.type === 'drop') {\n                    /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                    var type = args.filesData[0].type;\n                    var errType = 'unsupported';\n                    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                    if ((args.event.type === 'change' || (args.event.type === 'drop' && args.event.dataTransfer.files.length === 1)) && (type === 'png' || type === 'jpg' || type === 'jpeg' || type === 'svg')) {\n                        _this.notify('draw', { prop: 'fileSelect', value: { inputElement: _this.element.querySelector('#' + _this.element.id + '_dropfileUpload'), args: args } });\n                    }\n                    else {\n                        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                        if (args.event.type === 'drop' && args.event.dataTransfer.files.length > 1) {\n                            errType = 'multi-select-image';\n                        }\n                        _this.showDialogPopup(errType);\n                    }\n                }\n            }\n        });\n        uploadObj.appendTo('#' + this.element.id + '_dropfileUpload');\n    };\n    ImageEditor.prototype.dlgCloseBtnClick = function () {\n        getComponent(document.getElementById(this.element.id + '_dialog'), 'dialog').destroy();\n    };\n    /**\n     * Show dialog popup for unsupported files.\n     *\n     * @param { string } type - Specifies the type of error.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.showDialogPopup = function (type) {\n        var content = '';\n        this.element.querySelector('#' + this.element.id + '_dialog').style.display = 'block';\n        var headerObj;\n        var okObj = { key: 'DlgOK' };\n        this.notify('toolbar', { prop: 'getLocaleText', onPropertyChange: false, value: { obj: okObj } });\n        if (type === 'multi-select-image') {\n            headerObj = { key: 'ImageErrorDialogHeader' };\n            this.notify('toolbar', { prop: 'getLocaleText', onPropertyChange: false, value: { obj: headerObj } });\n            var contentObj = { key: 'ImageErrorDialogContent' };\n            this.notify('toolbar', { prop: 'getLocaleText', onPropertyChange: false, value: { obj: contentObj } });\n            content = '<span>' + contentObj['value'] + '</span>';\n        }\n        else {\n            headerObj = { key: 'AlertDialogHeader' };\n            this.notify('toolbar', { prop: 'getLocaleText', onPropertyChange: false, value: { obj: headerObj } });\n            var contentObj = { key: 'AlertDialogContent' };\n            this.notify('toolbar', { prop: 'getLocaleText', onPropertyChange: false, value: { obj: contentObj } });\n            var supportObj = { key: 'SupportText' };\n            this.notify('toolbar', { prop: 'getLocaleText', onPropertyChange: false, value: { obj: supportObj } });\n            var andObj = { key: 'And' };\n            this.notify('toolbar', { prop: 'getLocaleText', onPropertyChange: false, value: { obj: andObj } });\n            content = '<span>' + contentObj['value'] + ' ' + supportObj['value'] + '<b> JPG, PNG, ' + andObj['value'] + ' SVG</b></span>';\n        }\n        var dialog = new Dialog({\n            header: headerObj['value'],\n            closeOnEscape: true,\n            content: content,\n            target: document.getElementById('target'),\n            width: '285px',\n            isModal: true,\n            animationSettings: { effect: 'Zoom' },\n            close: this.dlgCloseBtnClick.bind(this),\n            buttons: [\n                { click: this.dlgCloseBtnClick.bind(this),\n                    buttonModel: { content: okObj['value'] }\n                }\n            ]\n        });\n        dialog.appendTo('#' + this.element.id + '_dialog');\n    };\n    /**\n     *\n     * This Method will add events to component (element, event, method, current reference)\n     *\n     * @returns {void}.\n     */\n    ImageEditor.prototype.wireEvent = function () {\n        EventHandler.add(document, 'keydown', this.keyDownEventHandler, this);\n        EventHandler.add(document, 'keypress', this.keyUpEventHandler, this);\n        EventHandler.add(this.upperCanvas, 'mousedown', this.mouseDownEventHandler, this);\n        EventHandler.add(this.upperCanvas, 'mousemove', this.mouseMoveEventHandler, this);\n        EventHandler.add(this.upperCanvas, 'mouseup', this.mouseUpEventHandler, this);\n        EventHandler.add(document, 'mouseup', this.mouseUpEventHandler, this);\n        EventHandler.add(this.lowerCanvas, 'mousedown', this.canvasMouseDownHandler, this);\n        EventHandler.add(this.lowerCanvas, 'mousemove', this.canvasMouseMoveHandler, this);\n        EventHandler.add(this.lowerCanvas, 'mouseup', this.canvasMouseUpHandler, this);\n        EventHandler.add(this.upperCanvas, 'touchstart', this.touchStartHandler, this);\n        EventHandler.add(this.lowerCanvas, 'touchstart', this.touchStartHandler, this);\n        EventHandler.add(this.lowerCanvas, 'mousewheel DOMMouseScroll', this.handleScroll, this);\n        EventHandler.add(this.upperCanvas, 'mousewheel DOMMouseScroll', this.handleScroll, this);\n        window.addEventListener('resize', this.windowResizeHandler.bind(this));\n        if ((!Browser.isIos && Browser.info.name !== 'safari')) {\n            screen.orientation.addEventListener('change', this.screenOrientation.bind(this));\n        }\n        this.notify('shape', { prop: 'wireEvent', onPropertyChange: false });\n    };\n    /**\n     *\n     * This Method will remove events from component\n     *\n     * @returns {void}.\n     */\n    ImageEditor.prototype.unwireEvent = function () {\n        EventHandler.remove(document, 'keydown', this.keyDownEventHandler);\n        EventHandler.remove(document, 'keypress', this.keyUpEventHandler);\n        EventHandler.remove(this.upperCanvas, 'mousedown', this.mouseDownEventHandler);\n        EventHandler.remove(this.upperCanvas, 'mousemove', this.mouseMoveEventHandler);\n        EventHandler.remove(this.upperCanvas, 'mouseup', this.mouseUpEventHandler);\n        EventHandler.remove(document, 'mouseup', this.mouseUpEventHandler);\n        EventHandler.remove(this.lowerCanvas, 'mousedown', this.canvasMouseDownHandler);\n        EventHandler.remove(this.lowerCanvas, 'mousemove', this.canvasMouseMoveHandler);\n        EventHandler.remove(this.lowerCanvas, 'mouseup', this.canvasMouseUpHandler);\n        EventHandler.remove(this.upperCanvas, 'touchstart', this.touchStartHandler);\n        EventHandler.remove(this.lowerCanvas, 'touchstart', this.touchStartHandler);\n        EventHandler.remove(this.lowerCanvas, 'mousewheel DOMMouseScroll', this.handleScroll);\n        EventHandler.remove(this.upperCanvas, 'mousewheel DOMMouseScroll', this.handleScroll);\n        window.removeEventListener('resize', this.windowResizeHandler.bind(this));\n        if ((!Browser.isIos && Browser.info.name !== 'safari')) {\n            screen.orientation.removeEventListener('change', this.screenOrientation.bind(this));\n        }\n        this.notify('shape', { prop: 'unWireEvent', onPropertyChange: false });\n        this.notify('selection', { prop: 'unWireEvent', onPropertyChange: false });\n    };\n    ImageEditor.prototype.createCanvas = function () {\n        this.element.style.boxSizing = 'border-box';\n        var obj = { toolbarHeight: 0 };\n        this.notify('toolbar', { prop: 'getToolbarHeight', value: { obj: obj } });\n        var height = obj['toolbarHeight'];\n        if (this.toolbar && this.toolbar.length > 0 && this.toolbar.indexOf('Open') === -1) {\n            height = 0;\n        }\n        this.element.style.width = this.width;\n        this.element.style.height = this.height;\n        var canvasWrapper = this.element.appendChild(this.createElement('div', { id: this.element.id + '_canvasWrapper',\n            className: 'e-canvas-wrapper', attrs: { style: 'height:' + (this.element.offsetHeight - height - 2) + 'px; width:' +\n                    (this.element.offsetWidth - 2)\n                    + 'px; position: relative; overflow: hidden; margin: 0 auto;' }\n        }));\n        var dragObj = { key: 'DragText' };\n        this.notify('toolbar', { prop: 'getLocaleText', onPropertyChange: false, value: { obj: dragObj } });\n        var dropObj = { key: 'DropText' };\n        this.notify('toolbar', { prop: 'getLocaleText', onPropertyChange: false, value: { obj: dropObj } });\n        var browseObj = { key: 'BrowseText' };\n        this.notify('toolbar', { prop: 'getLocaleText', onPropertyChange: false, value: { obj: browseObj } });\n        var supportObj = { key: 'SupportText' };\n        this.notify('toolbar', { prop: 'getLocaleText', onPropertyChange: false, value: { obj: supportObj } });\n        var andObj = { key: 'And' };\n        this.notify('toolbar', { prop: 'getLocaleText', onPropertyChange: false, value: { obj: andObj } });\n        var dropAreaElement = this.createElement('div', { id: this.element.id + '_dropArea', className: 'e-ie-drop-area', attrs: { style: 'position: relative;' } });\n        var dropIconElement = this.createElement('span', { className: 'e-ie-drop-icon e-icons e-image', attrs: { style: 'position: absolute;' } });\n        var dropContentElement = this.createElement('span', { className: 'e-ie-drop-content', attrs: { style: 'position: absolute; display: none;' } });\n        dropContentElement.textContent = dragObj['value'] + ' ';\n        var minDropContentElem = this.createElement('span', { className: 'e-ie-min-drop-content', attrs: { style: 'position: absolute;' } });\n        minDropContentElem.textContent = dropObj['value'] + ' ';\n        var dropAnchorElement = this.createElement('a', { id: this.element.id + '_dropBrowse', className: 'e-ie-drop-browse' });\n        dropAnchorElement.textContent = browseObj['value'];\n        var minDropAnchorElem = this.createElement('a', { id: this.element.id + '_dropBrowse', className: 'e-ie-drop-browse' });\n        minDropAnchorElem.textContent = browseObj['value'];\n        dropContentElement.appendChild(dropAnchorElement);\n        minDropContentElem.appendChild(minDropAnchorElem);\n        dropAnchorElement.href = '';\n        minDropAnchorElem.href = '';\n        var dropInfoElement = this.createElement('span', { className: 'e-ie-drop-info', attrs: { position: 'absolute' } });\n        dropInfoElement.textContent = supportObj['value'] + ' SVG, PNG, ' + andObj['value'] + ' JPG';\n        var dropUploader = dropAreaElement.appendChild(this.createElement('input', {\n            id: this.element.id + '_dropfileUpload', className: 'e-fileUpload e-image-upload'\n        }));\n        dropUploader.setAttribute('type', 'file');\n        dropUploader.setAttribute('accept', 'image/*');\n        dropAreaElement.appendChild(dropIconElement);\n        dropAreaElement.appendChild(dropContentElement);\n        dropAreaElement.appendChild(minDropContentElem);\n        dropAreaElement.appendChild(dropInfoElement);\n        canvasWrapper.appendChild(dropAreaElement);\n        this.lowerCanvas = canvasWrapper.appendChild(this.createElement('canvas', {\n            id: this.element.id + '_lowerCanvas', attrs: { name: 'canvasImage' }\n        }));\n        this.maskCanvas = canvasWrapper.appendChild(this.createElement('canvas', {\n            id: this.element.id + '_maskCanvas', attrs: { name: 'canvasImage' }\n        }));\n        this.upperCanvas = canvasWrapper.appendChild(this.createElement('canvas', {\n            id: this.element.id + '_upperCanvas', attrs: { name: 'canvasImage' }\n        }));\n        this.inMemoryCanvas = this.createElement('canvas', {\n            id: this.element.id + '_inMemoryCanvas', attrs: { name: 'canvasImage' }\n        });\n        this.baseImgCanvas = this.createElement('canvas', {\n            id: this.element.id + '_baseImgCanvas', attrs: { name: 'canvasImage' }\n        });\n        this.textArea = canvasWrapper.appendChild(this.createElement('textarea', {\n            id: this.element.id + '_textArea', className: 'e-textarea', attrs: { name: 'textArea' }\n        }));\n        var dialog = this.element.appendChild(this.createElement('div', {\n            id: this.element.id + '_dialog', className: 'e-dialog'\n        }));\n        dialog.style.display = 'none';\n        var uploader = this.element.appendChild(this.createElement('input', {\n            id: this.element.id + '_fileUpload', className: 'e-fileUpload'\n        }));\n        uploader.setAttribute('type', 'file');\n        uploader.setAttribute('accept', 'image/*');\n        uploader.style.display = 'none';\n        this.textArea.setAttribute('spellcheck', 'false');\n        this.textArea.style.lineHeight = 'normal';\n        this.lowerCanvas.style.width = this.upperCanvas.style.width = this.maskCanvas.style.width =\n            this.inMemoryCanvas.style.width = '100%';\n        this.lowerCanvas.style.height = this.upperCanvas.style.height = this.maskCanvas.style.height =\n            this.inMemoryCanvas.style.height = '100%';\n        this.upperCanvas.style.position = this.lowerCanvas.style.position = this.maskCanvas.style.position =\n            this.textArea.style.position = 'absolute';\n        this.textArea.style.backgroundColor = 'transparent';\n        this.textArea.style.display = 'none';\n        this.maskCanvas.style.display = this.textArea.style.resize = 'none';\n        this.lowerContext = this.lowerCanvas.getContext('2d');\n        this.baseImg = this.createElement('img', {\n            id: this.element.id + '_orgImg', attrs: { name: 'Image', crossorigin: 'anonymous' }\n        });\n        this.upperCanvas.style.cursor = this.cursor = 'default';\n        this.upperCanvas.style.display = 'block';\n        this.upperContext = this.upperCanvas.getContext('2d');\n        dropAnchorElement.addEventListener('click', function (e) {\n            e.preventDefault();\n            dropUploader.click();\n            return false;\n        });\n        minDropAnchorElem.addEventListener('click', function (e) {\n            e.preventDefault();\n            dropUploader.click();\n            return false;\n        });\n    };\n    ImageEditor.prototype.touchStartHandler = function (e) {\n        this.notify('selection', { prop: 'touchStartHandler', onPropertyChange: false, value: { e: e } });\n    };\n    ImageEditor.prototype.mouseDownEventHandler = function (e) {\n        if (e.target.className === 'e-ie-drop-browse') {\n            return;\n        }\n        this.notify('selection', { prop: 'mouseDownEventHandler', onPropertyChange: false, value: { e: e } });\n    };\n    ImageEditor.prototype.mouseMoveEventHandler = function (e) {\n        this.notify('selection', { prop: 'mouseMoveEventHandler', onPropertyChange: false, value: { e: e } });\n    };\n    ImageEditor.prototype.mouseUpEventHandler = function (e) {\n        if (e.target.className === 'e-ie-drop-browse') {\n            return;\n        }\n        this.notify('selection', { prop: 'mouseUpEventHandler', onPropertyChange: false, value: { e: e } });\n    };\n    ImageEditor.prototype.keyDownEventHandler = function (e) {\n        this.notify('selection', { prop: 'keyDownEventHandler', onPropertyChange: false, value: { e: e } });\n    };\n    ImageEditor.prototype.keyUpEventHandler = function (e) {\n        if ((this.textArea.style.display === 'block' || this.textArea.style.display === 'inline-block')\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            && e.target.id === this.element.id + '_textArea') {\n            this.notify('selection', { prop: 'textKeyDown', value: { e: e } });\n        }\n    };\n    ImageEditor.prototype.canvasMouseDownHandler = function (e) {\n        if (e.target.className === 'e-ie-drop-browse') {\n            return;\n        }\n        this.notify('selection', { prop: 'canvasMouseDownHandler', onPropertyChange: false, value: { e: e } });\n    };\n    ImageEditor.prototype.canvasMouseMoveHandler = function (e) {\n        this.notify('selection', { prop: 'canvasMouseMoveHandler', onPropertyChange: false, value: { e: e } });\n    };\n    ImageEditor.prototype.canvasMouseUpHandler = function (e) {\n        if (e.target.className === 'e-ie-drop-browse') {\n            return;\n        }\n        this.notify('selection', { prop: 'canvasMouseUpHandler', onPropertyChange: false, value: { e: e } });\n    };\n    ImageEditor.prototype.handleScroll = function (e) {\n        this.notify('selection', { prop: 'handleScroll', onPropertyChange: false, value: { e: e } });\n    };\n    ImageEditor.prototype.adjustToScreen = function () {\n        this.update();\n    };\n    ImageEditor.prototype.screenOrientation = function () {\n        if (Browser.isDevice) {\n            setTimeout(this.adjustToScreen.bind(this), 100);\n        }\n    };\n    ImageEditor.prototype.windowResizeHandler = function () {\n        if (!Browser.isDevice && this.element.classList.contains('e-image-editor')) {\n            this.adjustToScreen();\n        }\n    };\n    ImageEditor.prototype.notifyResetForAllModules = function () {\n        var modules = this.requiredModules();\n        for (var i = 0; i < modules.length; i++) {\n            var module = modules[i].member;\n            this.notify(module === 'toolbar-module' ? 'toolbar' : module, { prop: 'reset', onPropertyChange: false });\n        }\n    };\n    ImageEditor.prototype.allowShape = function (x, y) {\n        this.isPublicMethod = true;\n        this.applyShapes();\n        var obj = { inRange: false };\n        this.notify('shape', { prop: 'isPointsInRange', onPropertyChange: false,\n            value: { x: x, y: y, obj: obj } });\n        return obj['inRange'];\n    };\n    /**\n     * Clears the current selection performed in the image editor.\n     *\n     * @param { boolean } resetCrop - Specifies to reset last cropped image.\n     *\n     * @returns {void}.\n     */\n    ImageEditor.prototype.clearSelection = function (resetCrop) {\n        this.notify('selection', { prop: 'clearSelection', onPropertyChange: false, value: { resetCrop: resetCrop } });\n    };\n    /**\n     * Crops an image based on the selection done in the image editor.\n     *\n     * {% codeBlock src='image-editor/crop/index.md' %}{% endcodeBlock %}\n     *\n     * @remarks\n     * The selection can be done through programmatically using the 'select' method or through UI interactions.\n     *\n     * @returns {boolean}.\n     *\n     */\n    ImageEditor.prototype.crop = function () {\n        var obj = { isCrop: false };\n        this.notify('crop', { prop: 'crop', onPropertyChange: false, value: { obj: obj } });\n        return obj['isCrop'];\n    };\n    /**\n     * Flips an image by horizontally or vertically in the image editor.\n     *\n     * {% codeBlock src='image-editor/zoom/index.md' %}{% endcodeBlock %}\n     *\n     * @param { Direction } direction - Specifies the direction to flip the image.\n     * A horizontal direction for horizontal flipping and vertical direction for vertical flipping.\n     *\n     * @remarks\n     * It flips the shapes including rectangle, circle, line, text, image, and freehand drawings.\n     *\n     * @returns {void}.\n     *\n     */\n    ImageEditor.prototype.flip = function (direction) {\n        this.notify('transform', { prop: 'flip', value: { direction: direction } });\n        this.notify('draw', { prop: 'redrawDownScale' });\n        this.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n        var actionArgs = { action: 'flip', actionEventArgs: this.editCompleteArgs };\n        this.triggerEditCompleteEvent(actionArgs);\n    };\n    /**\n     * Returns an image as ImageData to load it in to a canvas.\n     *\n     * @param {boolean} [includeAnnotations=true] - Optional. Specifies whether the returned image data should include annotations. The default value is true, meaning annotations are included.\n     *\n     * @remarks\n     * The data returned from this method is directly drawn in a canvas using 'putImageData' method.\n     * And then the user can get the base64 string from the canvas using toDataURL method.\n     *\n     * @returns {ImageData}.\n     */\n    ImageEditor.prototype.getImageData = function (includeAnnotations) {\n        includeAnnotations = isNullOrUndefined(includeAnnotations) ? true : includeAnnotations;\n        var imageData;\n        if (includeAnnotations) {\n            var obj = { canvas: null };\n            this.applyShapes();\n            this.notify('export', { prop: 'exportToCanvas', value: { object: obj } });\n            imageData = obj['canvas'].getContext('2d').getImageData(0, 0, obj['canvas'].width, obj['canvas'].height);\n        }\n        else if (this.isMaskImage && this.element.getAttribute('data-value') === 'mask-drawing') {\n            imageData = this.getData(true);\n            this.updateColl('reset');\n        }\n        else {\n            imageData = this.getData();\n            this.notify('draw', { prop: 'render-image', value: { isMouseWheel: false } });\n        }\n        return imageData;\n    };\n    /**\n     *  Opens an image as URL or ImageData for editing in an image editor.\n     *\n     * @param {string | ImageData } data - Specifies url of the image or image data.\n     * @param {boolean} [resetChanges=true] - Optional. Determines whether to reset existing changes when opening the image. The default value is true, which resets all existing changes.\n     * @param {ImageSettings} imageSettings - Optional. Specifies the image setting that contains background color to apply when opening a transparent image. The default value of background color is an empty string (''), meaning no background color is applied by default when a transparent image is opened.\n     *\n     * @remarks\n     * The supported file types are JPG, JPEG, PNG, and SVG.\n     *\n     * @returns {void}.\n     */\n    ImageEditor.prototype.open = function (data, resetChanges, imageSettings) {\n        resetChanges = isNullOrUndefined(resetChanges) ? true : resetChanges;\n        if (resetChanges) {\n            if (isNullOrUndefined(data)) {\n                return;\n            }\n            var dropArea = document.getElementById(this.element.id + '_dropArea');\n            if (dropArea) {\n                dropArea.style.display = 'none';\n            }\n            this.notify('draw', { prop: 'open', value: { data: data } });\n        }\n        else {\n            this.updateImage(data, imageSettings ? imageSettings.backgroundColor : null);\n        }\n    };\n    /**\n     * Reset all the changesdone in an image editor and revert to original image.\n     *\n     * @remarks\n     * The undo redo collection also cleared while resetting the image editor.\n     *\n     * @returns {void}.\n     */\n    ImageEditor.prototype.reset = function () {\n        this.updateColl('reset');\n        var obj = { isErrorImage: false };\n        this.notify('draw', { prop: 'getErrorImage', value: { obj: obj } });\n        if (!this.disabled && !obj['isErrorImage']) {\n            this.clearContext(this.inMemoryContext);\n            this.clearContext(this.lowerContext);\n            this.clearContext(this.upperContext);\n            this.notify('shape', { prop: 'setRedactType', onPropertyChange: false, value: { redactType: 'blur' } });\n            this.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            this.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'main',\n                    isApplyBtn: false, isCropping: false, isZooming: null, cType: null } });\n            if (Browser.isDevice && document.getElementById(this.element.id + '_bottomToolbar')) {\n                getComponent(document.getElementById(this.element.id + '_bottomToolbar'), 'toolbar').destroy();\n                this.notify('toolbar', { prop: 'create-bottom-toolbar', onPropertyChange: false });\n            }\n            var isImageLoaded = this.isImageLoaded;\n            this.currObjType.isUndoAction = this.isUndoRedo = this.togglePan = this.togglePen = this.isImageLoaded = this.isFinetuning = false;\n            this.isCircleCrop = this.isCropTab = false;\n            this.objColl = [];\n            this.transform.degree = 0;\n            this.upperCanvas.style.display = 'block';\n            this.transform.currFlipState = '';\n            this.allowDownScale = true;\n            this.upperCanvas.style.cursor = this.cursor = this.lowerCanvas.style.cursor = 'default';\n            this.lowerContext.lineWidth = this.upperContext.lineWidth = undefined;\n            this.frameDestPoints = null;\n            this.textArea.value = this.textArea.textContent = '';\n            this.textArea.style.display = 'none';\n            this.lowerContext.filter = this.canvasFilter = this.getDefaultFilter();\n            this.img.destLeft = this.img.destTop = this.img.srcLeft = this.img.srcTop = 0;\n            this.img.destWidth = this.img.destHeight = this.img.srcWidth = this.img.srcHeight = null;\n            this.currSelectionPoint = null;\n            this.panPoint.currentPannedPoint = { x: 0, y: 0 };\n            this.rotateFlipColl = [];\n            this.points = [];\n            this.pointColl = {};\n            this.freehandCounter = 0;\n            this.notify('draw', { prop: 'resetPanPoints' });\n            this.lowerCanvas.style.left = this.upperCanvas.style.left = '';\n            this.fontSizeColl = [];\n            this.lowerCanvas.style.top = this.upperCanvas.style.top = '';\n            this.lowerCanvas.style.maxWidth = this.upperCanvas.style.maxWidth = '';\n            this.lowerCanvas.style.maxHeight = this.upperCanvas.style.maxHeight = '';\n            this.transform.defaultZoomFactor = this.transform.zoomFactor = 0;\n            this.transform.cropZoomFactor = null;\n            this.frameObj = { type: 'none', color: '#fff', size: 20, inset: 20, offset: 20, radius: 0, amount: 1, border: 'solid', gradientColor: '' };\n            this.tempFrameObj = { type: 'none', color: '#fff', size: 20, inset: 20, offset: 20, radius: 0, amount: 1, border: 'solid', gradientColor: '' };\n            this.currObjType = { shape: '', isDragging: false, isActiveObj: false, isText: false, isInitialText: false, isLine: false,\n                isInitialLine: false, isCustomCrop: false, isZoomed: false, isUndoZoom: false,\n                isUndoAction: false, isFiltered: false, isSave: false, isResize: false, isRedact: false };\n            this.cropObj = { cropZoom: 0, defaultZoom: 0, totalPannedPoint: { x: 0, y: 0 }, totalPannedClientPoint: { x: 0, y: 0 },\n                totalPannedInternalPoint: { x: 0, y: 0 }, tempFlipPanPoint: { x: 0, y: 0 }, activeObj: {},\n                rotateFlipColl: [], degree: 0, currFlipState: '', straighten: 0, zoomFactor: 0, previousZoomValue: 0,\n                destPoints: { startX: 0, startY: 0, width: 0, height: 0 }, frame: 'none',\n                srcPoints: { startX: 0, startY: 0, width: 0, height: 0 }, filter: '', isBrightAdjust: false,\n                aspectWidth: null, aspectHeight: null, straightenZoom: 0,\n                adjustmentLevel: { brightness: 0, contrast: 0, hue: 0, opacity: 100, saturation: 0, blur: 0,\n                    exposure: 0, transparency: 100, sharpen: false, bw: false }, currentFilter: '' };\n            this.afterCropActions = [];\n            this.currentFilter = '';\n            this.tempFrameZoomLevel = null;\n            this.cxtTbarHeight = null;\n            this.straightenPoint = null;\n            this.transform.straighten = 0;\n            this.cancelCropSelection = null;\n            this.aspectWidth = this.aspectHeight = null;\n            this.isResize = this.isMaskImage = false;\n            this.drawingShape = null;\n            this.isShapeDrawing = this.noPushUndo = this.isUndoRedoStack = this.isKBDNavigation = false;\n            this.shapeColl = [];\n            this.tempObjColl = [];\n            this.tempPointColl = [];\n            this.tempShapeColl = [];\n            this.isImageUpdated = false;\n            this.tempToolbarHeight = 0;\n            this.tempToolbar = [];\n            this.tempRedactBlur = 50;\n            this.tempRedactPixel = 40;\n            var obj_1 = { initialZoomValue: false };\n            this.editCompleteArgs = null;\n            this.isFinetuneBtnClick = false;\n            this.notify('draw', { prop: 'getInitialZoomValue', onPropertyChange: false, value: { obj: obj_1 } });\n            if (obj_1['initialZoomValue']) {\n                this.setProperties({ zoomSettings: { zoomFactor: obj_1['initialZoomValue'] } }, true);\n            }\n            var qtArea = document.getElementById(this.element.id + '_quickAccessToolbarArea');\n            if (qtArea) {\n                qtArea.style.display = 'none';\n            }\n            this.notifyResetForAllModules();\n            this.notify('filter', { prop: 'update-finetunes' });\n            if (this.toolbarTemplate) {\n                this.toolbarHeight = this.element.querySelector('#' + this.element.id + '_toolbarArea').clientHeight;\n            }\n            else if (this.element.querySelector('#' + this.element.id + '_toolbar')) {\n                this.toolbarHeight = this.element.querySelector('#' + this.element.id + '_toolbar').clientHeight;\n            }\n            this.notify('toolbar', { prop: 'setToolbarHeight', value: { height: this.toolbarHeight } });\n            this.isImageLoaded = isImageLoaded;\n            this.straightenBaseImageCanvas();\n            this.isImageLoaded = false;\n            this.notify('draw', { prop: 'update-canvas', onPropertyChange: false });\n            this.isImageLoaded = isImageLoaded;\n            this.prevStraightenedDegree = 0;\n            var ctWrapper = this.element.querySelector('.e-contextual-toolbar-wrapper');\n            if (ctWrapper) {\n                ctWrapper.classList.add('e-hide');\n            }\n            this.notify('toolbar', { prop: 'refresh-dropdown-btn', value: { isDisabled: false } });\n            this.notify('toolbar', { prop: 'enable-disable-btns' });\n            var straightenObj = { bool: this.isStraightening };\n            if (Browser.isDevice && straightenObj['bool']) {\n                this.notify('crop', { prop: 'resizeWrapper' });\n            }\n            var actionArgs = { action: 'reset', actionEventArgs: null };\n            this.triggerEditCompleteEvent(actionArgs);\n        }\n    };\n    /**\n     * Rotate an image to clockwise and anti-clockwise.\n     *\n     * {% codeBlock src='image-editor/rotate/index.md' %}{% endcodeBlock %}\n     *\n     * @param {number} degree - Specifies a degree to rotate an image.\n     * A positive integer value for clockwise and negative integer value for anti-clockwise rotation.\n     *\n     * @remarks\n     * It rotated the shapes including rectangle, circle, line, text, image, and freehand drawings.\n     *\n     * @returns {boolean}.\n     *\n     */\n    ImageEditor.prototype.rotate = function (degree) {\n        var obj = { isRotate: false };\n        if (degree === 90 || degree === -90) {\n            this.updateImageTransformColl(degree === 90 ? 'rotateright' : 'rotateleft');\n        }\n        this.notify('transform', { prop: 'rotate', value: { degree: degree, obj: obj } });\n        this.notify('draw', { prop: 'redrawDownScale' });\n        var actionArgs = { action: 'rotate', actionEventArgs: this.editCompleteArgs };\n        this.triggerEditCompleteEvent(actionArgs);\n        return obj['isRotate'];\n    };\n    /**\n     * Export an image using the specified file name and the extension.\n     *\n     * @param {string} type - Specifies a format of image to be saved.\n     * @param {string} fileName  Specifies a file name to be saved\n     * @param {number} imageQuality  Specifies the quality of an image to be saved. The default value is 1 which represents the original size of the image if not specified.\n     *\n     * @remarks\n     * The supported file types are JPG, JPEG, PNG, and SVG.\n     *\n     * @returns {void}.\n     */\n    ImageEditor.prototype.export = function (type, fileName, imageQuality) {\n        this.applyShapes();\n        this.notify('export', { prop: 'export', onPropertyChange: false, value: { type: type, fileName: fileName, imgQuality: imageQuality } });\n    };\n    /**\n     * Perform selection in an image editor. The selection helps to crop an image.\n     *\n     * {% codeBlock src='image-editor/select/index.md' %}{% endcodeBlock %}\n     *\n     * @param {string} type - Specifies the shape - circle / square / custom selection / pre-defined ratios.\n     * @param {number} startX  Specifies the start x-coordinate point of the selection.\n     * @param {number} startY  Specifies the start y-coordinate point of the selection.\n     * @param {number} width - Specifies the width of the selection area.\n     * @param {number} height - Specifies the height of the selection area.\n     *\n     * @remarks\n     * The selection UI is based on the 'theme' property.\n     *\n     * @returns {void}.\n     *\n     */\n    ImageEditor.prototype.select = function (type, startX, startY, width, height) {\n        this.applyShapes();\n        this.notify('toolbar', { prop: 'performCropTransformClick', value: { shape: 'crop-' + type } });\n        this.notify('draw', { prop: 'select', onPropertyChange: false,\n            value: { type: type, startX: startX, startY: startY, width: width, height: height } });\n        if ((startX && startY) || (width && height)) {\n            this.notify('draw', { prop: 'select', onPropertyChange: false,\n                value: { type: type, startX: startX, startY: startY, width: width, height: height } });\n        }\n        else {\n            this.cropObj = { cropZoom: 0, defaultZoom: 0, totalPannedPoint: { x: 0, y: 0 }, totalPannedClientPoint: { x: 0, y: 0 },\n                totalPannedInternalPoint: { x: 0, y: 0 }, tempFlipPanPoint: { x: 0, y: 0 }, activeObj: {},\n                rotateFlipColl: [], degree: 0, currFlipState: '', straighten: 0, zoomFactor: 0, previousZoomValue: 0,\n                destPoints: { startX: 0, startY: 0, width: 0, height: 0 }, frame: 'none',\n                srcPoints: { startX: 0, startY: 0, width: 0, height: 0 }, filter: '', isBrightAdjust: false,\n                aspectWidth: null, aspectHeight: null, straightenZoom: 0,\n                adjustmentLevel: { brightness: 0, contrast: 0, hue: 0, opacity: 100, saturation: 0, blur: 0,\n                    exposure: 0, transparency: 100, sharpen: false, bw: false }, currentFilter: '' };\n        }\n    };\n    /**\n     * Enable or disable a freehand drawing option in an Image Editor.\n     *\n     * @param {boolean} value - Specifies a value whether to enable or disable freehand drawing.\n     *\n     * @returns {void}.\n     * @private\n     */\n    ImageEditor.prototype.freeHandDraw = function (value) {\n        this.notify('freehand-draw', { prop: 'freeHandDraw', onPropertyChange: false, value: { value: value } });\n    };\n    /**\n     * Enable or disable a freehand drawing in an Image Editor.\n     *\n     * @param {boolean} value - Specifies a value whether to enable or disable freehand drawing.\n     *\n     * @remarks\n     * User can directly drawing on a canvas after enabling this option.\n     *\n     * @returns {void}.\n     */\n    ImageEditor.prototype.freehandDraw = function (value) {\n        if (!this.disabled && this.isImageLoaded) {\n            if (!value && this.isMaskImage) {\n                this.discard();\n                return;\n            }\n            this.applyShapes();\n            this.freeHandDraw(value);\n            var prevObj = { shapeSettingsObj: {} };\n            this.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: prevObj } });\n            var shapeSettings = prevObj['shapeSettingsObj'];\n            shapeSettings.type = ShapeType.FreehandDraw;\n            var shapeChangingArgs = { cancel: false, action: 'insert', previousShapeSettings: shapeSettings,\n                currentShapeSettings: shapeSettings };\n            this.notify('freehand-draw', { prop: 'triggerShapeChanging', value: { shapeChangingArgs: shapeChangingArgs } });\n        }\n    };\n    /**\n     * Enable or disable a panning on the Image Editor.\n     *\n     * @param {boolean} value - Specifies a value whether enable or disable panning.\n     * @param {number} x - Optional, Specifies a value to pan the image horizontally.\n     * @param {number} y - Optional, Specifies a value to pan the image vertically.\n     *\n     * @remarks\n     * This option will take into effect once the image's visibility is hidden when zooming an image or selection has been performed.\n     *\n     * @returns {void}.\n     */\n    ImageEditor.prototype.pan = function (value, x, y) {\n        this.applyShapes();\n        this.notify('transform', { prop: 'pan', onPropertyChange: false, value: { value: value, x: x, y: y } });\n    };\n    /**\n     * Zoom in or out on a point in the image editor.\n     *\n     * @param {number} zoomFactor - The percentage-based zoom factor to use (e.g. 20 for 2x zoom).\n     * @param {Point} zoomPoint - The point in the image editor to zoom in/out on.\n     *\n     * @remarks\n     * Zooming directly enables the panning option when the image's visibility is hidden.\n     * User can disable it by using 'Pan' method.\n     * @returns {void}\n     *\n     */\n    ImageEditor.prototype.zoom = function (zoomFactor, zoomPoint) {\n        this.isZoomBtnClick = true;\n        this.notify('transform', { prop: 'zoom', onPropertyChange: false,\n            value: { zoomFactor: zoomFactor, zoomPoint: zoomPoint } });\n        this.notify('draw', { prop: 'redrawDownScale' });\n    };\n    /**\n     * Draw ellipse on an image.\n     *\n     * {% codeBlock src='image-editor/ellipse/index.md' %}{% endcodeBlock %}\n     *\n     * @param {number} x - Specifies x-coordinate of ellipse.\n     * @param {number} y - Specifies y-coordinate of ellipse.\n     * @param {number} radiusX - Specifies the radius x point for the ellipse.\n     * @param {number} radiusY - Specifies the radius y point for the ellipse.\n     * @param {number} strokeWidth - Specifies the stroke width of ellipse.\n     * @param {string} strokeColor - Specifies the stroke color of ellipse.\n     * @param {string} fillColor - Specifies the fill color of the ellipse.\n     * @param {number} degree - Specifies the degree to rotate the ellipse.\n     * @param {boolean} isSelected - Specifies to show the ellipse in the selected state.\n     * @returns {boolean}.\n     *\n     */\n    ImageEditor.prototype.drawEllipse = function (x, y, radiusX, radiusY, strokeWidth, strokeColor, fillColor, degree, isSelected) {\n        var isEllipse = false;\n        var isPointsInRange = this.allowShape(x, y);\n        if (!this.disabled && this.isImageLoaded && (isPointsInRange || (isNullOrUndefined(x) && isNullOrUndefined(y)))) {\n            isEllipse = true;\n            this.notify('shape', { prop: 'drawEllipse', onPropertyChange: false, value: { x: x, y: y, radiusX: radiusX, radiusY: radiusY,\n                    strokeWidth: strokeWidth, strokeColor: strokeColor, fillColor: fillColor, degree: degree, isSelected: isSelected } });\n            this.editCompleted();\n        }\n        return isEllipse;\n    };\n    /**\n     * Draw line on an image.\n     *\n     * @param {number} startX  Specifies start point x-coordinate of line.\n     * @param {number} startY  Specifies start point y-coordinate of line.\n     * @param {number} endX - Specifies end point x-coordinates of line.\n     * @param {number} endY - Specifies end point y-coordinates of the line.\n     * @param {number} strokeWidth - Specifies the stroke width of line.\n     * @param {string} strokeColor - Specifies the stroke color of line.\n     * @param {boolean} isSelected - Specifies to show the line in the selected state.\n     * @returns {boolean}.\n     */\n    ImageEditor.prototype.drawLine = function (startX, startY, endX, endY, strokeWidth, strokeColor, isSelected) {\n        var isLine = false;\n        var isPointsInRange = this.allowShape(startX, startY);\n        if (!this.disabled && this.isImageLoaded && (isPointsInRange || (isNullOrUndefined(startX) && isNullOrUndefined(startY)))) {\n            isLine = true;\n            this.notify('shape', { prop: 'drawLine', onPropertyChange: false, value: { startX: startX, startY: startY, endX: endX,\n                    endY: endY, strokeWidth: strokeWidth, strokeColor: strokeColor, isSelected: isSelected } });\n            this.editCompleted();\n        }\n        return isLine;\n    };\n    /**\n     * Draw arrow on an image.\n     *\n     * @param {number} startX  Specifies start point x-coordinate of arrow.\n     * @param {number} startY  Specifies start point y-coordinate of arrow.\n     * @param {number} endX - Specifies end point x-coordinates of arrow.\n     * @param {number} endY - Specifies end point y-coordinates of the arrow.\n     * @param {number} strokeWidth - Specifies the stroke width of arrow.\n     * @param {string} strokeColor - Specifies the stroke color of arrow.\n     * @param {ArrowheadType} arrowStart  Specifies the type of arrowhead for start position. The default value is None.\n     * @param {ArrowheadType} arrowEnd  Specifies the type of arrowhead for end position. The default value is SolidArrow.\n     * @param {boolean} isSelected - Specifies to show the arrow in the selected state.\n     * @returns {boolean}.\n     */\n    ImageEditor.prototype.drawArrow = function (startX, startY, endX, endY, strokeWidth, strokeColor, arrowStart, arrowEnd, isSelected) {\n        var isArrow = false;\n        var isPointsInRange = this.allowShape(startX, startY);\n        if (!this.disabled && this.isImageLoaded && (isPointsInRange || (isNullOrUndefined(startX) && isNullOrUndefined(startY)))) {\n            isArrow = true;\n            this.notify('shape', { prop: 'drawArrow', onPropertyChange: false, value: { startX: startX, startY: startY, endX: endX,\n                    endY: endY, strokeWidth: strokeWidth, strokeColor: strokeColor, arrowStart: arrowStart, arrowEnd: arrowEnd,\n                    isSelected: isSelected } });\n            this.editCompleted();\n        }\n        return isArrow;\n    };\n    /**\n     * Draw path on an image.\n     *\n     * @param {Point[]} pointColl  Specifies collection of start and end x, y-coordinates of path.\n     * @param {number} strokeWidth - Specifies the stroke width of path.\n     * @param {string} strokeColor - Specifies the stroke color of path.\n     * @param {boolean} isSelected - Specifies to show the path in the selected state.\n     * @returns {boolean}.\n     */\n    ImageEditor.prototype.drawPath = function (pointColl, strokeWidth, strokeColor, isSelected) {\n        this.isPublicMethod = true;\n        var obj = { inRange: false };\n        var isPath = false;\n        if (pointColl && pointColl.length > 0) {\n            for (var i = 0; i < pointColl.length; i++) {\n                if (obj['inRange']) {\n                    break;\n                }\n                this.notify('shape', { prop: 'isPointsInRange', onPropertyChange: false,\n                    value: { x: pointColl[i].x, y: pointColl[i].y, obj: obj } });\n            }\n        }\n        if (!this.disabled && this.isImageLoaded && (obj['inRange'] || isNullOrUndefined(pointColl))) {\n            isPath = true;\n            this.applyShapes();\n            this.notify('shape', { prop: 'drawPath', onPropertyChange: false, value: { pointColl: pointColl,\n                    strokeWidth: strokeWidth, strokeColor: strokeColor, isSelected: isSelected } });\n            this.editCompleted();\n        }\n        return isPath;\n    };\n    /**\n     * Draw a rectangle on an image.\n     *\n     * @param {number} x - Specifies x-coordinate of rectangle.\n     * @param {number} y - Specifies y-coordinate of rectangle.\n     * @param {number} width - Specifies the width of the rectangle.\n     * @param {number} height - Specifies the height of the rectangle.\n     * @param {number} strokeWidth - Specifies the stroke width of rectangle.\n     * @param {string} strokeColor - Specifies the stroke color of rectangle.\n     * @param {string} fillColor - Specifies the fill color of the rectangle.\n     * @param {number} degree - Specifies the degree to rotate the rectangle.\n     * @param {boolean} isSelected - Specifies to show the rectangle in the selected state.\n     * @param {number} borderRadius - Specifies the radius to apply border radius to rectangle.\n     * @returns {boolean}.\n     */\n    ImageEditor.prototype.drawRectangle = function (x, y, width, height, strokeWidth, strokeColor, fillColor, degree, isSelected, borderRadius) {\n        var isRectangle = false;\n        var isPointsInRange = this.allowShape(x, y);\n        if (!this.disabled && this.isImageLoaded && (isPointsInRange || (isNullOrUndefined(x) && isNullOrUndefined(y)))) {\n            isRectangle = true;\n            this.notify('shape', { prop: 'drawRectangle', onPropertyChange: false, value: { x: x, y: y, width: width, height: height,\n                    strokeWidth: strokeWidth, strokeColor: strokeColor, fillColor: fillColor, degree: degree, isSelected: isSelected,\n                    radius: borderRadius } });\n            this.editCompleted();\n        }\n        return isRectangle;\n    };\n    /**\n     * Draw a text on an image.\n     *\n     * {% codeBlock src='image-editor/text/index.md' %}{% endcodeBlock %}\n     *\n     * @param {number} x - Specifies x-coordinate of text.\n     * @param {number} y - Specifies y-coordinate of text.\n     * @param {string} text - Specifies the text to add on an image.\n     * @param {string} fontFamily - Specifies the font family of the text.\n     * @param {number} fontSize - Specifies the font size of the text.\n     * @param {boolean} bold - Specifies whether the text is bold or not.\n     * @param {boolean} italic - Specifies whether the text is italic or not.\n     * @param {string} color - Specifies font color of the text.\n     * @param {boolean} isSelected - Specifies to show the text in the selected state.\n     * @param {number} degree - Specifies the degree to rotate the text.\n     * @param {fillColor} fillColor - Specifies the background Color of the text.\n     * @param {string} strokeColor - Specifies the outline color of the text annotation.\n     * @param {number} strokeWidth - Specifies the outline stroke width of the text annotation.\n     * @returns {boolean}.\n     *\n     */\n    ImageEditor.prototype.drawText = function (x, y, text, fontFamily, fontSize, bold, italic, color, isSelected, degree, fillColor, strokeColor, strokeWidth) {\n        var isText = false;\n        var isPointsInRange = this.allowShape(x, y);\n        if (!this.disabled && this.isImageLoaded && (isPointsInRange || (isNullOrUndefined(x) && isNullOrUndefined(y)))) {\n            isText = true;\n            this.notify('shape', { prop: 'drawText', onPropertyChange: false, value: { x: x, y: y, text: text, fontFamily: fontFamily,\n                    fontSize: fontSize, bold: bold, italic: italic, color: color, isSelected: isSelected, degree: degree, fillColor: fillColor,\n                    outlineColor: strokeColor, outlineWidth: strokeWidth } });\n            this.editCompleted();\n        }\n        return isText;\n    };\n    /**\n     * Draw an image as annotation on an image.\n     *\n     *\n     * @param {string | ImageData} data - Specifies url of the image or image data.\n     * @param {number} x - Specifies x-coordinate of a starting point for an image.\n     * @param {number} y - Specifies y-coordinate of a starting point for an image.\n     * @param {number} width - Specifies the width of the image.\n     * @param {number} height - Specifies the height of the image.\n     * @param {boolean} isAspectRatio - Specifies whether to maintain aspect ratio or not.\n     * @param {number} degree - Specifies the degree to rotate the image.\n     * @param {number} opacity - Specifies the value for the image.\n     * @param {boolean} isSelected - Specifies to show the image in the selected state.\n     * @returns {boolean}.\n     *\n     */\n    ImageEditor.prototype.drawImage = function (data, x, y, width, height, isAspectRatio, degree, opacity, isSelected) {\n        var isImage = false;\n        var isPointsInRange = this.allowShape(x, y);\n        if (!this.disabled && this.isImageLoaded && (isPointsInRange || (isNullOrUndefined(x) && isNullOrUndefined(y)))) {\n            var length_1 = this.objColl.length;\n            this.notify('shape', { prop: 'drawImage', onPropertyChange: false, value: { x: x, y: y, width: width, height: height,\n                    src: data, degree: degree, isAspectRatio: isAspectRatio, opacity: opacity, isSelected: isSelected } });\n            this.editCompleted();\n            if (this.objColl.length > length_1) {\n                isImage = true;\n            }\n        }\n        return isImage;\n    };\n    /**\n     * This method is used to update the existing shapes by changing its height, width, color, and font styles in the component.\n     * Use 'getShapeSettings' method to get the shape which is then passed to change the options of a shape.\n     * {% codeBlock src='image-editor/updateShape/index.md' %}{% endcodeBlock %}\n     *\n     * @param {ShapeSettings} setting - Specifies the shape settings to be updated for the shape on an image.\n     * @param {boolean} isSelected - Specifies to show the shape in the selected state.\n     * @returns {boolean}.\n     *\n     */\n    ImageEditor.prototype.updateShape = function (setting, isSelected) {\n        var obj = { isSelected: false };\n        var isTextArea = false;\n        var freehandObj = { bool: false };\n        if (isNullOrUndefined(setting.id)) {\n            if (setting.strokeColor) {\n                this.activeObj.strokeSettings.strokeColor = setting.strokeColor;\n            }\n            if (setting.fillColor) {\n                this.activeObj.strokeSettings.fillColor = setting.fillColor;\n            }\n            if (setting.strokeWidth) {\n                this.activeObj.strokeSettings.strokeWidth = setting.strokeWidth;\n            }\n            if (setting.index) {\n                this.activeObj.order = setting.index;\n            }\n            if (setting.type === 'FreehandDraw' && setting.strokeWidth) {\n                this.notify('freehand-draw', { prop: 'setPenStrokeWidth', onPropertyChange: false, value: { value: setting.strokeWidth } });\n            }\n        }\n        else {\n            if (setting.type.toLowerCase() === 'text' && (this.textArea.style.display === 'block' ||\n                this.textArea.style.display === 'inline-block')) {\n                this.okBtn(null, true);\n                isTextArea = true;\n            }\n            this.notify('shape', { prop: 'selectShape', onPropertyChange: false, value: { id: setting.id, obj: obj } });\n            this.notify('selection', { prop: 'getFreehandDrawEditing', onPropertyChange: false, value: { obj: freehandObj } });\n            if (obj['isSelected']) {\n                var tempFontSize = this.activeObj.textSettings.fontSize;\n                this.notify('shape', { prop: 'updateShapeChangeEventArgs', onPropertyChange: false,\n                    value: { shapeSettings: setting } });\n                if (this.activeObj.shape === 'text' && tempFontSize) {\n                    var diff = this.activeObj.textSettings.fontSize - tempFontSize;\n                    if (diff !== 0) {\n                        this.activeObj.activePoint.height += diff;\n                        this.activeObj.activePoint.startY -= (diff / 2);\n                        this.activeObj.activePoint.endY += (diff / 2);\n                        this.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: this.activeObj.activePoint, obj: this.activeObj,\n                                isMouseMove: null, x: null, y: null } });\n                    }\n                }\n                var activeObj = extend({}, this.activeObj, {}, true);\n                this.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                this.notify('draw', { prop: 'render-image', value: { isMouseWheel: null, isPreventClearRect: null, isFrame: null } });\n                this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n                if (activeObj.shape) {\n                    this.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: activeObj } });\n                }\n                if (this.activeObj.shape === 'text') {\n                    this.notify('toolbar', { prop: 'editText', onPropertyChange: false });\n                }\n                if (freehandObj['bool']) {\n                    this.notify('undo-redo', { prop: 'setPreventUR', value: { bool: true } });\n                }\n                this.okBtn(isSelected, true);\n                if (freehandObj['bool']) {\n                    this.notify('undo-redo', { prop: 'setPreventUR', value: { bool: false } });\n                }\n                this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n                this.editCompleteArgs = { action: 'shape-update', currentShapeSettings: setting };\n                this.editCompleted('shape-customize');\n                if (isTextArea) {\n                    this.enableTextEditing();\n                }\n                if (isSelected) {\n                    this.noRedact = true;\n                    this.selectShape(setting.id);\n                }\n            }\n        }\n        return obj['isSelected'];\n    };\n    /**\n     * Select a shape based on the given shape id.\n     * Use 'getShapeSettings' method to get the shape id which is then passed to perform selection.\n     *\n     * {% codeBlock src='image-editor/selectShape/index.md' %}{% endcodeBlock %}\n     *\n     * @param {string} id - Specifies the shape id to select a shape on an image.\n     * @returns {boolean}.\n     *\n     */\n    ImageEditor.prototype.selectShape = function (id) {\n        this.applyShapes();\n        var obj = { isSelected: false };\n        this.notify('shape', { prop: 'selectShape', onPropertyChange: false, value: { id: id, obj: obj } });\n        this.editCompleted('shape-select');\n        this.noRedact = false;\n        return obj['isSelected'];\n    };\n    /**\n     * Deletes a shape based on the given shape id.\n     * Use 'getShapeSettings' method to get the shape id which is then passed to perform selection.\n     *\n     * {% codeBlock src='image-editor/deleteShape/index.md' %}{% endcodeBlock %}\n     *\n     * @param {string} id - Specifies the shape id to delete the shape on an image.\n     * @returns {void}.\n     *\n     */\n    ImageEditor.prototype.deleteShape = function (id) {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        var shape = this.getShapeSetting(id);\n        if (shape.type === 'Redact') {\n            return;\n        }\n        this.applyShapes();\n        this.notify('shape', { prop: 'deleteShape', onPropertyChange: false, value: { id: id } });\n        this.editCompleted('shape-delete');\n    };\n    /**\n     * Get particular shapes details based on id of the shape which is drawn on an image editor.\n     *\n     * {% codeBlock src='image-editor/getShapeSetting/index.md' %}{% endcodeBlock %}\n     *\n     * @param {string} id - Specifies the shape id on an image.\n     * @returns {ShapeSettings}.\n     *\n     */\n    ImageEditor.prototype.getShapeSetting = function (id) {\n        this.applyShapes();\n        var obj = { shapeDetails: null };\n        this.notify('shape', { prop: 'getShapeSetting', onPropertyChange: false,\n            value: { id: id, obj: obj } });\n        this.notify('draw', { prop: 'redrawDownScale' });\n        var shapeDetails = obj['shapeDetails'] ? obj['shapeDetails'] : {};\n        return shapeDetails;\n    };\n    /**\n     * Get all the shapes details which is drawn on an image editor.\n     *\n     * @returns {ShapeSettings[]}.\n     */\n    ImageEditor.prototype.getShapeSettings = function () {\n        this.applyShapes();\n        var obj = { shapeDetailsColl: [] };\n        this.notify('shape', { prop: 'getShapeSettings', onPropertyChange: false, value: { obj: obj } });\n        this.notify('draw', { prop: 'redrawDownScale' });\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        return obj.shapeDetailsColl.filter(function (item) { return item.type !== 'redact'; });\n    };\n    /**\n     * Get all the shapes details which is drawn on an image editor.\n     *\n     * @returns {RedactSettings[]}.\n     */\n    ImageEditor.prototype.getRedacts = function () {\n        this.applyShapes();\n        var obj = { shapeDetailsColl: [] };\n        this.notify('shape', { prop: 'getRedactSettings', onPropertyChange: false, value: { obj: obj } });\n        this.notify('draw', { prop: 'redrawDownScale' });\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        return obj.shapeDetailsColl.filter(function (item) { return item.type !== 'redact'; });\n    };\n    /**\n     * Select a redaction based on the given redaction id.\n     * Use 'getRedacts' method to get the shape id which is then passed to perform selection.\n     *\n     *\n     * @param {string} id - Specifies the shape id to select a redact on an image.\n     * @returns {boolean}.\n     *\n     */\n    ImageEditor.prototype.selectRedact = function (id) {\n        this.applyShapes();\n        var obj = { isSelected: false };\n        this.notify('shape', { prop: 'selectShape', onPropertyChange: false, value: { id: id, obj: obj } });\n        this.editCompleted('redact-select');\n        this.noRedact = false;\n        return obj['isSelected'];\n    };\n    /**\n     * Deletes a redaction based on the given shape id.\n     * Use 'getRedacts' method to get the redaaction id which is then passed to perform deletion.\n     *\n     *\n     * @param {string} id - Specifies the redaction id to delete the redaction on an image.\n     * @returns {void}.\n     *\n     */\n    ImageEditor.prototype.deleteRedact = function (id) {\n        this.applyShapes();\n        this.notify('shape', { prop: 'deleteShape', onPropertyChange: false, value: { id: id } });\n        this.editCompleted('redact-delete');\n    };\n    /**\n     * This method is used to update the existing redacts by changing its height, width, blur, and pixel size in the component.\n     * Use 'getRedacts' method to get the redacts which is then passed to change the options of a redacts.\n     *\n     * @param {RedactSettings} setting - Specifies the redact settings to be updated for the shape on an image.\n     * @param {boolean} isSelected - Specifies to show the redacts in the selected state.\n     * @returns {boolean}.\n     *\n     */\n    ImageEditor.prototype.updateRedact = function (setting, isSelected) {\n        this.applyShapes();\n        var obj = { isSelected: false };\n        this.notify('shape', { prop: 'selectShape', onPropertyChange: false, value: { id: setting.id, obj: obj } });\n        if (obj['isSelected']) {\n            this.notify('shape', { prop: 'updateShapeChangeEventArgs', onPropertyChange: false,\n                value: { shapeSettings: setting } });\n            if (setting.blurIntensity) {\n                this.activeObj.redactBlur = setting.blurIntensity;\n            }\n            if (setting.pixelSize) {\n                this.activeObj.redactPixelate = setting.pixelSize;\n            }\n            this.activeObj.redactType = setting.type.toLowerCase() === 'blur' ? 'blur' : 'pixelate';\n            var activeObj = extend({}, this.activeObj, {}, true);\n            this.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            this.notify('draw', { prop: 'render-image', value: { isMouseWheel: null, isPreventClearRect: null, isFrame: null } });\n            this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n            if (activeObj.shape) {\n                this.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: activeObj } });\n            }\n            this.okBtn(isSelected, true);\n            this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n            this.editCompleteArgs = { action: 'redact-update', currentShapeSettings: setting };\n            this.editCompleted('redact-customize');\n            if (isSelected) {\n                this.selectRedact(setting.id);\n            }\n        }\n        return obj['isSelected'];\n    };\n    /**\n     * To refresh the Canvas Wrapper.\n     *\n     * @returns {void}.\n     */\n    ImageEditor.prototype.update = function () {\n        this.notify('transform', { prop: 'update' });\n    };\n    /**\n     * Finetuning an image with the given type of finetune and its value in the image editor.\n     *\n     * @param {ImageFinetuneOption } finetuneOption - Specifies the finetune options to be performed in the image.\n     * @param {number } value - Specifies the value for finetuning the image.\n     *\n     * @remarks\n     * The finetuning will not affect the shapes background and border color.\n     *\n     * @returns {void}.\n     *\n     */\n    ImageEditor.prototype.finetuneImage = function (finetuneOption, value) {\n        if (!this.disabled && this.isImageLoaded) {\n            this.applyShapes();\n            this.notify('filter', { prop: 'finetuneImage', value: { value: value, option: finetuneOption } });\n            this.editCompleteArgs = { finetune: finetuneOption, value: value };\n            this.editCompleted('fine-tune');\n        }\n    };\n    /**\n     * Filtering an image with the given type of filters.\n     *\n     * @param {ImageFilterOption } filterOption - Specifies the filter options to the image.\n     *\n     * @remarks\n     * The filtering will not affect the shape's background and border color.\n     * @returns {void}.\n     */\n    ImageEditor.prototype.applyImageFilter = function (filterOption) {\n        if (!this.disabled && this.isImageLoaded) {\n            this.applyShapes();\n            this.notify('filter', { prop: 'applyImageFilter', value: { option: filterOption.toString() } });\n            this.editCompleteArgs = { filter: filterOption };\n            this.editCompleted('filter');\n            this.canvasFilter = this.lowerContext.filter;\n            this.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n        }\n    };\n    /**\n     * Reverse the last action which performed by the user in the Image Editor.\n     *\n     * @remarks\n     * This method will take into effect once the 'allowUndoRedo' property is enabled.\n     *\n     * @returns {void}.\n     */\n    ImageEditor.prototype.undo = function () {\n        this.applyShapes();\n        this.notify('undo-redo', { prop: 'undo', onPropertyChange: false });\n        this.notify('draw', { prop: 'redrawDownScale' });\n    };\n    /**\n     * Redo the last user action that was undone by the user or `undo` method.\n     *\n     * @remarks\n     * This method will take into effect once the 'allowUndoRedo' property is enabled.\n     * @returns {void}.\n     */\n    ImageEditor.prototype.redo = function () {\n        this.applyShapes();\n        this.notify('undo-redo', { prop: 'redo', onPropertyChange: false });\n        this.notify('draw', { prop: 'redrawDownScale' });\n    };\n    /**\n     * Get the dimension of an image in the image editor such as x, y, width, and height.\n     * The method helps to get dimension after cropped an image.\n     *\n     * @returns {Dimension}.\n     * A Dimension object containing the x, y, width, and height of an image.\n     */\n    ImageEditor.prototype.getImageDimension = function () {\n        return { x: this.img.destLeft, y: this.img.destTop, width: this.img.destWidth, height: this.img.destHeight };\n    };\n    /**\n     * Resize an image by changing its width and height.\n     *\n     * @param {number} width - Specifies the width of an image.\n     * @param {number} height - Specifies the height of an image.\n     * @param {boolean} isAspectRatio - Specifies whether the scaling option is enabled or not.\n     *\n     * @returns {boolean} - A boolean value indicating the success of the resizing operation.\n     */\n    ImageEditor.prototype.resize = function (width, height, isAspectRatio) {\n        var isResized = false;\n        if ((width.toString()).length <= 4 && (height.toString()).length <= 4) {\n            this.applyShapes();\n            var destPoints = { startX: this.img.destLeft, startY: this.img.destTop, width: this.img.destWidth,\n                height: this.img.destHeight };\n            if (isAspectRatio) {\n                this.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'resize',\n                        isApplyBtn: false, isCropping: false } });\n                this.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'resize',\n                        isApplyBtn: false, isCropping: false } });\n            }\n            else {\n                this.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'resize',\n                        isApplyBtn: false, isCropping: false } });\n            }\n            var aspectRatioWidth = this.element.querySelector('#' + this.element.id + '_resizeWidth');\n            var aspectRatioHeight = this.element.querySelector('#' + this.element.id + '_resizeHeight');\n            if (aspectRatioWidth && aspectRatioHeight) {\n                getComponent(aspectRatioWidth, 'numerictextbox').value = Math.floor(width);\n                aspectRatioWidth.value = Math.floor(width).toString() + ' px';\n                getComponent(aspectRatioHeight, 'numerictextbox').value = Math.floor(height);\n                aspectRatioHeight.value = Math.floor(height).toString() + ' px';\n            }\n            this.notify('transform', { prop: 'resize', value: { width: width, height: height, isAspectRatio: isAspectRatio } });\n            if (destPoints.startX !== this.img.destLeft || destPoints.startY !== this.img.destTop ||\n                destPoints.width !== this.img.destWidth || destPoints.height !== this.img.destHeight) {\n                isResized = true;\n                this.okBtn();\n            }\n            else {\n                this.notify('draw', { prop: 'performCancel', value: { isContextualToolbar: null } });\n            }\n            this.notify('draw', { prop: 'redrawDownScale' });\n        }\n        return isResized;\n    };\n    /**\n     * Draw a frame on an image.\n     *\n     * @param { FrameType} frameType - Specifies the frame option to be drawn on an image.\n     * @param {string} color - Specifies the color of a frame on an image. The default value is #fff.\n     * @param {string} gradientColor - Specifies the gradient color of a frame on an image. The default value is .\n     * @param {number} size - Specifies the size of the frame as a percentage. It can be provided as an integer percentage (e.g., 10). Defaults to 20 if not specified.\n     * @param {number} inset - Specifies the inset value for line, hook, and inset type frames, as a percentage. It can be provided as an integer percentage (e.g., 10). Defaults to 0 if not specified.\n     * @param {number} offset - Specifies the offset value for line and inset type frames, as a percentage. It can be provided as an integer percentage (e.g., 10). Defaults to 0 if not specified.\n     * @param {number} borderRadius - Specifies the border radius for line-type frames, as a percentage. It can be provided as an integer percentage (e.g., 10). Defaults to 0 if not specified.\n     * @param {FrameLineStyle} frameLineStyle - Specifies the type of line to be drawn for line-type frames. Default to Solid if not specified.\n     * @param {number} lineCount - Specifies the number of lines for line-type frames. Defaults to 0 if not specified.\n     *\n     * @returns {boolean}.\n     */\n    ImageEditor.prototype.drawFrame = function (frameType, color, gradientColor, size, inset, offset, borderRadius, frameLineStyle, lineCount) {\n        this.applyShapes();\n        var isFrame = false;\n        var obj = { frameChangeEventArgs: null };\n        color = color ? color : '#fff';\n        gradientColor = gradientColor ? gradientColor : '';\n        size = size ? size : 20;\n        inset = inset ? inset : 0;\n        offset = offset ? offset : 0;\n        borderRadius = borderRadius ? borderRadius : 0;\n        frameLineStyle = frameLineStyle ? frameLineStyle : FrameLineStyle.Solid;\n        lineCount = lineCount ? lineCount : 0;\n        var prevFrameSettings = { type: this.toPascalCase(this.frameObj.type), color: this.frameObj.color,\n            gradientColor: this.frameObj.gradientColor, size: this.frameObj.size, inset: this.frameObj.inset,\n            offset: this.frameObj.offset, borderRadius: this.frameObj.radius,\n            frameLineStyle: this.toPascalCase(this.frameObj.border), lineCount: this.frameObj.amount };\n        extend(this.tempFrameObj, this.frameObj);\n        this.tempFrameZoomLevel = this.transform.zoomFactor;\n        this.frameDestPoints = extend({}, this.img, {}, true);\n        this.notify('toolbar', { prop: 'frameToolbarClick' });\n        this.frameObj.type = frameType.toLowerCase();\n        this.frameObj.color = color;\n        this.frameObj.gradientColor = gradientColor;\n        this.frameObj.size = size;\n        this.frameObj.inset = inset;\n        this.frameObj.offset = offset;\n        this.frameObj.radius = borderRadius;\n        this.frameObj.border = frameLineStyle.toLowerCase();\n        this.frameObj.amount = lineCount;\n        this.notify('draw', { prop: 'triggerFrameChange', value: { prevFrameSettings: prevFrameSettings, obj: obj } });\n        if (obj['frameChangeEventArgs'] && !obj['frameChangeEventArgs'].cancel) {\n            this.notify('draw', { prop: 'render-image', value: { isMouseWheel: null } });\n            if (JSON.stringify(this.frameObj) !== JSON.stringify(this.tempFrameObj)) {\n                isFrame = true;\n                this.okBtn();\n            }\n            else {\n                this.tempFrameZoomLevel = null;\n            }\n        }\n        else {\n            this.notify('draw', { prop: 'performCancel', value: { isContextualToolbar: null } });\n            extend(this.frameObj, this.tempFrameObj);\n            this.tempFrameZoomLevel = null;\n        }\n        this.notify('draw', { prop: 'redrawDownScale' });\n        return isFrame;\n    };\n    /**\n     * Straightens an image by rotating it clockwise or counterclockwise.\n     *\n     * @param {number} degree - The degree value specifying the amount of rotation for straightening the image.\n     * Positive values indicate clockwise rotation, while negative values indicate counterclockwise rotation.\n     *\n     * @remarks\n     * The degree value should be within the range of -45 to +45 degrees for accurate straightening.\n     *\n     * @returns {boolean} - A boolean value indicating the success of the straightening operation.\n     */\n    ImageEditor.prototype.straightenImage = function (degree) {\n        var isStraightened = false;\n        if (degree >= -45 && degree <= 45) {\n            this.applyShapes();\n            isStraightened = true;\n            this.notify('transform', { prop: 'straightenImage', value: { degree: degree } });\n            this.notify('draw', { prop: 'redrawDownScale' });\n        }\n        return isStraightened;\n    };\n    /**\n     * Duplicates a shape based on the given shape ID in the ImageEditor.\n     * Use 'getShapeSettings' method to get the shape and then pass a shapeId from the returned shape to clone a shape.\n     *\n     * @param {string} shapeId - Specifies the shape id to clone a shape on an image.\n     * @returns {boolean}.\n     *\n     */\n    ImageEditor.prototype.cloneShape = function (shapeId) {\n        var obj = { isSelected: false };\n        if (shapeId.split('_')[0] === 'shape') {\n            this.notify('shape', { prop: 'selectShape', onPropertyChange: false, value: { id: shapeId, obj: obj } });\n            if (obj['isSelected']) {\n                this.notify('toolbar', { prop: 'duplicateShape', onPropertyChange: false, value: { isPreventUndoRedo: false } });\n                this.okBtn(null, true);\n                this.notify('draw', { prop: 'redrawDownScale' });\n            }\n        }\n        return obj['isSelected'];\n    };\n    /**\n     * Update filter to the canvas in the ImageEditor.\n     *\n     * @param {ImageFilterOption } filterOption - Specifies the filter options to the image.\n     *\n     * @returns {string}.\n     *\n     */\n    ImageEditor.prototype.getImageFilter = function (filterOption) {\n        var canvas = this.createElement('canvas');\n        var ctx = canvas.getContext('2d');\n        this.notify('filter', { prop: 'updateAdj', value: { type: filterOption.toLowerCase(), value: null, isPreview: true, ctx: ctx } });\n        return ctx.filter;\n    };\n    /**\n     * Enable text area editing in the ImageEditor.\n     *\n     * @returns {void}.\n     *\n     */\n    ImageEditor.prototype.enableTextEditing = function () {\n        var activeObj = extend({}, this.activeObj, {}, true);\n        if (!activeObj.order) {\n            this.noPushUndo = true;\n            this.okBtn();\n            this.noPushUndo = false;\n            this.noRedact = true;\n            this.selectShape(activeObj.currIndex);\n            activeObj.order = this.activeObj.order;\n        }\n        this.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        this.notify('draw', { prop: 'render-image', value: { isMouseWheel: null, isPreventClearRect: null, isFrame: false } });\n        this.activeObj = activeObj;\n        this.notify('toolbar', { prop: 'editText', onPropertyChange: false });\n    };\n    /**\n     * Specifies if it's possible to undo the last recent action made in an Image Editor.\n     *\n     * @returns {boolean}.\n     *\n     */\n    ImageEditor.prototype.canUndo = function () {\n        var canUndo = false;\n        var object = this.getUndoRedoColl();\n        var undoRedoIndex = object['index'];\n        if (undoRedoIndex > 0) {\n            canUndo = true;\n        }\n        return canUndo;\n    };\n    /**\n     * Specifies if it's possible to redo the last recent action made in an Image Editor.\n     *\n     * @returns {boolean}.\n     *\n     */\n    ImageEditor.prototype.canRedo = function () {\n        var canRedo = false;\n        var object = this.getUndoRedoColl();\n        var undoRedoColl = object['undoRedoColl'];\n        var undoRedoIndex = object['index'];\n        if (undoRedoColl && undoRedoColl.length > 0 && undoRedoIndex < undoRedoColl.length - 1) {\n            canRedo = true;\n        }\n        if (undoRedoIndex === undoRedoColl.length) {\n            canRedo = false;\n        }\n        else if (undoRedoIndex === 0 && undoRedoColl.length > 0) {\n            canRedo = true;\n        }\n        else if (undoRedoIndex > 0) {\n            canRedo = true;\n        }\n        return canRedo;\n    };\n    /**\n     * Applies the operations performed in the Image Editor, such as annotation drawings.\n     *\n     * @returns{void}\n     * @remarks\n     * This method applies the actions performed after enabling annotation drawings, ensuring that the drawn annotations are applied to the image.\n     */\n    ImageEditor.prototype.apply = function () {\n        if (this.isMaskImage) {\n            this.discard();\n        }\n        else {\n            this.updateColl('reset');\n            this.closeOverlayTbar();\n            this.okBtn(null, true);\n        }\n    };\n    /**\n     * Discards the operations performed in the Image Editor, such as annotation drawings.\n     *\n     * @returns{void}\n     * @remarks\n     * This method discards the actions performed after enabling annotation drawings, ensuring that the drawn annotations are not applied to the image.\n     */\n    ImageEditor.prototype.discard = function () {\n        this.updateColl('reset');\n        this.notify('draw', { prop: 'performCancel', value: { isContextualToolbar: this.closeOverlayTbar(), isFinalCancel: true } });\n    };\n    /**\n     * Enable or disable a shape drawing option in an Image Editor.\n     *\n     * @param {ShapeType} shapeType - Specifies the type of shape to be enabled or disabled for drawing.\n     * @param {boolean} isEnabled - Optional. Specifies a value to indicate whether to enable or disable shape drawing. The default value is true.\n     *\n     * @remarks This function allows the user to toggle the shape drawing feature in the Image Editor. When enabled, users can draw shapes on the image. When disabled, the shape drawing functionality is not available.\n     *\n     * @returns {void}.\n     */\n    ImageEditor.prototype.enableShapeDrawing = function (shapeType, isEnabled) {\n        if (isEnabled) {\n            this.drawingShape = shapeType.toLowerCase();\n            this.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        }\n        if (shapeType && isEnabled) {\n            this.currObjType.shape = shapeType.toLowerCase();\n            this.activeObj.shape = this.currObjType.shape;\n            this.currObjType.isDragging = this.currObjType.isCustomCrop = false;\n            this.activeObj.shapeDegree = this.transform.degree;\n            this.activeObj.shapeFlip = this.transform.currFlipState;\n            this.activeObj.textFlip = this.transform.currFlipState;\n            this.activeObj.flipObjColl = [];\n            var orderObj = { order: null };\n            this.notify('shape', { prop: 'getNewOrder', onPropertyChange: false, value: { obj: orderObj } });\n            this.activeObj.order = orderObj['order'];\n            this.notify('selection', { prop: 'annotate', value: { shape: this.currObjType.shape } });\n            if (this.currObjType.shape === 'text') {\n                this.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'text',\n                        isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n            }\n            else if (this.currObjType.shape === 'redact') {\n                this.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'redact',\n                        isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n            }\n            else {\n                this.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'shapes',\n                        isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n            }\n            this.notify('toolbar', { prop: 'update-toolbar-items', onPropertyChange: false });\n        }\n        else if (!isEnabled) {\n            this.okBtn(null, true);\n        }\n    };\n    /**\n     * Moves a shape to the front of all other shapes based on the given shape id.\n     * Use 'getShapeSettings' method to get the shape id which is then passed to perform moving.\n     *\n     * @param {string} shapeId - Specifies the shape id to move the shape on an image.\n     * @returns {void}.\n     *\n     */\n    ImageEditor.prototype.bringToFront = function (shapeId) {\n        this.noRedact = true;\n        if (this.selectShape(shapeId)) {\n            this.updateShapeOrder(shapeId, 'bringToFront');\n            this.apply();\n        }\n    };\n    /**\n     * Moves a shape to ahead of one shape based on the given shape id.\n     * Use 'getShapeSettings' method to get the shape id which is then passed to perform moving.\n     *\n     * @param {string} shapeId - Specifies the shape id to move the shape on an image.\n     * @returns {void}.\n     *\n     */\n    ImageEditor.prototype.bringForward = function (shapeId) {\n        this.noRedact = true;\n        if (this.selectShape(shapeId)) {\n            this.updateShapeOrder(shapeId, 'bringForward');\n            this.apply();\n        }\n    };\n    /**\n     * Moves a shape to behind all other shapes based on the given shape id.\n     * Use 'getShapeSettings' method to get the shape id which is then passed to perform moving.\n     *\n     * @param {string} shapeId - Specifies the shape id to move the shape on an image.\n     * @returns {void}.\n     *\n     */\n    ImageEditor.prototype.sendToBack = function (shapeId) {\n        this.noRedact = true;\n        if (this.selectShape(shapeId)) {\n            this.updateShapeOrder(shapeId, 'sendToBack');\n            this.apply();\n        }\n    };\n    /**\n     * Moves a shape to behind one shape based on the given shape id.\n     * Use 'getShapeSettings' method to get the shape id which is then passed to perform moving.\n     *\n     * @param {string} shapeId - Specifies the shape id to move the shape on an image.\n     * @returns {void}.\n     *\n     */\n    ImageEditor.prototype.sendBackward = function (shapeId) {\n        this.noRedact = true;\n        if (this.selectShape(shapeId)) {\n            this.updateShapeOrder(shapeId, 'sendBackward');\n            this.apply();\n        }\n    };\n    /**\n     * Clears the loaded image in the Image Editor.\n     *\n     * @returns{void}\n     * @remarks\n     * This method clears the loaded image and updates the component's user interface to its initial state (the initial user interface without a loaded image).\n     */\n    ImageEditor.prototype.clearImage = function () {\n        this.reset();\n        this.isImageLoaded = false;\n        this.lowerContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n        this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n        var btoolbar = document.getElementById(this.element.id + '_bottomToolbar');\n        if (Browser.isDevice && btoolbar) {\n            document.getElementById(this.element.id + '_bottomToolbar').style.display = 'none';\n        }\n        this.notify('toolbar', { prop: 'destroy-top-toolbar', onPropertyChange: false });\n        this.notify('toolbar', { prop: 'create-toolbar', onPropertyChange: false });\n        this.notify('toolbar', { prop: 'create-contextual-toolbar', onPropertyChange: false });\n        var dropArea = document.getElementById(this.element.id + '_dropArea');\n        if (dropArea) {\n            dropArea.style.display = 'block';\n        }\n    };\n    // AI related codes\n    /**\n     * Enables overlay drawing to erase objects in an image editor. The eraser tool assists in selecting the mask image.\n     *\n     * @remarks\n     * The selection UI is based on the 'theme' property.\n     *\n     * @param {number} strokeWidth - Specifies the stroke width of the drawing.\n     * @param {string} color - Specifies the color of the drawing.\n     * @hidden\n     * @returns {void}.\n     *\n     */\n    ImageEditor.prototype.selectMaskImage = function (strokeWidth, color) {\n        strokeWidth = strokeWidth ? strokeWidth : 10;\n        color = color ? color : '#512da880';\n        this.applyShapes();\n        this.isMaskImage = true;\n        this.updateColl('empty');\n        this.enableDisableToolbar(true);\n        this.update();\n        this.activeObj.strokeSettings.strokeWidth = strokeWidth;\n        this.notify('freehand-draw', { prop: 'setPenStrokeWidth', onPropertyChange: false, value: { value: strokeWidth } });\n        this.activeObj.strokeSettings.strokeColor = color;\n        this.notify('freehand-draw', { prop: 'freeHandDraw', onPropertyChange: false, value: { value: true } });\n        this.maskCanvas.style.display = 'block';\n    };\n    ImageEditor.prototype.enableDisableToolbar = function (value) {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        var toolbar;\n        var elem = document.getElementById(this.element.id + '_toolbar');\n        if (elem) {\n            toolbar = getComponent(elem, 'toolbar');\n            if (toolbar) {\n                toolbar.disable(value);\n            }\n        }\n        elem = document.getElementById(this.element.id + '_bottomToolbar');\n        if (elem) {\n            toolbar = getComponent(elem, 'toolbar');\n            if (toolbar) {\n                toolbar.disable(value);\n            }\n        }\n    };\n    ImageEditor.prototype.updateImage = function (data, imageBackgroundColor) {\n        var _this = this;\n        if (data || imageBackgroundColor || imageBackgroundColor === '') {\n            var prevCropObj_1 = extend({}, this.cropObj, {}, true);\n            var object = { currObj: {} };\n            this.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n            var prevObj_1 = object['currObj'];\n            prevObj_1.objColl = extend([], this.objColl, [], true);\n            prevObj_1.pointColl = extend([], this.pointColl, [], true);\n            prevObj_1.afterCropActions = extend([], this.afterCropActions, [], true);\n            var selPointCollObj = { selPointColl: null };\n            this.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false, value: { obj: selPointCollObj } });\n            prevObj_1.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n            if (data) {\n                this.isImageUpdated = true;\n                if (typeof (data) !== 'string') {\n                    var canvas = this.createElement('canvas');\n                    canvas.width = data.width;\n                    canvas.height = data.height;\n                    canvas.getContext('2d').putImageData(data, 0, 0);\n                    data = canvas.toDataURL();\n                }\n                this.baseImg.src = data;\n                setTimeout(function () {\n                    if (_this.cropObj.straighten !== 0) {\n                        _this.notify('toolbar', { prop: 'performCropTransformClick', value: { shape: 'crop-' + 'custom' } });\n                        _this.noPushUndo = true;\n                        _this.crop();\n                        _this.noPushUndo = false;\n                    }\n                    else {\n                        _this.notify('draw', { prop: 'render-image', value: { isMouseWheel: false } });\n                    }\n                    _this.isImageUpdated = false;\n                    if (!imageBackgroundColor) {\n                        _this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false, value: { operation: 'updateImage', previousObj: prevObj_1,\n                                previousObjColl: prevObj_1.objColl, previousPointColl: prevObj_1.pointColl,\n                                previousSelPointColl: prevObj_1.selPointColl, previousCropObj: prevCropObj_1,\n                                previousText: null, currentText: null, previousFilter: null, isCircleCrop: null\n                            } });\n                        _this.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n                    }\n                }, 100);\n            }\n            if (imageBackgroundColor || imageBackgroundColor === '') {\n                this.notify('draw', { prop: 'imageBackgroundColor', onPropertyChange: false, value: { color: imageBackgroundColor } });\n                this.notify('draw', { prop: 'render-image', value: { isMouseWheel: false } });\n                if (!data) {\n                    this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false, value: { operation: 'bgColor', previousObj: prevObj_1,\n                            previousObjColl: prevObj_1.objColl, previousPointColl: prevObj_1.pointColl, previousSelPointColl: prevObj_1.selPointColl,\n                            previousCropObj: prevCropObj_1, previousText: null, currentText: null, previousFilter: null, isCircleCrop: null\n                        } });\n                    this.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n                }\n            }\n            if (data && imageBackgroundColor) {\n                this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false, value: { operation: 'updateImage', previousObj: prevObj_1,\n                        previousObjColl: prevObj_1.objColl, previousPointColl: prevObj_1.pointColl, previousSelPointColl: prevObj_1.selPointColl,\n                        previousCropObj: prevCropObj_1, previousText: null, currentText: null, previousFilter: null, isCircleCrop: null\n                    } });\n                this.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n            }\n        }\n    };\n    ImageEditor.prototype.editCompleted = function (type) {\n        this.notify('draw', { prop: 'redrawDownScale' });\n        var actionArgs = { action: type ? type : 'shape-insert',\n            actionEventArgs: this.editCompleteArgs };\n        this.triggerEditCompleteEvent(actionArgs);\n    };\n    ImageEditor.prototype.updateColl = function (type) {\n        if (!this.isMaskImage) {\n            return;\n        }\n        if (type === 'empty') {\n            this.tempToolbarHeight = this.toolbarHeight;\n            this.tempToolbar = this.toolbar ? extend([], this.toolbar, [], true) : null;\n            this.tempObjColl = extend([], this.objColl, [], true);\n            this.tempPointColl = extend([], this.pointColl, [], true);\n            this.tempShapeColl = extend([], this.shapeColl, [], true);\n            this.objColl = [];\n            this.pointColl = [];\n            this.shapeColl = [];\n            this.freehandCounter = 0;\n            this.notify('freehand-draw', { prop: 'setCurrentFreehandDrawIndex',\n                value: { value: 0 } });\n            this.notify('draw', { prop: 'render-image', value: { isMouseWheel: false } });\n        }\n        else if (type === 'reset') {\n            this.objColl = this.tempObjColl;\n            this.pointColl = this.tempPointColl;\n            this.shapeColl = this.tempShapeColl;\n            this.freehandCounter = this.pointColl.length;\n            this.notify('freehand-draw', { prop: 'setCurrentFreehandDrawIndex',\n                value: { value: this.freehandCounter } });\n            this.enableDisableToolbar(false);\n            if (this.cropObj.straighten !== 0) {\n                this.notify('toolbar', { prop: 'performCropTransformClick', value: { shape: 'crop-' + 'custom' } });\n                this.noPushUndo = true;\n                this.crop();\n                this.noPushUndo = false;\n            }\n            this.notify('draw', { prop: 'render-image', value: { isMouseWheel: false } });\n            this.isMaskImage = false;\n            this.upperContext.globalCompositeOperation = 'source-over';\n            this.maskCanvas.style.display = 'none';\n            this.activeObj.strokeSettings = { strokeColor: '#fff', fillColor: '', strokeWidth: null,\n                radius: null, outlineColor: '', outlineWidth: null };\n            this.notify('shape', { prop: 'setStrokeSettings', value: { strokeSettings: this.activeObj.strokeSettings,\n                    strokeColor: '#fff', fillColor: '', strokeWidth: null, outlineWidth: null } });\n            this.notify('freehand-draw', { prop: 'setPenStrokeWidth', onPropertyChange: false, value: { value: 2 } });\n            this.notify('freehand-draw', { prop: 'setMasking', onPropertyChange: false, value: { value: false } });\n        }\n    };\n    // Toolbar related codes\n    ImageEditor.prototype.resetToolbar = function () {\n        if (this.toolbarHeight !== this.tempToolbarHeight && !((isNullOrUndefined(this.toolbar) ||\n            (this.toolbar && this.toolbar.length > 0)\n            || !isNullOrUndefined(this.toolbarTemplate)))) {\n            this.toolbarHeight = this.tempToolbarHeight;\n            this.notify('toolbar', { prop: 'setToolbarHeight', value: { height: this.toolbarHeight } });\n            this.toolbar = this.tempToolbar;\n            if (!this.toolbarTemplate) {\n                this.notify('toolbar', { prop: 'create-toolbar', onPropertyChange: false });\n                this.notify('toolbar', { prop: 'create-contextual-toolbar', onPropertyChange: false });\n            }\n            this.update();\n        }\n    };\n    ImageEditor.prototype.getData = function (isMaskImage) {\n        if (isMaskImage) {\n            this.resetToolbar();\n        }\n        var objColl = extend([], this.objColl, null, true);\n        var pointColl = extend([], this.pointColl, null, true);\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var shapeColl = extend([], this.shapeColl, null, true);\n        if (isMaskImage) {\n            this.notify('shape', { prop: 'updateShapeColl', onPropertyChange: false });\n            for (var i = 0; i < this.freehandCounter; i++) {\n                this.pointColl[i].strokeColor = '#fff';\n            }\n        }\n        else {\n            this.objColl = [];\n            this.pointColl = [];\n            this.shapeColl = [];\n            this.freehandCounter = 0;\n        }\n        var frameType = this.frameObj.type;\n        this.frameObj.type = 'none';\n        var aspectWidth = this.aspectWidth;\n        var aspectHeight = this.aspectHeight;\n        this.aspectWidth = this.aspectHeight = null;\n        var straighten = this.cropObj.straighten;\n        this.togglePen = false;\n        this.notify('toolbar', { prop: 'performCropTransformClick', value: { shape: 'crop-' + 'custom' } });\n        var tempDestPoints = extend({}, this.img, {}, true);\n        var tempCropObj = extend({}, this.cropObj, {}, true);\n        var tempSel = extend({}, this.activeObj, {}, true);\n        var tempTransform = extend({}, this.transform, {}, true);\n        var panPoint = extend({}, this.panPoint, {}, true);\n        if (straighten !== 0) {\n            this.setStraighten(0);\n        }\n        var point = this.activeObj.activePoint;\n        point.startX = this.img.destLeft;\n        point.startY = this.img.destTop;\n        point.width = this.img.destWidth;\n        point.height = this.img.destHeight;\n        point.endX = point.startX + point.width;\n        point.endY = point.startY + point.height;\n        this.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: point, obj: this.activeObj,\n                isMouseMove: null, x: null, y: null } });\n        this.noPushUndo = true;\n        this.crop();\n        this.noPushUndo = false;\n        this.isCropTab = false;\n        this.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        this.notify('crop', { prop: 'resetZoom', onPropertyChange: false });\n        this.isCropTab = true;\n        var afterCropActions = extend([], this.afterCropActions, [], true);\n        var coll = extend([], this.rotateFlipColl, [], true);\n        this.notify('crop', { prop: 'revertTransform', value: { type: 'initial', coll: coll } });\n        var imageData = this.getImageData();\n        if (isMaskImage) {\n            var canvas = this.createElement('canvas');\n            var ctx = canvas.getContext('2d');\n            canvas.width = imageData.width;\n            canvas.height = imageData.height;\n            ctx.fillRect(0, 0, canvas.width, canvas.height);\n            if (this.pointColl.length > 0) {\n                var obj = { width: 0, height: 0 };\n                this.notify('crop', { prop: 'calcRatio', onPropertyChange: false,\n                    value: { obj: obj, dimension: { width: canvas.width, height: canvas.height } } });\n                var ratio = obj;\n                this.notify('export', { prop: 'drawAnnotation', value: { context: ctx, ratio: ratio } });\n            }\n            this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n            imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);\n        }\n        this.notify('crop', { prop: 'revertTransform', value: { type: 'reverse', coll: coll } });\n        this.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        this.afterCropActions = afterCropActions;\n        if (!isMaskImage) {\n            this.objColl = objColl;\n            this.pointColl = pointColl;\n            this.shapeColl = shapeColl;\n            this.freehandCounter = this.pointColl.length;\n        }\n        this.frameObj.type = frameType;\n        this.aspectWidth = aspectWidth;\n        this.aspectHeight = aspectHeight;\n        this.notify('toolbar', { prop: 'performCropTransformClick', value: { shape: 'crop-' + 'custom' } });\n        if (straighten !== 0) {\n            this.setStraighten(straighten);\n        }\n        this.img = tempDestPoints;\n        this.cropObj = tempCropObj;\n        this.activeObj = tempSel;\n        this.transform = tempTransform;\n        this.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n            value: { zoomFactor: 0.1, zoomPoint: null, isResize: null } });\n        this.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n            value: { zoomFactor: -0.1, zoomPoint: null, isResize: null } });\n        if (this.transform.degree !== 0) {\n            this.panPoint.currentPannedPoint = { x: panPoint.totalPannedClientPoint.x,\n                y: panPoint.totalPannedClientPoint.y };\n            this.notify('transform', { prop: 'drawPannedImage', value: { xDiff: panPoint.totalPannedClientPoint.x,\n                    yDiff: panPoint.totalPannedClientPoint.y } });\n            this.panPoint.currentPannedPoint = { x: 0, y: 0 };\n            this.notify('transform', { prop: 'setTempPanMove', value: { point: null } });\n        }\n        this.noPushUndo = true;\n        this.crop();\n        this.noPushUndo = false;\n        this.transform.straighten = 0;\n        this.notify('draw', { prop: 'render-image', value: { isMouseWheel: false } });\n        return imageData;\n    };\n    ImageEditor.prototype.applyShapes = function () {\n        if (this.isUndoRedoStack) {\n            return;\n        }\n        var shapes = ['rectangle', 'ellipse', 'line', 'arrow', 'path', 'text', 'image'];\n        var dummyObj = { bool: false };\n        this.notify('selection', { prop: 'getFreehandDrawEditing', onPropertyChange: false, value: { obj: dummyObj } });\n        if (dummyObj['bool'] || this.togglePen || (this.activeObj.shape && shapes.indexOf(this.activeObj.shape) !== -1) ||\n            this.drawingShape) {\n            this.okBtn(null, true);\n        }\n    };\n    ImageEditor.prototype.closeOverlayTbar = function () {\n        var isContextualToolbar = false;\n        var frameObject = { bool: null };\n        this.notify('toolbar', { prop: 'getFrameToolbar', onPropertyChange: false, value: { obj: frameObject } });\n        if (!frameObject['bool'] && this.element.querySelector('.e-contextual-toolbar-wrapper')) {\n            if (!this.element.querySelector('.e-contextual-toolbar-wrapper').classList.contains('e-hide')) {\n                isContextualToolbar = true;\n            }\n            var straightenObj = { bool: this.isStraightening };\n            if (!Browser.isDevice || (Browser.isDevice && !straightenObj['bool'])) {\n                this.element.querySelector('.e-contextual-toolbar-wrapper').classList.add('e-hide');\n            }\n        }\n        return isContextualToolbar;\n    };\n    ImageEditor.prototype.toolbarTemplateFn = function () {\n        var template;\n        var templateID = this.element.id + '_toolbar';\n        var toolbarArea = this.element.querySelector('#' + this.element.id + '_toolbarArea');\n        if (this.toolbarTemplate) {\n            this.toolbarFn = this.templateParser(this.toolbarTemplate);\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            if (this.isReact) {\n                template = this.toolbarFn({ type: 'toolbar' }, this, 'Template', templateID)[0];\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            }\n            else if (this.isAngular) {\n                var templateColl = this.toolbarFn({ type: 'toolbar' }, this, 'Template', templateID);\n                template = (templateColl[0].nodeType === 3) ? templateColl[1] : templateColl[0];\n            }\n            else {\n                template = this.toolbarFn({ type: 'toolbar' }, this, 'Template', templateID)[0];\n            }\n            toolbarArea.appendChild(template);\n            this.toolbarHeight = toolbarArea.clientHeight;\n            this.notify('toolbar', { prop: 'setToolbarHeight', value: { height: this.toolbarHeight } });\n            this['renderReactTemplates']();\n        }\n    };\n    ImageEditor.prototype.quickAccessToolbarTemplateFn = function () {\n        var template;\n        var templateID = this.element.id + '_quickAccessToolbar';\n        var toolbarArea = this.element.querySelector('#' + this.element.id + '_quickAccessToolbarArea');\n        if (this.quickAccessToolbarTemplate) {\n            this.qatFn = this.templateParser(this.quickAccessToolbarTemplate);\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            if (this.isReact) {\n                template = this.qatFn({ type: 'toolbar' }, this, 'Template', templateID)[0];\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            }\n            else if (this.isAngular) {\n                var templateColl = this.qatFn({ type: 'toolbar' }, this, 'Template', templateID);\n                template = (templateColl[0].nodeType === 3) ? templateColl[1] : templateColl[0];\n            }\n            else {\n                template = this.qatFn({ type: 'toolbar' }, this, 'Template', templateID)[0];\n            }\n            toolbarArea.appendChild(template);\n            this['renderReactTemplates']();\n        }\n    };\n    ImageEditor.prototype.templateParser = function (template) {\n        if (template) {\n            try {\n                if (typeof template !== 'function' && document.querySelectorAll(template).length) {\n                    return templateCompiler(document.querySelector(template).innerHTML.trim());\n                }\n                else {\n                    return compile(template);\n                }\n            }\n            catch (error) {\n                return templateCompiler(template);\n            }\n        }\n        return undefined;\n    };\n    // Common codes for EJ2 and Blazor\n    ImageEditor.prototype.getTextFromId = function (id) {\n        var idToValue = { '1': 'none', '2': 'bar', '3': 'arrow', '4': 'arrowSolid',\n            '5': 'circle', '6': 'circleSolid', '7': 'square', '8': 'squareSolid' };\n        return idToValue[\"\" + id];\n    };\n    ImageEditor.prototype.getFinetuneOption = function (type) {\n        var typeToOption = { 'brightness': ImageFinetuneOption.Brightness, 'contrast': ImageFinetuneOption.Contrast,\n            'hue': ImageFinetuneOption.Hue, 'saturation': ImageFinetuneOption.Saturation, 'opacity': ImageFinetuneOption.Opacity,\n            'blur': ImageFinetuneOption.Blur, 'exposure': ImageFinetuneOption.Exposure };\n        return typeToOption[\"\" + type];\n    };\n    ImageEditor.prototype.setPenStroke = function (args) {\n        this.notify('freehand-draw', { prop: 'setPenStrokeWidth', onPropertyChange: false, value: { value: parseInt(args, 10) } });\n    };\n    ImageEditor.prototype.updateFreehandDrawColorChange = function () {\n        var obj = { tempFreeHandDrawEditingStyles: null };\n        this.notify('freehand-draw', { prop: 'getTempFreeHandDrawEditingStyles', value: { obj: obj } });\n        this.notify('freehand-draw', { prop: 'color-change', value: { color: obj['tempFreeHandDrawEditingStyles'].strokeColor } });\n    };\n    ImageEditor.prototype.getUndoRedoColl = function () {\n        var obj = { undoRedoColl: null, index: null };\n        var undoRedoObj = { undoRedoStep: null };\n        var object = { appliedUndoRedoColl: [] };\n        this.notify('undo-redo', { prop: 'getAppliedUndoRedoColl', value: { obj: object } });\n        this.notify('undo-redo', { prop: 'getUndoRedoStep', value: { obj: undoRedoObj } });\n        obj['undoRedoColl'] = object['appliedUndoRedoColl'];\n        obj['index'] = undoRedoObj['undoRedoStep'];\n        return obj;\n    };\n    ImageEditor.prototype.updateImageTransformColl = function (type) {\n        var value;\n        if (type === 'rotateleft') {\n            value = -90;\n        }\n        else if (type === 'rotateright') {\n            value = 90;\n        }\n        else if (type === 'horizontalflip') {\n            value = 'horizontal';\n        }\n        else if (type === 'verticalflip') {\n            value = 'vertical';\n        }\n        for (var i = 0; i < this.objColl.length; i++) {\n            var shape = this.objColl[i].shape;\n            if (shape === 'image' || shape === 'text') {\n                if (isNullOrUndefined(this.objColl[i].rotateFlipColl)) {\n                    this.objColl[i].rotateFlipColl = [];\n                }\n                this.objColl[i].rotateFlipColl.push(value);\n                var obj = { collection: this.objColl[i].rotateFlipColl };\n                this.notify('shape', { prop: 'alignRotateFlipColl', onPropertyChange: false,\n                    value: { collection: this.objColl[i].rotateFlipColl, isRotateFlipCollection: false, obj: obj } });\n                this.objColl[i].rotateFlipColl = obj['collection'];\n            }\n        }\n    };\n    ImageEditor.prototype.setInitialZoomState = function () {\n        this.objColl.push(this.activeObj);\n        this.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        var isUndoRedo = this.isUndoRedo;\n        this.isCropTab = false;\n        this.isUndoRedo = true;\n        if (this.transform.cropZoomFactor && this.transform.cropZoomFactor > 0) {\n            this.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                value: { zoomFactor: -this.transform.cropZoomFactor, zoomPoint: null, isResize: true } });\n        }\n        else {\n            this.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                value: { zoomFactor: Math.abs(this.transform.cropZoomFactor), zoomPoint: null, isResize: true } });\n        }\n        this.isUndoRedo = isUndoRedo;\n        this.panPoint.totalPannedPoint = { x: 0, y: 0 };\n        this.transform.cropZoomFactor = 0;\n        this.notify('freehand-draw', { prop: 'updateFHDColl', onPropertyChange: false });\n        this.activeObj = extend({}, this.objColl[this.objColl.length - 1], {}, true);\n        this.objColl.pop();\n        this.isCropTab = true;\n        this.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: this.activeObj } });\n    };\n    /**\n     * Set the old item Transform item state.\n     *\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.updateCropTransformItems = function () {\n        this.prevCurrSelectionPoint = extend({}, this.currSelectionPoint, {}, true);\n        this.notify('draw', { prop: 'updateCropSelection', onPropertyChange: false });\n    };\n    /**\n     * Get the pascal case.\n     *\n     * @param { string } str - Specifies the string to convert to pascal case.\n     * @param { Object } obj - Specifies the string to convert to pascal case.\n     * @hidden\n     * @returns {string}.\n     * A pascal case string.\n     */\n    ImageEditor.prototype.toPascalCase = function (str, obj) {\n        var strArr = [];\n        if (!isNullOrUndefined(str)) {\n            strArr = str.toLowerCase().split('-');\n        }\n        for (var i = 0; i < strArr.length; i++) {\n            strArr[i] = strArr[i].charAt(0).toUpperCase() + strArr[i].slice(1);\n        }\n        if (obj) {\n            obj['maxText'] = strArr.join('');\n        }\n        return strArr.join('');\n    };\n    /**\n     * Get the font sizes.\n     *\n     * @hidden\n     * @returns {DropDownButtonItemModel[]}.\n     * A font size collections.\n     */\n    ImageEditor.prototype.getFontSizes = function () {\n        var items = [];\n        this.fontSizeColl = [];\n        var fontSize;\n        if (this.transform.degree === 0 || this.transform.degree % 180 === 0) {\n            fontSize = this.img.destWidth / 25;\n        }\n        else {\n            fontSize = this.img.destHeight / 25;\n        }\n        for (var i = 1; i <= 10; i++) {\n            this.fontSizeColl.push({ text: (i * (Math.round(fontSize / 2))).toString() });\n            items.push({ text: (i.toString()) });\n        }\n        return items;\n    };\n    /**\n     * Handles the OK button operation\n     *\n     * @param { boolean } isMouseDown - Specifies whether it is a mouse down.\n     * @param { boolean } isFinalApply - Specifies whether it is a final apply.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.okBtn = function (isMouseDown, isFinalApply) {\n        if (isFinalApply) {\n            this.noPushUndo = false;\n            var tempActiveObj = { activePoint: { startX: 0, startY: 0, endX: 0, endY: 0, width: 0, height: 0 },\n                flipObjColl: [], triangle: [], triangleRatio: [], order: null };\n            this.notify('selection', { prop: 'setTempActObj', onPropertyChange: false, value: { obj: tempActiveObj } });\n        }\n        var ctWrapper = this.element.querySelector('.e-contextual-toolbar-wrapper');\n        if (ctWrapper) {\n            ctWrapper.classList.remove('e-frame-wrapper');\n        }\n        var isCropSelection = false;\n        var splitWords;\n        this.isResizeOkBtn = true;\n        var aspectIcon = this.element.querySelector('#' + this.element.id + '_aspectratio');\n        var nonAspectIcon = this.element.querySelector('#' + this.element.id + '_nonaspectratio');\n        var blrAspRatElem = this.element.querySelector('.e-ie-toolbar-aspect-ratio-btn');\n        var blrNAspRatElem = this.element.querySelector('.e-ie-toolbar-nonaspect-ratio-btn');\n        if (this.activeObj.shape !== undefined) {\n            splitWords = this.activeObj.shape.split('-');\n        }\n        if (splitWords === undefined && this.currObjType.isCustomCrop) {\n            isCropSelection = true;\n        }\n        else if (splitWords !== undefined && splitWords[0] === 'crop') {\n            isCropSelection = true;\n        }\n        this.allowDownScale = true;\n        if ((this.activeObj.shape && this.activeObj.shape !== 'image' || this.togglePen) && !isCropSelection) {\n            var objt = { shapeSettingsObj: {} };\n            this.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: objt } });\n            var shapeSettings = objt['shapeSettingsObj'];\n            if (this.togglePen) {\n                shapeSettings.type = ShapeType.FreehandDraw;\n            }\n            var shapeChangedArgs = { action: 'apply', currentShapeSettings: extend({}, shapeSettings, {}, true) };\n            if (!this.currObjType.isRedact && (isFinalApply || this.isShapeDrawing)) {\n                if (this.isShapeDrawing) {\n                    shapeChangedArgs.action = 'draw-end';\n                }\n                this.trigger('shapeChange', shapeChangedArgs);\n            }\n            this.editCompleteArgs = shapeChangedArgs;\n            if (this.currObjType.isRedact) {\n                this.currObjType.isRedact = false;\n            }\n        }\n        if (aspectIcon || nonAspectIcon) {\n            var obj_2 = { width: null, height: null };\n            this.notify('selection', { prop: 'getNumTextValue', onPropertyChange: false, value: { obj: obj_2 } });\n            var point = { x: obj_2['width'], y: obj_2['height'] };\n            var obj1 = { prevCropObj: this.prevCropObj };\n            var obj2 = { prevObj: this.prevObj };\n            if (point && point.x && point.y && obj1['prevCropObj'] && obj2['prevObj']) {\n                if (nonAspectIcon || (blrNAspRatElem && !blrNAspRatElem.classList.contains('e-hidden'))) {\n                    this.notify('transform', { prop: 'resize', value: { width: point.x, height: point.y, isAspectRatio: false } });\n                }\n                else if (aspectIcon || (blrAspRatElem && !blrAspRatElem.classList.contains('e-hidden'))) {\n                    this.notify('transform', { prop: 'resize', value: { width: point.x, height: null, isAspectRatio: true } });\n                }\n                this.isResize = false;\n                this.aspectWidth = point.x;\n                this.aspectHeight = point.y;\n                this.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'main',\n                        isApplyBtn: false, isCropping: false, isZooming: null, cType: null } });\n                this.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                    value: { zoomFactor: -this.transform.zoomFactor, zoomPoint: null, isResize: true } });\n                this.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                    value: { zoomFactor: obj2['prevObj']['defaultZoom'], zoomPoint: null, isResize: true } });\n                if (obj2['prevObj'].zoomFactor) {\n                    this.setProperties({ zoomSettings: { zoomFactor: obj2['prevObj'].zoomFactor } }, true);\n                }\n                this.notify('transform', { prop: 'setPreviousZoomValue', onPropertyChange: false,\n                    value: { previousZoomValue: this.zoomSettings.zoomFactor } });\n                this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false, value: { operation: 'resize',\n                        previousObj: obj2['prevObj'], previousObjColl: obj2['prevObj']['objColl'],\n                        previousPointColl: obj2['prevObj']['pointColl'], previousSelPointColl: obj2['prevObj']['selPointColl'],\n                        previousCropObj: obj1['prevCropObj'], previousText: null, currentText: null, previousFilter: null,\n                        isCircleCrop: null } });\n                this.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n                var obj_3 = this.cancelCropSelection;\n                if ((obj_3 && (isNullOrUndefined(nonAspectIcon) || !nonAspectIcon))) {\n                    obj_3.previousObj.aspectWidth = obj_3.currentObj.aspectWidth = this.aspectWidth;\n                    obj_3.previousObj.aspectHeight = obj_3.currentObj.aspectHeight = this.aspectHeight;\n                    obj_3.previousCropObj = extend({}, this.cropObj, {}, true);\n                    obj_3.currentCropObj = extend({}, this.cropObj, {}, true);\n                    this.notify('draw', { prop: 'updateCropSelObj' });\n                }\n                this.cancelCropSelection = null;\n            }\n            else if (point && (point.x === 0 || point.y === 0)) {\n                this.notify('draw', { prop: 'performCancel', value: { isContextualToolbar: null } });\n            }\n            else {\n                this.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'main',\n                        isApplyBtn: false, isCropping: false, isZooming: null, cType: null } });\n            }\n            this.isAspectRatio = false;\n        }\n        var selElem = this.element.querySelector('.e-contextual-toolbar-wrapper .e-toolbar-item.e-selected');\n        var obj = { bool: false };\n        this.notify('selection', { prop: 'getFreehandDrawEditing', onPropertyChange: false, value: { obj: obj } });\n        var frameObject = { bool: null };\n        this.notify('toolbar', { prop: 'getFrameToolbar', onPropertyChange: false, value: { obj: frameObject } });\n        var sliderWrap = document.querySelector('#' + this.element.id + '_sliderWrapper');\n        if (selElem) {\n            this.currentFilter = selElem.children[0].children[0].id.replace('Canvas', '');\n        }\n        if (isCropSelection) {\n            if (this.transform.straighten !== 0 && (this.panPoint.totalPannedPoint.x !== 0 || this.panPoint.totalPannedPoint.y !== 0 ||\n                this.panPoint.totalPannedClientPoint.x !== 0 || this.panPoint.totalPannedClientPoint.y !== 0)) {\n                var temp = this.prevStraightenedDegree;\n                this.prevStraightenedDegree = this.transform.straighten;\n                this.setStraighten(this.transform.straighten - 3);\n                this.setStraighten(this.transform.straighten + 3);\n                this.prevStraightenedDegree = temp;\n            }\n            this.isCroppedEvent = this.crop();\n        }\n        else if (this.togglePen) {\n            this.freeHandDraw(false);\n            if (!this.isMaskImage) {\n                var widthObj = { penStrokeWidth: null };\n                this.notify('freehand-draw', { prop: 'getPenStrokeWidth', onPropertyChange: false, value: { obj: widthObj } });\n                this.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n                this.notify('freehand-draw', { prop: 'setPenStrokeWidth', onPropertyChange: false, value: { value: widthObj['penStrokeWidth'] } });\n            }\n            this.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n            this.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.upperContext } });\n        }\n        else if (this.textArea.style.display === 'block' || this.textArea.style.display === 'inline-block') {\n            this.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n                value: { x: null, y: null, isMouseDown: null } });\n            this.lowerContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n            this.notify('draw', { prop: 'redrawImgWithObj', onPropertyChange: false });\n            if (isNullOrUndefined(isMouseDown)) {\n                this.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n            }\n            this.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n            this.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.upperContext } });\n        }\n        else if ((sliderWrap || this.currObjType.isFiltered) && !this.drawingShape && this.activeObj.shape !== 'redact') {\n            this.initialAdjustmentValue = this.canvasFilter = this.lowerContext.filter;\n            this.currObjType.isFiltered = false;\n            var obj_4 = { value: null };\n            this.notify('draw', { prop: 'getTempAdjustmentValue', value: { obj: obj_4 } });\n            if (!sliderWrap || sliderWrap.parentElement.previousElementSibling.textContent !== 'Opacity') {\n                this.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n            }\n            if ((this.activeObj.activePoint.width !== 0 && this.activeObj.activePoint.height !== 0) ||\n                (this.activeObj.shape === 'path' && this.activeObj.pointColl.length > 0)) {\n                this.notify('shape', { prop: 'applyActObj', onPropertyChange: false, value: { isMouseDown: null } });\n            }\n        }\n        else if (obj['bool']) {\n            this.notify('freehand-draw', { prop: 'applyFhd', onPropertyChange: false });\n            this.notify('selection', { prop: 'setFreehandDrawCustomized', value: { isFreehandDrawCustomized: false } });\n            this.notify('toolbar', { prop: 'destroy-qa-toolbar' });\n            this.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n            this.notify('freehand-draw', { prop: 'resetFreehandDrawSelectedId', onPropertyChange: false });\n        }\n        else if ((this.activeObj.activePoint.width !== 0 || this.activeObj.activePoint.height !== 0) ||\n            (this.activeObj.shape === 'path' && this.activeObj.pointColl.length > 0)) {\n            if (this.activeObj.shape === 'image') {\n                this.notify('draw', { prop: 'setImageApply', onPropertyChange: false, value: { bool: true } });\n            }\n            this.notify('shape', { prop: 'applyActObj', onPropertyChange: false, value: { isMouseDown: null } });\n        }\n        else {\n            if (JSON.stringify(this.frameObj) !== JSON.stringify(this.tempFrameObj)) {\n                var object = { currObj: {} };\n                this.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n                this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false, value: {\n                        operation: 'frame', previousObj: object['currObj'], previousObjColl: object['currObj']['objColl'],\n                        previousPointColl: object['currObj']['pointColl'], previousSelPointColl: object['currObj']['selPointColl'],\n                        previousCropObj: extend({}, this.cropObj, {}, true), previousText: null, currentText: null,\n                        previousFilter: null, isCircleCrop: null\n                    } });\n                this.notify('draw', { prop: 'render-image', value: { isMouseWheel: null, isPreventClearRect: null, isFrame: true } });\n                var currFrameSettings = { type: this.toPascalCase(this.frameObj.type),\n                    color: this.frameObj.color, gradientColor: this.frameObj.gradientColor, size: this.frameObj.size,\n                    inset: this.frameObj.inset, offset: this.frameObj.offset, borderRadius: this.frameObj.radius,\n                    frameLineStyle: this.toPascalCase(this.frameObj.border), lineCount: this.frameObj.amount };\n                var prevFrameSettings = { type: this.toPascalCase(this.tempFrameObj.type),\n                    color: this.tempFrameObj.color, gradientColor: this.tempFrameObj.gradientColor, size: this.tempFrameObj.size,\n                    inset: this.tempFrameObj.inset, offset: this.tempFrameObj.offset, borderRadius: this.tempFrameObj.radius,\n                    frameLineStyle: this.toPascalCase(this.tempFrameObj.border), lineCount: this.tempFrameObj.amount };\n                var frameChange = { cancel: false, previousFrameSetting: prevFrameSettings,\n                    currentFrameSetting: currFrameSettings };\n                this.editCompleteArgs = frameChange;\n                this.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n                this.tempFrameObj = extend({}, this.frameObj, {}, true);\n            }\n            this.notify('draw', { prop: 'resetFrameZoom', onPropertyChange: false, value: { isOk: true } });\n        }\n        if (!obj['isCropToolbar']) {\n            this.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'main',\n                    isApplyBtn: false, isCropping: null, isZooming: null, cType: null } });\n            this.currObjType.isRedact = false;\n        }\n        this.notify('draw', { prop: 'setNewPath', value: { bool: false } });\n        this.transform.zoomFactor = this.transform.defaultZoomFactor;\n        this.notify('selection', { prop: 'setCurrentDrawingShape', onPropertyChange: false, value: { value: '' } });\n        this.isResizeOkBtn = false;\n        this.notify('draw', { prop: 'redrawDownScale' });\n        this.isChangesSaved = this.isFinetuneBtnClick = false;\n        if (isFinalApply) {\n            this.drawingShape = null;\n            this.notify('draw', { prop: 'resetTempObjColl' });\n            this.notify('draw', { prop: 'resetTempPointColl' });\n        }\n    };\n    ImageEditor.prototype.triggerEditCompleteEvent = function (args) {\n        if (args.action === 'shape-insert' && args.actionEventArgs &&\n            args.actionEventArgs.currentShapeSettings &&\n            args.actionEventArgs.currentShapeSettings.type.toString() === 'Redact') {\n            args.action = 'redact';\n        }\n        this.trigger('editComplete', args);\n        this.editCompleteArgs = null;\n    };\n    /**\n     * Handles the OK button operation\n     *\n     * @param { string } id - Specifies shape id to return.\n     * @hidden\n     * @returns {SelectionPoint | Object}.\n     */\n    ImageEditor.prototype.getObjFromId = function (id) {\n        var obj;\n        if (this.activeObj.currIndex && this.activeObj.currIndex === id) {\n            obj = extend({}, this.activeObj, {}, true);\n        }\n        else {\n            for (var i = 0; i < this.shapeColl.length; i++) {\n                var shapeId = this.shapeColl[i].id ? this.shapeColl[i].id :\n                    this.shapeColl[i].currIndex;\n                if (shapeId === id) {\n                    obj = extend({}, this.shapeColl[i], {}, true);\n                    break;\n                }\n            }\n        }\n        return obj;\n    };\n    /**\n     * Set the temporary filter properties.\n     *\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.setTempFilterProperties = function () {\n        this.upperCanvas.style.display = 'block';\n        this.cropSelectedState();\n        var obj = { adjustmentLevel: null };\n        this.notify('filter', { prop: 'getAdjustmentLevel', onPropertyChange: false,\n            value: { obj: obj } });\n        this.lowerContext.filter = this.initialAdjustmentValue;\n        this.notify('draw', { prop: 'setTempAdjustmentValue', value: { tempAdjustmentValue: this.lowerContext.filter } });\n        this.notify('filter', { prop: 'setTempAdjustmentLevel', onPropertyChange: false,\n            value: { tempAdjustmentLevel: extend({}, obj['adjustmentLevel'], {}, true) } });\n        this.notify('draw', { prop: 'setTempFilter', value: { tempFilter: this.currentFilter } });\n        var undoRedoObj = { undoRedoStep: null };\n        this.notify('undo-redo', { prop: 'getUndoRedoStep', value: { obj: undoRedoObj } });\n        this.notify('draw', { prop: 'setTempUndoRedoStep', value: { tempUndoRedoStep: undoRedoObj['undoRedoStep'] } });\n    };\n    /**\n     * To crop the selection.\n     *\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.cropSelectedState = function () {\n        if (this.activeObj.shape && this.activeObj.shape.split('-')[0] === 'crop') {\n            this.okBtn();\n        }\n    };\n    /**\n     * Get the current canvas data.\n     *\n     * @hidden\n     * @returns {ImageData}.\n     * An ImageData returns the current canvas image data object.\n     */\n    ImageEditor.prototype.getCurrentCanvasData = function () {\n        var tempFrame = extend({}, this.frameObj, {}, true);\n        this.frameObj = { type: 'none', color: '#fff', size: 20, inset: 20, offset: 20, radius: 0, amount: 1, border: 'solid', gradientColor: '' };\n        var tempFilter = this.lowerContext.filter;\n        this.lowerContext.filter = this.canvasFilter = 'none';\n        var objColl = extend([], this.objColl, null, true);\n        var pointColl = extend([], this.pointColl, null, true);\n        this.objColl = [];\n        this.pointColl = [];\n        this.freehandCounter = 0;\n        this.notify('draw', { prop: 'render-image', value: { isMouseWheel: false } });\n        var ctWrapper = this.element.querySelector('.e-contextual-toolbar-wrapper');\n        if (ctWrapper) {\n            ctWrapper.classList.add('e-hide');\n        }\n        var data = this.getImageData();\n        if (ctWrapper) {\n            ctWrapper.classList.remove('e-hide');\n        }\n        if (!Browser.isDevice) {\n            this.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'main',\n                    isApplyBtn: true, isCropping: false } });\n        }\n        this.element.querySelector('#' + this.element.id + '_contextualToolbarArea').classList.remove('e-hide');\n        this.objColl = objColl;\n        this.pointColl = pointColl;\n        this.freehandCounter = pointColl.length;\n        this.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n            value: { ctx: this.lowerContext, shape: 'iterate', pen: 'iterate', isPreventApply: null } });\n        this.lowerContext.filter = this.canvasFilter = tempFilter;\n        this.frameObj = tempFrame;\n        return data;\n    };\n    /**\n     * To set current adjustment value\n     *\n     * @param { string } type - Specifies the type of adjustment.\n     * @param { number } value - Specifies the value to adjust.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.setCurrAdjustmentValue = function (type, value) {\n        var finetuneValueChanging = { finetune: this.getFinetuneOption(type), value: value, cancel: false };\n        this.trigger('finetuneValueChanging', finetuneValueChanging);\n        this.editCompleteArgs = finetuneValueChanging;\n        if (finetuneValueChanging.cancel) {\n            return;\n        }\n        this.notify('filter', { prop: 'setCurrAdjValue', value: { type: type.toLowerCase(), value: value } });\n    };\n    /**\n     * Get the square point for path.\n     *\n     * @param { SelectionPoint } obj - Specifies the points of path.\n     * @hidden\n     * @returns {ActivePoint}.\n     * An ActivePoint object which returns the square point.\n     */\n    ImageEditor.prototype.getSquarePointForPath = function (obj) {\n        var point = { startX: 0, startY: 0, endX: 0, endY: 0, width: 0, height: 0 };\n        if (obj.pointColl.length > 0) {\n            point = { startX: obj.pointColl[0].x, startY: obj.pointColl[0].y, endX: obj.pointColl[0].x, endY: obj.pointColl[0].y };\n            for (var i = 1; i < obj.pointColl.length; i++) {\n                if (obj.pointColl[i].x < point.startX) {\n                    point.startX = obj.pointColl[i].x;\n                }\n                if (obj.pointColl[i].y < point.startY) {\n                    point.startY = obj.pointColl[i].y;\n                }\n                if (obj.pointColl[i].x > point.endX) {\n                    point.endX = obj.pointColl[i].x;\n                }\n                if (obj.pointColl[i].y > point.endY) {\n                    point.endY = obj.pointColl[i].y;\n                }\n            }\n            point.width = point.endX - point.startX;\n            point.height = point.endY - point.startY;\n        }\n        return point;\n    };\n    /**\n     * Get the SelectionType.\n     *\n     * @param { string } type - Specifies the SelectionType.\n     * @hidden\n     * @returns {string}.\n     * An string which returns the SelectionType.\n     */\n    ImageEditor.prototype.getSelectionType = function (type) {\n        type = type === 'crop-custom' ? 'CropCustom' : type;\n        var typeToSelectionType = { 'CropCustom': 'Custom', 'CropSquare': 'Square', 'CropCircle': 'Circle',\n            'Crop3:2': '3:2', 'Crop4:3': '4:3', 'Crop5:4': '5:4', 'Crop7:5': '7:5', 'Crop16:9': '16:9',\n            'Crop2:3': '2:3', 'Crop3:4': '3:4', 'Crop4:5': '4:5', 'Crop5:7': '5:7', 'Crop9:16': '9:16' };\n        return typeToSelectionType[\"\" + type] ? typeToSelectionType[\"\" + type] : type.split('Crop')[1];\n    };\n    /** Clears the context.\n     *\n     * @param { CanvasRenderingContext2D } ctx - Specifies the canvas context.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.clearContext = function (ctx) {\n        ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);\n        ctx.clearRect(0, 0, ctx.canvas.height, ctx.canvas.width);\n    };\n    /**\n     * Apply Arrow for start and end.\n     *\n     * @param { string } type - Specifies the start arrow or end arrow.\n     * @param { string } id - Specifies the start arrow or end arrow item id.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.updateArrow = function (type, id) {\n        var isObjPushed = false;\n        var collLength = this.objColl.length;\n        this.notify('shape', { prop: 'pushActItemIntoObj' });\n        if (collLength !== this.objColl.length) {\n            isObjPushed = true;\n        }\n        var prevCropObj = extend({}, this.cropObj, {}, true);\n        var object = { currObj: {} };\n        var objt = { shapeSettingsObj: {} };\n        this.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: objt } });\n        var shapeSettings = objt['shapeSettingsObj'];\n        this.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        var prevObj = object['currObj'];\n        prevObj.objColl = extend([], this.objColl, [], true);\n        prevObj.pointColl = extend([], this.pointColl, [], true);\n        prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n        if (isObjPushed) {\n            this.objColl.pop();\n        }\n        if (type === 'startArrow') {\n            this.activeObj.start = this.getTextFromId(id);\n        }\n        else if (type === 'endArrow') {\n            this.activeObj.end = this.getTextFromId(id);\n        }\n        this.notify('shape', { prop: 'setStrokeSettings', value: { strokeSettings: null, strokeColor: null, fillColor: null,\n                strokeWidth: this.activeObj.strokeSettings.strokeWidth } });\n        this.objColl.push(this.activeObj);\n        if (this.activeObj.activePoint.width !== 0 || this.activeObj.activePoint.height !== 0) {\n            this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                value: { operation: 'shapeTransform', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                    previousPointColl: prevObj.pointColl, previousCropObj: prevCropObj, previousText: null,\n                    currentText: null, previousFilter: null, isCircleCrop: null } });\n        }\n        this.notify('selection', { prop: 'redrawShape', value: { obj: this.objColl[this.objColl.length - 1] } });\n        if (Browser.isDevice) {\n            if (document.getElementById(this.element.id + '_bottomToolbar')) {\n                /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                var toolbar_1 = getComponent(this.element.id + '_bottomToolbar', 'toolbar');\n                toolbar_1.refreshOverflow();\n            }\n        }\n        else {\n            if (document.getElementById(this.element.id + '_toolbar')) {\n                /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                var toolbar_2 = getComponent(this.element.id + '_toolbar', 'toolbar');\n                toolbar_2.refreshOverflow();\n            }\n        }\n        var shapeChangedArgs = { action: type, currentShapeSettings: extend({}, shapeSettings, {}, true) };\n        this.trigger('shapeChange', shapeChangedArgs);\n        this.editCompleteArgs = shapeChangedArgs;\n    };\n    /**\n     * Apply Font style for text.\n     *\n     * @param { string } id - Specifies the selected item id.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.updateFontFamily = function (id) {\n        this.notify('selection', { prop: 'setInitialTextEdit', value: { bool: false } });\n        var isObjPushed = false;\n        var collLength = this.objColl.length;\n        this.notify('shape', { prop: 'pushActItemIntoObj' });\n        if (collLength !== this.objColl.length) {\n            isObjPushed = true;\n        }\n        var objColl = extend([], this.objColl, [], true);\n        var prevCropObj = extend({}, this.cropObj, {}, true);\n        var objt = { shapeSettingsObj: {} };\n        this.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: objt } });\n        var shapeSettings = objt['shapeSettingsObj'];\n        var object = { currObj: {} };\n        this.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        var prevObj = object['currObj'];\n        prevObj.objColl = extend([], this.objColl, [], true);\n        prevObj.pointColl = extend([], this.pointColl, [], true);\n        prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        this.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: selPointCollObj } });\n        prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        if (isObjPushed) {\n            this.objColl.pop();\n        }\n        if (this.textArea.style.display === 'block' || this.textArea.style.display === 'inline-block') {\n            this.notify('shape', { prop: 'updateFontRatio', onPropertyChange: false,\n                value: { obj: this.activeObj, isTextArea: true } });\n            var temp = this.activeObj.textSettings.fontFamily;\n            this.activeObj.textSettings.fontFamily = this.toPascalCase(id);\n            if (this.activeObj.activePoint.width !== 0 || this.activeObj.activePoint.height !== 0) {\n                this.notify('shape', { prop: 'redraw-text' });\n            }\n            this.objColl.push(this.activeObj);\n            if (this.activeObj.activePoint.width !== 0 || this.activeObj.activePoint.height !== 0) {\n                this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                    value: { operation: 'textAreaCustomization', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                        previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                        previousCropObj: prevCropObj, previousText: null,\n                        currentText: null, previousFilter: null, isCircleCrop: null } });\n            }\n            this.objColl.pop();\n            this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n            var width = this.activeObj.activePoint.width +\n                this.activeObj.textSettings.fontSize * 0.25;\n            this.textArea.style.width = width + 'px';\n            this.textArea.style.fontFamily = this.toPascalCase(id);\n            this.activeObj.textSettings.fontFamily = temp;\n            this.notify('shape', { prop: 'updateFontStyles', onPropertyChange: false,\n                value: { isTextBox: null } });\n        }\n        else {\n            this.notify('shape', { prop: 'updateFontRatio', onPropertyChange: false,\n                value: { obj: this.activeObj, isTextArea: null } });\n            var fontFamily = this.activeObj.textSettings.fontFamily = this.toPascalCase(id);\n            this.notify('shape', { prop: 'setTextSettings', onPropertyChange: false,\n                value: { textSettings: null, fontFamily: fontFamily, fontSize: null } });\n            if (this.activeObj.activePoint.width !== 0 || this.activeObj.activePoint.height !== 0) {\n                this.notify('shape', { prop: 'redraw-text' });\n            }\n            this.objColl.push(this.activeObj);\n            if (this.activeObj.activePoint.width !== 0 || this.activeObj.activePoint.height !== 0) {\n                this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                    value: { operation: 'shapeTransform', previousObj: prevObj, previousObjColl: objColl,\n                        previousPointColl: extend([], this.pointColl, [], true),\n                        previousSelPointColl: prevObj.selPointColl, previousCropObj: prevCropObj, previousText: null,\n                        currentText: null, previousFilter: null, isCircleCrop: null } });\n            }\n            this.notify('selection', { prop: 'redrawShape', value: { obj: this.objColl[this.objColl.length - 1] } });\n        }\n        var shapeChangedArgs = { action: 'font-family', currentShapeSettings: extend({}, shapeSettings, {}, true) };\n        shapeChangedArgs.currentShapeSettings.fontFamily = this.textArea.style.fontFamily;\n        this.trigger('shapeChange', shapeChangedArgs);\n        this.editCompleteArgs = shapeChangedArgs;\n    };\n    /**\n     * Apply Font size for text.\n     *\n     * @param { string } text - Specifies the selected item text.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.updateFontSize = function (text) {\n        var itemText = text;\n        this.notify('selection', { prop: 'setInitialTextEdit', value: { bool: false } });\n        var isObjPushed = false;\n        var collLength = this.objColl.length;\n        this.notify('shape', { prop: 'pushActItemIntoObj' });\n        if (collLength !== this.objColl.length) {\n            isObjPushed = true;\n        }\n        var prevCropObj = extend({}, this.cropObj, {}, true);\n        var objt = { shapeSettingsObj: {} };\n        this.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: objt } });\n        var shapeSettings = objt['shapeSettingsObj'];\n        var object = { currObj: {} };\n        this.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        var prevObj = object['currObj'];\n        prevObj.objColl = extend([], this.objColl, [], true);\n        prevObj.pointColl = extend([], this.pointColl, [], true);\n        prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        this.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: selPointCollObj } });\n        prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        if (isObjPushed) {\n            this.objColl.pop();\n        }\n        if (this.textArea.style.display === 'block' || this.textArea.style.display === 'inline-block') {\n            this.notify('shape', { prop: 'updateFontRatio', onPropertyChange: false,\n                value: { obj: this.activeObj, isTextArea: true } });\n            var temp = this.activeObj.textSettings.fontSize;\n            this.activeObj.textSettings.fontSize = parseInt(this.fontSizeColl[(parseInt(itemText, 10) - 1)].text, 10);\n            this.objColl.push(this.activeObj);\n            if (this.activeObj.activePoint.width !== 0 || this.activeObj.activePoint.height !== 0) {\n                this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                    value: { operation: 'textAreaCustomization', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                        previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                        previousCropObj: prevCropObj, previousText: null,\n                        currentText: null, previousFilter: null, isCircleCrop: null } });\n            }\n            this.objColl.pop();\n            var textStyle = '';\n            if (this.textArea.style.fontWeight === 'bold') {\n                textStyle = 'bold ';\n            }\n            if (this.textArea.style.fontStyle === 'italic') {\n                textStyle = 'italic ';\n            }\n            if (this.textArea.style.fontWeight === 'bold' && this.textArea.style.fontStyle === 'italic') {\n                textStyle = 'italic bold ';\n            }\n            this.upperContext.font = textStyle + this.activeObj.textSettings.fontSize + 'px' + ' ' + this.textArea.style.fontFamily;\n            var rows = this.textArea.value.split('\\n');\n            var obj = { maxText: '' };\n            this.notify('shape', { prop: 'getMaxText', onPropertyChange: false,\n                value: { isTextBox: true, text: null, obj: obj } });\n            var text_1 = obj['maxText'];\n            var width = this.upperContext.measureText(text_1).width +\n                this.activeObj.textSettings.fontSize * 0.5;\n            this.textArea.style.width = width + 'px';\n            this.textArea.style.height = rows.length * (this.activeObj.textSettings.fontSize + this.activeObj.textSettings.fontSize * 0.25) + 'px';\n            this.activeObj.textSettings.fontSize = temp;\n            this.upperContext.font = this.activeObj.textSettings.fontSize + 'px' + ' ' + this.activeObj.textSettings.fontFamily;\n            this.textArea.style.fontSize = parseInt(this.fontSizeColl[(parseInt(itemText, 10) - 1)].text, 10) + 'px';\n            if (this.textArea.style.fontFamily === 'georgia') {\n                this.textArea.style.width = parseFloat(this.textArea.style.width) + parseFloat(this.textArea.style.fontSize) + 'px';\n            }\n        }\n        else {\n            this.notify('shape', { prop: 'updateFontRatio', onPropertyChange: false,\n                value: { obj: this.activeObj, isTextArea: null } });\n            var fontSize = this.activeObj.textSettings.fontSize = parseInt(this.fontSizeColl[(parseInt(itemText, 10) - 1)].text, 10);\n            this.notify('shape', { prop: 'setTextSettings', onPropertyChange: false,\n                value: { textSettings: null, fontFamily: null, fontSize: fontSize } });\n            this.upperContext.font = this.activeObj.textSettings.fontSize + 'px' + ' ' + this.activeObj.textSettings.fontFamily;\n            var rows = this.activeObj.keyHistory.split('\\n');\n            var obj = { maxText: '' };\n            this.notify('shape', { prop: 'getMaxText', onPropertyChange: false,\n                value: { isTextBox: null, text: null, obj: obj } });\n            var text_2 = obj['maxText'];\n            var width = this.upperContext.measureText(text_2).width +\n                this.activeObj.textSettings.fontSize * 0.5;\n            var height = rows.length * (this.activeObj.textSettings.fontSize +\n                this.activeObj.textSettings.fontSize * 0.25);\n            if (this.activeObj.activePoint.width !== 0 || this.activeObj.activePoint.height !== 0) {\n                this.notify('selection', { prop: 'setTextSelection', onPropertyChange: false,\n                    value: { width: width, height: height } });\n                this.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: this.activeObj.activePoint, obj: this.activeObj,\n                        isMouseMove: null, x: null, y: null } });\n                this.notify('shape', { prop: 'redraw-text' });\n            }\n            this.objColl.push(this.activeObj);\n            if (this.activeObj.activePoint.width !== 0 || this.activeObj.activePoint.height !== 0) {\n                this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                    value: { operation: 'shapeTransform', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                        previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                        previousCropObj: prevCropObj, previousText: null,\n                        currentText: null, previousFilter: null, isCircleCrop: null } });\n            }\n            this.notify('selection', { prop: 'redrawShape', value: { obj: this.objColl[this.objColl.length - 1] } });\n        }\n        var shapeChangedArgs = { action: 'font-size', currentShapeSettings: extend({}, shapeSettings, {}, true) };\n        shapeChangedArgs.currentShapeSettings.fontSize = this.activeObj.textSettings.fontSize;\n        this.trigger('shapeChange', shapeChangedArgs);\n        this.editCompleteArgs = shapeChangedArgs;\n    };\n    /**\n     * Apply Font color for text.\n     *\n     * @param { string } value - Specifies the selected color item value.\n     * @param { string } color - Specifies the selected color type value.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.updateFontColor = function (value, color) {\n        this.notify('selection', { prop: 'setInitialTextEdit', value: { bool: false } });\n        var isObjPushed = false;\n        var collLength = this.objColl.length;\n        this.notify('shape', { prop: 'pushActItemIntoObj' });\n        if (collLength !== this.objColl.length) {\n            isObjPushed = true;\n        }\n        var prevCropObj = extend({}, this.cropObj, {}, true);\n        var objt = { shapeSettingsObj: {} };\n        this.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: objt } });\n        var shapeSettings = objt['shapeSettingsObj'];\n        var object = { currObj: {} };\n        this.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        var prevObj = object['currObj'];\n        prevObj.objColl = extend([], this.objColl, [], true);\n        prevObj.pointColl = extend([], this.pointColl, [], true);\n        prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        this.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: selPointCollObj } });\n        prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        if (isObjPushed) {\n            this.objColl.pop();\n        }\n        if (this.textArea.style.display === 'none') {\n            if (color === 'Text') {\n                this.activeObj.strokeSettings.strokeColor = value;\n                this.notify('shape', { prop: 'setStrokeSettings', value: { strokeSettings: null,\n                        strokeColor: this.activeObj.strokeSettings.strokeColor, fillColor: null, strokeWidth: null } });\n            }\n            else {\n                this.activeObj.strokeSettings.fillColor = value;\n                this.notify('shape', { prop: 'setStrokeSettings', value: { strokeSettings: null,\n                        strokeColor: null, fillColor: this.activeObj.strokeSettings.fillColor, strokeWidth: null } });\n            }\n            if (!this.togglePen) {\n                if (this.activeObj.activePoint.width !== 0 || this.activeObj.activePoint.height !== 0) {\n                    this.objColl.push(this.activeObj);\n                    this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                        value: { operation: 'shapeTransform', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                            previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                            previousCropObj: prevCropObj, previousText: null,\n                            currentText: null, previousFilter: null, isCircleCrop: null } });\n                    this.notify('selection', { prop: 'redrawShape', value: { obj: this.objColl[this.objColl.length - 1] } });\n                }\n            }\n        }\n        else if (this.textArea.style.display === 'block' || this.textArea.style.display === 'inline-block') {\n            this.textArea.style[color === 'Text' ? 'color' : 'backgroundColor'] = value;\n            var temp = color === 'Text' ? this.activeObj.strokeSettings.strokeColor : this.activeObj.strokeSettings.fillColor;\n            this.activeObj.strokeSettings[color === 'Text' ? 'strokeColor' : 'fillColor'] = value;\n            if (this.activeObj.activePoint.width !== 0 || this.activeObj.activePoint.height !== 0) {\n                this.objColl.push(this.activeObj);\n                this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                    value: { operation: 'textAreaCustomization', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                        previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                        previousCropObj: prevCropObj, previousText: null,\n                        currentText: null, previousFilter: null, isCircleCrop: null } });\n                this.objColl.pop();\n            }\n            this.activeObj.strokeSettings[color === 'Text' ? 'strokeColor' : 'fillColor'] = temp;\n        }\n        else if (!this.togglePen) {\n            if (this.activeObj.activePoint.width !== 0 || this.activeObj.activePoint.height !== 0) {\n                this.objColl.push(this.activeObj);\n                this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                    value: { operation: 'shapeTransform', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                        previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                        previousCropObj: prevCropObj, previousText: null,\n                        currentText: null, previousFilter: null, isCircleCrop: null } });\n                this.notify('selection', { prop: 'redrawShape', value: { obj: this.objColl[this.objColl.length - 1] } });\n            }\n        }\n        var shapeChangedArgs = { action: 'font-color', currentShapeSettings: extend({}, shapeSettings, {}, true) };\n        shapeChangedArgs.currentShapeSettings.fillColor = value;\n        this.trigger('shapeChange', shapeChangedArgs);\n        this.editCompleteArgs = shapeChangedArgs;\n    };\n    /**\n     * Apply Font color for text.\n     *\n     * @param { string } value - Specifies the selected color item value.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.updateStrokeTextColor = function (value) {\n        this.notify('selection', { prop: 'setInitialTextEdit', value: { bool: false } });\n        var isObjPushed = false;\n        var collLength = this.objColl.length;\n        this.notify('shape', { prop: 'pushActItemIntoObj' });\n        if (collLength !== this.objColl.length) {\n            isObjPushed = true;\n        }\n        var prevCropObj = extend({}, this.cropObj, {}, true);\n        var objt = { shapeSettingsObj: {} };\n        this.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: objt } });\n        var shapeSettings = objt['shapeSettingsObj'];\n        var object = { currObj: {} };\n        this.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        var prevObj = object['currObj'];\n        prevObj.objColl = extend([], this.objColl, [], true);\n        prevObj.pointColl = extend([], this.pointColl, [], true);\n        prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        this.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: selPointCollObj } });\n        prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        if (isObjPushed) {\n            this.objColl.pop();\n        }\n        if (this.textArea.style.display === 'none') {\n            this.activeObj.strokeSettings.outlineColor = value;\n            this.notify('shape', { prop: 'setStrokeSettings', value: { strokeSettings: null,\n                    strokeColor: null, fillColor: null, strokeWidth: null, outlineColor: this.activeObj.strokeSettings.outlineColor } });\n            if (!this.togglePen) {\n                if (this.activeObj.activePoint.width !== 0 || this.activeObj.activePoint.height !== 0) {\n                    this.objColl.push(this.activeObj);\n                    this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                        value: { operation: 'shapeTransform', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                            previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                            previousCropObj: prevCropObj, previousText: null,\n                            currentText: null, previousFilter: null, isCircleCrop: null } });\n                    this.notify('selection', { prop: 'redrawShape', value: { obj: this.objColl[this.objColl.length - 1] } });\n                }\n            }\n        }\n        else if (this.textArea.style.display === 'block' || this.textArea.style.display === 'inline-block') {\n            this.textArea.style.textShadow = \"-1px -1px 0 \" + value + \", 1px -1px 0 \" + value + \", -1px 1px 0 \" + value + \", 1px 1px 0 \" + value;\n            var temp = this.activeObj.strokeSettings.outlineColor;\n            this.activeObj.strokeSettings.outlineColor = value;\n            if (this.activeObj.activePoint.width !== 0 || this.activeObj.activePoint.height !== 0) {\n                this.objColl.push(this.activeObj);\n                this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                    value: { operation: 'textAreaCustomization', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                        previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                        previousCropObj: prevCropObj, previousText: null,\n                        currentText: null, previousFilter: null, isCircleCrop: null } });\n                this.objColl.pop();\n            }\n            this.activeObj.strokeSettings.outlineColor = temp;\n        }\n        else if (!this.togglePen) {\n            if (this.activeObj.activePoint.width !== 0 || this.activeObj.activePoint.height !== 0) {\n                this.objColl.push(this.activeObj);\n                this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                    value: { operation: 'shapeTransform', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                        previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                        previousCropObj: prevCropObj, previousText: null,\n                        currentText: null, previousFilter: null, isCircleCrop: null } });\n                this.notify('selection', { prop: 'redrawShape', value: { obj: this.objColl[this.objColl.length - 1] } });\n            }\n        }\n        var shapeChangedArgs = { action: 'font-color', currentShapeSettings: extend({}, shapeSettings, {}, true) };\n        shapeChangedArgs.currentShapeSettings.fillColor = value;\n        this.trigger('shapeChange', shapeChangedArgs);\n        this.editCompleteArgs = shapeChangedArgs;\n    };\n    /**\n     * Apply Pen stroke width.\n     *\n     * @param { string } id - Specifies the selected item id.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.updatePenStrokeWidth = function (id) {\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var temp = extend([], this.pointColl, [], true);\n        this.updateFreehandDrawColorChange();\n        var prevCropObj = extend({}, this.cropObj, {}, true);\n        var objt = { shapeSettingsObj: {} };\n        this.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: objt } });\n        var shapeSettings = objt['shapeSettingsObj'];\n        var object = { currObj: {} };\n        this.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        var prevObj = object['currObj'];\n        prevObj.objColl = extend([], this.objColl, [], true);\n        prevObj.pointColl = extend([], this.pointColl, [], true);\n        prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        this.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: selPointCollObj } });\n        prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        this.pointColl = temp;\n        this.notify('selection', { prop: 'setFreehandDrawCustomized', value: { isFreehandDrawCustomized: true } });\n        this.setPenStroke(id);\n        var obj = { bool: false };\n        this.notify('selection', { prop: 'getFreehandDrawEditing', onPropertyChange: false, value: { obj: obj } });\n        if (obj['bool']) {\n            var obj_5 = { penStrokeWidth: null };\n            this.notify('freehand-draw', { prop: 'getPenStrokeWidth', onPropertyChange: false, value: { obj: obj_5 } });\n            this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n            this.lowerContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n            this.notify('freehand-draw', { prop: 'hoverFhd', onPropertyChange: false,\n                value: { strokeColor: null, strokeWidth: obj_5['penStrokeWidth'] } });\n            var indexObj = { freehandSelectedIndex: null };\n            this.notify('freehand-draw', { prop: 'getFreehandSelectedIndex', onPropertyChange: false, value: { obj: indexObj } });\n            this.pointColl[indexObj['freehandSelectedIndex']].strokeWidth = obj_5['penStrokeWidth'];\n            this.notify('draw', { prop: 'render-image', value: { isMouseWheel: null } });\n            this.notify('draw', { prop: 'redrawDownScale' });\n            this.notify('freehand-draw', { prop: 'hoverFhd', onPropertyChange: false,\n                value: { strokeColor: null, strokeWidth: obj_5['penStrokeWidth'] } });\n            this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                value: { operation: 'freehanddrawCustomized', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                    previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                    previousCropObj: prevCropObj, previousText: null,\n                    currentText: null, previousFilter: null, isCircleCrop: null } });\n        }\n        shapeSettings.type = ShapeType.FreehandDraw;\n        var shapeChangedArgs = { action: 'stroke-width', currentShapeSettings: extend({}, shapeSettings, {}, true) };\n        shapeChangedArgs.currentShapeSettings.strokeWidth = this.activeObj.strokeSettings.strokeWidth;\n        this.trigger('shapeChange', shapeChangedArgs);\n        this.editCompleteArgs = shapeChangedArgs;\n    };\n    /**\n     * Apply Pen stroke color.\n     *\n     * @param { string } value - Specifies the selected color item value.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.updatePenStrokeColor = function (value) {\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var temp = extend([], this.pointColl, [], true);\n        this.updateFreehandDrawColorChange();\n        var prevCropObj = extend({}, this.cropObj, {}, true);\n        var objt = { shapeSettingsObj: {} };\n        this.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: objt } });\n        var shapeSettings = objt['shapeSettingsObj'];\n        var object = { currObj: {} };\n        this.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        var prevObj = object['currObj'];\n        prevObj.objColl = extend([], this.objColl, [], true);\n        prevObj.pointColl = extend([], this.pointColl, [], true);\n        prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        this.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: selPointCollObj } });\n        prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        this.pointColl = temp;\n        this.notify('selection', { prop: 'setFreehandDrawCustomized', value: { isFreehandDrawCustomized: true } });\n        this.activeObj.strokeSettings.strokeColor = value;\n        var indexObj = { freehandSelectedIndex: null };\n        this.notify('freehand-draw', { prop: 'getFreehandSelectedIndex', onPropertyChange: false, value: { obj: indexObj } });\n        if (indexObj['freehandSelectedIndex'] !== null && indexObj['freehandSelectedIndex'] !== undefined) {\n            this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n            this.notify('draw', { prop: 'render-image', value: { isMouseWheel: null } });\n            this.notify('draw', { prop: 'redrawDownScale' });\n            this.notify('freehand-draw', { prop: 'hoverFhd', onPropertyChange: false,\n                value: { strokeColor: null, strokeWidth: null } });\n        }\n        var obj = { bool: false };\n        this.notify('selection', { prop: 'getFreehandDrawEditing', onPropertyChange: false, value: { obj: obj } });\n        if (obj['bool']) {\n            var indexObj_1 = { freehandSelectedIndex: null };\n            this.notify('freehand-draw', { prop: 'getFreehandSelectedIndex', onPropertyChange: false, value: { obj: indexObj_1 } });\n            this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n            this.pointColl[indexObj_1['freehandSelectedIndex']].strokeColor = value;\n            this.notify('freehand-draw', { prop: 'hoverFhd', onPropertyChange: false,\n                value: { strokeColor: value } });\n            this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                value: { operation: 'freehanddrawCustomized', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                    previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                    previousCropObj: prevCropObj, previousText: null,\n                    currentText: null, previousFilter: null, isCircleCrop: null } });\n        }\n        else if (!this.togglePen) {\n            this.notify('selection', { prop: 'redrawShape', value: { obj: this.activeObj } });\n        }\n        shapeSettings.type = ShapeType.FreehandDraw;\n        var shapeChangedArgs = { action: 'stroke-color', currentShapeSettings: extend({}, shapeSettings, {}, true) };\n        shapeChangedArgs.currentShapeSettings.strokeColor = value;\n        this.trigger('shapeChange', shapeChangedArgs);\n        this.editCompleteArgs = shapeChangedArgs;\n    };\n    /**\n     * Apply Shape stroke width.\n     *\n     * @param { string } id - Specifies the selected item id.\n     * @param { string } type - Specifies the type of selected item.\n     * @param { string } shapeType - Specifies the shape type of selected item.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.updateStrokeWidth = function (id, type, shapeType) {\n        if (this.activeObj.shape && (this.activeObj.shape !== 'path' || (this.activeObj.shape === 'path' &&\n            this.activeObj.pointColl.length > 0))) {\n            var obj = { shapeSettingsObj: {} };\n            this.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: obj } });\n            var shapeSettings = obj['shapeSettingsObj'];\n            var isObjPushed = false;\n            var collLength = this.objColl.length;\n            this.notify('shape', { prop: 'pushActItemIntoObj' });\n            if (collLength !== this.objColl.length) {\n                isObjPushed = true;\n            }\n            var prevCropObj = extend({}, this.cropObj, {}, true);\n            var object = { currObj: {} };\n            this.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n            var prevObj = object['currObj'];\n            prevObj.objColl = extend([], this.objColl, [], true);\n            prevObj.pointColl = extend([], this.pointColl, [], true);\n            prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n            var selPointCollObj = { selPointColl: null };\n            this.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n                value: { obj: selPointCollObj } });\n            prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n            if (isObjPushed) {\n                this.objColl.pop();\n            }\n            this.activeObj.strokeSettings[type === 'width' ? (shapeType === 'text' ? 'outlineWidth' : 'strokeWidth') : 'radius'] = parseInt(id, 10);\n            if (this.activeObj.shape === 'rectangle' || this.activeObj.shape === 'ellipse') {\n                this.activeObj.strokeSettings[type === 'width' ? (shapeType === 'text' ? 'outlineWidth' : 'strokeWidth') : 'radius'] = parseInt(id, 10) - 1;\n            }\n            this.activeObj.strokeSettings[type === 'width' ? (shapeType === 'text' ? 'outlineWidth' : 'strokeWidth') : 'radius'] *= 2;\n            if (type === 'width') {\n                if (shapeType === 'text') {\n                    this.notify('shape', { prop: 'setStrokeSettings', value: { strokeSettings: null, strokeColor: null, fillColor: null,\n                            strokeWidth: null, radius: null, outlineWidth: this.activeObj.strokeSettings.outlineWidth } });\n                }\n                else {\n                    this.notify('shape', { prop: 'setStrokeSettings', value: { strokeSettings: null, strokeColor: null, fillColor: null,\n                            strokeWidth: this.activeObj.strokeSettings.strokeWidth, radius: null, outlineWidth: null } });\n                }\n            }\n            else {\n                this.notify('shape', { prop: 'setStrokeSettings', value: { strokeSettings: null, strokeColor: null, fillColor: null,\n                        strokeWidth: null, radius: this.activeObj.strokeSettings.radius } });\n            }\n            this.objColl.push(this.activeObj);\n            if (this.activeObj.activePoint.width !== 0 || this.activeObj.activePoint.height !== 0) {\n                this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                    value: { operation: 'shapeTransform', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                        previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                        previousCropObj: prevCropObj, previousText: null,\n                        currentText: null, previousFilter: null, isCircleCrop: null } });\n            }\n            this.notify('selection', { prop: 'redrawShape', value: { obj: this.objColl[this.objColl.length - 1] } });\n            var shapeChangedArgs = { action: 'stroke-width', currentShapeSettings: extend({}, shapeSettings, {}, true) };\n            shapeChangedArgs.currentShapeSettings[type === 'width' ? (shapeType === 'text' ? 'outlineWidth' : 'strokeWidth') : 'radius'] = this.activeObj.strokeSettings[type === 'width' ? (shapeType === 'text' ? 'outlineWidth' : 'strokeWidth') : 'radius'];\n            this.trigger('shapeChange', shapeChangedArgs);\n            this.editCompleteArgs = shapeChangedArgs;\n        }\n        else if (this.activeObj.shape && (this.activeObj.shape === 'path' &&\n            this.activeObj.pointColl.length === 0)) {\n            this.activeObj.strokeSettings.strokeWidth = parseInt(id, 10);\n            this.activeObj.strokeSettings.strokeWidth *= 2;\n            if (type === 'width') {\n                if (shapeType === 'text') {\n                    this.notify('shape', { prop: 'setStrokeSettings', value: { strokeSettings: null, strokeColor: null, fillColor: null,\n                            strokeWidth: null, radius: null, outlineWidth: this.activeObj.strokeSettings.outlineWidth } });\n                }\n                else {\n                    this.notify('shape', { prop: 'setStrokeSettings', value: { strokeSettings: null, strokeColor: null, fillColor: null,\n                            strokeWidth: this.activeObj.strokeSettings.strokeWidth, radius: null, outlineWidth: null } });\n                }\n            }\n            else {\n                this.notify('shape', { prop: 'setStrokeSettings', value: { strokeSettings: null, strokeColor: null, fillColor: null,\n                        strokeWidth: null, radius: this.activeObj.strokeSettings.radius } });\n            }\n        }\n    };\n    /**\n     * Apply Shape stroke color.\n     *\n     * @param { string } value - Specifies the selected color item value.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.updateStrokeColor = function (value) {\n        var objt = { shapeSettingsObj: {} };\n        this.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: objt } });\n        var shapeSettings = objt['shapeSettingsObj'];\n        if (this.activeObj.shape && (this.activeObj.shape !== 'path' || (this.activeObj.shape === 'path' &&\n            this.activeObj.pointColl.length > 0))) {\n            var isObjPushed = false;\n            var collLength = this.objColl.length;\n            this.notify('shape', { prop: 'pushActItemIntoObj' });\n            if (collLength !== this.objColl.length) {\n                isObjPushed = true;\n            }\n            var prevCropObj = extend({}, this.cropObj, {}, true);\n            var object = { currObj: {} };\n            this.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n            var prevObj = object['currObj'];\n            prevObj.objColl = extend([], this.objColl, [], true);\n            prevObj.pointColl = extend([], this.pointColl, [], true);\n            prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n            var selPointCollObj = { selPointColl: null };\n            this.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n                value: { obj: selPointCollObj } });\n            prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n            if (isObjPushed) {\n                this.objColl.pop();\n            }\n            this.activeObj.strokeSettings.strokeColor = value;\n            this.notify('shape', { prop: 'setStrokeSettings', value: { strokeSettings: null, strokeColor: this.activeObj.strokeSettings.strokeColor, fillColor: null, strokeWidth: null } });\n            if (!this.togglePen) {\n                this.objColl.push(this.activeObj);\n                if (this.activeObj.activePoint.width !== 0 || this.activeObj.activePoint.height !== 0) {\n                    this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                        value: { operation: 'shapeTransform', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                            previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                            previousCropObj: prevCropObj, previousText: null,\n                            currentText: null, previousFilter: null, isCircleCrop: null } });\n                }\n                this.notify('selection', { prop: 'redrawShape', value: { obj: this.objColl[this.objColl.length - 1] } });\n            }\n        }\n        else if (this.activeObj.shape && (this.activeObj.shape === 'path' &&\n            this.activeObj.pointColl.length === 0)) {\n            this.activeObj.strokeSettings.strokeColor = value;\n            this.notify('shape', { prop: 'setStrokeSettings', value: { strokeSettings: null, strokeColor: this.activeObj.strokeSettings.strokeColor, fillColor: null, strokeWidth: null } });\n        }\n        var shapeChangedArgs = { action: 'stroke-color', currentShapeSettings: extend({}, shapeSettings, {}, true) };\n        shapeChangedArgs.currentShapeSettings.strokeColor = value;\n        this.trigger('shapeChange', shapeChangedArgs);\n        this.editCompleteArgs = shapeChangedArgs;\n    };\n    /**\n     * Apply Shape fill color.\n     *\n     * @param { string } value - Specifies the selected color item value.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.updateFillColor = function (value) {\n        var obj = { shapeSettingsObj: {} };\n        this.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: obj } });\n        var shapeSettings = obj['shapeSettingsObj'];\n        var isObjPushed = false;\n        var collLength = this.objColl.length;\n        this.notify('shape', { prop: 'pushActItemIntoObj' });\n        if (collLength !== this.objColl.length) {\n            isObjPushed = true;\n        }\n        var prevCropObj = extend({}, this.cropObj, {}, true);\n        var object = { currObj: {} };\n        this.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        var prevObj = object['currObj'];\n        prevObj.objColl = extend([], this.objColl, [], true);\n        prevObj.pointColl = extend([], this.pointColl, [], true);\n        prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        this.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: selPointCollObj } });\n        prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        if (isObjPushed) {\n            this.objColl.pop();\n        }\n        this.activeObj.strokeSettings.fillColor = value;\n        this.notify('shape', { prop: 'setStrokeSettings',\n            value: { strokeSettings: null, strokeColor: null, fillColor: this.activeObj.strokeSettings.fillColor,\n                strokeWidth: null } });\n        this.objColl.push(this.activeObj);\n        if (this.activeObj.activePoint.width !== 0 || this.activeObj.activePoint.height !== 0) {\n            this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                value: { operation: 'shapeTransform', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                    previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                    previousCropObj: prevCropObj, previousText: null,\n                    currentText: null, previousFilter: null, isCircleCrop: null } });\n        }\n        this.notify('selection', { prop: 'redrawShape', value: { obj: this.objColl[this.objColl.length - 1] } });\n        var shapeChangedArgs = { action: 'fill-color', currentShapeSettings: extend({}, shapeSettings, {}, true) };\n        this.trigger('shapeChange', shapeChangedArgs);\n        this.editCompleteArgs = shapeChangedArgs;\n    };\n    /**\n     * Apply horizontal flip.\n     *\n     * @param { CanvasRenderingContext2D } ctx - Specifies the canvas context 2D.\n     * @param { boolean } isPreventURC - Specifies to update undo redo collection.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.horizontalFlip = function (ctx, isPreventURC) {\n        var prevCropObj;\n        var prevObj;\n        if (isNullOrUndefined(isPreventURC)) {\n            if (isNullOrUndefined(this.activeObj.imageRatio)) {\n                this.notify('shape', { prop: 'updImgRatioForActObj', onPropertyChange: false });\n            }\n            this.notify('shape', { prop: 'pushActItemIntoObj' });\n            prevCropObj = extend({}, this.cropObj, {}, true);\n            var object = { currObj: {} };\n            this.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n            prevObj = object['currObj'];\n            prevObj.objColl = extend([], this.objColl, [], true);\n            prevObj.pointColl = extend([], this.pointColl, [], true);\n            prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n            var selPointCollObj = { selPointColl: null };\n            this.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n                value: { obj: selPointCollObj } });\n            prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n            this.objColl.pop();\n        }\n        this.notify('toolbar', { prop: 'refreshSlider' });\n        ctx.clearRect(0, 0, this.activeObj.imageCanvas.width, this.activeObj.imageCanvas.height);\n        var activePoint = this.duplicateImage();\n        this.notify('draw', { prop: 'downScaleImgCanvas', onPropertyChange: false,\n            value: { ctx: this.activeObj.imageCanvas.getContext('2d'), isImgAnnotation: true, isHFlip: true, isVFlip: null } });\n        this.activeObj.activePoint = activePoint;\n        this.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate' } });\n        if (isNullOrUndefined(isPreventURC)) {\n            this.objColl.push(this.activeObj);\n            this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                value: { operation: 'imageHFlip', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                    previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                    previousCropObj: prevCropObj, previousText: null,\n                    currentText: null, previousFilter: null, isCircleCrop: null } });\n            this.notify('selection', { prop: 'redrawShape', value: { obj: this.objColl[this.objColl.length - 1] } });\n        }\n    };\n    /**\n     * Apply vertical flip.\n     *\n     * @param { CanvasRenderingContext2D } ctx - Specifies the canvas context 2D.\n     * @param { boolean } isPreventURC - Specifies to update undo redo collection.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.verticalFlip = function (ctx, isPreventURC) {\n        var prevCropObj;\n        var prevObj;\n        if (isNullOrUndefined(isPreventURC)) {\n            if (isNullOrUndefined(this.activeObj.imageRatio)) {\n                this.notify('shape', { prop: 'updImgRatioForActObj', onPropertyChange: false });\n            }\n            this.notify('shape', { prop: 'pushActItemIntoObj' });\n            prevCropObj = extend({}, this.cropObj, {}, true);\n            var object = { currObj: {} };\n            this.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n            prevObj = object['currObj'];\n            prevObj.objColl = extend([], this.objColl, [], true);\n            prevObj.pointColl = extend([], this.pointColl, [], true);\n            prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n            var selPointCollObj = { selPointColl: null };\n            this.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n                value: { obj: selPointCollObj } });\n            prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n            this.objColl.pop();\n        }\n        this.notify('toolbar', { prop: 'refreshSlider' });\n        ctx.clearRect(0, 0, this.activeObj.imageCanvas.width, this.activeObj.imageCanvas.height);\n        var activePoint = this.duplicateImage();\n        this.notify('draw', { prop: 'downScaleImgCanvas', onPropertyChange: false,\n            value: { ctx: this.activeObj.imageCanvas.getContext('2d'), isImgAnnotation: true, isHFlip: null, isVFlip: true } });\n        this.activeObj.activePoint = activePoint;\n        this.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate' } });\n        if (isNullOrUndefined(isPreventURC)) {\n            this.objColl.push(this.activeObj);\n            this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                value: { operation: 'imageVFlip', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                    previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                    previousCropObj: prevCropObj, previousText: null,\n                    currentText: null, previousFilter: null, isCircleCrop: null } });\n            this.notify('selection', { prop: 'redrawShape', value: { obj: this.objColl[this.objColl.length - 1] } });\n        }\n    };\n    /**\n     * Apply rotate image.\n     *\n     * @param { string } rotate - Specifies the direction of rotation.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.rotateImage = function (rotate) {\n        var prevCropObj;\n        var prevObj;\n        if (isNullOrUndefined(this.activeObj.imageRatio)) {\n            this.notify('shape', { prop: 'updImgRatioForActObj', onPropertyChange: false });\n        }\n        this.notify('shape', { prop: 'pushActItemIntoObj' });\n        // eslint-disable-next-line prefer-const\n        prevCropObj = extend({}, this.cropObj, {}, true);\n        var object = { currObj: {} };\n        this.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        // eslint-disable-next-line prefer-const\n        prevObj = object['currObj'];\n        prevObj.objColl = extend([], this.objColl, [], true);\n        prevObj.pointColl = extend([], this.pointColl, [], true);\n        prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        this.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: selPointCollObj } });\n        prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        this.objColl.pop();\n        this.notify('toolbar', { prop: 'refreshSlider' });\n        if (rotate === 'rotleft') {\n            this.activeObj.rotatedAngle -= (90 * (Math.PI / 180));\n        }\n        else {\n            this.activeObj.rotatedAngle += (90 * (Math.PI / 180));\n        }\n        this.notify('selection', { prop: 'updPtCollForShpRot', onPropertyChange: false, value: { obj: this.activeObj } });\n        this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n        this.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate' } });\n        this.objColl.push(this.activeObj);\n        this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n            value: { operation: 'imageRotate', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                previousCropObj: prevCropObj, previousText: null,\n                currentText: null, previousFilter: null, isCircleCrop: null } });\n        this.notify('selection', { prop: 'redrawShape', value: { obj: this.objColl[this.objColl.length - 1] } });\n        this.notify('toolbar', { prop: 'destroy-qa-toolbar' });\n        this.notify('toolbar', { prop: 'renderQAT', onPropertyChange: false, value: { isPenEdit: null } });\n    };\n    /**\n     * Get pascalToSplitWords from string.\n     *\n     * @param { string } str - Specifies the word.\n     * @hidden\n     * @returns {string}.\n     */\n    ImageEditor.prototype.pascalToSplitWords = function (str) {\n        str = str.charAt(0).toUpperCase() + str.slice(1);\n        var splitStr = str.match(/[A-Z][a-z]+/g);\n        if (isNullOrUndefined(splitStr)) {\n            return str;\n        }\n        else {\n            return splitStr.map(function (word) { return word.charAt(0).toUpperCase() + word.slice(1); }).join(' ');\n        }\n    };\n    /**\n     * Get Slider Value.\n     *\n     * @param { string } type - Finetune type.\n     * @hidden\n     * @returns {number}.\n     */\n    ImageEditor.prototype.getCurrAdjustmentValue = function (type) {\n        var value = 100;\n        var indexObj = { freehandSelectedIndex: null };\n        this.notify('freehand-draw', { prop: 'getFreehandSelectedIndex', onPropertyChange: false, value: { obj: indexObj } });\n        if (type === 'transparency' && this.togglePen) {\n            var obj = { penOpacity: 1 };\n            this.notify('freehand-draw', { prop: 'getPenOpacity', onPropertyChange: false, value: { obj: obj } });\n            value = obj['penOpacity'] * 100;\n        }\n        else if (type === 'transparency' && indexObj['freehandSelectedIndex'] !== null && indexObj['freehandSelectedIndex'] !== undefined) {\n            value = this.pointColl[indexObj['freehandSelectedIndex']].opacity * 100;\n        }\n        else {\n            var obj = { adjustmentLevel: null };\n            this.notify('filter', { prop: 'getAdjustmentLevel', onPropertyChange: false,\n                value: { obj: obj } });\n            var typeToAdjustmentLevel = { 'brightness': obj['adjustmentLevel'].brightness,\n                'contrast': obj['adjustmentLevel'].contrast, 'hue': obj['adjustmentLevel'].hue,\n                'saturation': obj['adjustmentLevel'].saturation, 'opacity': obj['adjustmentLevel'].opacity,\n                'blur': obj['adjustmentLevel'].blur, 'exposure': obj['adjustmentLevel'].exposure,\n                'transparency': obj['adjustmentLevel'].transparency, 'straighten': this.transform.straighten };\n            value = typeToAdjustmentLevel[\"\" + type];\n        }\n        return value;\n    };\n    /**\n     * Apply transformSelect.\n     *\n     * @param { string } type - Specifies the selected item text.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.transformSelect = function (type) {\n        if (this.transform.straighten === 0 && (type === 'rotateleft' || type === 'rotateright') &&\n            this.activeObj.shape && (['crop-2:3', 'crop-3:2', 'crop-3:4', 'crop-4:3', 'crop-4:5', 'crop-5:4', 'crop-5:7', 'crop-7:5',\n            'crop-9:16', 'crop-16:9'].indexOf(this.activeObj.shape) !== -1 || (this.activeObj.shape.indexOf('crop-') !== -1 &&\n            this.activeObj.shape !== 'crop-custom' && this.activeObj.shape !== 'crop-square' && this.activeObj.shape !== 'crop-circle'))) {\n            this.activeObj.shape = 'crop-' + this.activeObj.shape.split('-')[1].split(':')[1] + ':' + this.activeObj.shape.split('-')[1].split(':')[0];\n            this.notify('toolbar', { prop: 'performCropTransformClick', value: { shape: this.activeObj.shape, isTransform: true } });\n        }\n        this.isCropToolbar = true;\n        this.allowDownScale = false;\n        var straighten = this.transform.straighten;\n        var straightenObj = extend({}, this.activeObj, {}, true);\n        var zoomFactor = this.transform.zoomFactor;\n        this.prevEventSelectionPoint = extend({}, this.activeObj, {}, true);\n        var object = { currObj: {} };\n        this.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        this.prevEventObjPoint = object['currObj'];\n        this.prevEventObjPoint.objColl = extend([], this.objColl, [], true);\n        this.prevEventObjPoint.pointColl = extend([], this.pointColl, [], true);\n        this.prevEventObjPoint.afterCropActions = extend([], this.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        this.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: selPointCollObj } });\n        this.prevEventObjPoint.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        if (this.transform.straighten !== 0) {\n            this.transform.straighten = 0;\n            this.straightenBaseImageCanvas();\n            for (var i = 0, len = this.objColl.length; i < len; i++) {\n                var shape = this.objColl[i].shape;\n                if (shape !== 'line' && shape !== 'arrow' && shape !== 'path') {\n                    this.objColl[i].rotatedAngle -= (straighten * (Math.PI / 180));\n                    this.notify('selection', { prop: 'updPtCollForShpRot', onPropertyChange: false, value: { obj: this.objColl[i] } });\n                }\n            }\n            this.notify('draw', { prop: 'render-image', value: { isMouseWheel: false } });\n            this.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n                value: { ctx: this.lowerContext, shape: 'zoom', pen: 'zoom', isPreventApply: null } });\n        }\n        this.setInitialZoomState();\n        var activeObj = extend({}, this.activeObj, {}, true);\n        this.notify('crop', { prop: 'setTransformCrop', onPropertyChange: false, value: { bool: true } });\n        this.cropSelectedState();\n        this.notify('crop', { prop: 'setTransformCrop', onPropertyChange: false, value: { bool: false } });\n        this.notify('draw', { prop: 'resetCurrentSelectionPoint' });\n        this.updateImageTransformColl(type);\n        this.notify('transform', { prop: 'performTransformation', value: { text: type } });\n        this.isCropTab = true;\n        this.notify('draw', { prop: 'moveToSelectionRange', value: { type: type, activeObj: activeObj } });\n        if (this.isStraightening && (type === 'horizontalflip' || type === 'verticalflip')) {\n            this.notify('draw', { prop: 'resetStraightenDestPoints' });\n            this.notify('draw', { prop: 'setDestForStraighten' });\n        }\n        if (straighten !== 0) {\n            this.transform.straighten = straighten;\n            this.straightenBaseImageCanvas();\n            for (var i = 0, len = this.objColl.length; i < len; i++) {\n                var shape = this.objColl[i].shape;\n                if (shape !== 'line' && shape !== 'arrow' && shape !== 'path') {\n                    this.objColl[i].rotatedAngle += (straighten * (Math.PI / 180));\n                    this.notify('selection', { prop: 'updPtCollForShpRot', onPropertyChange: false, value: { obj: this.objColl[i] } });\n                }\n            }\n            this.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n                value: { ctx: this.lowerContext, shape: 'zoom', pen: 'zoom', isPreventApply: null } });\n            this.notify('draw', { prop: 'render-image', value: { isMouseWheel: false } });\n            this.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: straightenObj } });\n            this.notify('draw', { prop: 'setStraightenActObj', value: { activeObj: null } });\n            this.notify('draw', { prop: 'setStraightenInitZoom', value: { zoomFactor: zoomFactor } });\n            if ((this.isStraightening && (type === 'horizontalflip' || type === 'verticalflip')) &&\n                isNullOrUndefined(this.transform.zoomFactor) || this.transform.zoomFactor === 0) {\n                if (this.transform.degree === 0) {\n                    this.transform.zoomFactor += 0.025;\n                }\n                else if (this.transform.zoomFactor === 0) {\n                    this.transform.zoomFactor = null;\n                }\n            }\n            this.notify('draw', { prop: 'zoomToSel', value: { activeObj: straightenObj, isToolbar: false } });\n        }\n        this.isCropToolbar = false;\n        var stValPan = this.element.querySelector('.e-ie-straighten-value-span');\n        if (stValPan) {\n            stValPan.innerHTML = this.transform.straighten.toString() + '&#176';\n        }\n    };\n    /**\n     * Returns default filter.\n     *\n     * @hidden\n     * @returns {string}.\n     */\n    ImageEditor.prototype.getDefaultFilter = function () {\n        return 'brightness(' + 1 + ') ' + 'contrast(' + 100 + '%) ' + 'hue-rotate(' + 0 + 'deg) ' +\n            'saturate(' + 100 + '%) ' + 'opacity(' + 1 + ') ' + 'blur(' + 0 + 'px) ' + 'sepia(0%) ' +\n            'grayscale(0%) ' + 'invert(0%)';\n    };\n    /**\n     * Performs Straightening action.\n     *\n     * @param { number } value - Specifies the degree of straightening.\n     * @hidden\n     * @returns {void} .\n     */\n    ImageEditor.prototype.setStraighten = function (value) {\n        var straightenEventArgs = { cancel: false, previousDegree: this.transform.straighten, currentDegree: value };\n        this.trigger('rotating', straightenEventArgs);\n        this.editCompleteArgs = straightenEventArgs;\n        if (!straightenEventArgs.cancel) {\n            this.performStraighten(straightenEventArgs);\n            var actionArgs = { action: 'straighten', actionEventArgs: this.editCompleteArgs };\n            this.triggerEditCompleteEvent(actionArgs);\n        }\n    };\n    ImageEditor.prototype.duplicateImage = function () {\n        var activePoint = extend({}, this.activeObj.activePoint, {}, true);\n        var dimObj = { width: 0, height: 0 };\n        this.notify('transform', { prop: 'calcMaxDimension', onPropertyChange: false,\n            value: { width: this.activeObj.imageElement.width, height: this.activeObj.imageElement.height, obj: dimObj, isImgShape: null } });\n        this.activeObj.activePoint.width = dimObj['width'];\n        this.activeObj.activePoint.height = dimObj['height'];\n        return activePoint;\n    };\n    ImageEditor.prototype.performStraighten = function (straightenEventArgs) {\n        var value = straightenEventArgs.currentDegree;\n        var stValPan = this.element.querySelector('.e-ie-straighten-value-span');\n        if (stValPan) {\n            stValPan.innerHTML = value.toString() + '&#176';\n        }\n        var obj = extend({}, this.activeObj, null, true);\n        this.notify('freehand-draw', { prop: 'setCenterSelPoints' });\n        this.transform.straighten = value;\n        this.straightenPoint = { x: this.activeObj.activePoint.startX + (this.activeObj.activePoint.width / 2),\n            y: this.activeObj.activePoint.startY + (this.activeObj.activePoint.height / 2) };\n        this.straightenBaseImageCanvas();\n        for (var i = 0, len = this.objColl.length; i < len; i++) {\n            var shape = this.objColl[i].shape;\n            if (shape !== 'line' && shape !== 'arrow' && shape !== 'path') {\n                this.objColl[i].rotatedAngle += ((this.transform.straighten - this.prevStraightenedDegree) * (Math.PI / 180));\n                this.notify('selection', { prop: 'updPtCollForShpRot', onPropertyChange: false, value: { obj: this.objColl[i] } });\n            }\n        }\n        if (this.transform.degree % 90 === 0 && this.transform.degree % 180 !== 0) {\n            if (this.transform.straighten === 0) {\n                this.transform.straighten = 360;\n            }\n            this.notify('draw', { prop: 'performPointZoom', onPropertyChange: false,\n                value: { x: this.activeObj.activePoint.startX + (this.activeObj.activePoint.width / 2),\n                    y: this.activeObj.activePoint.startY + (this.activeObj.activePoint.height / 2), type: 'zoomIn', isResize: true } });\n            this.notify('draw', { prop: 'performPointZoom', onPropertyChange: false,\n                value: { x: this.activeObj.activePoint.startX + (this.activeObj.activePoint.width / 2),\n                    y: this.activeObj.activePoint.startY + (this.activeObj.activePoint.height / 2), type: 'zoomOut', isResize: true } });\n            if (this.transform.straighten === 360) {\n                this.transform.straighten = 0;\n            }\n        }\n        else {\n            this.notify('draw', { prop: 'render-image', value: { isMouseWheel: true, isPreventClearRect: null, isFrame: null, isStraighten: true } });\n        }\n        this.notify('draw', { prop: 'drawObject', onPropertyChange: false,\n            value: { canvas: 'duplicate', obj: obj } });\n        this.notify('draw', { prop: 'zoomToSel', value: { activeObj: obj, isToolbar: true } });\n        this.notify('transform', { prop: 'disableZoomOutBtn', value: { isZoomOut: true } });\n        this.prevStraightenedDegree = this.transform.straighten;\n    };\n    /**\n     * Straightens base image.\n     *\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.straightenBaseImageCanvas = function () {\n        if (this.isImageLoaded) {\n            var flipState = this.getStraightenFlipState();\n            var straighten = flipState === 'horizontal' || flipState === 'vertical' ?\n                -this.transform.straighten : this.transform.straighten;\n            var ctx = this.baseImgCanvas.getContext('2d');\n            if (ctx.canvas.width !== this.lowerContext.canvas.width &&\n                ctx.canvas.height !== this.lowerContext.canvas.height) {\n                var obj_6 = { width: 0, height: 0 };\n                this.notify('crop', { prop: 'calcRatio', onPropertyChange: false,\n                    value: { obj: obj_6, dimension: { width: ctx.canvas.width, height: ctx.canvas.height } } });\n            }\n            var dimension = void 0;\n            // eslint-disable-next-line prefer-const\n            dimension = this.getRotatedCanvasDim(this.baseImg.width, this.baseImg.height, this.transform.straighten);\n            this.img.srcWidth = ctx.canvas.width = dimension.width;\n            this.img.srcHeight = ctx.canvas.height = dimension.height;\n            var x = ctx.canvas.width / 2;\n            var y = ctx.canvas.height / 2;\n            ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);\n            ctx.translate(x, y);\n            ctx.rotate(straighten * Math.PI / 180);\n            ctx.drawImage(this.baseImg, -this.baseImg.width / 2, -this.baseImg.height / 2, this.baseImg.width, this.baseImg.height);\n            ctx.setTransform(1, 0, 0, 1, 0, 0);\n            var obj = { width: 0, height: 0 };\n            this.notify('crop', { prop: 'calcRatio', onPropertyChange: false, value: { obj: obj, dimension: { width: ctx.canvas.width, height: ctx.canvas.height } } });\n        }\n    };\n    /**\n     * Returns rotated canvas dimension.\n     *\n     * @param { number } width - Specifies the width of the canvas.\n     * @param { number } height - Specifies the height of the canvas.\n     * @param { number } angle - Specifies the angle of rotation in degrees.\n     * @hidden\n     * @returns {void} .\n     */\n    ImageEditor.prototype.getRotatedCanvasDim = function (width, height, angle) {\n        var angleRad = angle * Math.PI / 180;\n        var cosAngle = Math.cos(angleRad);\n        var sinAngle = Math.sin(angleRad);\n        var minX = Math.min(0, width * cosAngle, height * Math.cos(Math.PI / 2 - angleRad), width * cosAngle + height * Math.cos(Math.PI / 2 - angleRad));\n        var maxX = Math.max(0, width * cosAngle, height * Math.cos(Math.PI / 2 - angleRad), width * cosAngle + height * Math.cos(Math.PI / 2 - angleRad));\n        var minY = Math.min(0, width * sinAngle, height * Math.sin(Math.PI / 2 - angleRad), width * sinAngle + height * Math.sin(Math.PI / 2 - angleRad));\n        var maxY = Math.max(0, width * sinAngle, height * Math.sin(Math.PI / 2 - angleRad), width * sinAngle + height * Math.sin(Math.PI / 2 - angleRad));\n        return { width: Math.ceil(maxX - minX), height: Math.ceil(maxY - minY) };\n    };\n    /**\n     * Apply Shape order.\n     *\n     * @param { string } id - Specifies the id of the shape to change the order.\n     * @param { string } value - Specifies the order of the shapes.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.updateShapeOrder = function (id, value) {\n        var shapeObj = this.getObjFromId(id);\n        if ((shapeObj.shape && (shapeObj.shape !== 'path' ||\n            (shapeObj.shape === 'path' && shapeObj.pointColl.length > 0))) ||\n            (shapeObj && shapeObj['id'] && shapeObj['id'].indexOf('pen') > -1)) {\n            var obj = { shapeSettingsObj: {} };\n            this.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: obj } });\n            var shapeSettings = obj['shapeSettingsObj'];\n            if (shapeObj.shape) {\n                this.notify('shape', { prop: 'pushActItemIntoObj' });\n            }\n            var prevCropObj = extend({}, this.cropObj, {}, true);\n            var object = { currObj: {} };\n            this.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n            var prevObj = object['currObj'];\n            prevObj.objColl = extend([], this.objColl, [], true);\n            prevObj.pointColl = extend([], this.pointColl, [], true);\n            prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n            var selPointCollObj = { selPointColl: null };\n            this.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n                value: { obj: selPointCollObj } });\n            prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n            if (shapeObj.shape) {\n                this.objColl.pop();\n            }\n            this.notify('shape', { prop: 'z-order', onPropertyChange: false, value: { obj: shapeObj, value: value } });\n            if (shapeObj.shape) {\n                this.notify('shape', { prop: 'setStrokeSettings', value: { strokeSettings: null, strokeColor: null, fillColor: null,\n                        strokeWidth: shapeObj.strokeSettings.strokeWidth } });\n                this.objColl.push(shapeObj);\n            }\n            this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                value: { operation: 'shapeTransform', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                    previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                    previousCropObj: prevCropObj, previousText: null,\n                    currentText: null, previousFilter: null, isCircleCrop: null } });\n            if (shapeObj.shape) {\n                this.notify('selection', { prop: 'redrawShape', value: { obj: this.objColl[this.objColl.length - 1] } });\n                this.activeObj.order = shapeObj.order;\n            }\n            var shapeChangedArgs = { action: 'stroke-width', previousShapeSettings: extend({}, shapeSettings, {}, true),\n                currentShapeSettings: extend({}, shapeSettings, {}, true) };\n            shapeChangedArgs.currentShapeSettings.strokeWidth = this.activeObj.strokeSettings.strokeWidth;\n        }\n        else if (this.activeObj.shape && (this.activeObj.shape === 'path' &&\n            this.activeObj.pointColl.length === 0)) {\n            this.notify('shape', { prop: 'setStrokeSettings', value: { strokeSettings: null, strokeColor: null, fillColor: null,\n                    strokeWidth: this.activeObj.strokeSettings.strokeWidth } });\n        }\n    };\n    ImageEditor.prototype.getStraightenFlipState = function () {\n        var flipState = '';\n        if (this.rotateFlipColl.length > 0) {\n            for (var i = 0, len = this.rotateFlipColl.length; i < len; i++) {\n                var curFlip = this.rotateFlipColl[i];\n                if (curFlip === 'horizontal') {\n                    flipState += 'horizontal';\n                }\n                else if (curFlip === 'vertical') {\n                    flipState += 'vertical';\n                }\n                if (flipState === 'horizontalvertical' || flipState === 'verticalhorizontal') {\n                    flipState = '';\n                }\n            }\n        }\n        return flipState;\n    };\n    ImageEditor.prototype.initializeZoomSettings = function () {\n        this.theme = isNullOrUndefined(this.theme) ? 'Bootstrap5' : this.theme;\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        if (isNullOrUndefined(this.zoomSettings.zoomTrigger) || this.zoomSettings.zoomTrigger === 0) {\n            this.zoomSettings.zoomTrigger = (ZoomTrigger.MouseWheel | ZoomTrigger.Pinch | ZoomTrigger.Toolbar | ZoomTrigger.Commands);\n        }\n        if (isNullOrUndefined(this.selectionSettings.strokeColor)) {\n            this.selectionSettings.strokeColor = this.themeColl[this.theme]['primaryColor'];\n        }\n        if (isNullOrUndefined(this.selectionSettings.fillColor)) {\n            this.selectionSettings.fillColor = this.themeColl[this.theme]['secondaryColor'];\n        }\n    };\n    ImageEditor.prototype.initializeThemeColl = function () {\n        this.themeColl = {\n            Bootstrap5: { primaryColor: '#0d6efd', secondaryColor: '#fff' },\n            Bootstrap5Dark: { primaryColor: '#0d6efd', secondaryColor: '#fff' },\n            Tailwind: { primaryColor: '#4f46e5', secondaryColor: '#fff' },\n            TailwindDark: { primaryColor: '#22d3ee', secondaryColor: '#fff' },\n            Fluent: { primaryColor: '#0078d4', secondaryColor: '#fff' },\n            FluentDark: { primaryColor: '#0078d4', secondaryColor: '#fff' },\n            Bootstrap4: { primaryColor: '#007bff', secondaryColor: '#fff' },\n            Bootstrap: { primaryColor: '#317ab9', secondaryColor: '#fff' },\n            BootstrapDark: { primaryColor: '#317ab9', secondaryColor: '#fff' },\n            Material: { primaryColor: '#e3165b', secondaryColor: '#fff' },\n            MaterialDark: { primaryColor: '#00b0ff', secondaryColor: '#fff' },\n            Fabric: { primaryColor: '#0078d6', secondaryColor: '#fff' },\n            FabricDark: { primaryColor: '#0074cc', secondaryColor: '#fff' },\n            Highcontrast: { primaryColor: '#000000', secondaryColor: '#fff' },\n            Material3: { primaryColor: '#6750a4', secondaryColor: '#fff' },\n            Material3Dark: { primaryColor: '#d0bcff', secondaryColor: '#fff' },\n            Fluent2: { primaryColor: '#0f6cbd', secondaryColor: '#fff' },\n            Fluent2Dark: { primaryColor: '#115ea3', secondaryColor: '#fff' },\n            Fluent2Highcontrast: { primaryColor: '#1aebff', secondaryColor: '#fff' },\n            'Bootstrap5.3': { primaryColor: '#0d6efd', secondaryColor: '#fff' },\n            'Bootstrap5.3Dark': { primaryColor: '#0d6efd', secondaryColor: '#fff' }\n        };\n    };\n    /**\n     * Draw a redaction on an image.\n     *\n     * @param {RedactType} type  Optional. Specifies the type of redaction to be drawn on the image such as blur or pixelate. If not specified, the redaction drawing is initiated with the default blur value.\n     * @param {number} x  Optional. Specifies x-coordinate of redaction. If not specified, the redaction drawing is initiated with the first parameter.\n     * @param {number} y  Optional. Specifies y-coordinate of redaction. If not specified it draws redaction from the center point of the image.\n     * @param {number} width  Optional. Specifies the width of the redaction. The default value is 100.\n     * @param {number} height  Optional. Specifies the height of the redaction. The default value is 50.\n     * @param {number} value  Optional. Specifies the blur value for blur-type redaction or the pixel size for pixelate-type redaction. Defaults to 20 since the default redaction is blur.\n     * @returns {boolean}.\n     */\n    ImageEditor.prototype.drawRedact = function (type, x, y, width, height, value) {\n        var isRedact = false;\n        var isPointsInRange = this.allowShape(x, y);\n        if (!this.disabled && this.isImageLoaded && (isPointsInRange || (isNullOrUndefined(x) && isNullOrUndefined(y)))) {\n            isRedact = true;\n            this.notify('shape', {\n                prop: 'drawRedact', onPropertyChange: false, value: {\n                    x: x, y: y, width: width, height: height, type: type, value: value\n                }\n            });\n            this.notify('draw', { prop: 'redrawDownScale' });\n        }\n        return isRedact;\n    };\n    var ImageEditor_1;\n    __decorate([\n        Property('')\n    ], ImageEditor.prototype, \"cssClass\", void 0);\n    __decorate([\n        Property(false)\n    ], ImageEditor.prototype, \"disabled\", void 0);\n    __decorate([\n        Property('100%')\n    ], ImageEditor.prototype, \"height\", void 0);\n    __decorate([\n        Property('Bootstrap5')\n    ], ImageEditor.prototype, \"theme\", void 0);\n    __decorate([\n        Property()\n    ], ImageEditor.prototype, \"toolbar\", void 0);\n    __decorate([\n        Property()\n    ], ImageEditor.prototype, \"toolbarTemplate\", void 0);\n    __decorate([\n        Property('100%')\n    ], ImageEditor.prototype, \"width\", void 0);\n    __decorate([\n        Property(true)\n    ], ImageEditor.prototype, \"allowUndoRedo\", void 0);\n    __decorate([\n        Property(true)\n    ], ImageEditor.prototype, \"showQuickAccessToolbar\", void 0);\n    __decorate([\n        Property()\n    ], ImageEditor.prototype, \"quickAccessToolbarTemplate\", void 0);\n    __decorate([\n        Property(false)\n    ], ImageEditor.prototype, \"isReadOnly\", void 0);\n    __decorate([\n        Property(false)\n    ], ImageEditor.prototype, \"enableRtl\", void 0);\n    __decorate([\n        Property(false)\n    ], ImageEditor.prototype, \"enablePersistence\", void 0);\n    __decorate([\n        Complex({}, FinetuneSettings)\n    ], ImageEditor.prototype, \"finetuneSettings\", void 0);\n    __decorate([\n        Complex({}, ZoomSettings)\n    ], ImageEditor.prototype, \"zoomSettings\", void 0);\n    __decorate([\n        Complex({}, SelectionSettings)\n    ], ImageEditor.prototype, \"selectionSettings\", void 0);\n    __decorate([\n        Complex({}, FontFamily)\n    ], ImageEditor.prototype, \"fontFamily\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"beforeSave\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"created\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"destroyed\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"zooming\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"panning\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"cropping\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"rotating\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"flipping\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"shapeChanging\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"selectionChanging\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"fileOpened\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"saved\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"toolbarCreated\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"toolbarUpdating\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"toolbarItemClicked\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"imageFiltering\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"finetuneValueChanging\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"click\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"shapeChange\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"quickAccessToolbarOpen\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"resizing\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"quickAccessToolbarItemClick\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"frameChange\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"editComplete\", void 0);\n    ImageEditor = ImageEditor_1 = __decorate([\n        NotifyPropertyChanges\n    ], ImageEditor);\n    return ImageEditor;\n}(Component));\nexport { ImageEditor };\n","/**\n * An enum representing the file types supported by the image editor.\n *\n * @enum {string}\n */\nexport var FileType;\n(function (FileType) {\n    /** The PNG file type. */\n    FileType[\"Png\"] = \"Png\";\n    /** The JPEG file type. */\n    FileType[\"Jpeg\"] = \"Jpeg\";\n    /** The SVG file type. */\n    FileType[\"Svg\"] = \"Svg\";\n})(FileType || (FileType = {}));\n/**\n * An enumeration representing the direction of an image editor operation.\n *\n * @enum {string}\n */\nexport var Direction;\n(function (Direction) {\n    /** The horizontal direction. */\n    Direction[\"Horizontal\"] = \"Horizontal\";\n    /** The vertical direction. */\n    Direction[\"Vertical\"] = \"Vertical\";\n})(Direction || (Direction = {}));\n/**\n * An enumeration representing the type of shape to be added in the image editor.\n *\n * @enum {string}\n */\nexport var ShapeType;\n(function (ShapeType) {\n    /** A rectangle shape. */\n    ShapeType[\"Rectangle\"] = \"Rectangle\";\n    /** An ellipse shape. */\n    ShapeType[\"Ellipse\"] = \"Ellipse\";\n    /** A line shape. */\n    ShapeType[\"Line\"] = \"Line\";\n    /** An arrow shape. */\n    ShapeType[\"Arrow\"] = \"Arrow\";\n    /** A path shape. */\n    ShapeType[\"Path\"] = \"Path\";\n    /** A text shape. */\n    ShapeType[\"Text\"] = \"Text\";\n    /** A freehand drawing shape. */\n    ShapeType[\"FreehandDraw\"] = \"FreehandDraw\";\n    /** An Image shape. */\n    ShapeType[\"Image\"] = \"Image\";\n})(ShapeType || (ShapeType = {}));\n/**\n * An enumeration representing the different ways to trigger zooming in the image editor.\n *\n * @aspNumberEnum\n */\nexport var ZoomTrigger;\n(function (ZoomTrigger) {\n    /** Zooming triggered by mouse wheel. */\n    ZoomTrigger[ZoomTrigger[\"MouseWheel\"] = 1] = \"MouseWheel\";\n    /** Zooming triggered by pinch gesture. */\n    ZoomTrigger[ZoomTrigger[\"Pinch\"] = 2] = \"Pinch\";\n    /** Zooming triggered by command keys. */\n    ZoomTrigger[ZoomTrigger[\"Commands\"] = 4] = \"Commands\";\n    /** Zooming triggered by toolbar button click. */\n    ZoomTrigger[ZoomTrigger[\"Toolbar\"] = 8] = \"Toolbar\";\n})(ZoomTrigger || (ZoomTrigger = {}));\n/**\n * * An enum representing the available themes in the image editor.\n */\nexport var Theme;\n(function (Theme) {\n    /** The Bootstrap 5 theme. */\n    Theme[\"Bootstrap5\"] = \"Bootstrap5\";\n    /** The dark variant of the Bootstrap 5 theme. */\n    Theme[\"Bootstrap5Dark\"] = \"Bootstrap5Dark\";\n    /** The Tailwind CSS theme. */\n    Theme[\"Tailwind\"] = \"Tailwind\";\n    /** The dark variant of the Tailwind CSS theme. */\n    Theme[\"TailwindDark\"] = \"TailwindDark\";\n    /** The Fluent UI theme. */\n    Theme[\"Fluent\"] = \"Fluent\";\n    /** The dark variant of the Fluent UI theme. */\n    Theme[\"FluentDark\"] = \"FluentDark\";\n    /** The Bootstrap 4 theme. */\n    Theme[\"Bootstrap4\"] = \"Bootstrap4\";\n    /** The Bootstrap theme. */\n    Theme[\"Bootstrap\"] = \"Bootstrap\";\n    /** The dark variant of the Bootstrap theme. */\n    Theme[\"BootstrapDark\"] = \"BootstrapDark\";\n    /** The Material Design theme. */\n    Theme[\"Material\"] = \"Material\";\n    /** The dark variant of the Material Design theme. */\n    Theme[\"MaterialDark\"] = \"MaterialDark\";\n    /** The Fabric theme. */\n    Theme[\"Fabric\"] = \"Fabric\";\n    /** The dark variant of the Fabric theme. */\n    Theme[\"FabricDark\"] = \"FabricDark\";\n    /** The high contrast theme. */\n    Theme[\"Highcontrast\"] = \"Highcontrast\";\n    /** The Fluent 2.0 UI theme. */\n    Theme[\"Fluent2\"] = \"Fluent2\";\n    /** The dark variant of the Fluent 2.0 UI theme. */\n    Theme[\"Fluent2Dark\"] = \"Fluent2Dark\";\n})(Theme || (Theme = {}));\n/**\n * An enum representing the available toolbar commands in the image editor.\n */\nexport var ImageEditorCommand;\n(function (ImageEditorCommand) {\n    ImageEditorCommand[\"Crop\"] = \"Crop\";\n    ImageEditorCommand[\"Transform\"] = \"Transform\";\n    ImageEditorCommand[\"Annotate\"] = \"Annotate\";\n    ImageEditorCommand[\"ZoomIn\"] = \"ZoomIn\";\n    ImageEditorCommand[\"ZoomOut\"] = \"ZoomOut\";\n    ImageEditorCommand[\"Open\"] = \"Open\";\n    ImageEditorCommand[\"Reset\"] = \"Reset\";\n    ImageEditorCommand[\"Save\"] = \"Save\";\n    ImageEditorCommand[\"Pan\"] = \"Pan\";\n    ImageEditorCommand[\"Move\"] = \"Move\";\n    ImageEditorCommand[\"Pen\"] = \"Pen\";\n    ImageEditorCommand[\"Line\"] = \"Line\";\n    ImageEditorCommand[\"Arrow\"] = \"Arrow\";\n    ImageEditorCommand[\"Path\"] = \"Path\";\n    ImageEditorCommand[\"Rectangle\"] = \"Rectangle\";\n    ImageEditorCommand[\"Image\"] = \"Image\";\n    ImageEditorCommand[\"Ellipse\"] = \"Ellipse\";\n    ImageEditorCommand[\"Text\"] = \"Text\";\n    ImageEditorCommand[\"CustomSelection\"] = \"CustomSelection\";\n    ImageEditorCommand[\"CircleSelection\"] = \"CircleSelection\";\n    ImageEditorCommand[\"SquareSelection\"] = \"SquareSelection\";\n    ImageEditorCommand[\"RatioSelection\"] = \"RatioSelection\";\n    ImageEditorCommand[\"RotateLeft\"] = \"RotateLeft\";\n    ImageEditorCommand[\"RotateRight\"] = \"RotateRight\";\n    ImageEditorCommand[\"FlipHorizontal\"] = \"FlipHorizontal\";\n    ImageEditorCommand[\"FlipVertical\"] = \"FlipVertical\";\n    ImageEditorCommand[\"Undo\"] = \"Undo\";\n    ImageEditorCommand[\"Redo\"] = \"Redo\";\n    ImageEditorCommand[\"None\"] = \"None\";\n    ImageEditorCommand[\"Mat\"] = \"Mat\";\n    ImageEditorCommand[\"Bevel\"] = \"Bevel\";\n    ImageEditorCommand[\"Inset\"] = \"Inset\";\n    ImageEditorCommand[\"Hook\"] = \"Hook\";\n    ImageEditorCommand[\"Finetune\"] = \"Finetune\";\n    ImageEditorCommand[\"Filter\"] = \"Filter\";\n    ImageEditorCommand[\"Frame\"] = \"Frame\";\n    ImageEditorCommand[\"Resize\"] = \"Resize\";\n    ImageEditorCommand[\"HorizontalFlip\"] = \"HorizontalFlip\";\n    ImageEditorCommand[\"VerticalFlip\"] = \"VerticalFlip\";\n    ImageEditorCommand[\"Brightness\"] = \"Brightness\";\n    ImageEditorCommand[\"Contrast\"] = \"Contrast\";\n    ImageEditorCommand[\"Hue\"] = \"Hue\";\n    ImageEditorCommand[\"Saturation\"] = \"Saturation\";\n    ImageEditorCommand[\"Opacity\"] = \"Opacity\";\n    ImageEditorCommand[\"Blur\"] = \"Blur\";\n    ImageEditorCommand[\"Exposure\"] = \"Exposure\";\n    ImageEditorCommand[\"Default\"] = \"Default\";\n    ImageEditorCommand[\"Chrome\"] = \"Chrome\";\n    ImageEditorCommand[\"Cold\"] = \"Cold\";\n    ImageEditorCommand[\"Warm\"] = \"Warm\";\n    ImageEditorCommand[\"Grayscale\"] = \"Grayscale\";\n    ImageEditorCommand[\"Sepia\"] = \"Sepia\";\n    ImageEditorCommand[\"Invert\"] = \"Invert\";\n    ImageEditorCommand[\"Straightening\"] = \"Straightening\";\n})(ImageEditorCommand || (ImageEditorCommand = {}));\n/**\n * An enumeration of available image filter options.\n *\n * @remarks\n * These options can be used with the `applyImageFilter` method of the image editor control to apply filters to an image.\n */\nexport var ImageFilterOption;\n(function (ImageFilterOption) {\n    /** Default filter */\n    ImageFilterOption[\"Default\"] = \"Default\";\n    /** Chrome filter */\n    ImageFilterOption[\"Chrome\"] = \"Chrome\";\n    /** Cold filter */\n    ImageFilterOption[\"Cold\"] = \"Cold\";\n    /** Warm filter */\n    ImageFilterOption[\"Warm\"] = \"Warm\";\n    /** Grayscale filter */\n    ImageFilterOption[\"Grayscale\"] = \"Grayscale\";\n    /** Sepia filter */\n    ImageFilterOption[\"Sepia\"] = \"Sepia\";\n    /** Invert filter */\n    ImageFilterOption[\"Invert\"] = \"Invert\";\n})(ImageFilterOption || (ImageFilterOption = {}));\n/**\n * An enumeration of available image finetune options.\n *\n * @remarks\n * These options can be used with the `finetuneImage` method of the image editor control to apply finetuning to an image.\n */\nexport var ImageFinetuneOption;\n(function (ImageFinetuneOption) {\n    /** Adjust the brightness of the image */\n    ImageFinetuneOption[\"Brightness\"] = \"Brightness\";\n    /** Adjust the contrast of the image */\n    ImageFinetuneOption[\"Contrast\"] = \"Contrast\";\n    /** Adjust the hue of the image */\n    ImageFinetuneOption[\"Hue\"] = \"Hue\";\n    /** Adjust the saturation of the image */\n    ImageFinetuneOption[\"Saturation\"] = \"Saturation\";\n    /** Adjust the exposure of the image */\n    ImageFinetuneOption[\"Exposure\"] = \"Exposure\";\n    /** Adjust the opacity of the image */\n    ImageFinetuneOption[\"Opacity\"] = \"Opacity\";\n    /** Adjust the blur of the image */\n    ImageFinetuneOption[\"Blur\"] = \"Blur\";\n})(ImageFinetuneOption || (ImageFinetuneOption = {}));\n/**\n * Specifies the type of arrowhead should be drawn.\n *\n */\nexport var ArrowheadType;\n(function (ArrowheadType) {\n    /** Indicates no arrowhead should be drawn. */\n    ArrowheadType[\"None\"] = \"None\";\n    /** Indicates a normal triangle-shaped arrowhead should be drawn. */\n    ArrowheadType[\"Arrow\"] = \"Arrow\";\n    /** Indicates a solid triangle-shaped arrowhead should be drawn. */\n    ArrowheadType[\"SolidArrow\"] = \"SolidArrow\";\n    /** Indicates a circular-shaped arrowhead should be drawn. */\n    ArrowheadType[\"Circle\"] = \"Circle\";\n    /** Indicates a solid circular-shaped arrowhead should be drawn. */\n    ArrowheadType[\"SolidCircle\"] = \"SolidCircle\";\n    /** Indicates a square-shaped arrowhead should be drawn. */\n    ArrowheadType[\"Square\"] = \"Square\";\n    /** Indicates a solid square-shaped arrowhead should be drawn. */\n    ArrowheadType[\"SolidSquare\"] = \"SolidSquare\";\n    /** Indicates a bar shaped arrowhead should be drawn. */\n    ArrowheadType[\"Bar\"] = \"Bar\";\n})(ArrowheadType || (ArrowheadType = {}));\n/**\n * An enumeration of available frame options.\n *\n * @remarks\n * These options can be used with the `drawFrame` method of the image editor control to draw frames on an image.\n */\nexport var FrameType;\n(function (FrameType) {\n    /** Represents a no frame. */\n    FrameType[\"None\"] = \"None\";\n    /** Represents a mat frame. */\n    FrameType[\"Mat\"] = \"Mat\";\n    /** Represents a bevel frame. */\n    FrameType[\"Bevel\"] = \"Bevel\";\n    /** Represents a line frame. */\n    FrameType[\"Line\"] = \"Line\";\n    /** Represents an inset frame. */\n    FrameType[\"Inset\"] = \"Inset\";\n    /** Represents a hook frame. */\n    FrameType[\"Hook\"] = \"Hook\";\n})(FrameType || (FrameType = {}));\n/**\n * An enumeration of available line options.\n *\n * @remarks\n * These options can be used with the `drawFrame` method of the image editor control to draw frames on an image.\n */\nexport var FrameLineStyle;\n(function (FrameLineStyle) {\n    /** Represents a solid line. */\n    FrameLineStyle[\"Solid\"] = \"Solid\";\n    /** Represents a dashed line. */\n    FrameLineStyle[\"Dashed\"] = \"Dashed\";\n    /** Represents a dotted line. */\n    FrameLineStyle[\"Dotted\"] = \"Dotted\";\n})(FrameLineStyle || (FrameLineStyle = {}));\n/**\n * An enumeration representing the type of redaction to be added in the image editor.\n *\n * @enum {string}\n */\nexport var RedactType;\n(function (RedactType) {\n    /** Represents a blur redaction. */\n    RedactType[\"Blur\"] = \"Blur\";\n    /** Represents a pixelate redaction. */\n    RedactType[\"Pixelate\"] = \"Pixelate\";\n})(RedactType || (RedactType = {}));\n","import { extend, Browser, detach, select } from '@syncfusion/ej2-base';\nimport { EventHandler, getComponent, isNullOrUndefined, L10n } from '@syncfusion/ej2-base';\nimport { NumericTextBox } from '@syncfusion/ej2-inputs';\nimport { Toolbar } from '@syncfusion/ej2-navigations';\nimport { Button } from '@syncfusion/ej2-buttons';\nimport { DropDownButton } from '@syncfusion/ej2-splitbuttons';\nimport { ColorPicker, Uploader, Slider, TextBox } from '@syncfusion/ej2-inputs';\nimport { ZoomTrigger, ShapeType } from '../index';\nimport { Dialog, hideSpinner, showSpinner } from '@syncfusion/ej2-popups';\nimport { addClass, removeClass } from '@syncfusion/ej2-base';\nvar ToolbarModule = /** @class */ (function () {\n    function ToolbarModule(parent) {\n        this.defToolbarItems = [];\n        this.toolbarHeight = 46;\n        this.currToolbar = '';\n        this.preventZoomBtn = false;\n        this.currentToolbar = 'main';\n        this.selFhdColor = '#42a5f5';\n        this.preventEnableDisableUr = false;\n        this.isAspectRatio = true;\n        this.isFrameToolbar = false;\n        this.presetColors = {\n            'custom': ['#000000', '#f44336', '#e91e63', '#9c27b0', '#673ab7', '#2196f3',\n                '#03a9f4', '#00bcd4', '#009688', '#ffeb3b', '#ffffff', '#ffebee', '#fce4ec', '#f3e5f5', '#ede7f6', '#e3f2fd',\n                '#e1f5fe', '#e0f7fa', '#e0f2f1', '#fffde7', '#f2f2f2', '#ffcdd2', '#f8bbd0', '#e1bee7', '#d1c4e9', '#bbdefb',\n                '#b3e5fc', '#b2ebf2', '#b2dfdb', '#fff9c4', '#e6e6e6', '#ef9a9a', '#f48fb1', '#ce93d8', '#b39ddb', '#90caf9',\n                '#81d4fa', '#80deea', '#80cbc4', '#fff59d', '#cccccc', '#e57373', '#f06292', '#ba68c8', '#9575cd', '#64b5f6',\n                '#4fc3f7', '#4dd0e1', '#4db6ac', '#fff176', '#b3b3b3', '#ef5350', '#ec407a', '#ab47bc', '#7e57c2', '#42a5f5',\n                '#29b6f6', '#26c6da', '#26a69a', '#ffee58', '#999999', '#e53935', '#d81b60', '#8e24aa', '#5e35b1', '#1e88e5',\n                '#039be5', '#00acc1', '#00897b', '#fdd835', '#808080', '#d32f2f', '#c2185b', '#7b1fa2', '#512da8', '#1976d2',\n                '#0288d1', '#0097a7', '#00796b', '#fbc02d', '#666666', '#c62828', '#ad1457', '#6a1b9a', '#4527a0', '#1565c0',\n                '#0277bd', '#00838f', '#00695c', '#f9a825', '#4d4d4d', '#b71c1c', '#880e4f', '#4a148c', '#311b92', '#0d47a1',\n                '#01579b', '#006064', '#004d40', '#f57f17']\n        };\n        this.isSlider = false;\n        this.currentQuality = 1;\n        this.imageQuality = 'highest';\n        this.parent = parent;\n        this.addEventListener();\n        this.initLocale();\n    }\n    ToolbarModule.prototype.destroy = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.removeEventListener();\n    };\n    ToolbarModule.prototype.addEventListener = function () {\n        this.parent.on('toolbar', this.toolbar, this);\n        this.parent.on('destroyed', this.destroy, this);\n    };\n    ToolbarModule.prototype.removeEventListener = function () {\n        this.parent.off('toolbar', this.toolbar);\n        this.parent.off('destroyed', this.destroy);\n    };\n    ToolbarModule.prototype.initLocale = function () {\n        this.defaultLocale = {\n            Crop: 'Crop',\n            ZoomIn: 'Zoom In',\n            ZoomOut: 'Zoom Out',\n            Undo: 'Undo',\n            Redo: 'Redo',\n            Transform: 'Transform',\n            Annotation: 'Annotation',\n            Finetune: 'Finetune',\n            Brightness: 'Brightness',\n            Contrast: 'Contrast',\n            Hue: 'Hue',\n            Saturation: 'Saturation',\n            Opacity: 'Opacity',\n            Blur: 'Blur',\n            Sharpen: 'Sharpen',\n            Exposure: 'Exposure',\n            Filter: 'Filter',\n            Default: 'Default',\n            Chrome: 'Chrome',\n            Cold: 'Cold',\n            Warm: 'Warm',\n            Grayscale: 'Grayscale',\n            BlackAndWhite: 'Black and White',\n            Sepia: 'Sepia',\n            Invert: 'Invert',\n            Text: 'Add Text',\n            Pen: 'Pen',\n            Reset: 'Reset',\n            Save: 'Save',\n            Select: 'Select',\n            RotateLeft: 'Rotate Left',\n            RotateRight: 'Rotate Right',\n            HorizontalFlip: 'Horizontal Flip',\n            VerticalFlip: 'Vertical Flip',\n            OK: 'Apply',\n            Cancel: 'Discard',\n            FillColor: 'Fill Color',\n            StrokeColor: 'Stroke Color',\n            StrokeWidth: 'Stroke Width',\n            FontFamily: 'Font Family',\n            FontStyle: 'Font Style',\n            FontSize: 'Font Size',\n            FontColor: 'Font Color',\n            Pan: 'Pan',\n            Move: 'Move',\n            Load: 'Load',\n            Custom: 'Custom',\n            Square: 'Square',\n            Circle: 'Circle',\n            Ellipse: 'Ellipse',\n            Rectangle: 'Rectangle',\n            Line: 'Line',\n            Arrow: 'Arrow',\n            Path: 'Path',\n            Bold: 'Bold',\n            Italic: 'Italic',\n            BoldItalic: 'Bold Italic',\n            XSmall: 'X-Small',\n            Small: 'Small',\n            Medium: 'Medium',\n            Large: 'Large',\n            XLarge: 'X-Large',\n            ABC: 'ABC',\n            Browse: 'Browse',\n            Duplicate: 'Duplicate',\n            Remove: 'Remove',\n            EditText: 'Edit Text',\n            Start: 'Start',\n            End: 'End',\n            Bar: 'Bar',\n            ArrowSolid: 'Arrow Solid',\n            CircleSolid: 'Circle Solid',\n            SquareSolid: 'Square Solid',\n            None: 'None',\n            CropAndTransform: 'Crop and Transform',\n            CropSelection: 'Crop Selection',\n            Image: 'Add Image',\n            Transparency: 'Transparency',\n            Height: 'Height',\n            Width: 'Width',\n            AspectRatio: 'Maintain aspect ratio',\n            W: 'W',\n            H: 'H',\n            DragText: 'Drag and drop your image here or',\n            DropText: 'Drop your image here or',\n            BrowseText: 'Browse here...',\n            SupportText: 'Supports:',\n            Frame: 'Frame',\n            Mat: 'Mat',\n            Bevel: 'Bevel',\n            Inset: 'Inset',\n            Hook: 'Hook',\n            Color: 'Color',\n            Size: 'Size',\n            Offset: 'Offset',\n            Radius: 'Radius',\n            Amount: 'Amount',\n            Resize: 'Resize',\n            0: '0%',\n            20: '20%',\n            40: '40%',\n            60: '60%',\n            80: '80%',\n            100: '100%',\n            1: '1',\n            2: '2',\n            3: '3',\n            4: '4',\n            5: '5',\n            Border: 'Border',\n            Solid: 'Solid',\n            Dashed: 'Dashed',\n            Dotted: 'Dotted',\n            GradientColor: 'Gradient Color',\n            ConfirmDialogHeader: 'Confirm Save Changes',\n            ConfirmDialogContent: 'Do you want to save the changes you made to the image?',\n            AlertDialogHeader: 'Unsupported file',\n            AlertDialogContent: 'The selected file is unsupported.',\n            Yes: 'Yes',\n            No: 'No',\n            ImageErrorDialogHeader: 'Image Selection Error',\n            ImageErrorDialogContent: 'Please select only one image to open.',\n            Straighten: 'Straighten',\n            NoOutline: 'No outline',\n            DlgOK: 'OK',\n            SaveAs: 'Save As',\n            ImageName: 'Image name',\n            Format: 'Format',\n            Quality: 'Quality',\n            Download: 'Download',\n            Close: 'Close',\n            ImageSize: 'Image Size',\n            QualityInfo: 'The image quality option is only available for JPEG format',\n            Good: 'Good',\n            Great: 'Great',\n            Highest: 'Highest',\n            BringForward: 'Bring Forward',\n            SendBackward: 'Send Backward',\n            SendToBack: 'Send to Back',\n            BringToFront: 'Bring to Front',\n            ZOrder: 'Z-Order',\n            Redact: 'Redact',\n            Pixelate: 'Pixelate',\n            BorderRadius: 'Border Radius',\n            TextOutlineColor: 'Outline Color',\n            TextOutlineWidth: 'Outline Width',\n            PixelSize: 'Pixel Size',\n            And: 'and'\n        };\n        this.l10n = new L10n('image-editor', this.defaultLocale, this.parent.locale);\n    };\n    ToolbarModule.prototype.toolbar = function (args) {\n        var parent = this.parent;\n        this.updatePrivateVariables();\n        switch (args.prop) {\n            case 'create-toolbar':\n                this.createToolbar();\n                break;\n            case 'create-contextual-toolbar':\n                this.createContextualToolbar();\n                break;\n            case 'update-toolbar-items':\n                this.updateToolbarItems();\n                break;\n            case 'refresh-toolbar':\n                this.refreshToolbar(args.value['type'], args.value['isApplyBtn'], args.value['isCropping'], args.value['isZooming'], args.value['cType']);\n                break;\n            case 'renderQAT':\n                this.renderQAT(args.value['isPenEdit']);\n                break;\n            case 'enable-disable-btns':\n                this.enableDisableTbrBtn();\n                break;\n            case 'init-main-toolbar':\n                this.initMainToolbar(args.value['isApplyBtn'], args.value['isDevice'], args.value['isOkBtn'], args.value['isResize'], args.value['isFrame'], args.value['isMainToolbar']);\n                break;\n            case 'create-bottom-toolbar':\n                this.createBottomToolbar();\n                break;\n            case 'refresh-main-toolbar':\n                this.refreshMainToolbar();\n                break;\n            case 'create-qa-toolbar':\n                this.createQuickAccessToolbar();\n                break;\n            case 'destroy-qa-toolbar':\n                this.destroyQuickAccessToolbar();\n                break;\n            case 'zoom-up-handler':\n                this.zoomBtnMouseUpHandler();\n                break;\n            case 'refresh-dropdown-btn':\n                this.refreshDropDownBtn(args.value['isDisabled']);\n                break;\n            case 'close-contextual-toolbar':\n                this.closeContextualToolbar();\n                break;\n            case 'destroy-bottom-toolbar':\n                this.destroyBottomToolbar();\n                break;\n            case 'destroy-top-toolbar':\n                this.destroyTopToolbar();\n                break;\n            case 'destroySubComponents':\n                this.destroySubComponents();\n                break;\n            case 'setLocale':\n                this.l10n.setLocale(args.value['locale']);\n                break;\n            case 'setPreventZoomBtn':\n                this.preventZoomBtn = args.value['isPrevent'];\n                break;\n            case 'getToolbarHeight':\n                args.value['obj']['toolbarHeight'] = this.toolbarHeight;\n                break;\n            case 'setToolbarHeight':\n                if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.length > 0 && parent.toolbar.indexOf('Open') > -1)) {\n                    this.toolbarHeight = args.value['height'];\n                }\n                break;\n            case 'setCurrentToolbar':\n                this.currentToolbar = args.value['type'];\n                break;\n            case 'setSelectedFreehandColor':\n                this.selFhdColor = args.value['color'];\n                break;\n            case 'setInitialAdjustmentValue':\n                parent.initialAdjustmentValue = args.value['value'];\n                break;\n            case 'getCanvasFilter':\n                args.value['obj']['canvasFilter'] = parent.canvasFilter;\n                break;\n            case 'getDefToolbarItems':\n                args.value['obj']['defToolbarItems'] = this.defToolbarItems;\n                break;\n            case 'getPenStroke':\n                this.getPenStroke(args.value['value']);\n                break;\n            case 'performDefToolbarClickAction':\n                this.performDefTbrClick(args.value['type'], args.value['isContextualToolbar'], args.value['isDisabledAdjustment'], args.value['isDisabledFilter'], args.value['isFilterFinetune']);\n                break;\n            case 'setTempFilterProperties':\n                parent.setTempFilterProperties();\n                break;\n            case 'refreshSlider':\n                this.refreshSlider();\n                break;\n            case 'getCurrAdjustmentValue':\n                parent.getCurrAdjustmentValue(args.value['type']);\n                break;\n            case 'setCurrAdjustmentValue':\n                parent.setCurrAdjustmentValue(args.value['type'], args.value['value']);\n                break;\n            case 'refreshShapeDrawing':\n                this.refreshShapeDrawing();\n                break;\n            case 'setEnableDisableUndoRedo':\n                this.preventEnableDisableUr = args.value['isPrevent'];\n                break;\n            case 'reset':\n                this.reset();\n                break;\n            case 'getLocaleText':\n                args.value['obj']['value'] = this.l10n.getConstant(args.value['obj']['key']);\n                break;\n            case 'initResizeToolbar':\n                this.initResizeToolbar();\n                break;\n            case 'getFrameToolbar':\n                args.value['obj']['bool'] = this.isFrameToolbar;\n                break;\n            case 'resizeClick':\n                this.resizeClick();\n                break;\n            case 'frameToolbarClick':\n                this.frameToolbarClick();\n                break;\n            case 'performCropTransformClick':\n                this.performCropTransformClick(args.value['shape'], args.value['isTransform']);\n                break;\n            case 'duplicateShape':\n                this.duplicateShape(args.value['isPreventUndoRedo'], true);\n                break;\n            case 'editText':\n                this.editText();\n                break;\n            case 'setInitialSize':\n                this.initialSize = Number(args.value['value']);\n                break;\n            case 'widthPress':\n                this.widthPress(args.value['e']);\n                break;\n            case 'heightPress':\n                this.heightPress(args.value['e']);\n                break;\n            case 'widthAspectRatio':\n                this.widthAspectRatio(args.value['e']);\n                break;\n            case 'heightAspectRatio':\n                this.heightAspectRatio(args.value['e']);\n                break;\n        }\n    };\n    ToolbarModule.prototype.updatePrivateVariables = function () {\n        var parent = this.parent;\n        this.inMemoryCanvas = parent.inMemoryCanvas;\n        if (parent.lowerCanvas) {\n            this.lowerContext = parent.lowerCanvas.getContext('2d');\n        }\n        if (parent.upperCanvas) {\n            this.upperContext = parent.upperCanvas.getContext('2d');\n        }\n        if (this.inMemoryCanvas) {\n            this.inMemoryContext = this.inMemoryCanvas.getContext('2d');\n        }\n    };\n    ToolbarModule.prototype.reset = function () {\n        var parent = this.parent;\n        this.toolbarHeight = 46;\n        parent.prevCurrSelectionPoint = null;\n        this.zoomBtnHold = null;\n        this.currToolbar = '';\n        parent.cxtTbarHeight = null;\n        this.currentToolbar = 'main';\n        this.selFhdColor = '#42a5f5';\n        parent.currentFilter = '';\n        this.preventZoomBtn = parent.isCropToolbar = this.preventEnableDisableUr = this.isFrameToolbar = false;\n        parent.initialAdjustmentValue = parent.canvasFilter =\n            'brightness(' + 1 + ') ' + 'contrast(' + 100 + '%) ' + 'hue-rotate(' + 0 + 'deg) ' +\n                'saturate(' + 100 + '%) ' + 'opacity(' + 1 + ') ' + 'blur(' + 0 + 'px) ' + 'sepia(0%) ' + 'grayscale(0%) ' + 'invert(0%)';\n        parent.tempStraighten = 0;\n        parent.isStraightening = false;\n    };\n    ToolbarModule.prototype.destroyTopToolbar = function () {\n        var parent = this.parent;\n        var toolbar = document.getElementById(parent.element.id + '_toolbar');\n        if (this.isToolbar() && toolbar && toolbar.classList.contains('e-control')) {\n            getComponent(toolbar, 'toolbar').destroy();\n        }\n    };\n    ToolbarModule.prototype.destroyBottomToolbar = function () {\n        var parent = this.parent;\n        var toolbar = document.getElementById(parent.element.id + '_bottomToolbar');\n        if (toolbar && toolbar.classList.contains('e-control')) {\n            getComponent(toolbar, 'toolbar').destroy();\n        }\n    };\n    ToolbarModule.prototype.isToolbar = function () {\n        var parent = this.parent;\n        return (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.length > 0)\n            || !isNullOrUndefined(parent.toolbarTemplate));\n    };\n    ToolbarModule.prototype.createToolbar = function () {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.length > 0)) {\n            parent.element.appendChild(parent.createElement('div', {\n                id: id + '_toolbarArea', className: 'e-toolbar-area'\n            }));\n            var toolbarItems = { cssClass: 'e-image-upload', align: 'Left', type: 'Input',\n                tooltipText: this.l10n.getConstant('Browse'), template: new Uploader({ allowedExtensions: '.jpg, .jpeg, .png,.svg', multiple: false }) };\n            if (isNullOrUndefined(this.defToolbarItems)) {\n                this.defToolbarItems = [];\n            }\n            this.defToolbarItems.push(toolbarItems);\n            var toolbarArea = document.getElementById(id + '_toolbarArea');\n            var toolbar_1 = parent.createElement('div', { id: id + '_toolbar' });\n            toolbarArea.appendChild(toolbar_1);\n            var uploadItems = [\n                {\n                    cssClass: 'e-image-upload',\n                    align: 'Left', type: 'Input',\n                    tooltipText: this.l10n.getConstant('Browse'),\n                    template: new Uploader({\n                        allowedExtensions: '.jpg, .jpeg, .png,.svg',\n                        multiple: false,\n                        selected: function () {\n                            var toolbar = document.getElementById(id + '_toolbar');\n                            var bToolbar = document.getElementById(id + '_bottomToolbar');\n                            if (!parent.disabled) {\n                                if (Browser.isDevice) {\n                                    if (_this.defToolbarItems.length > 0 && toolbar) {\n                                        getComponent(toolbar, 'toolbar').destroy();\n                                    }\n                                    if (bToolbar) {\n                                        getComponent(bToolbar, 'toolbar').destroy();\n                                    }\n                                    _this.initMainToolbar(false, Browser.isDevice, null);\n                                    _this.createBottomToolbar();\n                                }\n                                else {\n                                    if (_this.defToolbarItems.length > 0 && toolbar) {\n                                        getComponent(toolbar, 'toolbar').destroy();\n                                    }\n                                    _this.initMainToolbar(false, false, null);\n                                }\n                            }\n                        }\n                    })\n                }\n            ];\n            var toolbarObj = new Toolbar({ items: uploadItems, width: '100%',\n                created: function () {\n                    parent.trigger('toolbarCreated', { toolbarType: 'main' });\n                },\n                clicked: this.defToolbarClicked.bind(this) });\n            toolbarObj.appendTo('#' + id + '_toolbar');\n            this.createLeftToolbarControls();\n            var mToolbar = document.getElementById(id + '_toolbar');\n            if (toolbar_1) {\n                this.toolbarHeight = mToolbar.clientHeight;\n                if (parent.toolbar && parent.toolbar.length > 0 && parent.toolbar.indexOf('Open') === -1) {\n                    var toolabr = getComponent(document.getElementById(parent.element.id + '_toolbar'), 'toolbar');\n                    if (toolabr) {\n                        toolabr.destroy();\n                        document.getElementById(parent.element.id + '_toolbar').innerHTML = '';\n                    }\n                }\n            }\n        }\n        else {\n            this.toolbarHeight = 0;\n        }\n    };\n    ToolbarModule.prototype.createContextualToolbar = function () {\n        var parent = this.parent;\n        var id = parent.element.id;\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.length > 0)) {\n            parent.element.appendChild(parent.createElement('div', { id: id + '_contextualToolbarArea',\n                className: 'e-contextual-toolbar-wrapper e-hide', attrs: { style: 'position: absolute;' }\n            }));\n            var toolbarArea = document.getElementById(id + '_contextualToolbarArea');\n            var toolbar_2 = parent.createElement('div', { id: id + '_contextualToolbar' });\n            toolbarArea.appendChild(toolbar_2);\n        }\n    };\n    ToolbarModule.prototype.createBottomToolbar = function () {\n        var parent = this.parent;\n        var id = parent.element.id;\n        if (parent.element.querySelector('#' + id + '_bottomToolbarArea')) {\n            parent.element.querySelector('#' + id + '_bottomToolbarArea').remove();\n        }\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.length > 0)) {\n            parent.element.appendChild(parent.createElement('div', {\n                id: id + '_bottomToolbarArea', className: 'e-bottom-toolbar'\n            }));\n            if (!parent.toolbarTemplate) {\n                var toolbarArea = document.getElementById(id + '_bottomToolbarArea');\n                var toolbarElem = parent.createElement('div', {\n                    id: id + '_bottomToolbar'\n                });\n                toolbarArea.appendChild(toolbarElem);\n            }\n            this.initBottomToolbar();\n        }\n    };\n    ToolbarModule.prototype.createQuickAccessToolbar = function () {\n        var parent = this.parent;\n        var id = parent.element.id;\n        if (parent.showQuickAccessToolbar) {\n            var toolbarItems = { cssClass: 'e-image-upload', align: 'Left', type: 'Input',\n                tooltipText: this.l10n.getConstant('Browse'), template: new Uploader({ allowedExtensions: '.jpg, .jpeg, .png,.svg', multiple: false }) };\n            if (isNullOrUndefined(this.defToolbarItems)) {\n                this.defToolbarItems = [];\n            }\n            this.defToolbarItems.push(toolbarItems);\n            var toolbarArea = document.getElementById(id + '_quickAccessToolbarArea');\n            var toolbar_3 = parent.createElement('div', {\n                id: id + '_quickAccessToolbar'\n            });\n            toolbarArea.appendChild(toolbar_3);\n            var toolbarObj = new Toolbar({ clicked: this.defToolbarClicked.bind(this) });\n            toolbarObj.appendTo('#' + id + '_quickAccessToolbar');\n        }\n    };\n    ToolbarModule.prototype.initMainToolbar = function (isApplyOption, isDevice, isOkBtn, isResize, isFrame, isMainToolbar, isRedact) {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        if (this.isToolbar()) {\n            var leftItem = this.getLeftToolbarItem(isOkBtn, isResize);\n            var rightItem = this.getRightToolbarItem(isOkBtn, isMainToolbar, isRedact);\n            var mainItem = this.getMainToolbarItem(isApplyOption, isFrame, isRedact);\n            var zoomItem = this.getZoomToolbarItem();\n            if (isDevice) {\n                if (isFrame || isRedact) {\n                    this.defToolbarItems = mainItem;\n                }\n                else {\n                    this.defToolbarItems = leftItem.concat(rightItem);\n                }\n            }\n            else {\n                this.defToolbarItems = leftItem.concat(mainItem, rightItem, zoomItem);\n            }\n            var args = { toolbarType: 'main', toolbarItems: this.defToolbarItems };\n            parent.trigger('toolbarUpdating', args);\n            this.defToolbarItems = args.toolbarItems;\n            if (this.defToolbarItems.length > 0) {\n                var toolbarObj = new Toolbar({\n                    width: '100%',\n                    items: this.defToolbarItems,\n                    clicked: this.defToolbarClicked.bind(this),\n                    created: function () {\n                        if (!isDevice) {\n                            _this.renderAnnotationBtn();\n                        }\n                        _this.wireZoomBtnEvents();\n                        parent.trigger('toolbarCreated', { toolbarType: 'main' });\n                    }\n                });\n                if ((isDevice && isFrame) || (isDevice && isRedact)) {\n                    toolbarObj.appendTo('#' + id + '_bottomToolbar');\n                }\n                else {\n                    toolbarObj.appendTo('#' + id + '_toolbar');\n                }\n                this.createLeftToolbarControls();\n                this.enableDisableTbrBtn();\n                if (this.isToolbar() && document.getElementById(id + '_toolbar')) {\n                    /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                    var toolbar_4 = getComponent(id + '_toolbar', 'toolbar');\n                    toolbar_4.refreshOverflow();\n                }\n            }\n        }\n    };\n    ToolbarModule.prototype.initBottomToolbar = function () {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.length > 0)) {\n            var items = this.getMainToolbarItem();\n            var args = { toolbarType: 'bottom-toolbar', toolbarItems: items };\n            parent.trigger('toolbarUpdating', args);\n            items = args.toolbarItems;\n            var toolbarObj = new Toolbar({ items: items, width: '100%',\n                created: function () {\n                    _this.renderAnnotationBtn();\n                    _this.renderCropBtn();\n                    _this.renderTransformBtn();\n                    parent.trigger('toolbarCreated', { toolbarType: 'main' });\n                },\n                clicked: this.defToolbarClicked.bind(this)\n            });\n            toolbarObj.appendTo('#' + id + '_bottomToolbar');\n            if (this.defToolbarItems.length > 0 && document.getElementById(id + '_bottomToolbar')) {\n                /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                var toolbar_5 = getComponent(id + '_bottomToolbar', 'toolbar');\n                toolbar_5.refreshOverflow();\n            }\n        }\n    };\n    ToolbarModule.prototype.getLeftToolbarItem = function (isOkBtn, isResize) {\n        var parent = this.parent;\n        var id = parent.element.id;\n        var toolbarItems = [];\n        if (!isOkBtn || isResize) {\n            if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('Open') > -1)) {\n                toolbarItems.push({ id: id + '_upload', cssClass: 'e-image-upload', align: 'Left', type: 'Input', template: new Uploader({ allowedExtensions: '.jpg, .jpeg, .png,.svg', multiple: false }) });\n                toolbarItems.push({ visible: false, cssClass: 'e-image-position e-btn e-flat', tooltipText: this.l10n.getConstant('Browse'), align: 'Left' });\n            }\n            else if (Browser.isDevice && (parent.toolbar && parent.toolbar.indexOf('Open') === -1)) {\n                toolbarItems.push({ visible: false, id: id + '_upload', cssClass: 'e-image-upload', align: 'Left', type: 'Input', template: new Uploader({ allowedExtensions: '.jpg, .jpeg, .png,.svg', multiple: false }) });\n                toolbarItems.push({ visible: false, cssClass: 'e-image-position e-btn e-flat', tooltipText: this.l10n.getConstant('Browse'), align: 'Left' });\n            }\n        }\n        if (parent.allowUndoRedo && !isResize) {\n            if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('Undo') > -1)) {\n                toolbarItems.push({ id: id + '_undo', prefixIcon: 'e-icons e-undo', cssClass: 'top-icon e-undo',\n                    tooltipText: this.l10n.getConstant('Undo'), align: 'Left' });\n            }\n            if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('Redo') > -1)) {\n                toolbarItems.push({ id: id + '_redo', prefixIcon: 'e-icons e-redo', cssClass: 'top-icon e-redo',\n                    tooltipText: this.l10n.getConstant('Redo'), align: 'Left' });\n            }\n        }\n        if (!this.preventZoomBtn && (parent.zoomSettings.zoomTrigger & ZoomTrigger.Toolbar) === ZoomTrigger.Toolbar && !isResize) {\n            if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('ZoomOut') > -1)) {\n                toolbarItems.push({ id: id + '_zoomOut', prefixIcon: 'e-icons e-zoom-out', cssClass: 'top-icon e-dec-zoom',\n                    tooltipText: this.l10n.getConstant('ZoomOut'), align: 'Left' });\n            }\n            if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('ZoomIn') > -1)) {\n                toolbarItems.push({ id: id + '_zoomIn', prefixIcon: 'e-icons e-zoom-in', cssClass: 'top-icon e-inc-zoom',\n                    tooltipText: this.l10n.getConstant('ZoomIn'), align: 'Left' });\n            }\n        }\n        var tempToolbarItems = this.processToolbar('left');\n        for (var i = 0, len = tempToolbarItems.length; i < len; i++) {\n            toolbarItems.push(tempToolbarItems[i]);\n        }\n        return toolbarItems;\n    };\n    ToolbarModule.prototype.getRightToolbarItem = function (isOkBtn, isMainToolbar, isRedact) {\n        var parent = this.parent;\n        var id = parent.element.id;\n        var toolbarItems = [];\n        if (isOkBtn || isRedact) {\n            toolbarItems.push({ id: id + '_ok', prefixIcon: 'e-icons e-check', cssClass: 'top-icon e-tick',\n                tooltipText: this.l10n.getConstant('OK'), align: 'Right', tabIndex: 0 });\n            toolbarItems.push({ id: id + '_cancel', prefixIcon: 'e-icons e-close', cssClass: 'top-icon e-save',\n                tooltipText: this.l10n.getConstant('Cancel'), align: 'Right' });\n        }\n        if ((isMainToolbar || !Browser.isDevice) && (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('Reset') > -1))) {\n            toolbarItems.push({ id: id + '_reset', prefixIcon: 'e-icons e-btn-reset', cssClass: 'top-icon e-img-reset',\n                tooltipText: this.l10n.getConstant('Reset'), align: 'Right' });\n        }\n        if (!isOkBtn) {\n            if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('Save') > -1)) {\n                toolbarItems.push({ id: id + '_save', prefixIcon: 'e-icons e-btn-save', cssClass: 'e-caret-hide top-icon e-save',\n                    tooltipText: this.l10n.getConstant('Save'), align: 'Right' });\n            }\n        }\n        var tempToolbarItems = this.processToolbar('right');\n        for (var i = 0, len = tempToolbarItems.length; i < len; i++) {\n            toolbarItems.push(tempToolbarItems[i]);\n        }\n        return toolbarItems;\n    };\n    ToolbarModule.prototype.getMainToolbarItem = function (isApplyOption, isFrame, isRedact) {\n        var parent = this.parent;\n        var id = parent.element.id;\n        var toolbarItems = [];\n        if (isFrame) {\n            if (isNullOrUndefined(parent.toolbar) || (!isNullOrUndefined(parent.toolbar) && parent.toolbar.indexOf('None') > -1) || parent.toolbar.indexOf('Frame') > -1) {\n                toolbarItems.push({ id: id + '_none', prefixIcon: 'e-icons e-frame-none', cssClass: 'top-icon e-frame-none',\n                    tooltipText: this.l10n.getConstant('None'), align: 'Center' });\n            }\n            if (isNullOrUndefined(parent.toolbar) || (!isNullOrUndefined(parent.toolbar) && parent.toolbar.indexOf('Mat') > -1) || parent.toolbar.indexOf('Frame') > -1) {\n                toolbarItems.push({ id: id + '_mat', prefixIcon: 'e-icons e-frame-mat', cssClass: 'top-icon e-frame-mat',\n                    tooltipText: this.l10n.getConstant('Mat'), align: 'Center' });\n            }\n            if (isNullOrUndefined(parent.toolbar) || (!isNullOrUndefined(parent.toolbar) && parent.toolbar.indexOf('Bevel') > -1) || parent.toolbar.indexOf('Frame') > -1) {\n                toolbarItems.push({ id: id + '_bevel', prefixIcon: 'e-icons e-frame-bevel', cssClass: 'top-icon e-frame-bevel',\n                    tooltipText: this.l10n.getConstant('Bevel'), align: 'Center' });\n            }\n            if (isNullOrUndefined(parent.toolbar) || (!isNullOrUndefined(parent.toolbar) && parent.toolbar.indexOf('Line') > -1) || parent.toolbar.indexOf('Frame') > -1) {\n                toolbarItems.push({ id: id + '_line', prefixIcon: 'e-icons e-frame-line', cssClass: 'top-icon e-frame-line',\n                    tooltipText: this.l10n.getConstant('Line'), align: 'Center' });\n            }\n            if (isNullOrUndefined(parent.toolbar) || (!isNullOrUndefined(parent.toolbar) && parent.toolbar.indexOf('Inset') > -1) || parent.toolbar.indexOf('Frame') > -1) {\n                toolbarItems.push({ id: id + '_inset', prefixIcon: 'e-icons e-frame-inset', cssClass: 'top-icon e-frame-inset',\n                    tooltipText: this.l10n.getConstant('Inset'), align: 'Center' });\n            }\n            if (isNullOrUndefined(parent.toolbar) || (!isNullOrUndefined(parent.toolbar) && parent.toolbar.indexOf('Hook') > -1) || parent.toolbar.indexOf('Frame') > -1) {\n                toolbarItems.push({ id: id + '_hook', prefixIcon: 'e-icons e-frame-hook', cssClass: 'top-icon e-frame-hook',\n                    tooltipText: this.l10n.getConstant('Hook'), align: 'Center' });\n            }\n        }\n        else if (isRedact) {\n            toolbarItems.push({ id: id + '_redactBlur', prefixIcon: 'e-icons e-tint', cssClass: 'top-icon e-opacity',\n                tooltipText: this.l10n.getConstant('Blur'), align: 'Center' });\n            toolbarItems.push({ id: id + '_pixelate', prefixIcon: 'e-icons e-opacity', cssClass: 'top-icon e-opacity',\n                tooltipText: this.l10n.getConstant('Pixelate'), align: 'Center' });\n            toolbarItems.push({ id: id + '_duplicate', prefixIcon: 'e-icons e-order', cssClass: 'top-icon e-order',\n                tooltipText: this.l10n.getConstant('Duplicate'), align: 'Center' });\n            toolbarItems.push({ id: id + '_remove', prefixIcon: 'e-icons e-trash', cssClass: 'top-icon e-trash',\n                tooltipText: this.l10n.getConstant('Remove'), align: 'Center' });\n        }\n        else {\n            if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('Crop') > -1)) {\n                toolbarItems.push({ id: id + '_cropTransform', prefixIcon: 'e-icons e-crop', cssClass: 'top-icon e-crop',\n                    tooltipText: this.l10n.getConstant('CropAndTransform'), align: 'Center' });\n            }\n            if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('Annotate') > -1)) {\n                toolbarItems.push({ id: id + '_annotation', tooltipText: this.l10n.getConstant('Annotation'), align: 'Center',\n                    template: '<button id=\"' + id + '_annotationBtn\"></button>' });\n            }\n            if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('Finetune') > -1)) {\n                toolbarItems.push({ id: id + '_adjustment', prefixIcon: 'e-icons e-adjustment', cssClass: 'top-icon e-adjustment',\n                    tooltipText: this.l10n.getConstant('Finetune'), align: 'Center' });\n            }\n            if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('Filter') > -1)) {\n                toolbarItems.push({ id: id + '_filter', prefixIcon: 'e-icons e-filters', cssClass: 'top-icon e-filters',\n                    tooltipText: this.l10n.getConstant('Filter'), align: 'Center' });\n            }\n            if (isNullOrUndefined(parent.toolbar) || (!isNullOrUndefined(parent.toolbar) && parent.toolbar.indexOf('Frame') > -1)) {\n                toolbarItems.push({ id: id + '_frame', prefixIcon: 'e-icons e-border-frame', cssClass: 'top-icon e-border-frame',\n                    tooltipText: this.l10n.getConstant('Frame'), align: 'Center' });\n            }\n            if (isNullOrUndefined(parent.toolbar) || (!isNullOrUndefined(parent.toolbar) && parent.toolbar.indexOf('Resize') > -1)) {\n                toolbarItems.push({ id: id + '_resize', prefixIcon: 'e-icons e-resize', cssClass: 'top-icon e-resize',\n                    tooltipText: this.l10n.getConstant('Resize'), align: 'Center' });\n            }\n            if (isNullOrUndefined(parent.toolbar) || (!isNullOrUndefined(parent.toolbar) && parent.toolbar.indexOf('Redact') > -1)) {\n                toolbarItems.push({ id: id + '_redact', prefixIcon: 'e-icons e-redact', cssClass: 'top-icon e-opacity',\n                    tooltipText: this.l10n.getConstant('Redact'), align: 'Center' });\n            }\n        }\n        var tempToolbarItems = this.processToolbar('center');\n        for (var i = 0, len = tempToolbarItems.length; i < len; i++) {\n            toolbarItems.push(tempToolbarItems[i]);\n        }\n        if (isApplyOption) {\n            toolbarItems.push({ id: id + '_ok', prefixIcon: 'e-icons e-check', cssClass: 'top-icon e-tick',\n                tooltipText: this.l10n.getConstant('OK'), align: 'Right', tabIndex: 0 });\n            toolbarItems.push({ id: id + '_cancel', prefixIcon: 'e-icons e-close', cssClass: 'top-icon e-save',\n                tooltipText: this.l10n.getConstant('Cancel'), align: 'Right' });\n        }\n        return toolbarItems;\n    };\n    ToolbarModule.prototype.getZoomToolbarItem = function () {\n        var toolbarItems = [];\n        return toolbarItems;\n    };\n    ToolbarModule.prototype.updateContextualToolbar = function (type, cType, isSelect) {\n        var parent = this.parent;\n        var id = parent.element.id;\n        var toolbarArea = parent.element.querySelector('#' + id + '_toolbarArea');\n        var contextualToolbarArea = parent.element.querySelector('#' + id + '_contextualToolbarArea');\n        if (!contextualToolbarArea) {\n            return;\n        }\n        contextualToolbarArea.classList.remove('e-hide');\n        contextualToolbarArea.style.left = toolbarArea.offsetLeft + 'px';\n        if (type === 'filter') {\n            var toolbar_6 = document.getElementById(id + '_toolbar');\n            if (toolbar_6 && this.defToolbarItems.length > 0) {\n                getComponent(toolbar_6, 'toolbar').destroy();\n            }\n            if (Browser.isDevice) {\n                this.initMainToolbar(false, true, true);\n            }\n            else {\n                this.initMainToolbar(true, null, null);\n            }\n            this.refreshSlider();\n            this.initFilterToolbarItem();\n        }\n        else {\n            var ctxToolbar = document.querySelector('#' + id + '_contextualToolbar');\n            if (ctxToolbar.classList.contains('e-control')) {\n                getComponent(ctxToolbar, 'toolbar').destroy();\n            }\n            this.refreshSlider();\n            if (type === 'frame') {\n                this.initFrameToolbarItem();\n            }\n            else {\n                this.renderSlider(cType, isSelect);\n            }\n        }\n        if (parent.toolbarTemplate) {\n            this.toolbarHeight = parent.element.querySelector('#' + id + '_toolbarArea').clientHeight;\n        }\n        else if (parent.element.querySelector('#' + id + '_toolbar')) {\n            this.toolbarHeight = parent.element.querySelector('#' + id + '_toolbar').clientHeight;\n        }\n        parent.toolbarHeight = this.toolbarHeight;\n        if (Browser.isDevice) {\n            var cHt = contextualToolbarArea.offsetHeight + 1;\n            var cusWrapper = parent.element.querySelector('#' + id + '_customizeWrapper');\n            if (this.isFrameToolbar && cusWrapper) {\n                cHt = cusWrapper.offsetHeight + 2;\n            }\n            var ht = parent.element.querySelector('#' + id + '_canvasWrapper').offsetHeight;\n            contextualToolbarArea.style.top = this.toolbarHeight + 1 + ht - cHt + 'px';\n            if (cType === 'straighten') {\n                parent.isStraightening = true;\n                var ctxToolbar = parent.element.querySelector('#' + id + '_contextualToolbarArea');\n                if (ctxToolbar.style.position === 'absolute') {\n                    ctxToolbar.style.position = '';\n                    parent.element.insertBefore(ctxToolbar, parent.element.querySelector('#' + id + '_bottomToolbarArea'));\n                    parent.update();\n                    if (isSelect) {\n                        parent.notify('draw', { prop: 'select', onPropertyChange: false,\n                            value: { type: this.getCropTextContent(document.getElementById(id + '_cropBtn')).toLowerCase(),\n                                startX: null, startY: null, width: null, height: null } });\n                    }\n                }\n            }\n        }\n        else {\n            contextualToolbarArea.style.top = this.toolbarHeight + 1 + 'px';\n        }\n    };\n    ToolbarModule.prototype.processToolbar = function (position) {\n        var parent = this.parent;\n        var toolbarItems = [];\n        if (parent.toolbar) {\n            for (var i = 0, len = parent.toolbar.length; i < len; i++) {\n                if (typeof (parent.toolbar[i]) === 'object') {\n                    if (isNullOrUndefined(parent.toolbar[i].align)) {\n                        if (position === 'left') {\n                            toolbarItems.push(parent.toolbar[i]);\n                        }\n                    }\n                    else if (parent.toolbar[i].align.toLowerCase() === position) {\n                        toolbarItems.push(parent.toolbar[i]);\n                    }\n                }\n            }\n        }\n        return toolbarItems;\n    };\n    ToolbarModule.prototype.processSubToolbar = function (items) {\n        var toolbarItems = [];\n        if (items) {\n            for (var i = 0, len = items.length; i < len; i++) {\n                if (typeof (items[i]) === 'object') {\n                    items[i].align = 'Center';\n                    toolbarItems.push(items[i]);\n                }\n            }\n        }\n        return toolbarItems;\n    };\n    ToolbarModule.prototype.wireZoomBtnEvents = function () {\n        var zoomIn = document.querySelector('#' + this.parent.element.id + '_zoomIn');\n        var zoomOut = document.querySelector('#' + this.parent.element.id + '_zoomOut');\n        if (zoomIn) {\n            zoomIn.addEventListener('mousedown', this.zoomInBtnMouseDownHandler.bind(this));\n            zoomIn.addEventListener('mouseup', this.zoomBtnMouseUpHandler.bind(this));\n            zoomIn.addEventListener('click', this.zoomInBtnClickHandler.bind(this));\n        }\n        if (zoomOut) {\n            zoomOut.addEventListener('mousedown', this.zoomOutBtnMouseDownHandler.bind(this));\n            zoomOut.addEventListener('mouseup', this.zoomBtnMouseUpHandler.bind(this));\n            zoomOut.addEventListener('click', this.zoomOutBtnClickHandler.bind(this));\n        }\n    };\n    ToolbarModule.prototype.widthPress = function (e) {\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        if (e.keyCode === 109) {\n            e.preventDefault();\n            return;\n        }\n    };\n    ToolbarModule.prototype.heightPress = function (e) {\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        if (e.keyCode === 109) {\n            e.preventDefault();\n            return;\n        }\n    };\n    ToolbarModule.prototype.widthAspectRatio = function (e) {\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        if (e.keyCode === 109 || e.keyCode === 9) {\n            return;\n        }\n        var parent = this.parent;\n        var id = parent.element.id;\n        var aspectRatioHeight = parent.element.querySelector('#' + id + '_resizeHeight');\n        var aspectRatioWidth = parent.element.querySelector('#' + id + '_resizeWidth');\n        var icon = parent.element.querySelector('#' + id + '_aspectratio');\n        var originalWidth = parent.img.destWidth;\n        var originalHeight = parent.img.destHeight;\n        var aspectRatioHeightValue = parseFloat(aspectRatioHeight.value);\n        var val = aspectRatioHeightValue / (originalHeight / originalWidth);\n        var width = val % 1 >= 0.5 || val % 1 <= -0.5 ? Math.round(val) : (val < 0) ? Math.ceil(val) : Math.floor(val);\n        var widthNumeric = getComponent(aspectRatioWidth, 'numerictextbox');\n        var heightNumeric = getComponent(aspectRatioWidth, 'numerictextbox');\n        if (icon) {\n            if (width != null && !isNaN(width)) {\n                if (isNullOrUndefined((widthNumeric).value)) {\n                    (widthNumeric).placeholder = width + ' px';\n                    aspectRatioWidth.placeholder = width.toString() + ' px';\n                }\n                else {\n                    (widthNumeric).value = width;\n                    aspectRatioWidth.value = width.toString() + ' px';\n                }\n            }\n            else {\n                if (isNullOrUndefined((widthNumeric).value)) {\n                    (widthNumeric).placeholder = '0 px';\n                    aspectRatioWidth.placeholder = '0 px';\n                    if (isNullOrUndefined(heightNumeric.value) && !isNullOrUndefined(heightNumeric.placeholder)) {\n                        (widthNumeric).placeholder = \"\" + parent.img.srcWidth;\n                        aspectRatioWidth.placeholder = \"\" + parent.img.srcWidth;\n                    }\n                }\n                else {\n                    (widthNumeric).value = 0;\n                    aspectRatioWidth.value = '0 px';\n                }\n            }\n        }\n    };\n    ToolbarModule.prototype.heightAspectRatio = function (e) {\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        if (e.keyCode === 109 || e.keyCode === 9) {\n            return;\n        }\n        var parent = this.parent;\n        var id = parent.element.id;\n        var aspectRatioHeight = parent.element.querySelector('#' + id + '_resizeHeight');\n        var aspectRatioWidth = parent.element.querySelector('#' + id + '_resizeWidth');\n        var icon = parent.element.querySelector('#' + id + '_aspectratio');\n        var originalWidth = parent.img.destWidth;\n        var originalHeight = parent.img.destHeight;\n        var aspectRatioWidthValue = parseFloat(aspectRatioWidth.value);\n        var value = aspectRatioWidthValue / (originalWidth / originalHeight);\n        var ht = value % 1 >= 0.5 || value % 1 <= -0.5 ? Math.round(value) : (value < 0) ? Math.ceil(value) : Math.floor(value);\n        var heightNumeric = getComponent(aspectRatioHeight, 'numerictextbox');\n        var widthNumeric = getComponent(aspectRatioWidth, 'numerictextbox');\n        if (icon) {\n            if (!isNaN(ht)) {\n                if (isNullOrUndefined((heightNumeric).value)) {\n                    (heightNumeric).placeholder = ht + ' px';\n                    aspectRatioHeight.placeholder = ht.toString() + ' px';\n                }\n                else {\n                    (heightNumeric).value = ht;\n                    aspectRatioHeight.value = ht.toString() + ' px';\n                }\n            }\n            else {\n                if (isNullOrUndefined((heightNumeric).value)) {\n                    (heightNumeric).placeholder = '0 px';\n                    aspectRatioHeight.placeholder = '0 px';\n                    if (isNullOrUndefined(widthNumeric.value) && !isNullOrUndefined(widthNumeric.placeholder)) {\n                        (heightNumeric).placeholder = \"\" + parent.img.srcHeight;\n                        aspectRatioHeight.placeholder = \"\" + parent.img.srcHeight;\n                    }\n                }\n                else {\n                    (heightNumeric).value = 0;\n                    aspectRatioHeight.value = '0 px';\n                }\n            }\n        }\n    };\n    ToolbarModule.prototype.getResizeToolbarItem = function () {\n        var parent = this.parent;\n        var id = parent.element.id;\n        var isResize = parent.aspectWidth && parent.aspectHeight ? true : false;\n        var width = this.parent.transform.degree % 90 === 0 && this.parent.transform.degree % 180 !== 0 ?\n            Math.ceil(this.parent.img.srcHeight).toString() : Math.ceil(this.parent.img.srcWidth).toString();\n        var height = this.parent.transform.degree % 90 === 0 && this.parent.transform.degree % 180 !== 0 ?\n            Math.ceil(this.parent.img.srcWidth).toString() : Math.ceil(this.parent.img.srcHeight).toString();\n        var toolbarItems = [];\n        var spanWidth = document.createElement('span');\n        spanWidth.innerHTML = this.l10n.getConstant('W');\n        toolbarItems.push({ id: id + '_width', cssClass: 'e-ie-resize-width', template: spanWidth, align: 'Center' });\n        toolbarItems.push({ id: id + '_resizeWidth', prefixIcon: 'e-icons e-anti-clock-wise',\n            tooltipText: this.l10n.getConstant('Width'), align: 'Center', type: 'Input', template: new NumericTextBox({ width: 75, htmlAttributes: { maxLength: '4' },\n                showSpinButton: false, value: isResize ? parent.aspectWidth : null,\n                placeholder: isResize ? null : width, format: '###.## px' })\n        });\n        var spanHeight = document.createElement('span');\n        spanHeight.innerHTML = this.l10n.getConstant('H');\n        toolbarItems.push({ id: id + '_height', cssClass: 'e-ie-resize-height', template: spanHeight, align: 'Center' });\n        toolbarItems.push({ id: id + '_resizeHeight', prefixIcon: 'e-icons e-clock-wise',\n            tooltipText: this.l10n.getConstant('Height'), align: 'Center', type: 'Input', template: new NumericTextBox({ width: 75, htmlAttributes: { maxLength: '4' },\n                showSpinButton: false, value: isResize ? parent.aspectHeight : null,\n                placeholder: isResize ? null : height, format: '###.## px' })\n        });\n        if (!this.isAspectRatio) {\n            toolbarItems.push({ id: id + '_aspectratio', prefixIcon: 'e-icons e-lock', align: 'Center',\n                tooltipText: this.l10n.getConstant('AspectRatio'), type: 'Button', tabIndex: 0 });\n            this.isAspectRatio = true;\n        }\n        else {\n            toolbarItems.push({ id: id + '_nonaspectratio', prefixIcon: 'e-icons e-unlock', align: 'Center', tooltipText: this.l10n.getConstant('AspectRatio'), type: 'Button' });\n            this.isAspectRatio = false;\n        }\n        if (!Browser.isDevice) {\n            toolbarItems.push({ id: id + '_ok', prefixIcon: 'e-icons e-check', cssClass: 'top-icon e-tick',\n                tooltipText: this.l10n.getConstant('OK'), align: 'Right', tabIndex: 0 });\n            toolbarItems.push({ id: id + '_cancel', prefixIcon: 'e-icons e-close', cssClass: 'top-icon e-save',\n                tooltipText: this.l10n.getConstant('Cancel'), align: 'Right' });\n        }\n        return toolbarItems;\n    };\n    ToolbarModule.prototype.initResizeToolbar = function () {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        var leftItem = this.getLeftToolbarItem(false, true);\n        var rightItem = this.getRightToolbarItem();\n        var mainItem = this.getResizeToolbarItem();\n        var zoomItem = this.getZoomToolbarItem();\n        if (Browser.isDevice) {\n            this.defToolbarItems = mainItem;\n        }\n        else {\n            this.defToolbarItems = leftItem.concat(zoomItem, mainItem, rightItem);\n        }\n        var args = { toolbarType: 'resize', toolbarItems: this.defToolbarItems };\n        parent.trigger('toolbarUpdating', args);\n        this.defToolbarItems = args.toolbarItems;\n        var toolbar = new Toolbar({\n            width: '100%',\n            items: this.defToolbarItems,\n            clicked: this.defToolbarClicked.bind(this),\n            created: function () {\n                _this.wireResizeBtnEvents();\n                parent.trigger('toolbarCreated', { toolbarType: 'shapes' });\n                if (Browser.isDevice) {\n                    if (_this.defToolbarItems.length > 0 && (!isNullOrUndefined(document.getElementById(id + '_bottomToolbar')))) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        toolbar.refreshOverflow();\n                    }\n                }\n                else {\n                    _this.createLeftToolbarControls();\n                    if (_this.defToolbarItems.length > 0 && (!isNullOrUndefined(document.getElementById(id + '_toolbar')))) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        toolbar.refreshOverflow();\n                    }\n                }\n            }\n        });\n        if (Browser.isDevice) {\n            toolbar.appendTo('#' + id + '_bottomToolbar');\n        }\n        else {\n            toolbar.appendTo('#' + id + '_toolbar');\n        }\n        parent.isResize = false;\n        this.enableDisableTbrBtn();\n        parent.isResize = true;\n        parent.notify('transform', { prop: 'disableZoomOutBtn', value: { isZoomOut: true } });\n    };\n    ToolbarModule.prototype.wireResizeBtnEvents = function () {\n        var parent = this.parent;\n        var id = parent.element.id;\n        var aspectRatioHeight = parent.element.querySelector('#' + id + '_resizeHeight');\n        var aspectRatioWidth = parent.element.querySelector('#' + id + '_resizeWidth');\n        if (!isNullOrUndefined(aspectRatioHeight)) {\n            aspectRatioHeight.addEventListener('keydown', this.widthPress.bind(this));\n            aspectRatioWidth.addEventListener('keyup', this.heightAspectRatio.bind(this));\n        }\n        if (!isNullOrUndefined(aspectRatioWidth)) {\n            aspectRatioWidth.addEventListener('keydown', this.heightPress.bind(this));\n            aspectRatioHeight.addEventListener('keyup', this.widthAspectRatio.bind(this));\n        }\n    };\n    ToolbarModule.prototype.enableDisableTbrBtn = function () {\n        var parent = this.parent;\n        var id = parent.element.id;\n        if (!this.preventEnableDisableUr) {\n            var object = { appliedUndoRedoColl: [] };\n            parent.notify('undo-redo', { prop: 'getAppliedUndoRedoColl', value: { obj: object } });\n            var undoRedoObj = { undoRedoStep: null };\n            parent.notify('undo-redo', { prop: 'getUndoRedoStep', value: { obj: undoRedoObj } });\n            var undo = parent.element.querySelector('#' + id + '_undo');\n            if (undo && undoRedoObj['undoRedoStep'] === 0) {\n                undo.classList.add('e-disabled');\n                undo.parentElement.classList.add('e-overlay');\n            }\n            else if (undo && undoRedoObj['undoRedoStep'] > 0) {\n                undo.classList.remove('e-disabled');\n                undo.parentElement.classList.remove('e-overlay');\n            }\n            var redo = parent.element.querySelector('#' + id + '_redo');\n            if (redo && (undoRedoObj['undoRedoStep'] === object['appliedUndoRedoColl'].length)) {\n                redo.classList.add('e-disabled');\n                redo.parentElement.classList.add('e-overlay');\n            }\n            else if (redo && (undoRedoObj['undoRedoStep'] === 0 && object['appliedUndoRedoColl'].length > 0)) {\n                redo.classList.remove('e-disabled');\n                redo.parentElement.classList.remove('e-overlay');\n            }\n            else if (redo && undoRedoObj['undoRedoStep'] > 0) {\n                redo.classList.remove('e-disabled');\n                redo.parentElement.classList.remove('e-overlay');\n            }\n        }\n        var zoomIn = document.querySelector('#' + id + '_zoomIn');\n        if (zoomIn && parent.zoomSettings.zoomFactor >= parent.zoomSettings.maxZoomFactor) {\n            zoomIn.classList.add('e-disabled');\n            zoomIn.parentElement.classList.add('e-overlay');\n        }\n        else if (zoomIn) {\n            zoomIn.classList.remove('e-disabled');\n            zoomIn.parentElement.classList.remove('e-overlay');\n        }\n        var zoomOut = document.querySelector('#' + id + '_zoomOut');\n        if (zoomOut && parent.zoomSettings.zoomFactor <= parent.zoomSettings.minZoomFactor) {\n            zoomOut.classList.add('e-disabled');\n            zoomOut.parentElement.classList.add('e-overlay');\n        }\n        else if (zoomOut) {\n            zoomOut.classList.remove('e-disabled');\n            zoomOut.parentElement.classList.remove('e-overlay');\n        }\n        var frame = document.querySelector('#' + id + '_frame');\n        if (frame && ((parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle') || parent.isCircleCrop)) {\n            frame.classList.add('e-overlay');\n        }\n        else if (frame) {\n            frame.classList.remove('e-overlay');\n        }\n        var ratio = document.querySelector('#' + id + '_aspectratio');\n        if (ratio && ((parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle') || parent.isCircleCrop)) {\n            ratio.classList.add('e-overlay');\n        }\n        else if (ratio) {\n            ratio.classList.remove('e-overlay');\n        }\n    };\n    ToolbarModule.prototype.createLeftToolbarControls = function () {\n        var parent = this.parent;\n        var id = parent.element.id;\n        if (this.defToolbarItems !== undefined && this.defToolbarItems.length > 0 &&\n            (document.getElementById(id + '_toolbar'))) {\n            var uploadDiv = document.getElementById(id + '_toolbar')\n                .querySelector('.e-image-upload');\n            if (uploadDiv) {\n                var uploadElem = uploadDiv.getElementsByTagName('input')[0];\n                var uploadBtnElem = uploadDiv.getElementsByTagName('button')[0];\n                uploadBtnElem.className = 'e-tbar-btn e-tbtn-txt top-icon';\n                uploadBtnElem.innerHTML = '';\n                uploadBtnElem.title = this.l10n.getConstant('Browse');\n                uploadBtnElem.appendChild(parent.createElement('span', {\n                    className: 'e-btn-icon e-icons e-upload-icon e-icon-left'\n                }));\n                uploadElem.onchange = this.fileSelect.bind(this, uploadElem);\n            }\n        }\n    };\n    ToolbarModule.prototype.fileSelect = function (inputElement, args) {\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var type = inputElement.files[0].type.split('/')[1];\n        var filesTypes = ['png', 'jpg', 'jpeg', 'svg', 'svg+xml'];\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        this.fileName = inputElement.files[0].name.split('.')[0];\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        this.parent.notify('toolbar', { prop: 'setInitialSize', value: { value: inputElement.files[0].size } });\n        if (filesTypes.indexOf(type) > -1) {\n            this.parent.notify('draw', { prop: 'fileSelect', value: { inputElement: inputElement, args: args } });\n        }\n        else {\n            this.parent.showDialogPopup();\n        }\n    };\n    ToolbarModule.prototype.triggerTbarClickEvent = function (args) {\n        var clickEvent = { item: args.item, originalEvent: args.event };\n        this.parent.trigger('toolbarItemClicked', clickEvent);\n    };\n    ToolbarModule.prototype.renderAnnotationBtn = function (isContextualToolbar) {\n        var _this = this;\n        var parent = this.parent;\n        var isCustomized = false;\n        var items = [];\n        var id = parent.element.id;\n        var defItems = ['Ellipse', 'Arrow', 'Line', 'Rectangle', 'Pen', 'Path', 'Text', 'Image'];\n        if (parent.toolbar) {\n            for (var i = 0; i < defItems.length; i++) {\n                if (parent.toolbar.indexOf(defItems[i]) !== -1) {\n                    isCustomized = true;\n                    break;\n                }\n            }\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('Pen') > -1)) {\n            items.push({ text: this.l10n.getConstant('Pen'), id: 'pen', iconCss: 'e-icons e-free-pen' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('Line') > -1)) {\n            items.push({ text: this.l10n.getConstant('Line'), id: 'line', iconCss: 'e-icons e-line' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('Rectangle') > -1)) {\n            items.push({ text: this.l10n.getConstant('Rectangle'), id: 'rectangle', iconCss: 'e-icons e-rectangle' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('Ellipse') > -1)) {\n            items.push({ text: this.l10n.getConstant('Ellipse'), id: 'ellipse', iconCss: 'e-icons e-circle' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('Arrow') > -1)) {\n            items.push({ text: this.l10n.getConstant('Arrow'), id: 'arrow', iconCss: 'e-icons e-arrow-right-up' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('Path') > -1)) {\n            items.push({ text: this.l10n.getConstant('Path'), id: 'path', iconCss: 'e-icons e-critical-path' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('Text') > -1)) {\n            items.push({ text: this.l10n.getConstant('Text'), id: 'text', iconCss: 'e-icons e-add-text' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('Image') > -1)) {\n            items.push({ text: this.l10n.getConstant('Image'), id: 'image', iconCss: 'e-icons e-image' });\n        }\n        var obj = { freehandDrawSelectedId: null };\n        parent.notify('freehand-draw', { prop: 'getFreehandDrawSelectedId', onPropertyChange: false, value: { obj: obj } });\n        var toolbarId = Browser.isDevice ? '#' + id + '_bottomToolbar ' + '#' + id : '#' + id;\n        this.enableDisableCloneBtn(toolbarId, obj);\n        var iconCss = isContextualToolbar ? this.getCurrentShapeIcon(parent.activeObj.shape) : 'e-annotation';\n        var drpDownBtn = new DropDownButton({ items: items, iconCss: 'e-icons ' + iconCss,\n            cssClass: 'e-image-popup',\n            open: function (args) {\n                if (parent.currObjType.isFiltered || parent.currObjType.isRedact) {\n                    parent.okBtn();\n                    parent.element.querySelector('#' + id + '_annotationBtn').click();\n                }\n                if (Browser.isDevice) {\n                    args.element.parentElement.style.top = drpDownBtn.element.getBoundingClientRect().top -\n                        args.element.parentElement.offsetHeight + 'px';\n                }\n                if (parent.activeObj.shape) {\n                    document.getElementById(parent.activeObj.shape).classList.add('e-selected');\n                }\n                else if (parent.togglePen) {\n                    document.getElementById('pen').classList.add('e-selected');\n                }\n            },\n            select: function (args) {\n                parent.noPushUndo = false;\n                _this.triggerTbarClickEvent(args);\n                parent.okBtn();\n                var isCropSelection = false;\n                var splitWords;\n                if (parent.activeObj.shape !== undefined) {\n                    splitWords = parent.activeObj.shape.split('-');\n                }\n                if (splitWords === undefined && parent.currObjType.isCustomCrop) {\n                    isCropSelection = true;\n                }\n                else if (splitWords !== undefined && splitWords[0] === 'crop') {\n                    isCropSelection = true;\n                }\n                parent.currObjType.isCustomCrop = false;\n                if (isCropSelection || parent.togglePan) {\n                    parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                    _this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                    _this.refreshToolbar('main');\n                }\n                var obj = { currentFreehandDrawIndex: null };\n                parent.notify('freehand-draw', { prop: 'getCurrentFreehandDrawIndex', value: { obj: obj } });\n                var prevObj = { shapeSettingsObj: {} };\n                var shapeSettings;\n                var shapeChangingArgs;\n                var shapes = ['ellipse', 'rectangle', 'text', 'image'];\n                var allowOutofBound;\n                drpDownBtn.iconCss = 'e-icons ' + _this.getCurrentShapeIcon(args.item.id);\n                parent.notify('draw', { prop: 'updateTempObjColl' });\n                parent.notify('draw', { prop: 'updateTempPointColl' });\n                var penStrokeWidthObj = { penStrokeWidth: 2 };\n                switch (args.item.id) {\n                    case 'pen':\n                        parent.notify('freehand-draw', { prop: 'getPenStrokeWidth', onPropertyChange: false, value: { obj: penStrokeWidthObj } });\n                        parent.notify('draw', { prop: 'setTempStrokeWidth', value: { strokeWidth: penStrokeWidthObj['penStrokeWidth'] } });\n                        parent.drawingShape = null;\n                        parent.notify('draw', { prop: 'setTempFreehandCounter', value: { tempFreehandCounter: parent.freehandCounter } });\n                        parent.notify('draw', { prop: 'setTempCurrentFreehandDrawIndex', value: { tempCurrentFreehandDrawIndex: obj['currentFreehandDrawIndex'] } });\n                        _this.currentToolbar = 'pen';\n                        parent.freeHandDraw(true);\n                        parent.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: prevObj } });\n                        shapeSettings = prevObj['shapeSettingsObj'];\n                        parent.notify('freehand-draw', { prop: 'getPenStrokeWidth', onPropertyChange: false, value: { obj: penStrokeWidthObj } });\n                        shapeSettings.strokeWidth = penStrokeWidthObj['penStrokeWidth'];\n                        shapeSettings.type = ShapeType.FreehandDraw;\n                        shapeChangingArgs = { cancel: false, action: 'insert', previousShapeSettings: shapeSettings,\n                            currentShapeSettings: shapeSettings };\n                        parent.notify('freehand-draw', { prop: 'triggerShapeChanging', value: { shapeChangingArgs: shapeChangingArgs } });\n                        break;\n                    case 'text':\n                        _this.currentToolbar = 'text';\n                        parent.drawingShape = args.item.id;\n                        _this.currentToolbar = 'text';\n                        _this.setInitialShapeSettings(args);\n                        parent.notify('selection', { prop: 'annotate', value: { shape: args.item.id } });\n                        parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'text',\n                                isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                        break;\n                    case 'image':\n                        parent.drawingShape = null;\n                        _this.currentToolbar = 'shapes';\n                        parent.element.querySelector('#' + id + '_fileUpload').click();\n                        break;\n                    case 'ellipse':\n                    case 'arrow':\n                    case 'line':\n                    case 'rectangle':\n                    case 'path':\n                        parent.drawingShape = args.item.id;\n                        _this.currentToolbar = 'shapes';\n                        _this.setInitialShapeSettings(args);\n                        parent.notify('selection', { prop: 'annotate', value: { shape: args.item.id } });\n                        parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'shapes',\n                                isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                        parent.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: prevObj } });\n                        shapeSettings = prevObj['shapeSettingsObj'];\n                        allowOutofBound = shapes.indexOf(_this.parent.activeObj.shape) !== -1 ? false : true;\n                        shapeChangingArgs = { cancel: false, action: 'insert', previousShapeSettings: shapeSettings,\n                            currentShapeSettings: shapeSettings, allowShapeOverflow: allowOutofBound };\n                        parent.trigger('shapeChanging', shapeChangingArgs);\n                        parent.editCompleteArgs = shapeChangingArgs;\n                        parent.notify('shape', { prop: 'updateShapeChangeEventArgs', value: { shapeSettings: shapeChangingArgs.currentShapeSettings } });\n                        break;\n                }\n                _this.updateToolbarItems();\n                var tempTogglePen = parent.togglePen;\n                if (args.item.id === 'pen') {\n                    parent.togglePen = false;\n                }\n                parent.notify('draw', { prop: 'redrawDownScale' });\n                parent.togglePen = tempTogglePen;\n            }\n        });\n        // Render initialized DropDownButton.\n        drpDownBtn.appendTo('#' + id + '_annotationBtn');\n    };\n    ToolbarModule.prototype.enableDisableCloneBtn = function (toolbarId, obj) {\n        var parent = this.parent;\n        var isDummyTextClick = false;\n        if (parent.activeObj.shape && parent.activeObj.shape === 'text' &&\n            parent.activeObj.textSettings.fontSize === 11 && Math.floor(parent.activeObj.activePoint.width) === 55 &&\n            Math.floor(parent.activeObj.activePoint.height) === 11) {\n            isDummyTextClick = true;\n        }\n        var duplicateElement = document.querySelector(toolbarId + '_duplicate');\n        var removeElement = document.querySelector(toolbarId + '_remove');\n        var editTextElement = document.querySelector(toolbarId + '_editText');\n        var zOrderElement = document.querySelector(toolbarId + '_zOrderBtn');\n        if (isDummyTextClick || (parent.activeObj.activePoint.width === 0 && parent.activeObj.activePoint.height === 0) &&\n            (isNullOrUndefined(parent.activeObj.pointColl) || (parent.activeObj.pointColl\n                && parent.activeObj.pointColl.length === 0)) &&\n            isNullOrUndefined(obj['freehandDrawSelectedId'])) {\n            if (duplicateElement) {\n                duplicateElement.classList.add('e-overlay');\n            }\n            if (removeElement) {\n                removeElement.classList.add('e-overlay');\n            }\n            if (editTextElement) {\n                editTextElement.classList.add('e-overlay');\n            }\n            if (zOrderElement) {\n                zOrderElement.classList.add('e-overlay');\n            }\n        }\n        else {\n            if (duplicateElement) {\n                duplicateElement.classList.remove('e-overlay');\n            }\n            if (removeElement) {\n                removeElement.classList.remove('e-overlay');\n            }\n            if (editTextElement) {\n                editTextElement.classList.remove('e-overlay');\n            }\n            if (zOrderElement) {\n                zOrderElement.classList.remove('e-overlay');\n            }\n        }\n        if (zOrderElement && (parent.shapeColl.length === 0 || (obj['freehandDrawSelectedId'] && parent.shapeColl.length === 1))) {\n            zOrderElement.classList.add('e-overlay');\n        }\n    };\n    ToolbarModule.prototype.renderStraightenSlider = function () {\n        var parent = this.parent;\n        var id = parent.element.id;\n        if ((isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('Straightening') > -1)) &&\n            parent.element.querySelector('#' + id + '_straightenSlider')) {\n            var slider = this.createSlider(-45, 45, parent.cropObj.straighten, 'straighten');\n            slider.appendTo('#' + id + '_straightenSlider');\n            var sliderHandle = slider.element.querySelector('.e-handle');\n            if (sliderHandle && !Browser.isDevice) {\n                sliderHandle.addEventListener('mousedown', function (e) {\n                    e.preventDefault();\n                    e.stopPropagation();\n                });\n                sliderHandle.addEventListener('touchstart', function (e) {\n                    e.preventDefault();\n                    e.stopPropagation();\n                });\n            }\n        }\n    };\n    ToolbarModule.prototype.renderCropBtn = function (shapeString) {\n        var _this = this;\n        var parent = this.parent;\n        var items = [];\n        var isCustomized = false;\n        var defItems = ['CustomSelection', 'CircleSelection', 'SquareSelection', 'RatioSelection'];\n        if (parent.toolbar) {\n            for (var i = 0; i < defItems.length; i++) {\n                if (parent.toolbar.indexOf(defItems[i]) !== -1) {\n                    isCustomized = true;\n                    break;\n                }\n            }\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('CustomSelection') > -1)) {\n            items.push({ text: this.l10n.getConstant('Custom'), id: 'custom', iconCss: 'e-icons e-custom' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('CircleSelection') > -1)) {\n            items.push({ text: this.l10n.getConstant('Circle'), id: 'circle', iconCss: 'e-icons e-circle' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('SquareSelection') > -1)) {\n            items.push({ text: this.l10n.getConstant('Square'), id: 'square', iconCss: 'e-icons e-square' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('RatioSelection') > -1)) {\n            items.push({ text: '2:3', id: '2:3', iconCss: 'e-icons e-custom-f' });\n            items.push({ text: '3:2', id: '3:2', iconCss: 'e-icons e-custom-a' });\n            items.push({ text: '3:4', id: '3:4', iconCss: 'e-icons e-custom-g' });\n            items.push({ text: '4:3', id: '4:3', iconCss: 'e-icons e-custom-b' });\n            items.push({ text: '4:5', id: '4:5', iconCss: 'e-icons e-custom-h' });\n            items.push({ text: '5:4', id: '5:4', iconCss: 'e-icons e-custom-c' });\n            items.push({ text: '5:7', id: '5:7', iconCss: 'e-icons e-custom-i' });\n            items.push({ text: '7:5', id: '7:5', iconCss: 'e-icons e-custom-d' });\n            items.push({ text: '9:16', id: '9:16', iconCss: 'e-icons e-custom-j' });\n            items.push({ text: '16:9', id: '16:9', iconCss: 'e-icons e-custom-e' });\n        }\n        var iconCss;\n        var shape;\n        if (shapeString) {\n            iconCss = this.getCurrentShapeIcon(shapeString);\n            shape = shapeString;\n        }\n        else if (parent.activeObj.shape &&\n            (parent.activeObj.activePoint.width !== 0 || parent.activeObj.activePoint.height !== 0) ||\n            (parent.activeObj.shape === 'path' && parent.activeObj.pointColl.length > 0)) {\n            iconCss = this.getCurrentShapeIcon(parent.activeObj.shape);\n            shape = parent.activeObj.shape;\n        }\n        else if (parent.currSelectionPoint) {\n            iconCss = this.getCurrentShapeIcon(parent.currSelectionPoint.shape);\n            shape = parent.currSelectionPoint.shape;\n        }\n        else {\n            iconCss = items[0].iconCss;\n            shape = items[0].id;\n        }\n        var drpDownBtn = new DropDownButton({\n            open: function (args) {\n                if (parent.togglePan) {\n                    _this.cancelPan();\n                }\n                if (Browser.isDevice) {\n                    args.element.parentElement.style.top = drpDownBtn.element.getBoundingClientRect().top -\n                        args.element.parentElement.offsetHeight + 'px';\n                }\n                if (parent.activeObj.shape && parent.activeObj.shape.split('-').length > 1) {\n                    var elem = document.getElementById(parent.activeObj.shape.split('-')[1]);\n                    if (elem) {\n                        elem.classList.add('e-selected');\n                        elem.focus();\n                    }\n                }\n                parent.notify('transform', { prop: 'disableZoomOutBtn', value: { isZoomOut: true } });\n            },\n            items: items,\n            select: function (args) {\n                _this.triggerTbarClickEvent(args);\n                _this.cropSelect(args);\n                drpDownBtn.iconCss = 'e-icons ' + _this.getCurrentShapeIcon('crop-' + args.item.id);\n                drpDownBtn.content = Browser.isDevice ? null : parent.toPascalCase(args.item.id);\n            },\n            iconCss: 'e-icons ' + iconCss, cssClass: 'e-image-popup e-ie-crop-ddb-popup',\n            content: Browser.isDevice ? null : parent.toPascalCase(shape.replace('crop-', ''))\n        });\n        drpDownBtn.appendTo('#' + parent.element.id + '_cropBtn');\n    };\n    ToolbarModule.prototype.renderTransformBtn = function () {\n        var _this = this;\n        var parent = this.parent;\n        var items = [];\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('RotateLeft') > -1)) {\n            items.push({ text: this.l10n.getConstant('RotateLeft'), id: 'rotateleft', iconCss: 'e-icons e-anti-clock-wise' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('RotateRight') > -1)) {\n            items.push({ text: this.l10n.getConstant('RotateRight'), id: 'rotateright', iconCss: 'e-icons e-clock-wise' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('FlipHorizontal') > -1)) {\n            items.push({ text: this.l10n.getConstant('HorizontalFlip'), id: 'horizontalflip', iconCss: 'e-icons e-horizontal-flip' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('FlipVertical') > -1)) {\n            items.push({ text: this.l10n.getConstant('VerticalFlip'), id: 'verticalflip', iconCss: 'e-icons e-vertical-flip' });\n        }\n        var drpDownBtn = new DropDownButton({\n            open: function (args) {\n                if (Browser.isDevice) {\n                    var elem = args.element.parentElement;\n                    var ht = elem.offsetHeight;\n                    elem.style.display = 'none';\n                    elem.style.top = drpDownBtn.element.getBoundingClientRect().top - ht + 'px';\n                    elem.style.display = 'block';\n                }\n            },\n            items: items,\n            select: function (args) {\n                _this.triggerTbarClickEvent(args);\n                parent.transformSelect.bind(_this);\n            },\n            iconCss: 'e-icons e-transform', cssClass: 'e-image-popup'\n        });\n        drpDownBtn.appendTo('#' + parent.element.id + '_transformBtn');\n    };\n    ToolbarModule.prototype.saveDialogPopup = function () {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        var quality = ['Good', 'Great', 'Highest'];\n        parent.element.appendChild(parent.createElement('div', { id: id + '_saveDialog' }));\n        var dialogContent = parent.createElement('div', {\n            id: id + '_dialogContent', attrs: { style: 'display: flex;' }\n        });\n        var dialogImgContent = dialogContent.appendChild(parent.createElement('div', {\n            id: id + '_dialogImgContent', className: 'e-ie-dlg-img-content'\n        }));\n        dialogImgContent.appendChild(parent.createElement('canvas', {\n            id: id + '_imgPic', className: 'e-ie-img-dlg-canvas'\n        }));\n        var imageNameContainer = dialogImgContent.appendChild(parent.createElement('div', {\n            id: id + '_imageNameContainer', className: 'e-ie-img-size'\n        }));\n        imageNameContainer.appendChild(parent.createElement('span', {\n            id: id + '_imageNameLabel', className: 'e-ie-quality-info'\n        }));\n        var dialogRightContent = dialogContent.appendChild(parent.createElement('div', {\n            id: id + '_dialogRightContent', className: 'e-ie-dlg-right-content'\n        }));\n        var imageNameDiv = dialogRightContent.appendChild(parent.createElement('div', {\n            id: id + '_namediv', className: 'e-ie-img-save-name'\n        }));\n        imageNameDiv.appendChild(parent.createElement('span', {\n            id: id + '_labelImgname', className: 'e-ie-img-label-name', innerHTML: this.l10n.getConstant('ImageName')\n        }));\n        imageNameDiv.appendChild(parent.createElement('input', {\n            id: id + '_imgNametext', className: 'e-ie-img-input', attrs: { type: 'text' }\n        }));\n        var formatNameDiv = dialogRightContent.appendChild(parent.createElement('div', {\n            id: id + '_imgNamediv', className: 'e-ie-img-save-dlg'\n        }));\n        formatNameDiv.appendChild(parent.createElement('span', {\n            id: id + '_labelname', className: 'e-ie-img-label-name', innerHTML: this.l10n.getConstant('Format')\n        }));\n        formatNameDiv.appendChild(parent.createElement('button', {\n            id: id + '_saveDropdownbtn', attrs: { tabindex: '1' }\n        }));\n        var qualityNameDiv = dialogRightContent.appendChild(parent.createElement('div', {\n            id: id + '_imgQualitydiv', className: 'e-ie-img-quality-name'\n        }));\n        var qualityDiv = parent.createElement('div', {\n            id: id + '_qualityContainer'\n        });\n        qualityDiv.appendChild(parent.createElement('span', {\n            id: id + '_qualityLabel', className: 'e-ie-img-quality-label',\n            innerHTML: this.l10n.getConstant('Quality')\n        }));\n        qualityDiv.appendChild(parent.createElement('span', {\n            id: id + '_qualityInfo', className: 'e-circle-info e-icons e-ie-quality-span',\n            attrs: { title: this.l10n.getConstant('QualityInfo') }\n        }));\n        var qualityValueElem = qualityDiv.appendChild(parent.createElement('div', {\n            id: id + '_imgsizeSpan',\n            className: 'e-ie-img-size-value-span'\n        }));\n        qualityValueElem.appendChild(parent.createElement('span', {\n            id: id + '_imgsizeValueSpan', className: ''\n        }));\n        qualityNameDiv.appendChild(qualityDiv);\n        var qualityOptionDiv = parent.createElement('div', {\n            id: id + '_qualityOptionContainer', className: 'e-ie-quality-option-container'\n        });\n        var buttonGroup = qualityNameDiv.appendChild(parent.createElement('div', {\n            id: id + '_qualityButtonGroup', className: 'e-btn-group'\n        }));\n        // eslint-disable-next-line @typescript-eslint/tslint/config\n        quality.forEach(function (option) {\n            var input = document.createElement('input');\n            input.type = 'radio';\n            input.id = id + '_' + option.toLowerCase();\n            input.name = 'quality';\n            input.value = option.toLowerCase();\n            var label = document.createElement('label');\n            label.className = 'e-btn';\n            label.htmlFor = option.toLowerCase();\n            label.textContent = _this.l10n.getConstant(option);\n            buttonGroup.appendChild(input);\n            buttonGroup.appendChild(label);\n        });\n        qualityOptionDiv.appendChild(buttonGroup);\n        qualityOptionDiv.appendChild(parent.createElement('div', {\n            id: id + '_qualitySlider', className: 'e-ie-img-quality-slider'\n        }));\n        qualityOptionDiv.appendChild(parent.createElement('button', { id: id + '_qualitybuttonIcon', className: 'e-ie-img-icon-button', attrs: { type: 'button' } }));\n        qualityNameDiv.appendChild(qualityOptionDiv);\n        if (Browser.isDevice) {\n            dialogRightContent.appendChild(parent.createElement('span', {\n                id: id + '_qualitySize', className: 'e-ie-img-quality-size'\n            }));\n        }\n        parent.element.querySelector('#' + id + '_saveDialog').style.display = 'block';\n        parent.element.appendChild(dialogContent);\n        var dialog = new Dialog({\n            target: parent.element,\n            header: this.l10n.getConstant('SaveAs'),\n            closeOnEscape: true, content: document.getElementById(id + '_dialogContent'),\n            width: Browser.isDevice ? '345px' : '570px', isModal: true, animationSettings: { effect: 'Zoom' }, beforeOpen: this.onBeforeopen(),\n            close: this.saveDialogClosed.bind(this, id),\n            cssClass: 'e-ie-save-dialog',\n            buttons: [\n                {\n                    'click': function () {\n                        dialog.hide();\n                    },\n                    buttonModel: {\n                        content: this.l10n.getConstant('Close'), cssClass: 'e-save-cancel-btn'\n                    }\n                },\n                {\n                    'click': function () {\n                        _this.download();\n                        dialog.hide();\n                        _this.isSlider = false;\n                    },\n                    buttonModel: {\n                        isPrimary: true, content: this.l10n.getConstant('Download'), cssClass: 'e-flat e-save-download-btn'\n                    }\n                }\n            ]\n        });\n        dialog.appendTo('#' + id + '_saveDialog');\n    };\n    /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n    ToolbarModule.prototype.saveDialogClosed = function (id) {\n        if (getComponent(document.getElementById(id + '_saveDropdownbtn'), 'dropdownbutton')) {\n            getComponent(document.getElementById(id + '_saveDropdownbtn'), 'dropdownbutton').destroy();\n        }\n        this.isSlider = false;\n        if (document.querySelector('#' + id + '_qualityButtonGroup') &&\n            document.querySelector('#' + id + '_qualitySlider')) {\n            document.querySelector('#' + id + '_qualityButtonGroup').remove();\n            document.querySelector('#' + id + '_qualitySlider').remove();\n            document.querySelector('#' + id + '_imgsizeValueSpan').remove();\n            document.querySelector('#' + id + '_imageNameLabel').remove();\n            document.querySelector('#' + id + '_imgsizeSpan').remove();\n        }\n        document.getElementById(id + '_dialogContent').remove();\n        getComponent(document.getElementById(id + '_saveDialog'), 'dialog').destroy();\n        document.getElementById(id + '_saveDialog').remove();\n    };\n    /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n    ToolbarModule.prototype.onBeforeopen = function () {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        var obj = { canvas: null };\n        var items = [\n            { id: 'jpeg', text: 'JPEG' },\n            { id: 'png', text: 'PNG' },\n            { id: 'svg', text: 'SVG' }\n        ];\n        var inputObj = new TextBox({\n            placeholder: this.l10n.getConstant('ImageName')\n        });\n        inputObj.appendTo('#' + id + '_imgNametext');\n        var qualityContainer = document.getElementById(id + '_imgQualitydiv');\n        var slider = document.getElementById(id + '_qualitySlider');\n        var qualityBtnGrp = document.querySelector('#' + id + '_qualityButtonGroup');\n        var qualityBtnIcon = document.querySelector('#' + id + '_qualitybuttonIcon');\n        var qualitySliderValue = document.querySelector('#' + id + '_imgsizeSpan');\n        var imageNameLabel;\n        if (Browser.isDevice) {\n            imageNameLabel = document.getElementById(id + '_qualitySize');\n        }\n        else {\n            imageNameLabel = document.getElementById(id + '_imageNameLabel');\n        }\n        var fileObj = { fileName: '', fileType: '' };\n        parent.notify('draw', { prop: 'getFileName', onPropertyChange: false, value: { obj: fileObj } });\n        this.fileType = fileObj['fileType'] ? fileObj['fileType'] : 'JPEG';\n        parent.notify('export', { prop: 'exportToCanvas', value: { object: obj } });\n        var tempCanvas = obj['canvas'];\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var canvas = document.getElementById(id + '_imgPic');\n        canvas.width = tempCanvas.width;\n        canvas.height = tempCanvas.height;\n        var buttonIcon = new Button({ iconCss: 'e-icons e-settings' });\n        buttonIcon.appendTo('#' + id + '_qualitybuttonIcon');\n        var ddbElem = document.getElementById(id + '_saveDropdownbtn');\n        if (ddbElem) {\n            var spanElem_1 = document.createElement('span');\n            spanElem_1.innerHTML = this.fileType.toUpperCase();\n            if (ddbElem) {\n                ddbElem.appendChild(spanElem_1);\n            }\n            var drpDownBtn_1 = new DropDownButton({\n                items: items,\n                open: function (args) {\n                    if (Browser.isDevice) {\n                        args.element.parentElement.style.top = drpDownBtn_1.element.getBoundingClientRect().top -\n                            args.element.parentElement.offsetHeight + 'px';\n                    }\n                    var activeBtn = spanElem_1.innerHTML;\n                    if (activeBtn !== '') {\n                        args.element.querySelector('[aria-label = ' + '\"' + activeBtn + '\"' + ']').classList.add('e-selected-btn');\n                    }\n                },\n                select: function (args) {\n                    qualitySliderValue.style.display = 'none';\n                    _this.fileType = spanElem_1.innerHTML = args.item.text;\n                    if (args.item.id !== 'jpeg') {\n                        qualityContainer.style.display = 'none';\n                        imageNameLabel.style.display = 'block';\n                        _this.updateImageSize(1, obj['canvas'], _this.fileType);\n                        if (slider) {\n                            if (_this.isSlider) {\n                                getComponent(slider, 'slider').destroy();\n                            }\n                            slider.style.display = 'none';\n                        }\n                        _this.isSlider = false;\n                    }\n                    else {\n                        qualityContainer.style.display = 'block';\n                        removeClass([qualityBtnGrp], 'e-hide');\n                        slider.style.display = 'none';\n                        imageNameLabel.style.display = 'block';\n                        _this.updateImageSize(isNullOrUndefined(_this.currentQuality) ? 1 : _this.currentQuality, obj['canvas'], _this.fileType);\n                        document.getElementById(id + '_' + _this.imageQuality).checked = true;\n                    }\n                }\n            });\n            drpDownBtn_1.appendTo('#' + id + '_saveDropdownbtn');\n            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n            var imgName = document.getElementById(id + '_imgNametext');\n            imgName.value = this.fileName ? this.fileName : fileObj['fileName'];\n            if (fileObj['fileType'] && fileObj['fileType'].toUpperCase() !== 'JPEG') {\n                qualityContainer.style.display = 'none';\n                qualitySliderValue.style.display = 'none';\n            }\n            if (Browser.isDevice) {\n                document.getElementById(id + '_dialogImgContent').style.display = 'none';\n                document.getElementById(id + '_dialogRightContent').style.width = '100%';\n                this.updateImageSize(1, obj['canvas'], this.fileType);\n            }\n            else {\n                this.updateImageSize(1, obj['canvas'], this.fileType);\n            }\n        }\n        document.getElementById(id + '_' + this.imageQuality).checked = true;\n        qualityBtnGrp.addEventListener('click', this.qualityBtnClickHandler.bind(this));\n        qualityBtnIcon.addEventListener('click', this.qualityBtnClickHandler.bind(this));\n    };\n    ToolbarModule.prototype.qualityBtnClickHandler = function (event) {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        var target = event.target;\n        var fileObj = { fileName: '' };\n        var obj = { canvas: null };\n        var compressionValues = {\n            'Good': 0.8,\n            'Great': 0.9,\n            'Highest': 1\n        };\n        var qualityBtnGrp = document.querySelector('#' + id + '_qualityButtonGroup');\n        var qualitySlider = document.querySelector('#' + id + '_qualitySlider');\n        var qualityOption = document.querySelector('#' + id + '_qualityOptionContainer');\n        var qualitySliderValueDiv = document.querySelector('#' + id + '_imgsizeSpan');\n        var qualitySliderValueSpan = document.querySelector('#' + id + '_imgsizeValueSpan');\n        parent.notify('draw', { prop: 'getFileName', onPropertyChange: false, value: { obj: fileObj } });\n        parent.notify('export', { prop: 'exportToCanvas', value: { object: obj } });\n        if (event.currentTarget.id === id + '_qualitybuttonIcon' && !this.isSlider) {\n            addClass([qualityBtnGrp], 'e-hide');\n            qualitySlider.style.display = 'block';\n            qualitySliderValueDiv.style.display = 'inline-block';\n            qualityOption.style.display = 'flex';\n            var sliderObj = new Slider({\n                tooltip: { placement: 'Before', isVisible: true, format: 'P0', showOn: 'Focus' },\n                min: 0.01, max: 1, step: 0.01, value: this.currentQuality,\n                type: 'MinRange',\n                width: Browser.isDevice ? '80%' : '190px',\n                created: function () {\n                    _this.updateImageSize(_this.currentQuality, obj['canvas'], 'jpeg');\n                    qualitySliderValueSpan.innerHTML = (Math.round(_this.currentQuality * 100)).toString();\n                },\n                changed: function (args) {\n                    _this.currentQuality = args.value;\n                    qualitySliderValueSpan.innerHTML = (Math.round(_this.currentQuality * 100)).toString();\n                    parent.notify('export', { prop: 'setImageQuality', value: { value: args.value } });\n                    _this.updateImageSize(args.value, obj['canvas'], 'jpeg');\n                }\n            });\n            sliderObj.appendTo('#' + id + '_qualitySlider');\n            sliderObj.element.parentElement.classList.add('e-ie-quality-slider');\n            this.isSlider = true;\n        }\n        else if (event.currentTarget.id === id + '_qualitybuttonIcon' && this.isSlider) {\n            getComponent(qualitySlider, 'slider').destroy();\n            qualitySlider.style.display = 'none';\n            qualitySliderValueDiv.style.display = 'none';\n            removeClass([qualityBtnGrp], 'e-hide');\n            qualityOption.style.display = 'block';\n            this.isSlider = false;\n            // eslint-disable-next-line no-prototype-builtins\n        }\n        else if (compressionValues.hasOwnProperty(target.textContent) && !this.isSlider) {\n            event.target.previousElementSibling.checked = true;\n            this.currentQuality = compressionValues[target.textContent];\n            this.imageQuality = target.textContent.toLowerCase();\n            this.updateImageSize(compressionValues[target.textContent], obj['canvas'], 'jpeg');\n        }\n    };\n    ToolbarModule.prototype.updateImageSize = function (quality, tempCanvas, fileType) {\n        var fileSize;\n        var parent = this.parent;\n        var id = parent.element.id;\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var canvas = document.getElementById(id + '_imgPic');\n        var ctx = canvas.getContext('2d');\n        var imageNameLabel;\n        if (Browser.isDevice) {\n            imageNameLabel = document.getElementById(id + '_qualitySize');\n        }\n        else {\n            imageNameLabel = document.getElementById(id + '_imageNameLabel');\n        }\n        if (fileType.toLowerCase() === 'jpeg') {\n            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n            tempCanvas.toBlob((function (blob) {\n                fileSize = Math.floor(blob.size / 1024);\n                if (fileSize > 1000) {\n                    var megabytes = fileSize / 1024;\n                    imageNameLabel.innerHTML = this.l10n.getConstant('ImageSize') + ': ' + megabytes.toFixed(2) + ' MB';\n                    fileSize = +megabytes.toFixed(2);\n                }\n                else {\n                    imageNameLabel.innerHTML = this.l10n.getConstant('ImageSize') + ': ' + fileSize.toFixed(2) + ' KB';\n                    fileSize = +fileSize.toFixed(2);\n                }\n                if (Browser.isDevice) {\n                    canvas.style.display = 'none';\n                }\n                else {\n                    var compressedImage_1 = new Image();\n                    compressedImage_1.src = URL.createObjectURL(blob);\n                    // eslint-disable-next-line @typescript-eslint/tslint/config\n                    compressedImage_1.onload = function () {\n                        ctx.drawImage(compressedImage_1, 0, 0);\n                        URL.revokeObjectURL(compressedImage_1.src);\n                    };\n                }\n                this.fileSize = fileSize;\n            }).bind(this), 'image/jpeg', quality);\n        }\n        else if (!isNullOrUndefined(fileType) && fileType.toLowerCase() === 'png') {\n            ctx.drawImage(tempCanvas, 0, 0);\n            tempCanvas.toBlob((function (blob) {\n                fileSize = Math.floor(blob.size / 1024);\n                if (fileSize > 1000) {\n                    var megabytes = fileSize / 1024;\n                    imageNameLabel.innerHTML = this.l10n.getConstant('ImageSize') + ': ' + megabytes.toFixed(2) + ' MB';\n                    fileSize = +megabytes.toFixed(2);\n                }\n                else {\n                    imageNameLabel.innerHTML = this.l10n.getConstant('ImageSize') + ': ' + fileSize.toFixed(2) + ' KB';\n                    fileSize = +fileSize.toFixed(2);\n                }\n                if (Browser.isDevice) {\n                    canvas.style.display = 'none';\n                }\n                this.fileSize = fileSize;\n            }).bind(this), 'image/png', 1);\n        }\n        else if (!isNullOrUndefined(fileType) && fileType.toLowerCase() === 'svg') {\n            ctx.drawImage(tempCanvas, 0, 0);\n            var svgDataUrl = tempCanvas.toDataURL('image/svg+xml');\n            var base64Data = svgDataUrl.split(',')[1];\n            var binaryStringLength = base64Data.length;\n            var rawByteSize = binaryStringLength;\n            var fileSize_1 = Math.floor(rawByteSize / 1024); // KB\n            if (fileSize_1 > 1000) {\n                var megabytes = fileSize_1 / 1024; // Convert to MB\n                imageNameLabel.innerHTML = this.l10n.getConstant('ImageSize') + ': ' + megabytes.toFixed(2) + ' MB';\n                fileSize_1 = +megabytes.toFixed(2);\n            }\n            else {\n                imageNameLabel.innerHTML = this.l10n.getConstant('ImageSize') + ': ' + fileSize_1.toFixed(2) + ' KB';\n                fileSize_1 = +fileSize_1.toFixed(2);\n            }\n            if (Browser.isDevice) {\n                canvas.style.display = 'none';\n            }\n            this.fileSize = fileSize_1;\n        }\n        else {\n            if (Browser.isDevice) {\n                canvas.style.display = 'none';\n            }\n            else {\n                ctx.drawImage(tempCanvas, 0, 0);\n                if (this.initialSize > 1000) {\n                    var megabytes = this.initialSize / 1048576;\n                    imageNameLabel.innerHTML = this.l10n.getConstant('ImageSize') + ': ' + megabytes.toFixed(2) + ' MB';\n                }\n                else {\n                    imageNameLabel.innerHTML = this.l10n.getConstant('ImageSize') + ': ' + this.initialSize.toFixed(2) + ' KB';\n                }\n            }\n        }\n    };\n    ToolbarModule.prototype.download = function () {\n        var parent = this.parent;\n        var id = parent.element.id;\n        if (this.fileType === 'JPEG' && this.isSlider) {\n            var value = getComponent(document.getElementById(id + '_qualitySlider'), 'slider').value;\n            parent.notify('export', { prop: 'setImageQuality', value: { value: value } });\n        }\n        else {\n            parent.notify('export', { prop: 'setImageQuality', value: { value: this.currentQuality } });\n        }\n        var fileName = document.getElementById(id + '_imgNametext').value;\n        parent.export(this.fileType, fileName);\n    };\n    ToolbarModule.prototype.getCropTransformToolbarItem = function () {\n        var parent = this.parent;\n        var id = parent.element.id;\n        var toolbarItems = [];\n        toolbarItems.push({ id: id + '_crop', tooltipText: this.l10n.getConstant('CropSelection'), align: 'Center',\n            template: '<button id=\"' + id + '_cropBtn\"></button>'\n        });\n        toolbarItems.push({ align: 'Center', type: 'Separator' });\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && (parent.toolbar.indexOf('Transform') > -1 || parent.toolbar.indexOf('RotateLeft') > -1))) {\n            toolbarItems.push({ id: id + '_rotateLeft', prefixIcon: 'e-icons e-anti-clock-wise', tooltipText: this.l10n.getConstant('RotateLeft'), align: 'Center' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && (parent.toolbar.indexOf('Transform') > -1 || parent.toolbar.indexOf('RotateRight') > -1))) {\n            toolbarItems.push({ id: id + '_rotateRight', prefixIcon: 'e-icons e-clock-wise', tooltipText: this.l10n.getConstant('RotateRight'), align: 'Center' });\n        }\n        if (toolbarItems.length > 2) {\n            toolbarItems.push({ align: 'Center', type: 'Separator' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && (parent.toolbar.indexOf('Transform') > -1 || parent.toolbar.indexOf('HorizontalFlip') > -1))) {\n            toolbarItems.push({ id: id + '_horizontalFlip', prefixIcon: 'e-icons e-horizontal-flip', tooltipText: this.l10n.getConstant('HorizontalFlip'), align: 'Center' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && (parent.toolbar.indexOf('Transform') > -1 || parent.toolbar.indexOf('VerticalFlip') > -1))) {\n            toolbarItems.push({ id: id + '_verticalFlip', prefixIcon: 'e-icons e-vertical-flip', tooltipText: this.l10n.getConstant('VerticalFlip'), align: 'Center' });\n        }\n        if ((isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('Straightening') > -1)) && !Browser.isDevice) {\n            toolbarItems.push({ align: 'Center', type: 'Separator' });\n            if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && (parent.toolbar.indexOf('Straighten') > -1 || parent.toolbar.indexOf('Straighten') > -1))) {\n                var spanWidth = document.createElement('span');\n                spanWidth.innerHTML = this.l10n.getConstant('Straighten');\n                toolbarItems.push({ id: id + '_straightenSpan', cssClass: 'e-ie-straighten-span', template: spanWidth, align: 'Center' });\n                toolbarItems.push({ id: id + '_straighten',\n                    cssClass: 'top-icon e-straighten', tooltipText: this.l10n.getConstant('Straighten'), align: 'Center', type: 'Input',\n                    template: '<div id=\"' + id + '_straightenSlider\"></div>' });\n                var straightenSpan = document.createElement('span');\n                straightenSpan.innerHTML = parent.transform.straighten.toString() + '&#176';\n                toolbarItems.push({ id: id + '_straightenSpan', cssClass: 'e-ie-straighten-value-span',\n                    template: straightenSpan, align: 'Center' });\n            }\n        }\n        if (!Browser.isDevice) {\n            toolbarItems.push({ id: id + '_ok', prefixIcon: 'e-icons e-check', cssClass: 'top-icon e-tick',\n                tooltipText: this.l10n.getConstant('OK'), align: 'Right', tabIndex: 0 });\n            toolbarItems.push({ id: id + '_cancel', prefixIcon: 'e-icons e-close', cssClass: 'top-icon e-save',\n                tooltipText: this.l10n.getConstant('Cancel'), align: 'Right' });\n        }\n        return toolbarItems;\n    };\n    ToolbarModule.prototype.getShapesToolbarItem = function (items) {\n        var parent = this.parent;\n        var id = parent.element.id;\n        var toolbarItems = [];\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar)) {\n            toolbarItems.push({ id: id + '_annotation', tooltipText: this.l10n.getConstant('Annotation'), align: 'Center',\n                template: '<button id=\"' + id + '_annotationBtn\"></button>' });\n        }\n        if (items.indexOf('fillColor') > -1) {\n            toolbarItems.push({ prefixIcon: 'e-icons e-copy', id: id + '_fillcolor',\n                cssClass: 'top-icon e-fill', tooltipText: this.l10n.getConstant('FillColor'), align: 'Center', type: 'Input',\n                template: '<button id=\"' + id + '_fillColorBtn\"></button>' });\n        }\n        if (items.indexOf('strokeColor') > -1) {\n            toolbarItems.push({ prefixIcon: 'e-icons e-copy', id: id + '_strokecolor',\n                cssClass: 'top-icon e-stroke', tooltipText: this.l10n.getConstant('StrokeColor'), align: 'Center', type: 'Input',\n                template: '<button id=\"' + id + '_borderColorBtn\"></button>' });\n        }\n        if (items.indexOf('strokeWidth') > -1) {\n            toolbarItems.push({ id: id + '_strokeWidth', cssClass: 'top-icon e-size', tooltipText: this.l10n.getConstant('StrokeWidth'), align: 'Center',\n                type: 'Input', template: '<button id=\"' + id + '_borderWidthBtn\"></button>' });\n        }\n        if (items.indexOf('start') > -1) {\n            toolbarItems.push({ id: id + '_start', cssClass: 'top-icon e-size', tooltipText: this.l10n.getConstant('Start'), align: 'Center',\n                type: 'Input', template: '<button id=\"' + id + '_startBtn\"></button>' });\n        }\n        if (items.indexOf('borderRadius') > -1) {\n            toolbarItems.push({ id: id + '_rectangleRadius', cssClass: 'top-icon e-size', tooltipText: this.l10n.getConstant('BorderRadius'), align: 'Center',\n                type: 'Input', template: '<button id=\"' + id + '_rectangleRadiusBtn\"></button>' });\n        }\n        if (items.indexOf('end') > -1) {\n            toolbarItems.push({ id: id + '_end', cssClass: 'top-icon e-size', tooltipText: this.l10n.getConstant('End'), align: 'Center',\n                type: 'Input', template: '<button id=\"' + id + '_endBtn\"></button>' });\n        }\n        if (items.indexOf('flip') > -1) {\n            toolbarItems.push({ id: id + '_rotLeft', prefixIcon: 'e-anti-clock-wise',\n                tooltipText: this.l10n.getConstant('RotateLeft'), align: 'Center' });\n            toolbarItems.push({ id: id + '_rotRight', prefixIcon: 'e-clock-wise',\n                tooltipText: this.l10n.getConstant('RotateRight'), align: 'Center' });\n            toolbarItems.push({ id: id + '_hFlip', prefixIcon: 'e-horizontal-flip',\n                tooltipText: this.l10n.getConstant('HorizontalFlip'), align: 'Center' });\n            toolbarItems.push({ id: id + '_vFlip', prefixIcon: 'e-vertical-flip',\n                tooltipText: this.l10n.getConstant('VerticalFlip'), align: 'Center' });\n        }\n        if (items.indexOf('transparency') > -1) {\n            toolbarItems.push({ align: 'Center', type: 'Separator' });\n            toolbarItems.push({ id: id + '_transparency', prefixIcon: 'e-opacity',\n                tooltipText: this.l10n.getConstant('Opacity'), align: 'Center' });\n        }\n        toolbarItems.push({ align: 'Center', type: 'Separator' });\n        if (items.indexOf('z-order') > -1) {\n            toolbarItems.push({ id: id + '_zOrder', cssClass: 'top-icon e-list-unordered-3', tooltipText: this.l10n.getConstant('ZOrder'), align: 'Center',\n                type: 'Input', template: '<button id=\"' + id + '_zOrderBtn\"></button>' });\n        }\n        if (items.indexOf('duplicate') > -1) {\n            toolbarItems.push({ id: id + '_duplicate', prefixIcon: 'e-icons e-order', cssClass: 'top-icon e-order',\n                tooltipText: this.l10n.getConstant('Duplicate'), align: 'Center' });\n        }\n        if (items.indexOf('remove') > -1) {\n            toolbarItems.push({ id: id + '_remove', prefixIcon: 'e-icons e-trash', cssClass: 'top-icon e-trash',\n                tooltipText: this.l10n.getConstant('Remove'), align: 'Center' });\n        }\n        if (items.indexOf('text') > -1) {\n            toolbarItems.push({ id: id + '_editText', prefixIcon: 'e-icons e-annotation-edit', cssClass: 'top-icon e-annotation-edit',\n                tooltipText: this.l10n.getConstant('EditText'), align: 'Center' });\n        }\n        var tempToolbarItems = this.processSubToolbar(items);\n        for (var i = 0, len = tempToolbarItems.length; i < len; i++) {\n            toolbarItems.push(tempToolbarItems[i]);\n        }\n        if (!Browser.isDevice) {\n            var obj = { shape: null };\n            parent.notify('selection', { prop: 'getCurrentDrawingShape', value: { obj: obj } });\n            if (obj['shape'] !== 'path') {\n                toolbarItems.push({ id: id + '_ok', prefixIcon: 'e-icons e-check', cssClass: 'top-icon e-tick',\n                    tooltipText: this.l10n.getConstant('OK'), align: 'Right', tabIndex: 0 });\n                toolbarItems.push({ id: id + '_cancel', prefixIcon: 'e-icons e-close', cssClass: 'top-icon e-save',\n                    tooltipText: this.l10n.getConstant('Cancel'), align: 'Right' });\n            }\n        }\n        return toolbarItems;\n    };\n    ToolbarModule.prototype.initCropTransformToolbar = function (shape, isTransform) {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        var leftItem = this.getLeftToolbarItem();\n        var rightItem = this.getRightToolbarItem();\n        var mainItem = this.getCropTransformToolbarItem();\n        var zoomItem = this.getZoomToolbarItem();\n        if (Browser.isDevice) {\n            this.defToolbarItems = mainItem;\n        }\n        else {\n            this.defToolbarItems = leftItem.concat(zoomItem, mainItem, rightItem);\n        }\n        var args = { toolbarType: 'crop-transform', toolbarItems: this.defToolbarItems };\n        parent.trigger('toolbarUpdating', args);\n        this.defToolbarItems = args.toolbarItems;\n        var toolbar = new Toolbar({\n            width: '100%',\n            items: this.defToolbarItems,\n            clicked: this.defToolbarClicked.bind(this),\n            created: function () {\n                _this.renderCropBtn(shape);\n                _this.renderStraightenSlider();\n                _this.wireZoomBtnEvents();\n                parent.trigger('toolbarCreated', { toolbarType: 'shapes' });\n                if (Browser.isDevice) {\n                    if (_this.defToolbarItems.length > 0 && document.getElementById(id + '_bottomToolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        toolbar.refreshOverflow();\n                        toolbar.refreshOverflow();\n                        toolbar.refreshOverflow();\n                    }\n                }\n                else {\n                    _this.createLeftToolbarControls();\n                    if (_this.defToolbarItems.length > 0 && document.getElementById(id + '_toolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        toolbar.refreshOverflow();\n                    }\n                }\n                if (document.getElementById(id + '_cropBtn') && isNullOrUndefined(isTransform)) {\n                    if (!Browser.isDevice) {\n                        parent.notify('draw', { prop: 'select', onPropertyChange: false,\n                            value: { type: _this.getCropTextContent(document.getElementById(id + '_cropBtn')).toLowerCase(),\n                                startX: null, startY: null, width: null, height: null } });\n                    }\n                }\n            }\n        });\n        if (Browser.isDevice) {\n            toolbar.appendTo('#' + id + '_bottomToolbar');\n        }\n        else {\n            toolbar.appendTo('#' + id + '_toolbar');\n        }\n        var slider = parent.element.querySelector('#' + id + '_straightenSlider');\n        if ((isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('Straightening') > -1))\n            && slider && slider.parentElement.clientHeight > this.toolbarHeight) {\n            this.toolbarHeight = parent.toolbarHeight = slider.parentElement.clientHeight;\n        }\n        this.enableDisableTbrBtn();\n        parent.notify('transform', { prop: 'disableZoomOutBtn', value: { isZoomOut: true } });\n    };\n    ToolbarModule.prototype.getCropTextContent = function (elem) {\n        if (elem) {\n            var classToContentMap = { 'e-custom': 'Custom', 'e-circle': 'Circle',\n                'e-square': 'Square', 'e-custom-a': '3:2', 'e-custom-b': '4:3', 'e-custom-c': '5:4', 'e-custom-d': '7:5',\n                'e-custom-e': '16:9', 'e-custom-f': '2:3', 'e-custom-g': '3:4', 'e-custom-h': '4:5', 'e-custom-i': '5:7',\n                'e-custom-j': '9:16'\n            };\n            var classList = elem.children[0].classList;\n            for (var className in classToContentMap) {\n                if (classList.contains(className)) {\n                    return classToContentMap[className];\n                }\n            }\n        }\n        return '';\n    };\n    ToolbarModule.prototype.getCurrentShapeIcon = function (shape) {\n        // eslint-disable-next-line @typescript-eslint/tslint/config\n        var shapeIcons = {\n            rectangle: 'e-rectangle',\n            ellipse: 'e-circle',\n            line: 'e-line',\n            arrow: 'e-arrow-right-up',\n            path: 'e-critical-path',\n            text: 'e-add-text',\n            image: 'e-image',\n            pen: 'e-free-pen',\n            'crop-custom': 'e-custom',\n            'crop-circle': 'e-circle',\n            'crop-square': 'e-square',\n            'crop-3:2': 'e-custom-a',\n            'crop-4:3': 'e-custom-b',\n            'crop-5:4': 'e-custom-c',\n            'crop-7:5': 'e-custom-d',\n            'crop-16:9': 'e-custom-e',\n            'crop-2:3': 'e-custom-f',\n            'crop-3:4': 'e-custom-g',\n            'crop-4:5': 'e-custom-h',\n            'crop-5:7': 'e-custom-i',\n            'crop-9:16': 'e-custom-j'\n        };\n        return shapeIcons[shape] ? shapeIcons[shape] : (shape && shape.indexOf('crop-') !== -1) ? 'e-custom' : 'e-free-pen';\n    };\n    ToolbarModule.prototype.initShapesToolbarItem = function (items) {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        var leftItem = this.getLeftToolbarItem();\n        var rightItem = this.getRightToolbarItem();\n        var mainItem = this.getShapesToolbarItem(items);\n        var zoomItem = this.getZoomToolbarItem();\n        if (Browser.isDevice) {\n            this.defToolbarItems = mainItem;\n        }\n        else {\n            this.defToolbarItems = leftItem.concat(zoomItem, mainItem, rightItem);\n        }\n        var args = { toolbarType: parent.activeObj.shape ? parent.activeObj.shape : 'shapes',\n            toolbarItems: this.defToolbarItems };\n        parent.trigger('toolbarUpdating', args);\n        if (this.isToolbarString(args.toolbarItems)) {\n            items = args.toolbarItems;\n            this.excludeItems(args.toolbarItems);\n        }\n        else {\n            this.defToolbarItems = args.toolbarItems;\n        }\n        var toolbar = new Toolbar({\n            width: '100%',\n            items: this.defToolbarItems,\n            clicked: this.defToolbarClicked.bind(this),\n            created: function () {\n                _this.renderAnnotationBtn(true);\n                _this.createRectangleRadius(items);\n                _this.createShapeColor(items);\n                _this.createShapeBtn(items);\n                _this.createZOrderBtn(items);\n                if (parent.activeObj.shape === 'arrow') {\n                    // eslint-disable-next-line @typescript-eslint/tslint/config\n                    if (items.some(function (item) { return item.toLowerCase().indexOf('start') > -1; })) {\n                        _this.createStartBtn();\n                    }\n                    // eslint-disable-next-line @typescript-eslint/tslint/config\n                    if (items.some(function (item) { return item.toLowerCase().indexOf('end') > -1; })) {\n                        _this.createEndBtn();\n                    }\n                }\n                _this.wireZoomBtnEvents();\n                parent.trigger('toolbarCreated', { toolbarType: 'shapes' });\n                if (Browser.isDevice) {\n                    if (_this.defToolbarItems.length > 0 && document.getElementById(id + '_bottomToolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        toolbar.refreshOverflow();\n                        toolbar.refreshOverflow();\n                        toolbar.refreshOverflow();\n                    }\n                }\n                else {\n                    _this.createLeftToolbarControls();\n                    if (_this.defToolbarItems.length > 0 && document.getElementById(id + '_toolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        toolbar.refreshOverflow();\n                    }\n                }\n            }\n        });\n        if (Browser.isDevice) {\n            toolbar.appendTo('#' + id + '_bottomToolbar');\n        }\n        else {\n            toolbar.appendTo('#' + id + '_toolbar');\n        }\n        this.enableDisableTbrBtn();\n    };\n    ToolbarModule.prototype.createRectangleRadius = function (items) {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        if (items.indexOf('borderRadius') > -1) {\n            var strokeWidthItems = [\n                { id: '1', text: this.l10n.getConstant('0') },\n                { id: '2', text: this.l10n.getConstant('20') },\n                { id: '3', text: this.l10n.getConstant('40') },\n                { id: '4', text: this.l10n.getConstant('60') },\n                { id: '5', text: this.l10n.getConstant('80') },\n                { id: '6', text: this.l10n.getConstant('100') }\n            ];\n            var strokeWidthBtn = document.getElementById(id + '_rectangleRadiusBtn');\n            var spanElem_2 = document.createElement('span');\n            spanElem_2.innerHTML = this.l10n.getConstant(parent.frameObj.radius.toString());\n            spanElem_2.className = 'e-shape-rectangle-radius';\n            strokeWidthBtn.appendChild(spanElem_2);\n            // Initialize the DropDownButton component.\n            var drpDownBtn_2 = new DropDownButton({ items: strokeWidthItems,\n                open: function (args) {\n                    if (Browser.isDevice) {\n                        var parentElem = args.element.parentElement;\n                        parentElem.style.top = drpDownBtn_2.element.getBoundingClientRect().top -\n                            parentElem.offsetHeight + 'px';\n                    }\n                    var activeBtn = drpDownBtn_2.element.childNodes[0].textContent;\n                    if (activeBtn !== '') {\n                        args.element.querySelector('[aria-label = ' + '\"' + activeBtn + '\"' + ']').classList.add('e-selected-btn');\n                    }\n                },\n                select: function (args) {\n                    _this.triggerTbarClickEvent(args);\n                    spanElem_2.textContent = args.item.text;\n                    parent.updateStrokeWidth(args.item.id, 'radius');\n                    if (Browser.isDevice) {\n                        if (document.getElementById(id + '_bottomToolbar')) {\n                            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                            var toolbar_7 = getComponent(id + '_bottomToolbar', 'toolbar');\n                            toolbar_7.refreshOverflow();\n                        }\n                    }\n                    else {\n                        if (document.getElementById(id + '_toolbar')) {\n                            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                            var toolbar_8 = getComponent(id + '_toolbar', 'toolbar');\n                            toolbar_8.refreshOverflow();\n                        }\n                    }\n                    parent.notify('undo-redo', { prop: 'updateUndoRedoStack', onPropertyChange: false });\n                }\n            });\n            // Render initialized DropDownButton.\n            drpDownBtn_2.appendTo('#' + id + '_rectangleRadiusBtn');\n        }\n    };\n    ToolbarModule.prototype.beforeModeSwitch = function (args, inst) {\n        this.popupLeft = args.element.offsetParent.style.left;\n        if (args.mode === 'Picker') {\n            inst.showButtons = true;\n            inst.dataBind();\n            args.element.querySelector('.e-apply').title = this.l10n.getConstant('Apply');\n            args.element.querySelector('.e-cancel').title = this.l10n.getConstant('Cancel');\n            args.element.querySelector('.e-mode-switch-btn').title = this.l10n.getConstant('StandardColors');\n        }\n        else {\n            inst.showButtons = false;\n            inst.dataBind();\n            args.element.querySelector('.e-mode-switch-btn').title = this.l10n.getConstant('MoreColors');\n        }\n    };\n    ToolbarModule.prototype.createShapeColor = function (items) {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        if (items.indexOf('fillColor') > -1) {\n            parent.element.querySelector('.e-template.e-fill').appendChild(parent.createElement('input', {\n                id: id + '_shape_fill'\n            }));\n            var fillColor_1 = new ColorPicker({\n                modeSwitcher: true, noColor: true, value: '', inline: true,\n                showButtons: false, mode: 'Palette', cssClass: 'e-shape-fill-color',\n                beforeModeSwitch: function (args) { return _this.beforeModeSwitch(args, fillColor_1); },\n                presetColors: {\n                    'custom': ['', '#f44336', '#e91e63', '#9c27b0', '#673ab7', '#2196f3',\n                        '#03a9f4', '#00bcd4', '#009688', '#ffeb3b', '#ffffff', '#ffebee', '#fce4ec', '#f3e5f5', '#ede7f6', '#e3f2fd',\n                        '#e1f5fe', '#e0f7fa', '#e0f2f1', '#fffde7', '#f2f2f2', '#ffcdd2', '#f8bbd0', '#e1bee7', '#d1c4e9', '#bbdefb',\n                        '#b3e5fc', '#b2ebf2', '#b2dfdb', '#fff9c4', '#e6e6e6', '#ef9a9a', '#f48fb1', '#ce93d8', '#b39ddb', '#90caf9',\n                        '#81d4fa', '#80deea', '#80cbc4', '#fff59d', '#cccccc', '#e57373', '#f06292', '#ba68c8', '#9575cd', '#64b5f6',\n                        '#4fc3f7', '#4dd0e1', '#4db6ac', '#fff176', '#b3b3b3', '#ef5350', '#ec407a', '#ab47bc', '#7e57c2', '#42a5f5',\n                        '#29b6f6', '#26c6da', '#26a69a', '#ffee58', '#999999', '#e53935', '#d81b60', '#8e24aa', '#5e35b1', '#1e88e5',\n                        '#039be5', '#00acc1', '#00897b', '#fdd835', '#808080', '#d32f2f', '#c2185b', '#7b1fa2', '#512da8', '#1976d2',\n                        '#0288d1', '#0097a7', '#00796b', '#fbc02d', '#666666', '#c62828', '#ad1457', '#6a1b9a', '#4527a0', '#1565c0',\n                        '#0277bd', '#00838f', '#00695c', '#f9a825', '#4d4d4d', '#b71c1c', '#880e4f', '#4a148c', '#311b92', '#0d47a1',\n                        '#01579b', '#006064', '#004d40', '#f57f17']\n                },\n                beforeTileRender: function (args) {\n                    if (args.value === '') {\n                        args.element.classList.add('e-nocolor-item');\n                    }\n                },\n                change: function (args) {\n                    parent.updateFillColor(args.value);\n                    if (args.currentValue.rgba === '') {\n                        fillDDB_1.element.children[0].classList.add('e-nocolor-item');\n                    }\n                    else {\n                        fillDDB_1.element.children[0].classList.remove('e-nocolor-item');\n                        fillDDB_1.element.children[0].style.backgroundColor = args.currentValue.rgba;\n                    }\n                    fillDDB_1.toggle();\n                    parent.notify('undo-redo', { prop: 'updateUndoRedoStack', onPropertyChange: false });\n                },\n                onModeSwitch: function (args) {\n                    if (Browser.isDevice) {\n                        args.element.parentElement.parentElement.style.left = _this.popupLeft;\n                        args.element.parentElement.parentElement.style.top = (fillDDB_1.element.getBoundingClientRect().top - args.element.parentElement.parentElement.offsetHeight) + 'px';\n                    }\n                },\n                beforeClose: function () {\n                    fillDDB_1.toggle();\n                }\n            }, '#' + id + '_shape_fill');\n            var fillDDB_1 = new DropDownButton({\n                open: function (args) {\n                    var parenElem = args.element.parentElement;\n                    if (Browser.isDevice) {\n                        parenElem.style.top = fillDDB_1.element.getBoundingClientRect().top -\n                            parenElem.offsetHeight + 'px';\n                        if (window.innerWidth <= 520) {\n                            parenElem.style.left = parent.element.offsetLeft + 'px';\n                        }\n                    }\n                },\n                target: '.e-shape-fill-color',\n                iconCss: 'e-dropdownbtn-preview',\n                cssClass: 'e-ie-ddb-popup'\n            }, '#' + id + '_fillColorBtn');\n            fillColor_1.inline = true;\n            fillColor_1.value = fillColor_1.getValue(fillColor_1.value, 'rgba');\n            parent.element.querySelector('.e-fill.e-template .e-dropdownbtn-preview').classList.add('e-nocolor-item');\n        }\n        if (items.indexOf('strokeColor') > -1) {\n            parent.element.querySelector('.e-template.e-stroke').appendChild(parent.createElement('input', {\n                id: id + '_shape_stroke'\n            }));\n            var strokeColor_1 = new ColorPicker({\n                modeSwitcher: true, noColor: false, value: '#fff', inline: true,\n                showButtons: false, mode: 'Palette', cssClass: 'e-shape-stroke-color',\n                beforeModeSwitch: function (args) {\n                    _this.popupLeft = args.element.offsetParent.style.left;\n                    strokeColor_1.value = parent.activeObj.strokeSettings.strokeColor !== '#fff' ? parent.activeObj.strokeSettings.strokeColor : '#008000ff';\n                    _this.beforeModeSwitch(args, strokeColor_1);\n                },\n                presetColors: this.presetColors,\n                change: function (args) {\n                    parent.updateStrokeColor(args.value);\n                    strokeDDB_1.element.children[0].style.backgroundColor = args.currentValue.rgba;\n                    strokeDDB_1.toggle();\n                    parent.notify('undo-redo', { prop: 'updateUndoRedoStack', onPropertyChange: false });\n                },\n                onModeSwitch: function (args) {\n                    if (Browser.isDevice) {\n                        args.element.parentElement.parentElement.style.left = _this.popupLeft;\n                        args.element.parentElement.parentElement.style.top = (strokeDDB_1.element.getBoundingClientRect().top - args.element.parentElement.parentElement.offsetHeight) + 'px';\n                    }\n                },\n                beforeClose: function () {\n                    strokeDDB_1.toggle();\n                }\n            }, '#' + id + '_shape_stroke');\n            var strokeDDB_1 = new DropDownButton({\n                open: function (args) {\n                    var parenElem = args.element.parentElement;\n                    if (Browser.isDevice) {\n                        parenElem.style.top = strokeDDB_1.element.getBoundingClientRect().top -\n                            parenElem.offsetHeight + 'px';\n                        if (window.innerWidth <= 520) {\n                            parenElem.style.left = parent.element.offsetLeft + 'px';\n                        }\n                    }\n                },\n                target: '.e-shape-stroke-color',\n                iconCss: 'e-dropdownbtn-preview',\n                cssClass: 'e-ie-ddb-popup'\n            }, '#' + id + '_borderColorBtn');\n            strokeColor_1.inline = true;\n            strokeColor_1.value = strokeColor_1.getValue(strokeColor_1.value, 'rgba');\n            parent.element.querySelector('.e-stroke.e-template .e-dropdownbtn-preview').style.background = '#fff';\n        }\n    };\n    ToolbarModule.prototype.createShapeBtn = function (items) {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        if (items.indexOf('strokeWidth') > -1) {\n            var strokeWidthItems = [\n                { id: '1', text: this.l10n.getConstant('XSmall') },\n                { id: '2', text: this.l10n.getConstant('Small') },\n                { id: '3', text: this.l10n.getConstant('Medium') },\n                { id: '4', text: this.l10n.getConstant('Large') },\n                { id: '5', text: this.l10n.getConstant('XLarge') }\n            ];\n            if (parent.activeObj.shape && (parent.activeObj.shape === 'rectangle' || parent.activeObj.shape === 'ellipse')) {\n                strokeWidthItems = [\n                    { id: '1', text: this.l10n.getConstant('NoOutline') },\n                    { id: '2', text: this.l10n.getConstant('XSmall') },\n                    { id: '3', text: this.l10n.getConstant('Small') },\n                    { id: '4', text: this.l10n.getConstant('Medium') },\n                    { id: '5', text: this.l10n.getConstant('Large') },\n                    { id: '6', text: this.l10n.getConstant('XLarge') }\n                ];\n            }\n            var strokeWidthBtn = document.getElementById(id + '_borderWidthBtn');\n            var spanElem_3 = document.createElement('span');\n            spanElem_3.innerHTML = this.l10n.getConstant('XSmall');\n            spanElem_3.className = 'e-shape-stroke-width';\n            strokeWidthBtn.appendChild(spanElem_3);\n            // Initialize the DropDownButton component.\n            var drpDownBtn_3 = new DropDownButton({ items: strokeWidthItems,\n                open: function (args) {\n                    if (Browser.isDevice) {\n                        args.element.parentElement.style.top = drpDownBtn_3.element.getBoundingClientRect().top -\n                            args.element.parentElement.offsetHeight + 'px';\n                    }\n                    var activeBtn = spanElem_3.innerHTML;\n                    if (activeBtn !== '') {\n                        args.element.querySelector('[aria-label = ' + '\"' + activeBtn + '\"' + ']').classList.add('e-selected-btn');\n                    }\n                },\n                select: function (args) {\n                    _this.triggerTbarClickEvent(args);\n                    spanElem_3.textContent = args.item.text;\n                    parent.updateStrokeWidth(args.item.id, 'width', parent.activeObj.shape);\n                    if (Browser.isDevice) {\n                        if (document.getElementById(id + '_bottomToolbar')) {\n                            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                            var toolbar_9 = getComponent(id + '_bottomToolbar', 'toolbar');\n                            toolbar_9.refreshOverflow();\n                        }\n                    }\n                    else {\n                        if (document.getElementById(id + '_toolbar')) {\n                            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                            var toolbar_10 = getComponent(id + '_toolbar', 'toolbar');\n                            toolbar_10.refreshOverflow();\n                        }\n                    }\n                    parent.notify('undo-redo', { prop: 'updateUndoRedoStack', onPropertyChange: false });\n                }\n            });\n            // Render initialized DropDownButton.\n            drpDownBtn_3.appendTo('#' + id + '_borderWidthBtn');\n        }\n    };\n    ToolbarModule.prototype.createZOrderBtn = function (items) {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        if (items.indexOf('z-order') > -1) {\n            var zOrderItems = [\n                { text: this.l10n.getConstant('BringForward'), id: 'bringForward', iconCss: 'e-icons e-bring-forward' },\n                { text: this.l10n.getConstant('SendBackward'), id: 'sendBackward', iconCss: 'e-icons e-send-backward' },\n                { text: this.l10n.getConstant('BringToFront'), id: 'bringToFront', iconCss: 'e-icons e-bring-to-front' },\n                { text: this.l10n.getConstant('SendToBack'), id: 'sendToBack', iconCss: 'e-icons e-send-to-back' }\n            ];\n            // Initialize the DropDownButton component.\n            var drpDownBtn_4 = new DropDownButton({ items: zOrderItems, iconCss: 'e-icons e-layers',\n                beforeOpen: function (args) {\n                    if (document.getElementById(parent.element.id + '_zOrderBtn').classList.contains('e-disabled')) {\n                        args.cancel = true;\n                    }\n                    var indexObj = { freehandSelectedIndex: -1 };\n                    parent.notify('freehand-draw', { prop: 'getFreehandSelectedIndex', onPropertyChange: false, value: { obj: indexObj } });\n                    var orderObj = { order: null };\n                    parent.notify('shape', { prop: 'getHighestOrder', onPropertyChange: false, value: { obj: orderObj } });\n                    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                    var order = parent.activeObj.order ? parent.activeObj.order : parent.getObjFromId(parent.pointColl[indexObj['freehandSelectedIndex']].id).order;\n                    if (order && order >= orderObj['order']) {\n                        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                        args.items[0].disabled = true;\n                        args.items[2].disabled = true;\n                    }\n                    else {\n                        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                        args.items[0].disabled = false;\n                        args.items[2].disabled = false;\n                    }\n                    parent.notify('shape', { prop: 'getLowestOrder', onPropertyChange: false, value: { obj: orderObj } });\n                    if (order && order <= orderObj['order']) {\n                        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                        args.items[1].disabled = true;\n                        args.items[3].disabled = true;\n                    }\n                    else {\n                        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                        args.items[1].disabled = false;\n                        args.items[3].disabled = false;\n                    }\n                },\n                open: function (args) {\n                    if (Browser.isDevice) {\n                        args.element.parentElement.style.top = drpDownBtn_4.element.getBoundingClientRect().top -\n                            args.element.parentElement.offsetHeight + 'px';\n                    }\n                },\n                select: function (args) {\n                    _this.triggerTbarClickEvent(args);\n                    var obj = { freehandDrawSelectedId: null };\n                    parent.notify('freehand-draw', { prop: 'getFreehandDrawSelectedId', onPropertyChange: false, value: { obj: obj } });\n                    var shapeId = obj['freehandDrawSelectedId'] ? obj['freehandDrawSelectedId'] : parent.activeObj.currIndex;\n                    parent.updateShapeOrder(shapeId, args.item.id);\n                    if (Browser.isDevice) {\n                        if (document.getElementById(id + '_bottomToolbar')) {\n                            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                            var toolbar_11 = getComponent(id + '_bottomToolbar', 'toolbar');\n                            toolbar_11.refreshOverflow();\n                        }\n                    }\n                    else {\n                        if (document.getElementById(id + '_toolbar')) {\n                            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                            var toolbar_12 = getComponent(id + '_toolbar', 'toolbar');\n                            toolbar_12.refreshOverflow();\n                        }\n                    }\n                    if (shapeId.indexOf('shape') > -1) {\n                        parent.notify('undo-redo', { prop: 'updateUndoRedoStack', onPropertyChange: false });\n                    }\n                    else if (shapeId.indexOf('pen') > -1) {\n                        parent.notify('undo-redo', { prop: 'updateUndoRedoStack', value: { isPenDraw: true } });\n                    }\n                }\n            });\n            // Render initialized DropDownButton.\n            drpDownBtn_4.appendTo('#' + id + '_zOrderBtn');\n        }\n    };\n    ToolbarModule.prototype.createStartBtn = function () {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        var strokeWidthItems = [\n            { id: '1', text: this.l10n.getConstant('None') },\n            { id: '2', text: this.l10n.getConstant('Bar') },\n            { id: '3', text: this.l10n.getConstant('Arrow') },\n            { id: '4', text: this.l10n.getConstant('ArrowSolid') },\n            { id: '5', text: this.l10n.getConstant('Circle') },\n            { id: '6', text: this.l10n.getConstant('CircleSolid') },\n            { id: '7', text: this.l10n.getConstant('Square') },\n            { id: '8', text: this.l10n.getConstant('SquareSolid') }\n        ];\n        var strokeWidthBtn = document.getElementById(id + '_startBtn');\n        var spanElem = document.createElement('span');\n        if (isNullOrUndefined(parent.activeObj.start)) {\n            parent.activeObj.start = 'none';\n        }\n        spanElem.innerHTML = parent.pascalToSplitWords(parent.activeObj.start);\n        spanElem.className = 'e-shape-start';\n        strokeWidthBtn.appendChild(spanElem);\n        // Initialize the DropDownButton component.\n        var drpDownBtn = new DropDownButton({ items: strokeWidthItems,\n            open: function (args) {\n                if (Browser.isDevice) {\n                    args.element.parentElement.style.top = drpDownBtn.element.getBoundingClientRect().top -\n                        args.element.parentElement.offsetHeight + 'px';\n                }\n                var activeBtn = spanElem.innerHTML;\n                if (activeBtn !== '') {\n                    args.element.querySelector('[aria-label = ' + '\"' + activeBtn + '\"' + ']').classList.add('e-selected-btn');\n                }\n            },\n            select: function (args) {\n                var idToValue = { '1': 'none', '2': 'bar', '3': 'arrow', '4': 'arrowSolid',\n                    '5': 'circle', '6': 'circleSolid', '7': 'square', '8': 'squareSolid' };\n                parent.notify('selection', { prop: 'setArrowShape', value: { type: 'initial', shape: idToValue[\"\" + args.item.id] } });\n                _this.triggerTbarClickEvent(args);\n                spanElem.textContent = args.item.text;\n                parent.updateArrow('startArrow', args.item.id);\n                parent.notify('undo-redo', { prop: 'updateUndoRedoStack', onPropertyChange: false });\n            }\n        });\n        // Render initialized DropDownButton.\n        drpDownBtn.appendTo('#' + id + '_startBtn');\n    };\n    ToolbarModule.prototype.createEndBtn = function () {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        var strokeWidthItems = [\n            { id: '1', text: this.l10n.getConstant('None') },\n            { id: '2', text: this.l10n.getConstant('Bar') },\n            { id: '3', text: this.l10n.getConstant('Arrow') },\n            { id: '4', text: this.l10n.getConstant('ArrowSolid') },\n            { id: '5', text: this.l10n.getConstant('Circle') },\n            { id: '6', text: this.l10n.getConstant('CircleSolid') },\n            { id: '7', text: this.l10n.getConstant('Square') },\n            { id: '8', text: this.l10n.getConstant('SquareSolid') }\n        ];\n        var strokeEndBtn = document.getElementById(id + '_endBtn');\n        var spanElem = document.createElement('span');\n        if (isNullOrUndefined(parent.activeObj.end)) {\n            parent.activeObj.end = 'arrowSolid';\n        }\n        spanElem.innerHTML = parent.pascalToSplitWords(parent.activeObj.end);\n        spanElem.className = 'e-shape-end';\n        strokeEndBtn.appendChild(spanElem);\n        // Initialize the DropDownButton component.\n        var drpDownBtn = new DropDownButton({ items: strokeWidthItems,\n            open: function (args) {\n                if (Browser.isDevice) {\n                    args.element.parentElement.style.top = drpDownBtn.element.getBoundingClientRect().top -\n                        args.element.parentElement.offsetHeight + 'px';\n                }\n                var activeBtn = spanElem.innerHTML;\n                if (activeBtn !== '') {\n                    args.element.querySelector('[aria-label = ' + '\"' + activeBtn + '\"' + ']').classList.add('e-selected-btn');\n                }\n            },\n            select: function (args) {\n                var idToValue = { '1': 'none', '2': 'bar', '3': 'arrow', '4': 'arrowSolid',\n                    '5': 'circle', '6': 'circleSolid', '7': 'square', '8': 'squareSolid' };\n                parent.notify('selection', { prop: 'setArrowShape', value: { type: 'final', shape: idToValue[\"\" + args.item.id] } });\n                _this.triggerTbarClickEvent(args);\n                spanElem.textContent = args.item.text;\n                parent.updateArrow('endArrow', args.item.id);\n                parent.notify('undo-redo', { prop: 'updateUndoRedoStack', onPropertyChange: false });\n            }\n        });\n        // Render initialized DropDownButton.\n        drpDownBtn.appendTo('#' + id + '_endBtn');\n    };\n    ToolbarModule.prototype.getTextToolbarItem = function (items) {\n        var parent = this.parent;\n        var id = parent.element.id;\n        var toolbarItems = [];\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar)) {\n            toolbarItems.push({ id: id + '_annotation', tooltipText: this.l10n.getConstant('Annotation'), align: 'Center',\n                template: '<button id=\"' + id + '_annotationBtn\"></button>' });\n        }\n        if (items.indexOf('fontFamily') > -1) {\n            toolbarItems.push({ id: id + '_fontFamily', cssClass: 'top-icon e-img-font-family',\n                tooltipText: this.l10n.getConstant('FontFamily'), align: 'Center',\n                template: '<button id=\"' + id + '_fontFamilyBtn\"></button>' });\n        }\n        if (items.indexOf('fontSize') > -1) {\n            toolbarItems.push({ id: id + '_fontSize', cssClass: 'top-icon e-img-font-size',\n                tooltipText: this.l10n.getConstant('FontSize'), align: 'Center',\n                template: '<button id=\"' + id + '_fontSizeBtn\"></button>' });\n        }\n        if (items.indexOf('fontColor') > -1) {\n            toolbarItems.push({ cssClass: 'top-icon e-text-font-color', id: id + '_text_strokecolor',\n                tooltipText: this.l10n.getConstant('FontColor'), align: 'Center',\n                type: 'Input', template: '<button id=\"' + id + '_fontColorBtn\"></button>' });\n        }\n        if (items.indexOf('strokeColor') > -1) {\n            toolbarItems.push({ cssClass: 'top-icon e-stroke-text-font-color', id: id + '_stroke_text_color',\n                tooltipText: this.l10n.getConstant('TextOutlineColor'), align: 'Center',\n                type: 'Input', template: '<button id=\"' + id + '_strokeTextColorBtn\"></button>' });\n        }\n        if (items.indexOf('fillColor') > -1) {\n            toolbarItems.push({ cssClass: 'top-icon e-text-background-color', id: id + '_text_backgroundcolor',\n                tooltipText: this.l10n.getConstant('FillColor'), align: 'Center',\n                type: 'Input', template: '<button id=\"' + id + '_bgColorBtn\"></button>'\n            });\n        }\n        if (items.indexOf('bold') > -1) {\n            toolbarItems.push({ id: id + '_bold', prefixIcon: 'e-icons e-bold', cssClass: 'top-icon e-bold',\n                tooltipText: this.l10n.getConstant('Bold'), align: 'Center' });\n        }\n        if (items.indexOf('italic') > -1) {\n            toolbarItems.push({ id: id + '_italic', prefixIcon: 'e-icons e-italic', cssClass: 'top-icon e-italic',\n                tooltipText: this.l10n.getConstant('Italic'), align: 'Center' });\n        }\n        if (items.indexOf('strokeWidth') > -1) {\n            toolbarItems.push({ id: id + '_strokeWidth', cssClass: 'top-icon e-size', tooltipText: this.l10n.getConstant('TextOutlineWidth'), align: 'Center',\n                type: 'Input', template: '<button id=\"' + id + '_borderWidthBtn\"></button>' });\n        }\n        if (items.indexOf('transparency') > -1) {\n            toolbarItems.push({ id: id + '_transparency', prefixIcon: 'e-opacity',\n                tooltipText: this.l10n.getConstant('Opacity'), align: 'Center' });\n        }\n        toolbarItems.push({ align: 'Center', type: 'Separator' });\n        if (items.indexOf('z-order') > -1) {\n            toolbarItems.push({ id: id + '_zOrder', cssClass: 'top-icon e-list-unordered-3', tooltipText: this.l10n.getConstant('ZOrder'), align: 'Center',\n                type: 'Input', template: '<button id=\"' + id + '_zOrderBtn\"></button>' });\n        }\n        if (items.indexOf('duplicate') > -1) {\n            toolbarItems.push({ id: id + '_duplicate', prefixIcon: 'e-icons e-order', cssClass: 'top-icon e-order',\n                tooltipText: this.l10n.getConstant('Duplicate'), align: 'Center', disabled: (parent.textArea.style.display === 'block' || parent.textArea.style.display === 'inline-block') ? true : false });\n        }\n        if (items.indexOf('remove') > -1) {\n            toolbarItems.push({ id: id + '_remove', prefixIcon: 'e-icons e-trash', cssClass: 'top-icon e-trash',\n                tooltipText: this.l10n.getConstant('Remove'), align: 'Center', disabled: (parent.textArea.style.display === 'block' || parent.textArea.style.display === 'inline-block') ? true : false });\n        }\n        if (items.indexOf('text') > -1) {\n            toolbarItems.push({ id: id + '_editText', prefixIcon: 'e-icons e-annotation-edit', cssClass: 'top-icon e-annotation-edit',\n                tooltipText: this.l10n.getConstant('EditText'), align: 'Center', disabled: (parent.textArea.style.display === 'block' || parent.textArea.style.display === 'inline-block') ? true : false });\n        }\n        var tempToolbarItems = this.processSubToolbar(items);\n        for (var i = 0, len = tempToolbarItems.length; i < len; i++) {\n            toolbarItems.push(tempToolbarItems[i]);\n        }\n        if (!Browser.isDevice) {\n            toolbarItems.push({ id: id + '_ok', prefixIcon: 'e-icons e-check', cssClass: 'top-icon e-tick',\n                tooltipText: this.l10n.getConstant('OK'), align: 'Right', tabIndex: 0 });\n            toolbarItems.push({ id: id + '_cancel', prefixIcon: 'e-icons e-close', cssClass: 'top-icon e-save',\n                tooltipText: this.l10n.getConstant('Cancel'), align: 'Right' });\n        }\n        return toolbarItems;\n    };\n    ToolbarModule.prototype.getFontFamilyItems = function () {\n        var parent = this.parent;\n        var items = [];\n        if (parent.fontFamily && parent.fontFamily.items && parent.fontFamily.items.length > 0) {\n            items = parent.fontFamily.items;\n        }\n        else {\n            if (Browser.isDevice) {\n                items = [{ id: 'arial', text: 'ABC' }, { id: 'calibri', text: 'ABC' }, { id: 'georgia', text: 'ABC' },\n                    { id: 'roboto', text: 'ABC' }, { id: 'tahoma', text: 'ABC' }];\n            }\n            else {\n                items = [{ id: 'arial', text: 'Arial' }, { id: 'calibri', text: 'Calibri' }, { id: 'georgia', text: 'Georgia' },\n                    { id: 'roboto', text: 'Roboto' }, { id: 'tahoma', text: 'Tahoma' }];\n            }\n        }\n        return items;\n    };\n    ToolbarModule.prototype.initTextToolbarItem = function (items) {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        var leftItem = this.getLeftToolbarItem();\n        var rightItem = this.getRightToolbarItem();\n        var mainItem = this.getTextToolbarItem(items);\n        var zoomItem = this.getZoomToolbarItem();\n        if (Browser.isDevice) {\n            this.defToolbarItems = mainItem;\n        }\n        else {\n            this.defToolbarItems = leftItem.concat(zoomItem, mainItem, rightItem);\n        }\n        var args = { toolbarType: 'text', toolbarItems: this.defToolbarItems };\n        parent.trigger('toolbarUpdating', args);\n        if (this.isToolbarString(args.toolbarItems)) {\n            items = args.toolbarItems;\n            this.excludeItems(args.toolbarItems);\n        }\n        else {\n            this.defToolbarItems = args.toolbarItems;\n        }\n        var toolbar = new Toolbar({\n            width: '100%',\n            items: this.defToolbarItems,\n            clicked: this.defToolbarClicked.bind(this),\n            created: function () {\n                _this.renderAnnotationBtn(true);\n                _this.createTextColor(items);\n                _this.createStrokeTextColor(items);\n                _this.createShapeBtn(items);\n                _this.createBackgroundColor(items);\n                _this.createTextBtn(items);\n                _this.createZOrderBtn(items);\n                _this.wireZoomBtnEvents();\n                parent.trigger('toolbarCreated', { toolbarType: 'text' });\n                if (Browser.isDevice) {\n                    if (_this.defToolbarItems.length > 0 && document.getElementById(id + '_bottomToolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        toolbar.refreshOverflow();\n                        toolbar.refreshOverflow();\n                        toolbar.refreshOverflow();\n                    }\n                }\n                else {\n                    _this.createLeftToolbarControls();\n                    if (_this.defToolbarItems.length > 0 && document.getElementById(id + '_toolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        toolbar.refreshOverflow();\n                    }\n                }\n            }\n        });\n        if (Browser.isDevice) {\n            toolbar.appendTo('#' + id + '_bottomToolbar');\n        }\n        else {\n            toolbar.appendTo('#' + id + '_toolbar');\n        }\n        this.enableDisableTbrBtn();\n    };\n    ToolbarModule.prototype.createTextColor = function (items) {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        if (items.indexOf('fontColor') > -1 && parent.element.querySelector('.e-template.e-text-font-color')) {\n            parent.element.querySelector('.e-template.e-text-font-color').appendChild(parent.createElement('input', {\n                id: id + '_text_font'\n            }));\n            var fontColor_1 = new ColorPicker({\n                modeSwitcher: true, noColor: false, value: '#fff', inline: true,\n                showButtons: false, mode: 'Palette', cssClass: 'e-text-fontt-color',\n                beforeModeSwitch: function (args) {\n                    _this.popupLeft = args.element.offsetParent.style.left;\n                    fontColor_1.value = parent.activeObj.strokeSettings.strokeColor !== '#fff' ? parent.activeObj.strokeSettings.strokeColor : '#008000ff';\n                    _this.beforeModeSwitch(args, fontColor_1);\n                },\n                presetColors: this.presetColors,\n                change: function (args) {\n                    parent.updateFontColor(args.value, 'Text');\n                    strokeDDB_2.element.children[0].style.backgroundColor = args.currentValue.rgba;\n                    strokeDDB_2.toggle();\n                    if (parent.activeObj.activePoint.width !== 0 || parent.activeObj.activePoint.height !== 0) {\n                        parent.notify('undo-redo', { prop: 'updateUndoRedoStack', onPropertyChange: false });\n                    }\n                },\n                onModeSwitch: function (args) {\n                    if (Browser.isDevice) {\n                        args.element.parentElement.parentElement.style.left = _this.popupLeft;\n                        args.element.parentElement.parentElement.style.top = (strokeDDB_2.element.getBoundingClientRect().top - args.element.parentElement.parentElement.offsetHeight) + 'px';\n                    }\n                },\n                beforeClose: function () {\n                    strokeDDB_2.toggle();\n                }\n            }, '#' + id + '_text_font');\n            var strokeDDB_2 = new DropDownButton({\n                open: function (args) {\n                    var parenElem = args.element.parentElement;\n                    if (Browser.isDevice) {\n                        parenElem.style.top = strokeDDB_2.element.getBoundingClientRect().top -\n                            parenElem.offsetHeight + 'px';\n                        if (window.innerWidth <= 520) {\n                            parenElem.style.left = parent.element.offsetLeft + 'px';\n                        }\n                    }\n                },\n                target: '.e-text-fontt-color',\n                iconCss: 'e-dropdownbtn-preview',\n                cssClass: 'e-ie-ddb-popup'\n            }, '#' + id + '_fontColorBtn');\n            fontColor_1.inline = true;\n            fontColor_1.value = fontColor_1.getValue(fontColor_1.value, 'rgba');\n            parent.element.querySelector('.e-text-font-color.e-template .e-dropdownbtn-preview').style.background\n                = '#fff';\n        }\n    };\n    ToolbarModule.prototype.createBackgroundColor = function (items) {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        if (items.indexOf('fillColor') > -1 && parent.element.querySelector('.e-template.e-text-background-color')) {\n            parent.element.querySelector('.e-template.e-text-background-color').appendChild(parent.createElement('input', {\n                id: id + '_text_bgColor'\n            }));\n            var backgroundColor_1 = new ColorPicker({\n                modeSwitcher: true, noColor: true, value: '', inline: true,\n                showButtons: false, mode: 'Palette', cssClass: 'e-text-fontt-color',\n                beforeModeSwitch: function (args) {\n                    _this.popupLeft = args.element.offsetParent.style.left;\n                    _this.beforeModeSwitch(args, backgroundColor_1);\n                },\n                presetColors: {\n                    'custom': ['', '#f44336', '#e91e63', '#9c27b0', '#673ab7', '#2196f3',\n                        '#03a9f4', '#00bcd4', '#009688', '#ffeb3b', '#ffffff', '#ffebee', '#fce4ec', '#f3e5f5', '#ede7f6', '#e3f2fd',\n                        '#e1f5fe', '#e0f7fa', '#e0f2f1', '#fffde7', '#f2f2f2', '#ffcdd2', '#f8bbd0', '#e1bee7', '#d1c4e9', '#bbdefb',\n                        '#b3e5fc', '#b2ebf2', '#b2dfdb', '#fff9c4', '#e6e6e6', '#ef9a9a', '#f48fb1', '#ce93d8', '#b39ddb', '#90caf9',\n                        '#81d4fa', '#80deea', '#80cbc4', '#fff59d', '#cccccc', '#e57373', '#f06292', '#ba68c8', '#9575cd', '#64b5f6',\n                        '#4fc3f7', '#4dd0e1', '#4db6ac', '#fff176', '#b3b3b3', '#ef5350', '#ec407a', '#ab47bc', '#7e57c2', '#42a5f5',\n                        '#29b6f6', '#26c6da', '#26a69a', '#ffee58', '#999999', '#e53935', '#d81b60', '#8e24aa', '#5e35b1', '#1e88e5',\n                        '#039be5', '#00acc1', '#00897b', '#fdd835', '#808080', '#d32f2f', '#c2185b', '#7b1fa2', '#512da8', '#1976d2',\n                        '#0288d1', '#0097a7', '#00796b', '#fbc02d', '#666666', '#c62828', '#ad1457', '#6a1b9a', '#4527a0', '#1565c0',\n                        '#0277bd', '#00838f', '#00695c', '#f9a825', '#4d4d4d', '#b71c1c', '#880e4f', '#4a148c', '#311b92', '#0d47a1',\n                        '#01579b', '#006064', '#004d40', '#f57f17']\n                },\n                beforeTileRender: function (args) {\n                    if (args.value === '') {\n                        args.element.classList.add('e-nocolor-item');\n                    }\n                },\n                change: function (args) {\n                    parent.updateFontColor(args.value, 'Background');\n                    if (args.currentValue.rgba === '') {\n                        strokeDDB_3.element.children[0].classList.add('e-nocolor-item');\n                    }\n                    else {\n                        strokeDDB_3.element.children[0].classList.remove('e-nocolor-item');\n                        strokeDDB_3.element.children[0].style.backgroundColor = args.currentValue.rgba;\n                    }\n                    strokeDDB_3.toggle();\n                    if (parent.activeObj.activePoint.width !== 0 || parent.activeObj.activePoint.height !== 0) {\n                        parent.notify('undo-redo', { prop: 'updateUndoRedoStack', onPropertyChange: false });\n                    }\n                },\n                onModeSwitch: function (args) {\n                    if (Browser.isDevice) {\n                        args.element.parentElement.parentElement.style.left = _this.popupLeft;\n                        args.element.parentElement.parentElement.style.top = (strokeDDB_3.element.getBoundingClientRect().top - args.element.parentElement.parentElement.offsetHeight) + 'px';\n                    }\n                },\n                beforeClose: function () {\n                    strokeDDB_3.toggle();\n                }\n            }, '#' + id + '_text_bgColor');\n            var strokeDDB_3 = new DropDownButton({\n                open: function (args) {\n                    var parenElem = args.element.parentElement;\n                    if (Browser.isDevice) {\n                        parenElem.style.top = strokeDDB_3.element.getBoundingClientRect().top -\n                            parenElem.offsetHeight + 'px';\n                        if (window.innerWidth <= 520) {\n                            parenElem.style.left = parent.element.offsetLeft + 'px';\n                        }\n                    }\n                },\n                target: '.e-text-fontt-color',\n                iconCss: 'e-dropdownbtn-preview',\n                cssClass: 'e-ie-ddb-popup'\n            }, '#' + id + '_bgColorBtn');\n            backgroundColor_1.inline = true;\n            backgroundColor_1.value = backgroundColor_1.getValue(backgroundColor_1.value, 'rgba');\n            parent.element.querySelector('.e-text-background-color.e-template .e-dropdownbtn-preview').style.background\n                = '#fff';\n        }\n    };\n    ToolbarModule.prototype.createStrokeTextColor = function (items) {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        if (items.indexOf('strokeColor') > -1 && parent.element.querySelector('.e-template.e-stroke-text-font-color')) {\n            parent.element.querySelector('.e-template.e-stroke-text-font-color').appendChild(parent.createElement('input', {\n                id: id + '_stroke_text'\n            }));\n            var fontColor_2 = new ColorPicker({\n                modeSwitcher: true, noColor: true, value: '', inline: true,\n                showButtons: false, mode: 'Palette', cssClass: 'e-text-fontt-color',\n                beforeModeSwitch: function (args) {\n                    _this.popupLeft = args.element.offsetParent.style.left;\n                    _this.beforeModeSwitch(args, fontColor_2);\n                },\n                presetColors: {\n                    'custom': ['', '#f44336', '#e91e63', '#9c27b0', '#673ab7', '#2196f3',\n                        '#03a9f4', '#00bcd4', '#009688', '#ffeb3b', '#ffffff', '#ffebee', '#fce4ec', '#f3e5f5', '#ede7f6', '#e3f2fd',\n                        '#e1f5fe', '#e0f7fa', '#e0f2f1', '#fffde7', '#f2f2f2', '#ffcdd2', '#f8bbd0', '#e1bee7', '#d1c4e9', '#bbdefb',\n                        '#b3e5fc', '#b2ebf2', '#b2dfdb', '#fff9c4', '#e6e6e6', '#ef9a9a', '#f48fb1', '#ce93d8', '#b39ddb', '#90caf9',\n                        '#81d4fa', '#80deea', '#80cbc4', '#fff59d', '#cccccc', '#e57373', '#f06292', '#ba68c8', '#9575cd', '#64b5f6',\n                        '#4fc3f7', '#4dd0e1', '#4db6ac', '#fff176', '#b3b3b3', '#ef5350', '#ec407a', '#ab47bc', '#7e57c2', '#42a5f5',\n                        '#29b6f6', '#26c6da', '#26a69a', '#ffee58', '#999999', '#e53935', '#d81b60', '#8e24aa', '#5e35b1', '#1e88e5',\n                        '#039be5', '#00acc1', '#00897b', '#fdd835', '#808080', '#d32f2f', '#c2185b', '#7b1fa2', '#512da8', '#1976d2',\n                        '#0288d1', '#0097a7', '#00796b', '#fbc02d', '#666666', '#c62828', '#ad1457', '#6a1b9a', '#4527a0', '#1565c0',\n                        '#0277bd', '#00838f', '#00695c', '#f9a825', '#4d4d4d', '#b71c1c', '#880e4f', '#4a148c', '#311b92', '#0d47a1',\n                        '#01579b', '#006064', '#004d40', '#f57f17']\n                },\n                beforeTileRender: function (args) {\n                    if (args.value === '') {\n                        args.element.classList.add('e-nocolor-item');\n                    }\n                },\n                change: function (args) {\n                    parent.updateStrokeTextColor(args.value);\n                    if (args.currentValue.rgba === '') {\n                        strokeDDB_4.element.children[0].classList.add('e-nocolor-item');\n                    }\n                    else {\n                        strokeDDB_4.element.children[0].classList.remove('e-nocolor-item');\n                        strokeDDB_4.element.children[0].style.backgroundColor = args.currentValue.rgba;\n                    }\n                    strokeDDB_4.toggle();\n                    if (parent.activeObj.activePoint.width !== 0 || parent.activeObj.activePoint.height !== 0) {\n                        parent.notify('undo-redo', { prop: 'updateUndoRedoStack', onPropertyChange: false });\n                    }\n                },\n                onModeSwitch: function (args) {\n                    if (Browser.isDevice) {\n                        args.element.parentElement.parentElement.style.left = _this.popupLeft;\n                        args.element.parentElement.parentElement.style.top = (strokeDDB_4.element.getBoundingClientRect().top - args.element.parentElement.parentElement.offsetHeight) + 'px';\n                    }\n                },\n                beforeClose: function () {\n                    strokeDDB_4.toggle();\n                }\n            }, '#' + id + '_stroke_text');\n            var strokeDDB_4 = new DropDownButton({\n                open: function (args) {\n                    var parenElem = args.element.parentElement;\n                    if (Browser.isDevice) {\n                        parenElem.style.top = strokeDDB_4.element.getBoundingClientRect().top -\n                            parenElem.offsetHeight + 'px';\n                        if (window.innerWidth <= 520) {\n                            parenElem.style.left = parent.element.offsetLeft + 'px';\n                        }\n                    }\n                },\n                target: '.e-text-fontt-color',\n                iconCss: 'e-dropdownbtn-preview',\n                cssClass: 'e-ie-ddb-popup'\n            }, '#' + id + '_strokeTextColorBtn');\n            fontColor_2.inline = true;\n            fontColor_2.value = fontColor_2.getValue(fontColor_2.value, 'rgba');\n            parent.element.querySelector('.e-stroke-text-font-color.e-template .e-dropdownbtn-preview').style.background\n                = '#fff';\n        }\n    };\n    ToolbarModule.prototype.createTextBtn = function (items) {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        if (items.indexOf('fontFamily') > -1) {\n            var fontNameBtn = document.getElementById(id + '_fontFamilyBtn');\n            var spanElem_4 = document.createElement('span');\n            if (Browser.isDevice) {\n                spanElem_4.innerHTML = 'ABC';\n                spanElem_4.setAttribute('style', 'font-family: ' + parent.fontFamily.default.toLowerCase() + '\\'');\n            }\n            else {\n                spanElem_4.innerHTML = parent.fontFamily.default;\n            }\n            spanElem_4.className = 'e-text-font-family';\n            if (fontNameBtn) {\n                fontNameBtn.appendChild(spanElem_4);\n            }\n            var fontFamilyBtn_1 = new DropDownButton({ items: this.getFontFamilyItems(),\n                cssClass: 'e-font-family',\n                createPopupOnClick: true,\n                beforeItemRender: function (args) {\n                    args.element.setAttribute('style', 'font-family:' + args.element.id);\n                },\n                open: function (args) {\n                    if (Browser.isDevice) {\n                        args.element.parentElement.style.top = fontFamilyBtn_1.element.getBoundingClientRect().top -\n                            args.element.parentElement.offsetHeight + 'px';\n                    }\n                    var fontFamily;\n                    if (parent.textArea.style.display === 'block' || parent.textArea.style.display === 'inline-block') {\n                        fontFamily = parent.textArea.style.fontFamily;\n                    }\n                    else {\n                        fontFamily = parent.activeObj.textSettings.fontFamily;\n                    }\n                    var elem = args.element.querySelector('[id *= ' + '\"' + fontFamily.toLowerCase() + '\"' + ']');\n                    if (elem) {\n                        elem.classList.add('e-selected-btn');\n                    }\n                },\n                select: function (args) {\n                    _this.triggerTbarClickEvent(args);\n                    spanElem_4.textContent = args.item.text;\n                    if (Browser.isDevice) {\n                        spanElem_4.setAttribute('style', 'font-family:' + args.item.id);\n                    }\n                    parent.updateFontFamily(args.item.id);\n                    parent.notify('undo-redo', { prop: 'updateUndoRedoStack', onPropertyChange: false });\n                    var toolbar = document.getElementById(parent.element.id + '_toolbar');\n                    if (toolbar && toolbar.classList.contains('e-control')) {\n                        getComponent(toolbar, 'toolbar').refreshOverflow();\n                    }\n                }\n            });\n            fontFamilyBtn_1.appendTo('#' + id + '_fontFamilyBtn');\n        }\n        if (items.indexOf('fontSize') > -1) {\n            var fontSizeBtnElem = document.getElementById(id + '_fontSizeBtn');\n            var fontSizeSpanElem_1 = document.createElement('span');\n            var fontSizes = parent.getFontSizes();\n            fontSizeSpanElem_1.innerHTML = fontSizes[0].text;\n            fontSizeSpanElem_1.className = 'e-text-font-size';\n            fontSizeBtnElem.appendChild(fontSizeSpanElem_1);\n            var fontSizeBtn_1 = new DropDownButton({\n                cssClass: 'e-font-size',\n                items: fontSizes,\n                open: function (args) {\n                    if (Browser.isDevice) {\n                        args.element.parentElement.style.top = fontSizeBtn_1.element.getBoundingClientRect().top -\n                            args.element.parentElement.offsetHeight + 'px';\n                    }\n                    var activeBtn = fontSizeSpanElem_1.innerHTML;\n                    args.element.querySelector('[aria-label *= ' + '\"' + activeBtn + '\"' + ']').classList.add('e-selected-btn');\n                },\n                select: function (args) {\n                    _this.triggerTbarClickEvent(args);\n                    fontSizeSpanElem_1.textContent = args.item.text;\n                    parent.updateFontSize(args.item.text);\n                    parent.notify('undo-redo', { prop: 'updateUndoRedoStack', onPropertyChange: false });\n                }\n            });\n            fontSizeBtn_1.appendTo('#' + id + '_fontSizeBtn');\n        }\n    };\n    ToolbarModule.prototype.refreshToolbar = function (type, isApplyBtn, isCropping, isZooming, cType, shape, isTransform) {\n        var parent = this.parent;\n        var id = parent.element.id;\n        if (!parent.isImageLoaded || parent.isCropToolbar) {\n            return;\n        }\n        var args = {};\n        var aspectIcon;\n        var nonAspectIcon;\n        if (type !== 'filter' && type !== 'color') {\n            var toolbarElement = document.getElementById(id + '_toolbar');\n            var cusWrapper = document.getElementById(id + '_customizeWrapper');\n            var bottomToolbar = document.getElementById(id + '_bottomToolbar');\n            if (cusWrapper && (getComponent(cusWrapper, 'toolbar')) && this.defToolbarItems.length > 0) {\n                getComponent(cusWrapper, 'toolbar').destroy();\n                cusWrapper.innerHTML = '';\n            }\n            if (toolbarElement && toolbarElement.classList.contains('e-control') && this.defToolbarItems.length > 0) {\n                getComponent(toolbarElement, 'toolbar').destroy();\n                toolbarElement.innerHTML = '';\n            }\n            if (toolbarElement && (this.defToolbarItems.length > 0 || parent.toolbar && parent.toolbar.length > 0 && parent.toolbar.indexOf('Open') === -1)) {\n                var toolbar_13 = getComponent(toolbarElement, 'toolbar');\n                if (!isNullOrUndefined(toolbar_13)) {\n                    toolbar_13.destroy();\n                    document.getElementById(parent.element.id + '_toolbar').innerHTML = '';\n                }\n            }\n            if (bottomToolbar && this.defToolbarItems.length > 0) {\n                if (bottomToolbar.className.indexOf('e-control') > -1) {\n                    getComponent(bottomToolbar, 'toolbar').destroy();\n                    bottomToolbar.innerHTML = '';\n                }\n            }\n        }\n        this.refreshSlider();\n        if (document.querySelector('.e-slider-tooltip')) {\n            document.querySelector('.e-slider-tooltip').remove();\n        }\n        this.isFrameToolbar = parent.isCropTab = false;\n        switch (type) {\n            case 'main':\n                if (Browser.isDevice) {\n                    if (isCropping) {\n                        this.initMainToolbar(false, true, true, false, false, true);\n                    }\n                    else {\n                        this.initMainToolbar(false, true, null, false, false, true);\n                    }\n                }\n                else if (!Browser.isDevice || isZooming) {\n                    if (isZooming) {\n                        this.initMainToolbar(isApplyBtn, Browser.isDevice, null);\n                    }\n                    else {\n                        this.initMainToolbar(isApplyBtn, Browser.isDevice, null);\n                    }\n                }\n                if (Browser.isDevice) {\n                    this.initBottomToolbar();\n                }\n                break;\n            case 'shapes':\n                parent.noPushUndo = true;\n                if (Browser.isDevice) {\n                    this.initMainToolbar(false, true, true);\n                }\n                if (parent.activeObj.shape === 'line' || parent.activeObj.shape === 'path') {\n                    args.toolbarItems = ['strokeColor', 'strokeWidth', 'z-order', 'duplicate', 'remove'];\n                }\n                else if (parent.activeObj.shape === 'arrow') {\n                    args.toolbarItems = ['strokeColor', 'strokeWidth', 'start', 'end', 'z-order', 'duplicate', 'remove'];\n                }\n                else if (parent.activeObj.shape === 'image') {\n                    args.toolbarItems = ['flip', 'z-order', 'duplicate', 'remove', 'transparency'];\n                }\n                else if (parent.activeObj.shape === 'rectangle') {\n                    args.toolbarItems = ['fillColor', 'strokeColor', 'strokeWidth', 'borderRadius', 'z-order', 'duplicate', 'remove'];\n                }\n                else {\n                    args.toolbarItems = ['fillColor', 'strokeColor', 'strokeWidth', 'z-order', 'duplicate', 'remove'];\n                }\n                this.initShapesToolbarItem(args.toolbarItems);\n                if (parent.activeObj.shape === 'image') {\n                    var actObj = extend({}, parent.activeObj, {}, true);\n                    parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                    parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: null, isPreventClearRect: null, isFrame: true } });\n                    parent.activeObj = actObj;\n                    parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: parent.activeObj,\n                            isCropRatio: null, points: null, isPreventDrag: true } });\n                    this.renderQAT(false);\n                }\n                break;\n            case 'text':\n                if (Browser.isDevice) {\n                    this.initMainToolbar(false, true, true);\n                }\n                args.toolbarItems = ['fontFamily', 'fontSize', 'fontColor', 'fillColor', 'strokeColor', 'strokeWidth', 'bold', 'italic', 'z-order', 'duplicate', 'remove', 'text'];\n                this.initTextToolbarItem(args.toolbarItems);\n                break;\n            case 'pen':\n                if (Browser.isDevice) {\n                    this.initMainToolbar(false, true, true);\n                }\n                args.toolbarItems = ['strokeColor', 'strokeWidth', 'z-order', 'remove', 'transparency'];\n                this.initPenToolbarItem(args.toolbarItems);\n                break;\n            case 'adjustment':\n                if (Browser.isDevice) {\n                    this.initMainToolbar(false, true, true);\n                }\n                this.initAdjustmentToolbarItem();\n                break;\n            case 'filter':\n                this.updateContextualToolbar(type);\n                break;\n            case 'resize':\n                if (parent.isCircleCrop || (parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle')) {\n                    parent.aspectHeight = parent.aspectWidth;\n                    this.isAspectRatio = false;\n                }\n                this.initResizeToolbar();\n                if (Browser.isDevice) {\n                    this.initMainToolbar(false, true, true, true);\n                }\n                aspectIcon = parent.element.querySelector('#' + id + '_aspectratio');\n                nonAspectIcon = parent.element.querySelector('#' + id + '_nonaspectratio');\n                if (parent.aspectWidth && parent.aspectHeight) {\n                    if (nonAspectIcon) {\n                        parent.notify('transform', { prop: 'resize', value: { width: parent.aspectWidth, height: parent.aspectHeight, isAspectRatio: false } });\n                    }\n                    else if (aspectIcon) {\n                        parent.notify('transform', { prop: 'resize', value: { width: parent.aspectWidth, height: null, isAspectRatio: true } });\n                    }\n                }\n                break;\n            case 'color':\n                this.updateContextualToolbar(type, cType);\n                break;\n            case 'croptransform':\n                if (isNullOrUndefined(isTransform)) {\n                    parent.allowDownScale = false;\n                    parent.isCropTab = true;\n                }\n                if (Browser.isDevice) {\n                    this.initMainToolbar(false, true, true);\n                }\n                if (isNullOrUndefined(isTransform)) {\n                    parent.updateCropTransformItems();\n                }\n                this.initCropTransformToolbar(shape, isTransform);\n                if (Browser.isDevice && this.isToolbar()) {\n                    this.updateContextualToolbar('color', 'straighten', true);\n                }\n                if (parent.isMaskImage) {\n                    this.refreshToolbar('main');\n                }\n                break;\n            case 'frame':\n                this.isFrameToolbar = true;\n                if (Browser.isDevice) {\n                    this.initMainToolbar(false, true, true);\n                    this.initMainToolbar(false, true, true, false, true);\n                }\n                else {\n                    this.initMainToolbar(true, null, null, false, true);\n                }\n                // eslint-disable-next-line no-case-declarations\n                var frameElem = parent.element.querySelector('#' + id + '_' + parent.frameObj.type);\n                if (frameElem) {\n                    frameElem.classList.add('e-selected-btn');\n                }\n                if (parent.frameObj.type !== 'none') {\n                    this.updateContextualToolbar(type, cType);\n                }\n                parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: null, isPreventClearRect: null, isFrame: true } });\n                break;\n            case 'redact':\n                if (Browser.isDevice) {\n                    this.initMainToolbar(false, true, true);\n                    this.initMainToolbar(false, true, true, null, null, null, true);\n                }\n                else {\n                    this.initMainToolbar(isApplyBtn, Browser.isDevice, null, null, null, null, true);\n                }\n                this.enableDisableTbrBtn();\n                if (parent.activeObj.redactType === 'blur') {\n                    var redactBlurElement = parent.element.querySelector('#' + id + '_' + 'redactBlur');\n                    if (redactBlurElement) {\n                        redactBlurElement.classList.add('e-selected-btn');\n                    }\n                }\n                else {\n                    var pixelateElement = parent.element.querySelector('#' + id + '_' + 'pixelate');\n                    if (pixelateElement) {\n                        pixelateElement.classList.add('e-selected-btn');\n                    }\n                }\n                this.redactSlider(parent.activeObj.redactType);\n                break;\n        }\n        this.refreshDropDownBtn(isCropping);\n        this.updateKBDNavigation(type);\n        this.currToolbar = type;\n    };\n    ToolbarModule.prototype.updateRedactObj = function () {\n        var parent = this.parent;\n        var objColl = extend([], parent.objColl, [], true);\n        parent.objColl = [];\n        var activeObj = extend({}, parent.activeObj, {}, true);\n        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: null, isPreventClearRect: null, isFrame: true } });\n        parent.objColl = objColl;\n        for (var i = 0; i < parent.objColl.length; i++) {\n            var obj = parent.objColl[i];\n            if (obj.shape === 'redact') {\n                obj.redactImage = parent.createElement('canvas');\n                obj.redactImage.width = obj.activePoint.width;\n                obj.redactImage.height = obj.activePoint.height;\n                obj.redactImage.getContext('2d').drawImage(parent.lowerCanvas, obj.activePoint.startX, obj.activePoint.startY, obj.activePoint.width, obj.activePoint.height, 0, 0, obj.redactImage.width, obj.redactImage.height);\n            }\n        }\n        parent.isCropTab = false;\n        parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: null, isPreventClearRect: null, isFrame: true } });\n        parent.isCropTab = true;\n        if (activeObj) {\n            parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: activeObj,\n                    isCropRatio: null, points: null, isPreventDrag: true } });\n        }\n    };\n    ToolbarModule.prototype.updateKBDNavigation = function (type) {\n        var parent = this.parent;\n        var id = parent.element.id;\n        if (!parent.isKBDNavigation || this.currToolbar === type) {\n            return;\n        }\n        if (this.isToolbar()) {\n            var tbar = parent.element.querySelectorAll('#' + id + '_toolbar')[0];\n            var tbarInitialChild = void 0;\n            var tbarInitialBtn_1;\n            if (tbar) {\n                tbarInitialChild = tbar.querySelector('.e-toolbar-center');\n                if (!tbarInitialChild || !tbarInitialChild.children[0]) {\n                    return;\n                }\n                tbarInitialBtn_1 = tbarInitialChild.children[0].querySelector('.e-btn');\n                var tempElem = tbarInitialChild.children[1];\n                if (tempElem) {\n                    tempElem = tempElem.children[0];\n                }\n                if (tempElem) {\n                    tempElem = tempElem.children[0];\n                }\n                if (type === 'resize' && tempElem) {\n                    tbarInitialBtn_1 = tempElem;\n                }\n                if (type === 'filter') {\n                    var defaultFilter_1 = document.querySelector('#' + id + '_defaultCanvas');\n                    if (defaultFilter_1) {\n                        setTimeout(function () { return defaultFilter_1.focus(); }, 50);\n                    }\n                }\n                if (tbarInitialBtn_1) {\n                    if (type === 'main') {\n                        setTimeout(function () { return tbarInitialBtn_1.focus(); }, 50);\n                    }\n                    else {\n                        tbarInitialBtn_1.focus();\n                    }\n                }\n            }\n        }\n    };\n    ToolbarModule.prototype.performCropTransformClick = function (shape, isTransform) {\n        var parent = this.parent;\n        if (isNullOrUndefined(isTransform)) {\n            parent.notify('draw', { prop: 'setTempStraightenZoomDeg' });\n            parent.tempStraighten = parent.transform.straighten;\n            if (parent.currObjType.isFiltered || parent.currObjType.isRedact) {\n                parent.okBtn();\n            }\n            parent.isStraightening = true;\n        }\n        this.refreshToolbar('croptransform', null, null, null, null, shape, isTransform);\n        if (isNullOrUndefined(isTransform)) {\n            parent.notify('draw', { prop: 'setDestForStraighten' });\n            parent.notify('draw', { prop: 'setTempDestForStraighten' });\n        }\n    };\n    ToolbarModule.prototype.getAdjustmentToolbarItem = function () {\n        var toolbarItems = [];\n        var parent = this.parent;\n        var isCustomized = false;\n        var id = parent.element.id;\n        var defItems = ['Brightness', 'Contrast', 'Hue', 'Saturation', 'Exposure', 'Opacity', 'Blur'];\n        if (parent.toolbar) {\n            for (var i = 0; i < defItems.length; i++) {\n                if (parent.toolbar.indexOf(defItems[i]) !== -1) {\n                    isCustomized = true;\n                    break;\n                }\n            }\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('Brightness') > -1)) {\n            toolbarItems.push({ id: id + '_brightness', prefixIcon: 'e-icons e-brightness', cssClass: 'top-icon e-brightness',\n                tooltipText: this.l10n.getConstant('Brightness'), align: 'Center' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('Contrast') > -1)) {\n            toolbarItems.push({ id: id + '_contrast', prefixIcon: 'e-icons e-contrast', cssClass: 'top-icon e-contrast',\n                tooltipText: this.l10n.getConstant('Contrast'), align: 'Center' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('Hue') > -1)) {\n            toolbarItems.push({ id: id + '_hue', prefixIcon: 'e-icons e-fade', cssClass: 'top-icon e-fade',\n                tooltipText: this.l10n.getConstant('Hue'), align: 'Center' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('Saturation') > -1)) {\n            toolbarItems.push({ id: id + '_saturation', prefixIcon: 'e-icons e-saturation', cssClass: 'top-icon e-saturation',\n                tooltipText: this.l10n.getConstant('Saturation'), align: 'Center' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('Exposure') > -1)) {\n            toolbarItems.push({ id: id + '_exposure', prefixIcon: 'e-icons e-grain', cssClass: 'top-icon e-grain',\n                tooltipText: this.l10n.getConstant('Exposure'), align: 'Center' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('Opacity') > -1)) {\n            toolbarItems.push({ id: id + '_opacity', prefixIcon: 'e-icons e-opacity', cssClass: 'top-icon e-opacity',\n                tooltipText: this.l10n.getConstant('Opacity'), align: 'Center' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('Blur') > -1)) {\n            toolbarItems.push({ id: id + '_blur', prefixIcon: 'e-icons e-tint', cssClass: 'top-icon e-tint',\n                tooltipText: this.l10n.getConstant('Blur'), align: 'Center' });\n        }\n        var tempToolbarItems = this.processToolbar('center');\n        for (var i = 0, len = tempToolbarItems.length; i < len; i++) {\n            toolbarItems.push(tempToolbarItems[i]);\n        }\n        if (!Browser.isDevice) {\n            toolbarItems.push({ id: id + '_ok', prefixIcon: 'e-icons e-check', cssClass: 'top-icon e-tick',\n                tooltipText: this.l10n.getConstant('OK'), align: 'Right', tabIndex: 0 });\n            toolbarItems.push({ id: id + '_cancel', prefixIcon: 'e-icons e-close', cssClass: 'top-icon e-save',\n                tooltipText: this.l10n.getConstant('Cancel'), align: 'Right' });\n        }\n        return toolbarItems;\n    };\n    ToolbarModule.prototype.getFrameToolbarItem = function () {\n        var parent = this.parent;\n        var id = parent.element.id;\n        var toolbarItems = [];\n        toolbarItems.push({ prefixIcon: 'e-icons e-copy', id: id + '_frameColor',\n            cssClass: 'top-icon e-stroke', tooltipText: this.l10n.getConstant('Color'), align: 'Center', type: 'Input',\n            template: '<span>' + this.l10n.getConstant('Color') + '</span><button id=\"' + id + '_frameColorBtn\"></button>' });\n        toolbarItems.push({ prefixIcon: 'e-icons e-copy', id: id + '_frameGradient',\n            cssClass: 'top-icon e-frame-stroke', tooltipText: this.l10n.getConstant('GradientColor'), align: 'Center', type: 'Input',\n            template: '<span>' + this.l10n.getConstant('GradientColor') + '</span><button id=\"' + id + '_frameGradientColorBtn\"></button>' });\n        toolbarItems.push({ id: id + '_frameSize', cssClass: 'top-icon e-size', tooltipText: this.l10n.getConstant('Size'), align: 'Center',\n            type: 'Input', template: '<span>' + this.l10n.getConstant('Size') + '</span><button id=\"' + id + '_frameSizeBtn\"></button>' });\n        if (parent.frameObj.type === 'line' || parent.frameObj.type === 'inset' || parent.frameObj.type === 'hook') {\n            toolbarItems.push({ id: id + '_frameInset', cssClass: 'top-icon e-size', tooltipText: this.l10n.getConstant('Inset'), align: 'Center',\n                type: 'Input', template: '<span>' + this.l10n.getConstant('Inset') + '</span><button id=\"' + id + '_frameInsetBtn\"></button>' });\n        }\n        if (parent.frameObj.type === 'line' || parent.frameObj.type === 'inset') {\n            toolbarItems.push({ id: id + '_frameOffset', cssClass: 'top-icon e-size', tooltipText: this.l10n.getConstant('Offset'), align: 'Center',\n                type: 'Input', template: '<span>' + this.l10n.getConstant('Offset') + '</span><button id=\"' + id + '_frameOffsetBtn\"></button>' });\n        }\n        if (parent.frameObj.type === 'line') {\n            toolbarItems.push({ id: id + '_frameRadius', cssClass: 'top-icon e-size', tooltipText: this.l10n.getConstant('Radius'), align: 'Center',\n                type: 'Input', template: '<span>' + this.l10n.getConstant('Radius') + '</span><button id=\"' + id + '_frameRadiusBtn\"></button>' });\n            toolbarItems.push({ id: id + '_frameAmount', cssClass: 'top-icon e-size', tooltipText: this.l10n.getConstant('Amount'), align: 'Center',\n                type: 'Input', template: '<span>' + this.l10n.getConstant('Amount') + '</span><button id=\"' + id + '_frameAmountBtn\"></button>' });\n            toolbarItems.push({ id: id + '_frameBorder', cssClass: 'top-icon e-size', tooltipText: this.l10n.getConstant('Border'), align: 'Center',\n                type: 'Input', template: '<span>' + this.l10n.getConstant('Border') + '</span><button id=\"' + id + '_frameBorderBtn\"></button>' });\n        }\n        return toolbarItems;\n    };\n    ToolbarModule.prototype.getFilterToolbarItem = function () {\n        var toolbarItems = [];\n        var parent = this.parent;\n        var isCustomized = false;\n        var id = parent.element.id;\n        var defItems = ['Default', 'Chrome', 'Cold', 'Warm', 'Grayscale', 'Sepia', 'Invert'];\n        if (parent.toolbar) {\n            for (var i = 0; i < defItems.length; i++) {\n                if (parent.toolbar.indexOf(defItems[i]) !== -1) {\n                    isCustomized = true;\n                    break;\n                }\n            }\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('Default') > -1)) {\n            toolbarItems.push({ id: id + '_default', prefixIcon: 'e-icons e-none', cssClass: 'top-icon e-none',\n                tooltipText: this.l10n.getConstant('Default'), align: 'Center',\n                template: '<div class=\"filter-wrapper\" style=\"box-sizing: content-box;\"><canvas id=' + id + '_defaultCanvas' + ' tabindex=0></canvas><div style=\"text-align:center;\"><span>' + this.l10n.getConstant('Default') + '</span></div></div>' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('Chrome') > -1)) {\n            toolbarItems.push({ id: id + '_chrome', prefixIcon: 'e-icons e-none', cssClass: 'top-icon e-none',\n                tooltipText: this.l10n.getConstant('Chrome'), align: 'Center',\n                template: '<div class=\"filter-wrapper\" style=\"box-sizing: content-box;\"><canvas id=' + id + '_chromeCanvas' + '></canvas><div style=\"text-align:center;\"><span>' + this.l10n.getConstant('Chrome') + '</span></div></div>' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('Cold') > -1)) {\n            toolbarItems.push({ id: id + '_cold', prefixIcon: 'e-icons e-none', cssClass: 'top-icon e-none',\n                tooltipText: this.l10n.getConstant('Cold'), align: 'Center',\n                template: '<div class=\"filter-wrapper\" style=\"box-sizing: content-box;\"><canvas id=' + id + '_coldCanvas' + '></canvas><div style=\"text-align:center;\"><span>' + this.l10n.getConstant('Cold') + '</span></div></div>' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('Warm') > -1)) {\n            toolbarItems.push({ id: id + '_warm', prefixIcon: 'e-icons e-none', cssClass: 'top-icon e-none',\n                tooltipText: this.l10n.getConstant('Warm'), align: 'Center',\n                template: '<div class=\"filter-wrapper\" style=\"box-sizing: content-box;\"><canvas id=' + id + '_warmCanvas' + '></canvas><div style=\"text-align:center;\"><span>' + this.l10n.getConstant('Warm') + '</span></div></div>' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('Grayscale') > -1)) {\n            toolbarItems.push({ id: id + '_grayscale', prefixIcon: 'e-icons e-none', cssClass: 'top-icon e-none',\n                tooltipText: this.l10n.getConstant('Grayscale'), align: 'Center',\n                template: '<div class=\"filter-wrapper\" style=\"box-sizing: content-box;\"><canvas id=' + id + '_grayscaleCanvas' + '></canvas><div style=\"text-align:center;\"><span>' + this.l10n.getConstant('Grayscale') + '</span></div></div>' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('Sepia') > -1)) {\n            toolbarItems.push({ id: id + '_sepia', prefixIcon: 'e-icons e-none', cssClass: 'top-icon e-none',\n                tooltipText: this.l10n.getConstant('Sepia'), align: 'Center',\n                template: '<div class=\"filter-wrapper\" style=\"box-sizing: content-box;\"><canvas id=' + id + '_sepiaCanvas' + '></canvas><div style=\"text-align:center;\"><span>' + this.l10n.getConstant('Sepia') + '</span></div></div>' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('Invert') > -1)) {\n            toolbarItems.push({ id: id + '_invert', prefixIcon: 'e-icons e-none', cssClass: 'top-icon e-none',\n                tooltipText: this.l10n.getConstant('Invert'), align: 'Center',\n                template: '<div class=\"filter-wrapper\" style=\"box-sizing: content-box;\"><canvas id=' + id + '_invertCanvas' + '></canvas><div style=\"text-align:center;\"><span>' + this.l10n.getConstant('Invert') + '</span></div></div>' });\n        }\n        var tempToolbarItems = this.processToolbar('center');\n        for (var i = 0, len = tempToolbarItems.length; i < len; i++) {\n            toolbarItems.push(tempToolbarItems[i]);\n        }\n        return toolbarItems;\n    };\n    ToolbarModule.prototype.getPenToolbarItem = function (items) {\n        var parent = this.parent;\n        var id = parent.element.id;\n        var toolbarItems = [];\n        if (isNullOrUndefined(parent.toolbar) || parent.toolbar) {\n            toolbarItems.push({ id: id + '_annotation', tooltipText: this.l10n.getConstant('Annotation'), align: 'Center',\n                template: '<button id=\"' + id + '_annotationBtn\"></button>' });\n        }\n        if (items.indexOf('strokeColor') > -1) {\n            toolbarItems.push({ prefixIcon: 'e-icons e-copy', id: id + '_pen_strokecolor',\n                cssClass: 'top-icon e-pen-stroke-color',\n                tooltipText: this.l10n.getConstant('StrokeColor'), align: 'Center', type: 'Input',\n                template: '<button id=\"' + id + '_penColorBtn\"></button>' });\n        }\n        if (items.indexOf('strokeWidth') > -1) {\n            toolbarItems.push({ prefixIcon: 'e-icons e-copy', id: id + '_pen_strokewidth',\n                cssClass: 'top-icon e-size',\n                tooltipText: this.l10n.getConstant('StrokeWidth'),\n                align: 'Center', type: 'Input', template: '<button id=\"' + id + '_penStrokeWidth\"></button>' });\n        }\n        toolbarItems.push({ align: 'Center', type: 'Separator' });\n        if (items.indexOf('z-order') > -1) {\n            toolbarItems.push({ id: id + '_zOrder', cssClass: 'top-icon e-list-unordered-3', tooltipText: this.l10n.getConstant('ZOrder'), align: 'Center',\n                type: 'Input', template: '<button id=\"' + id + '_zOrderBtn\"></button>' });\n        }\n        if (items.indexOf('remove') > -1) {\n            toolbarItems.push({ id: id + '_remove', prefixIcon: 'e-icons e-trash', cssClass: 'top-icon e-trash',\n                tooltipText: this.l10n.getConstant('Remove'), align: 'Center' });\n        }\n        var tempToolbarItems = this.processSubToolbar(items);\n        for (var i = 0, len = tempToolbarItems.length; i < len; i++) {\n            toolbarItems.push(tempToolbarItems[i]);\n        }\n        if (!Browser.isDevice) {\n            toolbarItems.push({ id: id + '_ok', prefixIcon: 'e-icons e-check', cssClass: 'top-icon e-tick',\n                tooltipText: this.l10n.getConstant('OK'), align: 'Right', tabIndex: 0 });\n            toolbarItems.push({ id: id + '_cancel', prefixIcon: 'e-icons e-close', cssClass: 'top-icon e-save',\n                tooltipText: this.l10n.getConstant('Cancel'), align: 'Right' });\n        }\n        return toolbarItems;\n    };\n    ToolbarModule.prototype.initPenToolbarItem = function (items) {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        var leftItem = this.getLeftToolbarItem();\n        var rightItem = this.getRightToolbarItem();\n        var mainItem = this.getPenToolbarItem(items);\n        var zoomItem = this.getZoomToolbarItem();\n        if (Browser.isDevice) {\n            this.defToolbarItems = mainItem;\n        }\n        else {\n            this.defToolbarItems = leftItem.concat(zoomItem, mainItem, rightItem);\n        }\n        var args = { toolbarType: 'pen', toolbarItems: this.defToolbarItems };\n        parent.trigger('toolbarUpdating', args);\n        if (this.isToolbarString(args.toolbarItems)) {\n            items = args.toolbarItems;\n            this.excludeItems(args.toolbarItems);\n        }\n        else {\n            this.defToolbarItems = args.toolbarItems;\n        }\n        var toolbar = new Toolbar({\n            width: '100%',\n            items: this.defToolbarItems,\n            clicked: this.defToolbarClicked.bind(this),\n            created: function () {\n                _this.renderAnnotationBtn(true);\n                _this.createPenColor(items);\n                _this.createPenBtn(items);\n                _this.createZOrderBtn(items);\n                _this.wireZoomBtnEvents();\n                parent.trigger('toolbarCreated', { toolbarType: 'pen' });\n                if (Browser.isDevice) {\n                    if (_this.defToolbarItems.length > 0 && document.getElementById(id + '_toolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        toolbar.refreshOverflow();\n                        toolbar.refreshOverflow();\n                    }\n                }\n                else {\n                    _this.createLeftToolbarControls();\n                    if (_this.defToolbarItems.length > 0 && document.getElementById(id + '_toolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        toolbar.refreshOverflow();\n                    }\n                }\n            }\n        });\n        if (Browser.isDevice) {\n            toolbar.appendTo('#' + id + '_bottomToolbar');\n        }\n        else {\n            toolbar.appendTo('#' + id + '_toolbar');\n        }\n        this.enableDisableTbrBtn();\n    };\n    ToolbarModule.prototype.createPenColor = function (items) {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        if (items.indexOf('strokeColor') > -1) {\n            parent.element.querySelector('.e-template.e-pen-stroke-color').appendChild(parent.createElement('input', {\n                id: id + '_pen_stroke'\n            }));\n            var presentVal = parent.activeObj.strokeSettings.strokeColor;\n            var penColor = new ColorPicker({\n                modeSwitcher: false, value: '#fff',\n                showButtons: false, mode: 'Palette', cssClass: 'e-pen-color',\n                change: function (args) {\n                    parent.updatePenStrokeColor(args.currentValue.hex);\n                    _this.selFhdColor = args.currentValue.hex;\n                    strokeDDB_5.element.children[0].style.backgroundColor = args.currentValue.rgba;\n                    strokeDDB_5.toggle();\n                    parent.notify('undo-redo', { prop: 'updateUndoRedoStack', value: { isPenDraw: true } });\n                }\n            }, '#' + id + '_pen_stroke');\n            var strokeDDB_5 = new DropDownButton({\n                open: function (args) {\n                    var parentElem = args.element.parentElement;\n                    if (Browser.isDevice) {\n                        parentElem.style.top = strokeDDB_5.element.getBoundingClientRect().top -\n                            parentElem.offsetHeight + 'px';\n                        if (window.innerWidth <= 520) {\n                            parentElem.style.left = parent.element.offsetLeft + 'px';\n                        }\n                    }\n                },\n                target: '.e-pen-color',\n                iconCss: 'e-dropdownbtn-preview',\n                cssClass: 'e-ie-ddb-popup'\n            }, '#' + id + '_penColorBtn');\n            penColor.inline = true;\n            penColor.value = penColor.getValue(parent.activeObj.strokeSettings.strokeColor, 'rgba');\n            if (penColor.value === 'null') {\n                penColor.value = presentVal;\n            }\n            var obj = { tempFreeHandDrawEditingStyles: null };\n            parent.notify('freehand-draw', { prop: 'getTempFreeHandDrawEditingStyles', value: { obj: obj } });\n            var indexObj = { freehandSelectedIndex: null };\n            parent.notify('freehand-draw', { prop: 'getFreehandSelectedIndex', onPropertyChange: false, value: { obj: indexObj } });\n            if (!isNullOrUndefined(indexObj['freehandSelectedIndex']) && indexObj['freehandSelectedIndex'] > -1) {\n                parent.element.querySelector('.e-pen-stroke-color.e-template .e-dropdownbtn-preview').style.background\n                    = this.selFhdColor === '#42a5f5' ? obj['tempFreeHandDrawEditingStyles'].strokeColor :\n                        parent.pointColl[indexObj['freehandSelectedIndex']].strokeColor;\n            }\n            else {\n                parent.element.querySelector('.e-pen-stroke-color.e-template .e-dropdownbtn-preview').style.background\n                    = penColor.value;\n            }\n        }\n    };\n    ToolbarModule.prototype.createPenBtn = function (items) {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        var strokeWidthItems = [\n            { id: '1', text: this.l10n.getConstant('XSmall') },\n            { id: '2', text: this.l10n.getConstant('Small') },\n            { id: '3', text: this.l10n.getConstant('Medium') },\n            { id: '4', text: this.l10n.getConstant('Large') },\n            { id: '5', text: this.l10n.getConstant('XLarge') }\n        ];\n        if (items.indexOf('strokeWidth') > -1) {\n            var strokeWidthBtn = document.getElementById(id + '_penStrokeWidth');\n            var spanElem_5 = document.createElement('span');\n            var indexObj = { freehandSelectedIndex: null };\n            parent.notify('freehand-draw', { prop: 'getFreehandSelectedIndex', onPropertyChange: false, value: { obj: indexObj } });\n            if (!isNullOrUndefined(indexObj['freehandSelectedIndex']) && indexObj['freehandSelectedIndex'] > -1) {\n                spanElem_5.innerHTML = this.getPenStroke(parent.pointColl[indexObj['freehandSelectedIndex']].strokeWidth);\n            }\n            else {\n                var obj = { penStrokeWidth: 2 };\n                parent.notify('freehand-draw', { prop: 'getPenStrokeWidth', onPropertyChange: false, value: { obj: obj } });\n                if (obj['penStrokeWidth']) {\n                    spanElem_5.innerHTML = this.getPenStroke(obj['penStrokeWidth']);\n                }\n                else {\n                    spanElem_5.innerHTML = this.l10n.getConstant('Small');\n                }\n            }\n            spanElem_5.className = 'e-pen-stroke-width';\n            strokeWidthBtn.appendChild(spanElem_5);\n            var drpDownBtn_5 = new DropDownButton({ items: strokeWidthItems,\n                open: function (args) {\n                    if (Browser.isDevice) {\n                        args.element.parentElement.style.top = drpDownBtn_5.element.getBoundingClientRect().top -\n                            args.element.parentElement.offsetHeight + 'px';\n                    }\n                    var activeBtn = spanElem_5.innerHTML;\n                    args.element.querySelector('[aria-label = ' + '\"' + activeBtn + '\"' + ']').classList.add('e-selected-btn');\n                },\n                select: function (args) {\n                    _this.triggerTbarClickEvent(args);\n                    spanElem_5.textContent = args.item.text;\n                    parent.updatePenStrokeWidth(args.item.id);\n                    if (Browser.isDevice) {\n                        if (document.getElementById(id + '_bottomToolbar')) {\n                            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                            var toolbar_14 = getComponent(id + '_bottomToolbar', 'toolbar');\n                            toolbar_14.refreshOverflow();\n                        }\n                    }\n                    else {\n                        if (document.getElementById(id + '_toolbar')) {\n                            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                            var toolbar_15 = getComponent(id + '_toolbar', 'toolbar');\n                            toolbar_15.refreshOverflow();\n                        }\n                    }\n                    var widthObj = { penStrokeWidth: null };\n                    parent.notify('freehand-draw', { prop: 'getPenStrokeWidth', onPropertyChange: false, value: { obj: widthObj } });\n                    parent.notify('undo-redo', { prop: 'updateUndoRedoStack', value: { isPenDraw: true } });\n                    parent.notify('freehand-draw', { prop: 'setPenStrokeWidth', onPropertyChange: false, value: { value: widthObj['penStrokeWidth'] } });\n                }\n            });\n            // Render initialized DropDownButton.\n            drpDownBtn_5.appendTo('#' + id + '_penStrokeWidth');\n        }\n    };\n    ToolbarModule.prototype.getPenStroke = function (value) {\n        var textContent = '';\n        var valueToTextContent = {\n            1: this.l10n.getConstant('XSmall'),\n            2: this.l10n.getConstant('Small'),\n            3: this.l10n.getConstant('Medium'),\n            4: this.l10n.getConstant('Large'),\n            5: this.l10n.getConstant('XLarge')\n        };\n        if (value >= 1 && value <= 5) {\n            textContent = valueToTextContent[value];\n        }\n        return textContent;\n    };\n    ToolbarModule.prototype.initAdjustmentToolbarItem = function () {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        var leftItem = this.getLeftToolbarItem(null);\n        var rightItem = this.getRightToolbarItem();\n        var mainItem = this.getAdjustmentToolbarItem();\n        var zoomItem = this.getZoomToolbarItem();\n        if (Browser.isDevice) {\n            this.defToolbarItems = mainItem;\n        }\n        else {\n            this.defToolbarItems = leftItem.concat(zoomItem, mainItem, rightItem);\n        }\n        var args = { toolbarType: 'finetune', toolbarItems: this.defToolbarItems };\n        parent.trigger('toolbarUpdating', args);\n        this.defToolbarItems = args.toolbarItems;\n        var toolbar = new Toolbar({\n            width: '100%',\n            items: this.defToolbarItems,\n            clicked: this.defToolbarClicked.bind(this),\n            created: function () {\n                _this.wireZoomBtnEvents();\n                if (Browser.isDevice) {\n                    if (_this.defToolbarItems.length > 0 && document.getElementById(id + '_toolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        toolbar.refreshOverflow();\n                    }\n                }\n                else {\n                    _this.createLeftToolbarControls();\n                    if (_this.defToolbarItems.length > 0 && document.getElementById(id + '_toolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        toolbar.refreshOverflow();\n                    }\n                }\n            }\n        });\n        if (Browser.isDevice) {\n            toolbar.appendTo('#' + id + '_bottomToolbar');\n        }\n        else {\n            toolbar.appendTo('#' + id + '_toolbar');\n        }\n        this.enableDisableTbrBtn();\n    };\n    ToolbarModule.prototype.initFrameToolbarItem = function () {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        var canvasWrapper = document.querySelector('#' + id + '_contextualToolbarArea');\n        var frameWrapper = document.querySelector('#' + id + '_frameWrapper');\n        if (frameWrapper) {\n            frameWrapper.style.display = 'block';\n        }\n        else {\n            frameWrapper = canvasWrapper.appendChild(parent.createElement('div', {\n                id: id + '_frameWrapper', className: 'e-frame-wrapper', styles: 'position: relative'\n            }));\n        }\n        frameWrapper.appendChild(parent.createElement('div', {\n            id: id + '_customizeWrapper',\n            styles: 'position: absolute'\n        }));\n        var mainItem = this.getFrameToolbarItem();\n        var args = { toolbarType: 'frame', toolbarItems: mainItem };\n        parent.trigger('toolbarUpdating', args);\n        mainItem = args.toolbarItems;\n        var toolbar = new Toolbar({\n            width: '100%',\n            items: mainItem,\n            clicked: this.defToolbarClicked.bind(this),\n            created: function () {\n                _this.createFrameColor();\n                _this.createFrameSize();\n                var frameType = parent.frameObj.type;\n                if (frameType === 'line') {\n                    _this.createFrameRadius();\n                }\n                if (frameType === 'line' || frameType === 'inset' || frameType === 'hook') {\n                    _this.createFrameInset();\n                }\n                if (frameType === 'line' || frameType === 'inset') {\n                    _this.createFrameOffset();\n                }\n                if (frameType === 'line') {\n                    _this.createFrameAmount();\n                    _this.createFrameBorder();\n                }\n                _this.createFrameGradientColor();\n                if (Browser.isDevice) {\n                    if (_this.defToolbarItems.length > 0 && document.getElementById(id + '_bottomToolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        toolbar.refreshOverflow();\n                        toolbar.refreshOverflow();\n                        toolbar.refreshOverflow();\n                    }\n                }\n                else {\n                    _this.createLeftToolbarControls();\n                    if (_this.defToolbarItems.length > 0 && document.getElementById(id + '_toolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        toolbar.refreshOverflow();\n                    }\n                }\n                parent.element.querySelector('#' + id + '_' + frameType).focus();\n            }\n        });\n        toolbar.appendTo('#' + id + '_customizeWrapper');\n    };\n    ToolbarModule.prototype.createFrameGradientColor = function () {\n        var parent = this.parent;\n        var prevFrameSettings;\n        var obj = { frameChangeEventArgs: null };\n        var id = parent.element.id;\n        parent.element.querySelector('.e-template.e-frame-stroke').appendChild(parent.createElement('input', {\n            id: id + '_frame_gradient_fill'\n        }));\n        var fillColor = new ColorPicker({\n            modeSwitcher: false, noColor: true, value: parent.frameObj.gradientColor,\n            showButtons: false, mode: 'Palette', cssClass: 'e-frame-gradient-fill-color',\n            change: function (args) {\n                prevFrameSettings = { type: parent.toPascalCase(parent.frameObj.type), color: parent.frameObj.color,\n                    gradientColor: parent.frameObj.gradientColor, size: parent.frameObj.size, inset: parent.frameObj.inset,\n                    offset: parent.frameObj.offset, borderRadius: parent.frameObj.radius,\n                    frameLineStyle: parent.toPascalCase(parent.frameObj.border), lineCount: parent.frameObj.amount };\n                var temp = parent.frameObj.gradientColor;\n                var object = { currObj: {} };\n                parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n                parent.frameObj.gradientColor = args.currentValue.hex;\n                parent.notify('draw', { prop: 'triggerFrameChange', value: { prevFrameSettings: prevFrameSettings, obj: obj } });\n                if (obj['frameChangeEventArgs'] && !obj['frameChangeEventArgs'].cancel) {\n                    parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false, value: {\n                            operation: 'frame', previousObj: object['currObj'], previousObjColl: object['currObj']['objColl'],\n                            previousPointColl: object['currObj']['pointColl'], previousSelPointColl: object['currObj']['selPointColl'],\n                            previousCropObj: extend({}, parent.cropObj, {}, true), previousText: null, currentText: null,\n                            previousFilter: null, isCircleCrop: null\n                        } });\n                    parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: null, isPreventClearRect: null, isFrame: true } });\n                    parent.notify('draw', { prop: 'redrawDownScale' });\n                    if (args.currentValue.rgba === '') {\n                        fillDDB.element.children[0].classList.add('e-nocolor-item');\n                    }\n                    else {\n                        fillDDB.element.children[0].classList.remove('e-nocolor-item');\n                        fillDDB.element.children[0].style.backgroundColor = args.currentValue.rgba;\n                    }\n                    parent.curFrameObjEvent = { previousFrameSetting: obj['frameChangeEventArgs'].previousFrameSetting,\n                        currentFrameSetting: obj['frameChangeEventArgs'].currentFrameSetting };\n                    parent.isFrameBtnClick = true;\n                }\n                else {\n                    parent.frameObj.gradientColor = temp;\n                }\n                fillDDB.toggle();\n            }\n        }, '#' + id + '_frame_gradient_fill');\n        var fillDDB = new DropDownButton({\n            open: function (args) {\n                if (Browser.isDevice) {\n                    var parentElem = args.element.parentElement;\n                    parentElem.style.top = fillDDB.element.getBoundingClientRect().top -\n                        parentElem.offsetHeight + 'px';\n                    if (window.innerWidth <= 520) {\n                        parentElem.style.left = parent.element.offsetLeft + 'px';\n                    }\n                }\n            },\n            target: '.e-frame-gradient-fill-color',\n            iconCss: 'e-dropdownbtn-preview',\n            cssClass: 'e-ie-ddb-popup'\n        }, '#' + id + '_frameGradientColorBtn');\n        fillColor.inline = true;\n        if (parent.frameObj.gradientColor === '') {\n            parent.element.querySelector('.e-frame-stroke.e-template .e-dropdownbtn-preview').classList.add('e-nocolor-item');\n        }\n        else {\n            parent.element.querySelector('.e-frame-stroke.e-template .e-dropdownbtn-preview').style.background\n                = parent.frameObj.gradientColor;\n        }\n    };\n    ToolbarModule.prototype.createFrameColor = function () {\n        var parent = this.parent;\n        var prevFrameSettings;\n        var obj = { frameChangeEventArgs: null };\n        var id = parent.element.id;\n        parent.element.querySelector('.e-template.e-stroke').appendChild(parent.createElement('input', {\n            id: id + '_frame_fill'\n        }));\n        var fillColor = new ColorPicker({\n            modeSwitcher: false, value: parent.frameObj.color,\n            showButtons: false, mode: 'Palette', cssClass: 'e-frame-fill-color',\n            change: function (args) {\n                prevFrameSettings = { type: parent.toPascalCase(parent.frameObj.type), color: parent.frameObj.color,\n                    gradientColor: parent.frameObj.gradientColor, size: parent.frameObj.size, inset: parent.frameObj.inset,\n                    offset: parent.frameObj.offset, borderRadius: parent.frameObj.radius,\n                    frameLineStyle: parent.toPascalCase(parent.frameObj.border), lineCount: parent.frameObj.amount };\n                var temp = parent.frameObj.color;\n                var object = { currObj: {} };\n                parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n                parent.frameObj.color = args.currentValue.hex;\n                parent.notify('draw', { prop: 'triggerFrameChange', value: { prevFrameSettings: prevFrameSettings, obj: obj } });\n                if (obj['frameChangeEventArgs'] && !obj['frameChangeEventArgs'].cancel) {\n                    parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false, value: {\n                            operation: 'frame', previousObj: object['currObj'], previousObjColl: object['currObj']['objColl'],\n                            previousPointColl: object['currObj']['pointColl'], previousSelPointColl: object['currObj']['selPointColl'],\n                            previousCropObj: extend({}, parent.cropObj, {}, true), previousText: null, currentText: null,\n                            previousFilter: null, isCircleCrop: null\n                        } });\n                    parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: null, isPreventClearRect: null, isFrame: true } });\n                    parent.notify('draw', { prop: 'redrawDownScale' });\n                    if (args.currentValue.rgba === '') {\n                        fillDDB.element.children[0].classList.add('e-nocolor-item');\n                    }\n                    else {\n                        fillDDB.element.children[0].classList.remove('e-nocolor-item');\n                        fillDDB.element.children[0].style.backgroundColor = args.currentValue.rgba;\n                    }\n                    parent.curFrameObjEvent = { previousFrameSetting: obj['frameChangeEventArgs'].previousFrameSetting,\n                        currentFrameSetting: obj['frameChangeEventArgs'].currentFrameSetting };\n                    parent.isFrameBtnClick = true;\n                }\n                else {\n                    parent.frameObj.color = temp;\n                }\n                fillDDB.toggle();\n            }\n        }, '#' + id + '_frame_fill');\n        var fillDDB = new DropDownButton({\n            open: function (args) {\n                if (Browser.isDevice) {\n                    var parentElem = args.element.parentElement;\n                    parentElem.style.top = fillDDB.element.getBoundingClientRect().top -\n                        parentElem.offsetHeight + 'px';\n                    if (window.innerWidth <= 520) {\n                        parentElem.style.left = parent.element.offsetLeft + 'px';\n                    }\n                }\n            },\n            target: '.e-frame-fill-color',\n            iconCss: 'e-dropdownbtn-preview',\n            cssClass: 'e-ie-ddb-popup'\n        }, '#' + id + '_frameColorBtn');\n        fillColor.inline = true;\n        parent.element.querySelector('.e-stroke.e-template .e-dropdownbtn-preview').style.background = parent.frameObj.color;\n    };\n    ToolbarModule.prototype.createFrameSize = function () {\n        var _this = this;\n        var parent = this.parent;\n        var prevFrameSettings;\n        var obj = { frameChangeEventArgs: null };\n        var id = parent.element.id;\n        var strokeWidthItems = [\n            { id: '1', text: this.l10n.getConstant('20') },\n            { id: '2', text: this.l10n.getConstant('40') },\n            { id: '3', text: this.l10n.getConstant('60') },\n            { id: '4', text: this.l10n.getConstant('80') },\n            { id: '5', text: this.l10n.getConstant('100') }\n        ];\n        var strokeWidthBtn = document.getElementById(id + '_frameSizeBtn');\n        var spanElem = document.createElement('span');\n        spanElem.innerHTML = this.l10n.getConstant(parent.frameObj.size.toString());\n        spanElem.className = 'e-frame-stroke-width';\n        strokeWidthBtn.appendChild(spanElem);\n        // Initialize the DropDownButton component.\n        var drpDownBtn = new DropDownButton({ items: strokeWidthItems,\n            open: function (args) {\n                if (Browser.isDevice) {\n                    var parentElem = args.element.parentElement;\n                    parentElem.style.top = drpDownBtn.element.getBoundingClientRect().top -\n                        parentElem.offsetHeight + 'px';\n                }\n                var activeBtn = drpDownBtn.element.childNodes[0].textContent;\n                if (activeBtn !== '') {\n                    args.element.querySelector('[aria-label = ' + '\"' + activeBtn + '\"' + ']').classList.add('e-selected-btn');\n                }\n            },\n            select: function (args) {\n                _this.triggerTbarClickEvent(args);\n                prevFrameSettings = { type: parent.toPascalCase(parent.frameObj.type), color: parent.frameObj.color,\n                    gradientColor: parent.frameObj.gradientColor, size: parent.frameObj.size, inset: parent.frameObj.inset,\n                    offset: parent.frameObj.offset, borderRadius: parent.frameObj.radius,\n                    frameLineStyle: parent.toPascalCase(parent.frameObj.border), lineCount: parent.frameObj.amount };\n                var temp = parent.frameObj.size;\n                var object = { currObj: {} };\n                parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n                parent.frameObj.size = parseInt(args.item.text, 10);\n                parent.notify('draw', { prop: 'triggerFrameChange', value: { prevFrameSettings: prevFrameSettings, obj: obj } });\n                if (obj['frameChangeEventArgs'] && !obj['frameChangeEventArgs'].cancel) {\n                    parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false, value: {\n                            operation: 'frame', previousObj: object['currObj'], previousObjColl: object['currObj']['objColl'],\n                            previousPointColl: object['currObj']['pointColl'], previousSelPointColl: object['currObj']['selPointColl'],\n                            previousCropObj: extend({}, parent.cropObj, {}, true), previousText: null, currentText: null,\n                            previousFilter: null, isCircleCrop: null\n                        } });\n                    parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: null, isPreventClearRect: null, isFrame: true } });\n                    parent.notify('draw', { prop: 'redrawDownScale' });\n                    drpDownBtn.content = args.item.text;\n                    parent.curFrameObjEvent = { previousFrameSetting: obj['frameChangeEventArgs'].previousFrameSetting,\n                        currentFrameSetting: obj['frameChangeEventArgs'].currentFrameSetting };\n                    parent.isFrameBtnClick = true;\n                }\n                else {\n                    parent.frameObj.size = temp;\n                }\n                if (Browser.isDevice) {\n                    if (document.getElementById(id + '_bottomToolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        var toolbar_16 = getComponent(id + '_bottomToolbar', 'toolbar');\n                        toolbar_16.refreshOverflow();\n                    }\n                }\n                else {\n                    if (document.getElementById(id + '_toolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        var toolbar_17 = getComponent(id + '_toolbar', 'toolbar');\n                        toolbar_17.refreshOverflow();\n                    }\n                }\n            }\n        });\n        // Render initialized DropDownButton.\n        drpDownBtn.appendTo('#' + id + '_frameSizeBtn');\n    };\n    ToolbarModule.prototype.createFrameInset = function () {\n        var _this = this;\n        var parent = this.parent;\n        var prevFrameSettings;\n        var obj = { frameChangeEventArgs: null };\n        var id = parent.element.id;\n        var strokeWidthItems = [\n            { id: '1', text: this.l10n.getConstant('20') },\n            { id: '2', text: this.l10n.getConstant('40') },\n            { id: '3', text: this.l10n.getConstant('60') },\n            { id: '4', text: this.l10n.getConstant('80') },\n            { id: '5', text: this.l10n.getConstant('100') }\n        ];\n        var strokeWidthBtn = document.getElementById(id + '_frameInsetBtn');\n        var spanElem = document.createElement('span');\n        spanElem.innerHTML = this.l10n.getConstant(parent.frameObj.inset.toString());\n        spanElem.className = 'e-frame-inset';\n        strokeWidthBtn.appendChild(spanElem);\n        // Initialize the DropDownButton component.\n        var drpDownBtn = new DropDownButton({ items: strokeWidthItems,\n            open: function (args) {\n                if (Browser.isDevice) {\n                    var parentElem = args.element.parentElement;\n                    parentElem.style.top = drpDownBtn.element.getBoundingClientRect().top -\n                        parentElem.offsetHeight + 'px';\n                }\n                var activeBtn = drpDownBtn.element.childNodes[0].textContent;\n                if (activeBtn !== '') {\n                    args.element.querySelector('[aria-label = ' + '\"' + activeBtn + '\"' + ']').classList.add('e-selected-btn');\n                }\n            },\n            select: function (args) {\n                _this.triggerTbarClickEvent(args);\n                prevFrameSettings = { type: parent.toPascalCase(parent.frameObj.type), color: parent.frameObj.color,\n                    gradientColor: parent.frameObj.gradientColor, size: parent.frameObj.size, inset: parent.frameObj.inset,\n                    offset: parent.frameObj.offset, borderRadius: parent.frameObj.radius,\n                    frameLineStyle: parent.toPascalCase(parent.frameObj.border), lineCount: parent.frameObj.amount };\n                var temp = parent.frameObj.inset;\n                var object = { currObj: {} };\n                parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n                parent.frameObj.inset = parseInt(args.item.text, 10);\n                parent.notify('draw', { prop: 'triggerFrameChange', value: { prevFrameSettings: prevFrameSettings, obj: obj } });\n                if (obj['frameChangeEventArgs'] && !obj['frameChangeEventArgs'].cancel) {\n                    parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false, value: {\n                            operation: 'frame', previousObj: object['currObj'], previousObjColl: object['currObj']['objColl'],\n                            previousPointColl: object['currObj']['pointColl'], previousSelPointColl: object['currObj']['selPointColl'],\n                            previousCropObj: extend({}, parent.cropObj, {}, true), previousText: null, currentText: null,\n                            previousFilter: null, isCircleCrop: null\n                        } });\n                    parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: null, isPreventClearRect: null, isFrame: true } });\n                    parent.notify('draw', { prop: 'redrawDownScale' });\n                    drpDownBtn.content = args.item.text;\n                    parent.curFrameObjEvent = { previousFrameSetting: obj['frameChangeEventArgs'].previousFrameSetting,\n                        currentFrameSetting: obj['frameChangeEventArgs'].currentFrameSetting };\n                    parent.isFrameBtnClick = true;\n                }\n                else {\n                    parent.frameObj.inset = temp;\n                }\n                if (Browser.isDevice) {\n                    if (document.getElementById(id + '_bottomToolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        var toolbar_18 = getComponent(id + '_bottomToolbar', 'toolbar');\n                        toolbar_18.refreshOverflow();\n                    }\n                }\n                else {\n                    if (document.getElementById(id + '_toolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        var toolbar_19 = getComponent(id + '_toolbar', 'toolbar');\n                        toolbar_19.refreshOverflow();\n                    }\n                }\n            }\n        });\n        // Render initialized DropDownButton.\n        drpDownBtn.appendTo('#' + id + '_frameInsetBtn');\n    };\n    ToolbarModule.prototype.createFrameOffset = function () {\n        var _this = this;\n        var parent = this.parent;\n        var prevFrameSettings;\n        var obj = { frameChangeEventArgs: null };\n        var id = parent.element.id;\n        var strokeWidthItems = [\n            { id: '1', text: this.l10n.getConstant('20') },\n            { id: '2', text: this.l10n.getConstant('40') },\n            { id: '3', text: this.l10n.getConstant('60') },\n            { id: '4', text: this.l10n.getConstant('80') },\n            { id: '5', text: this.l10n.getConstant('100') }\n        ];\n        var strokeWidthBtn = document.getElementById(id + '_frameOffsetBtn');\n        var spanElem = document.createElement('span');\n        spanElem.innerHTML = this.l10n.getConstant(parent.frameObj.offset.toString());\n        spanElem.className = 'e-frame-offset';\n        strokeWidthBtn.appendChild(spanElem);\n        // Initialize the DropDownButton component.\n        var drpDownBtn = new DropDownButton({ items: strokeWidthItems,\n            open: function (args) {\n                if (Browser.isDevice) {\n                    var parentElem = args.element.parentElement;\n                    parentElem.style.top = drpDownBtn.element.getBoundingClientRect().top -\n                        parentElem.offsetHeight + 'px';\n                }\n                var activeBtn = drpDownBtn.element.childNodes[0].textContent;\n                if (activeBtn !== '') {\n                    args.element.querySelector('[aria-label = ' + '\"' + activeBtn + '\"' + ']').classList.add('e-selected-btn');\n                }\n            },\n            select: function (args) {\n                _this.triggerTbarClickEvent(args);\n                prevFrameSettings = { type: parent.toPascalCase(parent.frameObj.type), color: parent.frameObj.color,\n                    gradientColor: parent.frameObj.gradientColor, size: parent.frameObj.size, inset: parent.frameObj.inset,\n                    offset: parent.frameObj.offset, borderRadius: parent.frameObj.radius,\n                    lineCount: parent.frameObj.amount, frameLineStyle: parent.toPascalCase(parent.frameObj.border) };\n                var temp = parent.frameObj.offset;\n                var object = { currObj: {} };\n                parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n                parent.frameObj.offset = parseInt(args.item.text, 10);\n                parent.notify('draw', { prop: 'triggerFrameChange', value: { prevFrameSettings: prevFrameSettings, obj: obj } });\n                if (obj['frameChangeEventArgs'] && !obj['frameChangeEventArgs'].cancel) {\n                    parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false, value: {\n                            operation: 'frame', previousObj: object['currObj'], previousObjColl: object['currObj']['objColl'],\n                            previousPointColl: object['currObj']['pointColl'], previousSelPointColl: object['currObj']['selPointColl'],\n                            previousCropObj: extend({}, parent.cropObj, {}, true), previousText: null, currentText: null,\n                            previousFilter: null, isCircleCrop: null\n                        } });\n                    parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: null, isPreventClearRect: null, isFrame: true } });\n                    parent.notify('draw', { prop: 'redrawDownScale' });\n                    drpDownBtn.content = args.item.text;\n                    parent.curFrameObjEvent = { previousFrameSetting: obj['frameChangeEventArgs'].previousFrameSetting,\n                        currentFrameSetting: obj['frameChangeEventArgs'].currentFrameSetting };\n                    parent.isFrameBtnClick = true;\n                }\n                else {\n                    parent.frameObj.offset = temp;\n                }\n                if (Browser.isDevice) {\n                    if (document.getElementById(id + '_bottomToolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        var toolbar_20 = getComponent(id + '_bottomToolbar', 'toolbar');\n                        toolbar_20.refreshOverflow();\n                    }\n                }\n                else {\n                    if (document.getElementById(id + '_toolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        var toolbar_21 = getComponent(id + '_toolbar', 'toolbar');\n                        toolbar_21.refreshOverflow();\n                    }\n                }\n            }\n        });\n        // Render initialized DropDownButton.\n        drpDownBtn.appendTo('#' + id + '_frameOffsetBtn');\n    };\n    ToolbarModule.prototype.createFrameRadius = function () {\n        var _this = this;\n        var parent = this.parent;\n        var prevFrameSettings;\n        var obj = { frameChangeEventArgs: null };\n        var id = parent.element.id;\n        var strokeWidthItems = [\n            { id: '1', text: this.l10n.getConstant('0') },\n            { id: '2', text: this.l10n.getConstant('20') },\n            { id: '3', text: this.l10n.getConstant('40') },\n            { id: '4', text: this.l10n.getConstant('60') },\n            { id: '5', text: this.l10n.getConstant('80') },\n            { id: '6', text: this.l10n.getConstant('100') }\n        ];\n        var strokeWidthBtn = document.getElementById(id + '_frameRadiusBtn');\n        var spanElem = document.createElement('span');\n        spanElem.innerHTML = this.l10n.getConstant(parent.frameObj.radius.toString());\n        spanElem.className = 'e-frame-radius';\n        strokeWidthBtn.appendChild(spanElem);\n        // Initialize the DropDownButton component.\n        var drpDownBtn = new DropDownButton({ items: strokeWidthItems,\n            open: function (args) {\n                if (Browser.isDevice) {\n                    var parentElem = args.element.parentElement;\n                    parentElem.style.top = drpDownBtn.element.getBoundingClientRect().top -\n                        parentElem.offsetHeight + 'px';\n                }\n                var activeBtn = drpDownBtn.element.childNodes[0].textContent;\n                if (activeBtn !== '') {\n                    args.element.querySelector('[aria-label = ' + '\"' + activeBtn + '\"' + ']').classList.add('e-selected-btn');\n                }\n            },\n            select: function (args) {\n                _this.triggerTbarClickEvent(args);\n                prevFrameSettings = { type: parent.toPascalCase(parent.frameObj.type), color: parent.frameObj.color,\n                    gradientColor: parent.frameObj.gradientColor, size: parent.frameObj.size, inset: parent.frameObj.inset,\n                    offset: parent.frameObj.offset, borderRadius: parent.frameObj.radius,\n                    frameLineStyle: parent.toPascalCase(parent.frameObj.border),\n                    lineCount: parent.frameObj.amount };\n                var temp = parent.frameObj.radius;\n                var object = { currObj: {} };\n                parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n                parent.frameObj.radius = parseInt(args.item.text, 10);\n                parent.notify('draw', { prop: 'triggerFrameChange', value: { prevFrameSettings: prevFrameSettings, obj: obj } });\n                if (obj['frameChangeEventArgs'] && !obj['frameChangeEventArgs'].cancel) {\n                    parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false, value: {\n                            operation: 'frame', previousObj: object['currObj'], previousObjColl: object['currObj']['objColl'],\n                            previousPointColl: object['currObj']['pointColl'], previousSelPointColl: object['currObj']['selPointColl'],\n                            previousCropObj: extend({}, parent.cropObj, {}, true), previousText: null, currentText: null,\n                            previousFilter: null, isCircleCrop: null\n                        } });\n                    parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: null, isPreventClearRect: null, isFrame: true } });\n                    parent.notify('draw', { prop: 'redrawDownScale' });\n                    drpDownBtn.content = args.item.text;\n                    parent.curFrameObjEvent = { previousFrameSetting: obj['frameChangeEventArgs'].previousFrameSetting,\n                        currentFrameSetting: obj['frameChangeEventArgs'].currentFrameSetting };\n                    parent.isFrameBtnClick = true;\n                }\n                else {\n                    parent.frameObj.radius = temp;\n                }\n                if (Browser.isDevice) {\n                    if (document.getElementById(id + '_bottomToolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        var toolbar_22 = getComponent(id + '_bottomToolbar', 'toolbar');\n                        toolbar_22.refreshOverflow();\n                    }\n                }\n                else {\n                    if (document.getElementById(id + '_toolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        var toolbar_23 = getComponent(id + '_toolbar', 'toolbar');\n                        toolbar_23.refreshOverflow();\n                    }\n                }\n            }\n        });\n        // Render initialized DropDownButton.\n        drpDownBtn.appendTo('#' + id + '_frameRadiusBtn');\n    };\n    ToolbarModule.prototype.createFrameAmount = function () {\n        var _this = this;\n        var parent = this.parent;\n        var prevFrameSettings;\n        var obj = { frameChangeEventArgs: null };\n        var id = parent.element.id;\n        var strokeWidthItems = [\n            { id: '1', text: this.l10n.getConstant('1') },\n            { id: '2', text: this.l10n.getConstant('2') },\n            { id: '3', text: this.l10n.getConstant('3') },\n            { id: '4', text: this.l10n.getConstant('4') },\n            { id: '5', text: this.l10n.getConstant('5') }\n        ];\n        var strokeWidthBtn = document.getElementById(id + '_frameAmountBtn');\n        var spanElem = document.createElement('span');\n        spanElem.innerHTML = this.l10n.getConstant(parent.frameObj.amount.toString());\n        spanElem.className = 'e-frame-amount';\n        strokeWidthBtn.appendChild(spanElem);\n        // Initialize the DropDownButton component.\n        var drpDownBtn = new DropDownButton({ items: strokeWidthItems,\n            open: function (args) {\n                if (Browser.isDevice) {\n                    var parentElem = args.element.parentElement;\n                    parentElem.style.top = drpDownBtn.element.getBoundingClientRect().top -\n                        parentElem.offsetHeight + 'px';\n                }\n                var activeBtn = drpDownBtn.element.childNodes[0].textContent;\n                if (activeBtn !== '') {\n                    args.element.querySelector('[aria-label = ' + '\"' + activeBtn + '\"' + ']').classList.add('e-selected-btn');\n                }\n            },\n            select: function (args) {\n                _this.triggerTbarClickEvent(args);\n                prevFrameSettings = { type: parent.toPascalCase(parent.frameObj.type), color: parent.frameObj.color,\n                    gradientColor: parent.frameObj.gradientColor, size: parent.frameObj.size, inset: parent.frameObj.inset,\n                    offset: parent.frameObj.offset, borderRadius: parent.frameObj.radius,\n                    lineCount: parent.frameObj.amount, frameLineStyle: parent.toPascalCase(parent.frameObj.border) };\n                var temp = parent.frameObj.amount;\n                var object = { currObj: {} };\n                parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n                parent.frameObj.amount = parseInt(args.item.text, 10);\n                parent.notify('draw', { prop: 'triggerFrameChange', value: { prevFrameSettings: prevFrameSettings, obj: obj } });\n                if (obj['frameChangeEventArgs'] && !obj['frameChangeEventArgs'].cancel) {\n                    parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false, value: {\n                            operation: 'frame', previousObj: object['currObj'], previousObjColl: object['currObj']['objColl'],\n                            previousPointColl: object['currObj']['pointColl'], previousSelPointColl: object['currObj']['selPointColl'],\n                            previousCropObj: extend({}, parent.cropObj, {}, true), previousText: null, currentText: null,\n                            previousFilter: null, isCircleCrop: null\n                        } });\n                    parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: null, isPreventClearRect: null, isFrame: true } });\n                    parent.notify('draw', { prop: 'redrawDownScale' });\n                    drpDownBtn.content = args.item.text;\n                    parent.curFrameObjEvent = { previousFrameSetting: obj['frameChangeEventArgs'].previousFrameSetting, currentFrameSetting: obj['frameChangeEventArgs'].currentFrameSetting };\n                    parent.isFrameBtnClick = true;\n                }\n                else {\n                    parent.frameObj.amount = temp;\n                }\n                if (Browser.isDevice) {\n                    if (document.getElementById(id + '_bottomToolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        var toolbar_24 = getComponent(id + '_bottomToolbar', 'toolbar');\n                        toolbar_24.refreshOverflow();\n                    }\n                }\n                else {\n                    if (document.getElementById(id + '_toolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        var toolbar_25 = getComponent(id + '_toolbar', 'toolbar');\n                        toolbar_25.refreshOverflow();\n                    }\n                }\n            }\n        });\n        // Render initialized DropDownButton.\n        drpDownBtn.appendTo('#' + id + '_frameAmountBtn');\n    };\n    ToolbarModule.prototype.createFrameBorder = function () {\n        var _this = this;\n        var parent = this.parent;\n        var prevFrameSettings;\n        var obj = { frameChangeEventArgs: null };\n        var id = parent.element.id;\n        var strokeWidthItems = [\n            { id: '1', text: this.l10n.getConstant('Solid') },\n            { id: '2', text: this.l10n.getConstant('Dashed') },\n            { id: '3', text: this.l10n.getConstant('Dotted') }\n        ];\n        var strokeWidthBtn = document.getElementById(id + '_frameBorderBtn');\n        var spanElem = document.createElement('span');\n        spanElem.innerHTML = this.l10n.getConstant(parent.toPascalCase(parent.frameObj.border));\n        spanElem.className = 'e-frame-border';\n        strokeWidthBtn.appendChild(spanElem);\n        // Initialize the DropDownButton component.\n        var drpDownBtn = new DropDownButton({ items: strokeWidthItems,\n            open: function (args) {\n                if (Browser.isDevice) {\n                    var parentElem = args.element.parentElement;\n                    parentElem.style.top = drpDownBtn.element.getBoundingClientRect().top -\n                        parentElem.offsetHeight + 'px';\n                }\n                var activeBtn = drpDownBtn.element.childNodes[0].textContent;\n                if (activeBtn !== '') {\n                    args.element.querySelector('[aria-label = ' + '\"' + activeBtn + '\"' + ']').classList.add('e-selected-btn');\n                }\n            },\n            select: function (args) {\n                _this.triggerTbarClickEvent(args);\n                prevFrameSettings = { lineCount: parent.frameObj.amount, color: parent.frameObj.color, borderRadius: parent.frameObj.radius,\n                    gradientColor: parent.frameObj.gradientColor, size: parent.frameObj.size, inset: parent.frameObj.inset,\n                    offset: parent.frameObj.offset, frameLineStyle: parent.toPascalCase(parent.frameObj.border),\n                    type: parent.toPascalCase(parent.frameObj.type) };\n                var temp = parent.frameObj.border;\n                var object = { currObj: {} };\n                parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n                parent.frameObj.border = args.item.text.toLowerCase();\n                parent.notify('draw', { prop: 'triggerFrameChange', value: { prevFrameSettings: prevFrameSettings, obj: obj } });\n                if (obj['frameChangeEventArgs'] && !obj['frameChangeEventArgs'].cancel) {\n                    parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false, value: {\n                            operation: 'frame', previousObj: object['currObj'], previousObjColl: object['currObj']['objColl'],\n                            previousPointColl: object['currObj']['pointColl'], previousSelPointColl: object['currObj']['selPointColl'],\n                            previousCropObj: extend({}, parent.cropObj, {}, true), previousText: null, currentText: null,\n                            previousFilter: null, isCircleCrop: null\n                        } });\n                    parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: null, isPreventClearRect: null, isFrame: true } });\n                    parent.notify('draw', { prop: 'redrawDownScale' });\n                    drpDownBtn.content = args.item.text;\n                    parent.curFrameObjEvent = { previousFrameSetting: obj['frameChangeEventArgs'].previousFrameSetting, currentFrameSetting: obj['frameChangeEventArgs'].currentFrameSetting };\n                    parent.isFrameBtnClick = true;\n                }\n                else {\n                    parent.frameObj.border = temp;\n                }\n                if (Browser.isDevice) {\n                    if (document.getElementById(id + '_bottomToolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        var toolbar_26 = getComponent(id + '_bottomToolbar', 'toolbar');\n                        toolbar_26.refreshOverflow();\n                    }\n                }\n                else {\n                    if (document.getElementById(id + '_toolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        var toolbar_27 = getComponent(id + '_toolbar', 'toolbar');\n                        toolbar_27.refreshOverflow();\n                    }\n                }\n            }\n        });\n        // Render initialized DropDownButton.\n        drpDownBtn.appendTo('#' + id + '_frameBorderBtn');\n    };\n    ToolbarModule.prototype.initFilterToolbarItem = function () {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        var mainItem = this.getFilterToolbarItem();\n        var args = { toolbarType: 'filter', toolbarItems: mainItem };\n        parent.trigger('toolbarUpdating', args);\n        mainItem = args.toolbarItems;\n        if (document.querySelector('#' + id + '_contextualToolbar').classList.contains('e-control')) {\n            getComponent(document.getElementById(id + '_contextualToolbar'), 'toolbar').destroy();\n        }\n        var toolbar = new Toolbar({\n            width: '100%',\n            items: mainItem,\n            clicked: this.contextualToolbarClicked.bind(this),\n            created: function () {\n                _this.updatePrivateVariables();\n                _this.createCanvasFilter();\n                if (parent.currentFilter === '') {\n                    parent.currentFilter = id + '_default';\n                }\n                var hdrWrapper = document.querySelector('#' + id + '_headWrapper');\n                if (hdrWrapper) {\n                    hdrWrapper.style.display = 'none';\n                }\n                var filterElem = document.getElementById(parent.currentFilter + 'Canvas');\n                if (filterElem) {\n                    filterElem.parentElement.parentElement.classList.add('e-selected');\n                }\n                _this.enableDisableTbrBtn();\n                toolbar.refreshOverflow();\n            }\n        });\n        toolbar.appendTo('#' + id + '_contextualToolbar');\n    };\n    ToolbarModule.prototype.drawDashedLine = function (ctx) {\n        ctx.beginPath();\n        ctx.setLineDash([5]);\n        ctx.rect(10, 10, 280, 130);\n        ctx.stroke();\n        ctx.closePath();\n    };\n    ToolbarModule.prototype.createCanvasFilter = function () {\n        var parent = this.parent;\n        showSpinner(parent.element);\n        parent.element.style.opacity = '0.5';\n        var imageData = parent.getCurrentCanvasData();\n        this.inMemoryCanvas.width = imageData.width;\n        this.inMemoryCanvas.height = imageData.height;\n        this.inMemoryContext.putImageData(imageData, 0, 0);\n        this.updateFilterCanvas('_defaultCanvas', 'default');\n        this.updateFilterCanvas('_chromeCanvas', 'chrome');\n        this.updateFilterCanvas('_coldCanvas', 'cold');\n        this.updateFilterCanvas('_warmCanvas', 'warm');\n        this.updateFilterCanvas('_grayscaleCanvas', 'grayscale');\n        this.updateFilterCanvas('_sepiaCanvas', 'sepia');\n        this.updateFilterCanvas('_invertCanvas', 'invert');\n        hideSpinner(parent.element);\n        parent.element.style.opacity = '1';\n        parent.initialAdjustmentValue = this.lowerContext.filter;\n    };\n    ToolbarModule.prototype.updateFilterCanvas = function (selector, type) {\n        var parent = this.parent;\n        var filter = parent.element.querySelector('#' + parent.element.id + selector);\n        if (filter) {\n            var ctx = filter.getContext('2d');\n            ctx = filter.getContext('2d');\n            filter.style.width = '100px';\n            filter.style.height = '100px';\n            parent.notify('filter', { prop: 'updateAdj', value: { type: type, value: null, isPreview: true, ctx: ctx } });\n            ctx.drawImage(this.inMemoryCanvas, 0, 0, 300, 150);\n            if (parent.isSafari) {\n                parent.notify('filter', { prop: 'apply-filter', onPropertyChange: false, value: { context: ctx } });\n            }\n        }\n    };\n    ToolbarModule.prototype.getQuickAccessToolbarItem = function (isPenEdit) {\n        var parent = this.parent;\n        var id = parent.element.id;\n        var args = { cancel: false, toolbarItems: [] };\n        var toolbarItems = [];\n        if (isNullOrUndefined(isPenEdit)) {\n            if (parent.activeObj.shape === 'image') {\n                toolbarItems.push('Flip');\n            }\n            if (parent.activeObj.shape !== 'redact') {\n                toolbarItems.push('BringToFront');\n            }\n            toolbarItems.push('Clone');\n            toolbarItems.push('Delete');\n            if (parent.activeObj.shape === 'text') {\n                toolbarItems.push('EditText');\n            }\n            args.shape = parent.toPascalCase(parent.activeObj.shape);\n        }\n        else if (isPenEdit) {\n            toolbarItems.push('BringToFront');\n            toolbarItems.push('Delete');\n            args.shape = 'Freehand draw';\n        }\n        args.toolbarItems = extend([], toolbarItems, null, true);\n        parent.trigger('quickAccessToolbarOpen', args);\n        var orgToolbarItems = [];\n        if (args.cancel) {\n            orgToolbarItems = [];\n        }\n        else {\n            for (var i = 0; i < args.toolbarItems.length; i++) {\n                switch (args.toolbarItems[i]) {\n                    case 'BringToFront':\n                        orgToolbarItems.push({ id: id + '_bringToFront', prefixIcon: 'e-icons e-bring-to-front',\n                            tooltipText: this.l10n.getConstant('BringToFront'), align: 'Left' });\n                        break;\n                    case 'Clone':\n                        orgToolbarItems.push({ id: id + '_duplicate', prefixIcon: 'e-icons e-order', cssClass: 'top-icon e-order',\n                            tooltipText: this.l10n.getConstant('Duplicate'), align: 'Left' });\n                        break;\n                    case 'Delete':\n                        orgToolbarItems.push({ id: id + '_remove', prefixIcon: 'e-icons e-trash', cssClass: 'top-icon e-trash',\n                            tooltipText: this.l10n.getConstant('Remove'), align: 'Left' });\n                        break;\n                    case 'EditText':\n                        orgToolbarItems.push({ id: id + '_editText', prefixIcon: 'e-icons e-annotation-edit', cssClass: 'top-icon e-annotation-edit',\n                            tooltipText: this.l10n.getConstant('EditText'), align: 'Left' });\n                        break;\n                    case 'Flip':\n                        orgToolbarItems.push({ id: id + '_hFlip', prefixIcon: 'e-icons e-horizontal-flip',\n                            tooltipText: this.l10n.getConstant('HorizontalFlip'), align: 'Left' });\n                        orgToolbarItems.push({ id: id + '_vFlip', prefixIcon: 'e-icons e-vertical-flip',\n                            tooltipText: this.l10n.getConstant('VerticalFlip'), align: 'Left' });\n                        break;\n                    default:\n                        orgToolbarItems.push(args.toolbarItems[i]);\n                        break;\n                }\n            }\n        }\n        return orgToolbarItems;\n    };\n    ToolbarModule.prototype.renderQAT = function (isPenEdit) {\n        var parent = this.parent;\n        var id = parent.element.id;\n        if (parent.activeObj && parent.showQuickAccessToolbar) {\n            var qtArea = document.getElementById(id + '_quickAccessToolbarArea');\n            if (qtArea) {\n                this.destroyQuickAccessToolbar();\n                qtArea.style.display = 'block';\n            }\n            var items = this.getQuickAccessToolbarItem(isPenEdit);\n            if (items.length === 0) {\n                return;\n            }\n            if (isNullOrUndefined(parent.quickAccessToolbarTemplate)) {\n                var toolbarObj = new Toolbar({\n                    items: items,\n                    clicked: this.quickAccessToolbarClicked.bind(this)\n                });\n                toolbarObj.appendTo('#' + id + '_quickAccessToolbar');\n            }\n            var height = this.toolbarHeight && this.toolbarHeight !== 0 ? this.toolbarHeight : qtArea.clientHeight;\n            var wrapperElement = parent.element.querySelector('#' + id + '_headWrapper');\n            if (isNullOrUndefined(isPenEdit) && (parent.activeObj.activePoint.width !== 0 ||\n                parent.activeObj.activePoint.height !== 0 ||\n                (parent.activeObj.shape && parent.activeObj.shape === 'path' && parent.activeObj.pointColl.length > 0))) {\n                var orderObj = { order: null };\n                parent.notify('shape', { prop: 'getHighestOrder', onPropertyChange: false, value: { obj: orderObj } });\n                if (parent.activeObj.order > orderObj['order'] && document.getElementById(parent.element.id + '_bringToFront')) {\n                    document.getElementById(parent.element.id + '_bringToFront').classList.add('e-overlay');\n                }\n                else {\n                    if (document.getElementById(parent.element.id + '_bringToFront')) {\n                        document.getElementById(parent.element.id + '_bringToFront').classList.remove('e-overlay');\n                    }\n                }\n                qtArea.style.width = 'auto';\n                parent.activeObj.activePoint.width = Math.abs(parent.activeObj.activePoint.width);\n                parent.activeObj.activePoint.height = Math.abs(parent.activeObj.activePoint.height);\n                var x = parent.activeObj.activePoint.startX < parent.activeObj.activePoint.endX ?\n                    parent.activeObj.activePoint.startX : parent.activeObj.activePoint.endX;\n                var y = parent.activeObj.activePoint.startY < parent.activeObj.activePoint.endY ?\n                    parent.activeObj.activePoint.startY : parent.activeObj.activePoint.endY;\n                var width = parent.activeObj.activePoint.width;\n                if (parent.activeObj.rotatedAngle !== 0 && parent.activeObj.shape !== 'arrow') {\n                    var object = { activePoint: null };\n                    parent.notify('shape', { prop: 'getSquarePointForRotatedShape', onPropertyChange: false,\n                        value: { obj: parent.activeObj, object: object } });\n                    var point = object['activePoint'];\n                    x = point.startX;\n                    y = point.startY;\n                    width = point.width;\n                }\n                else if (parent.activeObj.shape === 'path') {\n                    var path = parent.getSquarePointForPath(parent.activeObj);\n                    x = path.startX;\n                    y = path.startY;\n                    width = path.width;\n                }\n                qtArea.style.left = (x + (width / 2)) - (items.length * 25) + 'px';\n                if (parseFloat(qtArea.style.left) + (qtArea.clientWidth / 2) !== x + (width / 2)) {\n                    var diff = (x + (width / 2)) - (parseFloat(qtArea.style.left) + (qtArea.clientWidth / 2));\n                    qtArea.style.left = parseFloat(qtArea.style.left) + diff + 'px';\n                }\n                if (wrapperElement) {\n                    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                    height = wrapperElement.offsetHeight + height;\n                }\n                if (y - (height + (height / 1.5)) < parent.img.destTop) {\n                    qtArea.style.top = parent.img.destTop + 'px';\n                    if (wrapperElement) {\n                        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                        qtArea.style.top = (parent.img.destTop < 0 ? 0 : parent.img.destTop) + wrapperElement.offsetHeight + 'px';\n                    }\n                }\n                else {\n                    height = this.toolbarHeight;\n                    qtArea.style.top = y - (height + (height / 1.5)) + 'px';\n                }\n            }\n            else if (isPenEdit) {\n                var indexObj = { freehandSelectedIndex: -1 };\n                parent.notify('freehand-draw', { prop: 'getFreehandSelectedIndex', onPropertyChange: false, value: { obj: indexObj } });\n                var orderObj = { order: null };\n                parent.notify('shape', { prop: 'getHighestOrder', onPropertyChange: false, value: { obj: orderObj } });\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                if (parent.getObjFromId(parent.pointColl[indexObj['freehandSelectedIndex']].id).order >= orderObj['order'] && document.getElementById(parent.element.id + '_bringToFront')) {\n                    document.getElementById(parent.element.id + '_bringToFront').classList.add('e-overlay');\n                }\n                else {\n                    if (document.getElementById(parent.element.id + '_bringToFront')) {\n                        document.getElementById(parent.element.id + '_bringToFront').classList.remove('e-overlay');\n                    }\n                }\n                var obj = { activePoint: null };\n                parent.notify('freehand-draw', { prop: 'getSqPtFD',\n                    value: { idx: indexObj['freehandSelectedIndex'], obj: obj } });\n                var point = obj['activePoint'];\n                qtArea.style.width = 'auto';\n                qtArea.style.left = (point.startX + (point.width / 2)) - (items.length * 24) + 'px';\n                if (point.startY - (height + (height / 1.5)) < parent.img.destTop) {\n                    qtArea.style.top = parent.img.destTop + 'px';\n                }\n                else {\n                    qtArea.style.top = point.startY - (height + (height / 1.5)) + 'px';\n                }\n            }\n            else {\n                qtArea.style.display = 'none';\n            }\n            if (parseFloat(qtArea.style.top) < 0) {\n                qtArea.style.top = '0px';\n            }\n        }\n    };\n    ToolbarModule.prototype.refreshDropDownBtn = function (isDisabled) {\n        if (isNullOrUndefined(isDisabled)) {\n            return;\n        }\n        var parent = this.parent;\n        var id = parent.element.id;\n        var annotation = document.querySelector('#' + id + '_annotationBtn');\n        if (annotation) {\n            if (isDisabled) {\n                annotation.classList.add('e-disabled');\n                annotation.parentElement.classList.add('e-overlay');\n            }\n            else {\n                annotation.classList.remove('e-disabled');\n                annotation.parentElement.classList.remove('e-overlay');\n            }\n            getComponent(annotation, 'dropdown-btn').disabled = isDisabled;\n        }\n        var transform = document.querySelector('#' + id + '_transformBtn');\n        if (transform) {\n            if (isDisabled) {\n                transform.classList.add('e-disabled');\n                transform.parentElement.classList.add('e-overlay');\n            }\n            else {\n                transform.classList.remove('e-disabled');\n                transform.parentElement.classList.remove('e-overlay');\n            }\n            getComponent(transform, 'dropdown-btn').disabled = isDisabled;\n        }\n        var adjustment = document.querySelector('#' + id + '_adjustment');\n        if (adjustment) {\n            if (isDisabled) {\n                adjustment.classList.add('e-disabled');\n                adjustment.parentElement.classList.add('e-overlay');\n            }\n            else {\n                adjustment.classList.remove('e-disabled');\n                adjustment.parentElement.classList.remove('e-overlay');\n            }\n            getComponent(adjustment, 'btn').disabled = isDisabled;\n        }\n        var filter = document.querySelector('#' + id + '_filter');\n        if (filter) {\n            if (isDisabled) {\n                filter.classList.add('e-disabled');\n                filter.parentElement.classList.add('e-overlay');\n            }\n            else {\n                filter.classList.remove('e-disabled');\n                filter.parentElement.classList.remove('e-overlay');\n            }\n            getComponent(filter, 'btn').disabled = isDisabled;\n        }\n    };\n    ToolbarModule.prototype.cropSelect = function (args) {\n        var parent = this.parent;\n        parent.isCropTab = true;\n        if (isNullOrUndefined(parent.transform.cropZoomFactor)) {\n            parent.transform.cropZoomFactor = parent.transform.zoomFactor;\n            parent.notify('draw', { prop: 'setTempZoomFactor', onPropertyChange: false, value: { tempZoomFactor: parent.transform.zoomFactor } });\n        }\n        parent.transform.zoomFactor = parent.transform.cropZoomFactor;\n        var text = args.item.id;\n        this.currentToolbar = 'crop';\n        parent.currSelectionPoint = null;\n        parent.notify('draw', { prop: 'setIsCropSelect', value: { bool: true } });\n        var obj = { prevObj: null };\n        parent.notify('crop', { prop: 'getPreviousCropCurrentObj', value: { obj: obj } });\n        parent.notify('draw', { prop: 'select', onPropertyChange: false,\n            value: { type: text, startX: null, startY: null, width: null, height: null } });\n        parent.notify('crop', { prop: 'setPreviousCropCurrentObj', value: { obj: obj['prevObj'] } });\n        this.enableDisableTbrBtn();\n        parent.notify('transform', { prop: 'disableZoomOutBtn', value: { isZoomOut: true } });\n    };\n    ToolbarModule.prototype.quickAccessToolbarClicked = function (args, isContextualToolbar) {\n        var parent = this.parent;\n        var id = parent.element.id;\n        if (args.item) {\n            var isPreventUndoRedo = null;\n            var obj = { prevActObj: null };\n            var object = { tempObj: null };\n            parent.notify('draw', { prop: 'getPrevActObj', onPropertyChange: false, value: { obj: obj } });\n            parent.notify('selection', { prop: 'getTempActObj', onPropertyChange: false, value: { obj: object } });\n            object['tempObj']['activePoint']['height'] = Math.abs(object['tempObj']['activePoint']['height']);\n            var pathObject = { isNewPath: null };\n            var ctx = void 0;\n            parent.notify('draw', { prop: 'getNewPath', value: { obj: pathObject } });\n            var type = args.item.id.replace(id + '_', '').toLowerCase();\n            var left = void 0;\n            var right = void 0;\n            var indexObj = { freehandSelectedIndex: null };\n            var shapeId = void 0;\n            var isDisabled = void 0;\n            var orderObj = { order: null };\n            switch (type) {\n                case 'duplicate':\n                    if (!parent.element.querySelector('#' + id + '_duplicate').classList.contains('e-overlay')) {\n                        this.refreshSlider();\n                        if (!pathObject['isNewPath'] && JSON.stringify(object['tempObj']) === JSON.stringify(parent.activeObj)) {\n                            isPreventUndoRedo = true;\n                        }\n                        this.duplicateShape(isPreventUndoRedo);\n                    }\n                    break;\n                case 'remove':\n                    if (!parent.element.querySelector('#' + id + '_remove').classList.contains('e-overlay')) {\n                        parent.noPushUndo = false;\n                        this.refreshSlider();\n                        parent.notify('selection', { prop: 'deleteItem', onPropertyChange: false });\n                    }\n                    break;\n                case 'edittext':\n                    if (!parent.element.querySelector('#' + id + '_editText').classList.contains('e-overlay')) {\n                        this.editText();\n                    }\n                    break;\n                case 'rotleft':\n                case 'rotright':\n                    left = parent.element.querySelector('#' + id + '_rotLeft');\n                    right = parent.element.querySelector('#' + id + '_rotRight');\n                    if ((left && !left.classList.contains('e-disabled')) ||\n                        (right && !right.classList.contains('e-disabled'))) {\n                        parent.rotateImage(args.item.id.replace(id + '_', '').toLowerCase());\n                    }\n                    parent.notify('undo-redo', { prop: 'updateUndoRedoStack', onPropertyChange: false });\n                    break;\n                case 'hflip':\n                    if (!parent.element.querySelector('#' + id + '_hFlip').classList.contains('e-disabled')) {\n                        ctx = parent.activeObj.imageCanvas.getContext('2d');\n                        parent.horizontalFlip(ctx);\n                    }\n                    parent.notify('undo-redo', { prop: 'updateUndoRedoStack', onPropertyChange: false });\n                    break;\n                case 'vflip':\n                    if (!parent.element.querySelector('#' + id + '_vFlip').classList.contains('e-disabled')) {\n                        ctx = parent.activeObj.imageCanvas.getContext('2d');\n                        parent.verticalFlip(ctx);\n                    }\n                    parent.notify('undo-redo', { prop: 'updateUndoRedoStack', onPropertyChange: false });\n                    break;\n                case 'bringtofront':\n                    if (!parent.element.querySelector('#' + id + '_bringToFront').classList.contains('e-overlay')) {\n                        parent.notify('freehand-draw', { prop: 'getFreehandSelectedIndex', onPropertyChange: false, value: { obj: indexObj } });\n                        shapeId = indexObj['freehandSelectedIndex'] !== null ? parent.pointColl[indexObj['freehandSelectedIndex']].id :\n                            parent.activeObj.currIndex;\n                        parent.updateShapeOrder(shapeId, type);\n                        isDisabled = false;\n                        parent.notify('shape', { prop: 'getHighestOrder', onPropertyChange: false, value: { obj: orderObj } });\n                        if (shapeId.indexOf('pen') > -1) {\n                            parent.notify('shape', { prop: 'updateShapeColl', onPropertyChange: false });\n                            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                            var order = parent.getObjFromId(shapeId).order;\n                            isDisabled = order >= orderObj['order'] ? true : false;\n                        }\n                        else {\n                            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                            var order = parent.getObjFromId(shapeId).order;\n                            isDisabled = order > orderObj['order'] ? true : false;\n                        }\n                        if (isDisabled) {\n                            document.getElementById(parent.element.id + '_bringToFront').classList.add('e-overlay');\n                        }\n                        else {\n                            document.getElementById(parent.element.id + '_bringToFront').classList.remove('e-overlay');\n                        }\n                        parent.notify('undo-redo', { prop: 'updateUndoRedoStack', onPropertyChange: false });\n                    }\n                    break;\n            }\n            if (type === 'duplicate' || type === 'remove') {\n                parent.notify('draw', { prop: 'redrawDownScale' });\n            }\n        }\n        if (isNullOrUndefined(isContextualToolbar)) {\n            parent.trigger('quickAccessToolbarItemClick', args);\n        }\n    };\n    ToolbarModule.prototype.editText = function () {\n        var parent = this.parent;\n        var points = { x: parent.activeObj.activePoint.startX, y: parent.activeObj.activePoint.startY };\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        parent.notify('selection', { prop: 'setTempActObj', onPropertyChange: false,\n            value: { obj: extend({}, parent.activeObj, {}, true) } });\n        parent.notify('selection', { prop: 'setInitialTextEdit', onPropertyChange: false,\n            value: { bool: true } });\n        parent.notify('draw', { prop: 'setPrevActObj', onPropertyChange: false,\n            value: { prevActObj: extend({}, parent.activeObj, {}, true) } });\n        if (parent.activeObj.rotatedAngle !== 0) {\n            var object = { x: points.x, y: points.y };\n            parent.notify('shape', { prop: 'getTextBoxPosition', onPropertyChange: false,\n                value: { obj: parent.activeObj, object: object } });\n            points.x = object['x'];\n            points.y = object['y'];\n            var object1 = { x: points.x, y: points.y };\n            parent.notify('shape', { prop: 'setFlipState', onPropertyChange: false,\n                value: { x: points.x, y: points.y, obj: parent.activeObj, object: object1 } });\n            points.x = object1['x'];\n            points.y = object1['y'];\n        }\n        var tempActiveObj = extend({}, parent.activeObj, {}, true);\n        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        this.lowerContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        parent.notify('draw', { prop: 'redrawImgWithObj', onPropertyChange: false });\n        parent.notify('draw', { prop: 'redrawDownScale' });\n        parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n        parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.upperContext } });\n        parent.activeObj = tempActiveObj;\n        parent.notify('shape', { prop: 'renderTextArea', onPropertyChange: false,\n            value: { x: points.x, y: points.y, actObj: parent.activeObj } });\n        if (isNullOrUndefined(parent.activeObj.currIndex)) {\n            parent.notify('draw', { prop: 'setShapeTextInsert', onPropertyChange: false, value: { bool: true } });\n        }\n        if (document.getElementById(parent.element.id + '_quickAccessToolbarArea')) {\n            document.getElementById(parent.element.id + '_quickAccessToolbarArea').style.display = 'none';\n        }\n    };\n    ToolbarModule.prototype.duplicateShape = function (isPreventUndoRedo, isPublicMethod) {\n        var parent = this.parent;\n        var tempObj = { activePoint: { startX: 0, startY: 0, endX: 0, endY: 0, width: 0, height: 0 },\n            flipObjColl: [], triangle: [], triangleRatio: [] };\n        parent.notify('selection', { prop: 'setTempActObj', onPropertyChange: false,\n            value: { obj: tempObj } });\n        var obj = { prevActObj: null };\n        parent.notify('draw', { prop: 'getPrevActObj', onPropertyChange: false, value: { obj: obj } });\n        var pathObject = { isNewPath: null };\n        parent.notify('draw', { prop: 'getNewPath', value: { obj: pathObject } });\n        var objColl;\n        var duplicateObj = extend({}, parent.activeObj, {}, true);\n        var orderObj = { order: null };\n        parent.notify('shape', { prop: 'getHighestOrder', onPropertyChange: false, value: { obj: orderObj } });\n        if (duplicateObj.order) {\n            parent.notify('shape', { prop: 'updateShapeColl', onPropertyChange: false });\n            duplicateObj.order = orderObj['order'] > duplicateObj.order ? orderObj['order'] + 1 : duplicateObj.order + 1;\n        }\n        else {\n            parent.noPushUndo = true;\n            parent.okBtn();\n            parent.noPushUndo = false;\n            parent.selectShape(duplicateObj.currIndex);\n            duplicateObj.order = orderObj['order'] > duplicateObj.order ? orderObj['order'] + 1 : duplicateObj.order + 1;\n        }\n        if (duplicateObj.shape === 'image') {\n            objColl = extend([], parent.objColl, [], true);\n            parent.notify('undo-redo', { prop: 'updateUrObj', onPropertyChange: false, value: { objColl: objColl } });\n        }\n        if (isNullOrUndefined(parent.activeObj.currIndex)) {\n            parent.notify('shape', { prop: 'applyActObj', onPropertyChange: false, value: { isMouseDown: isPreventUndoRedo } });\n        }\n        else if (obj['prevActObj'] || isPublicMethod) {\n            parent.activeObj.currIndex = null;\n            duplicateObj.currIndex = null;\n            parent.notify('shape', { prop: 'applyActObj', onPropertyChange: false, value: { isMouseDown: isPreventUndoRedo } });\n        }\n        else {\n            parent.notify('shape', { prop: 'applyActObj', onPropertyChange: false, value: { isMouseDown: true } });\n        }\n        var noPushUndo = parent.noPushUndo;\n        parent.noPushUndo = false;\n        parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n        parent.noPushUndo = noPushUndo;\n        objColl = extend([], parent.objColl, [], true);\n        duplicateObj.activePoint.startX += 10;\n        duplicateObj.activePoint.startY -= 10;\n        duplicateObj.activePoint.endX += 10;\n        duplicateObj.activePoint.endY -= 10;\n        if (duplicateObj.shape === 'path') {\n            for (var i = 0; i < duplicateObj.pointColl.length; i++) {\n                duplicateObj.pointColl[i].x += 10;\n                duplicateObj.pointColl[i].y -= 10;\n            }\n        }\n        else if (duplicateObj.shape === 'image') {\n            duplicateObj.imageCanvas = parent.createElement('canvas');\n        }\n        var shapeIDObj = { id: 'shape_' + (parent.objColl.length + 1) };\n        parent.notify('shape', { prop: 'getNewShapeId', onPropertyChange: false, value: { obj: shapeIDObj } });\n        duplicateObj.currIndex = shapeIDObj['id'];\n        parent.activeObj = extend({}, duplicateObj, {}, true);\n        if (parent.activeObj.shape === 'image') {\n            var activePoint = extend({}, duplicateObj.activePoint, {}, true);\n            var dimObj = { width: 0, height: 0 };\n            parent.notify('transform', { prop: 'calcMaxDimension', onPropertyChange: false,\n                value: { width: parent.activeObj.imageElement.width, height: parent.activeObj.imageElement.height,\n                    obj: dimObj, isImgShape: null } });\n            parent.activeObj.activePoint.width = dimObj['width'];\n            parent.activeObj.activePoint.height = dimObj['height'];\n            if (parent.activeObj.isHorImageFlip && parent.activeObj.isVerImageFlip) {\n                parent.activeObj.isHorImageFlip = parent.activeObj.isVerImageFlip = false;\n                parent.notify('draw', { prop: 'downScaleImgCanvas', onPropertyChange: false,\n                    value: { ctx: duplicateObj.imageCanvas.getContext('2d'), isImgAnnotation: true, isHFlip: true, isVFlip: true } });\n                parent.activeObj.isHorImageFlip = parent.activeObj.isVerImageFlip = true;\n            }\n            else if (parent.activeObj.isHorImageFlip) {\n                parent.activeObj.isHorImageFlip = false;\n                parent.notify('draw', { prop: 'downScaleImgCanvas', onPropertyChange: false,\n                    value: { ctx: duplicateObj.imageCanvas.getContext('2d'), isImgAnnotation: true, isHFlip: true, isVFlip: null } });\n                parent.activeObj.isHorImageFlip = true;\n            }\n            else if (parent.activeObj.isVerImageFlip) {\n                parent.activeObj.isVerImageFlip = false;\n                parent.notify('draw', { prop: 'downScaleImgCanvas', onPropertyChange: false,\n                    value: { ctx: duplicateObj.imageCanvas.getContext('2d'), isImgAnnotation: true, isHFlip: null, isVFlip: true } });\n                parent.activeObj.isVerImageFlip = true;\n            }\n            else {\n                parent.notify('draw', { prop: 'downScaleImgCanvas', onPropertyChange: false,\n                    value: { ctx: duplicateObj.imageCanvas.getContext('2d'), isImgAnnotation: true, isHFlip: null, isVFlip: null } });\n            }\n            parent.activeObj.activePoint = activePoint;\n        }\n        if (parent.activeObj.shape === 'line' || parent.activeObj.shape === 'arrow') {\n            parent.notify('shape', { prop: 'setPointCollForLineArrow', onPropertyChange: false,\n                value: { obj: parent.activeObj } });\n        }\n        parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: parent.activeObj,\n                isCropRatio: null, points: null, isPreventDrag: true } });\n        parent.notify('undo-redo', { prop: 'updateUrObj', onPropertyChange: false, value: { objColl: objColl } });\n        parent.notify('shape', { prop: 'applyActObj', onPropertyChange: false, value: { isMouseDown: true } });\n        parent.noPushUndo = false;\n        parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n        parent.noPushUndo = true;\n        parent.notify('selection', { prop: 'redrawShape', onPropertyChange: false,\n            value: { obj: parent.objColl[parent.objColl.length - 1] } });\n        var id = parent.element.id;\n        var toolbarId = Browser.isDevice ? '#' + id + '_bottomToolbar ' + '#' + id : '#' + id;\n        var object = { freehandDrawSelectedId: null };\n        parent.notify('freehand-draw', { prop: 'getFreehandDrawSelectedId', onPropertyChange: false, value: { obj: object } });\n        this.enableDisableCloneBtn(toolbarId, object);\n        this.renderQAT();\n        if (parent.activeObj.shape && parent.activeObj.shape === 'redact') {\n            this.redactSlider(parent.activeObj.redactType);\n        }\n    };\n    ToolbarModule.prototype.defToolbarClicked = function (args) {\n        var parent = this.parent;\n        var id = parent.element.id;\n        var isContextualToolbar = false;\n        var isFilterFinetune = false;\n        if (!this.isFrameToolbar && parent.element.querySelector('.e-contextual-toolbar-wrapper')) {\n            if (!parent.element.querySelector('.e-contextual-toolbar-wrapper').classList.contains('e-hide')) {\n                isContextualToolbar = isFilterFinetune = true;\n            }\n            var straightenObj = { bool: parent.isStraightening };\n            if (!Browser.isDevice || (Browser.isDevice && !straightenObj['bool'])) {\n                parent.element.querySelector('.e-contextual-toolbar-wrapper').classList.add('e-hide');\n            }\n        }\n        if (args.item) {\n            var type = args.item.id.replace(id + '_', '').toLowerCase();\n            if (type === 'duplicate' || type === 'remove' || type === 'edittext' ||\n                type === 'hflip' || type === 'vflip' || type === 'rotleft' || type === 'rotright') {\n                this.quickAccessToolbarClicked(args, true);\n                parent.trigger('toolbarItemClicked', args);\n            }\n            else {\n                var isDisabledFilter = false;\n                var isDisabledAdjustment = false;\n                var adjustment = document.querySelector('#' + id + '_adjustment');\n                if (adjustment && adjustment.classList.contains('e-disabled')) {\n                    isDisabledAdjustment = true;\n                }\n                var filter = document.querySelector('#' + id + '_filter');\n                if (filter && filter.classList.contains('e-disabled')) {\n                    isDisabledFilter = true;\n                }\n                this.enableDisableTbrBtn();\n                this.performDefTbrClick(type, isContextualToolbar, isDisabledAdjustment, isDisabledFilter, isFilterFinetune);\n                parent.trigger('toolbarItemClicked', args);\n                if (parent.isStraightening) {\n                    parent.notify('transform', { prop: 'disableZoomOutBtn', value: { isZoomOut: true } });\n                }\n                var validTypes = ['undo', 'redo', 'cancel', 'aspectratio', 'nonaspectratio',\n                    'save', 'duplicate', 'filter', 'frame', 'none', 'mat', 'bevel', 'line', 'inset', 'hook', 'resize',\n                    'remove'];\n                if (validTypes.indexOf(type) !== -1) {\n                    parent.notify('draw', { prop: 'redrawDownScale' });\n                }\n            }\n        }\n    };\n    ToolbarModule.prototype.performDefTbrClick = function (type, isContextualToolbar, isDisabledAdjustment, isDisabledFilter, isFilterFinetune) {\n        var parent = this.parent;\n        var id = parent.element.id;\n        var zoomIn = parent.element.querySelector('#' + id + '_zoomIn');\n        var aspectRatioHeight = parent.element.querySelector('#' + id + '_resizeHeight');\n        var aspectRatioWidth = parent.element.querySelector('#' + id + '_resizeWidth');\n        var isCropSelection = false;\n        var panBtn;\n        var splitWords;\n        var actionType;\n        var actionArgs;\n        if (parent.activeObj.shape !== undefined) {\n            splitWords = parent.activeObj.shape.split('-');\n        }\n        if (splitWords === undefined && parent.currObjType.isCustomCrop) {\n            isCropSelection = true;\n        }\n        else if (splitWords !== undefined && splitWords[0] === 'crop') {\n            isCropSelection = true;\n        }\n        if (!parent.disabled) {\n            switch (type) {\n                case 'pan':\n                    parent.currObjType.isCustomCrop = parent.currObjType.isFiltered = false;\n                    parent.currObjType.isRedact = false;\n                    if (parent.currObjType.isUndoAction) {\n                        parent.notify('undo-redo', { prop: 'refreshUrc', value: { bool: null } });\n                    }\n                    if (isCropSelection) {\n                        parent.currObjType.isCustomCrop = false;\n                        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                        this.refreshToolbar('main');\n                    }\n                    if (parent.togglePan) {\n                        this.cancelPan();\n                        parent.notify('transform', { prop: 'setDisablePan', onPropertyChange: false, value: { bool: true } });\n                        if (this.currentToolbar === 'pen') {\n                            parent.freeHandDraw(true);\n                        }\n                    }\n                    else {\n                        panBtn = parent.element.querySelector('.e-img-pan .e-btn');\n                        if (panBtn) {\n                            panBtn.classList.add('e-selected-btn');\n                        }\n                        parent.pan(true);\n                        parent.notify('transform', { prop: 'setDisablePan', onPropertyChange: false, value: { bool: false } });\n                    }\n                    if (zoomIn && parent.zoomSettings.zoomFactor >= parent.zoomSettings.maxZoomFactor) {\n                        zoomIn.classList.add('e-disabled');\n                        zoomIn.parentElement.classList.add('e-overlay');\n                    }\n                    else if (zoomIn) {\n                        zoomIn.classList.remove('e-disabled');\n                        zoomIn.parentElement.classList.remove('e-overlay');\n                    }\n                    this.refreshToolbar('main');\n                    break;\n                case 'cancel':\n                    if (parent.currObjType.isRedact) {\n                        parent.currObjType.isRedact = false;\n                    }\n                    if (this.isFrameToolbar && parent.element.querySelector('.e-contextual-toolbar-wrapper') && !parent.element.querySelector('.e-contextual-toolbar-wrapper').classList.contains('e-hide')) {\n                        parent.element.querySelector('.e-contextual-toolbar-wrapper').classList.add('e-hide');\n                    }\n                    parent.notify('draw', { prop: 'performCancel', value: { isContextualToolbar: isContextualToolbar, isFinalCancel: true } });\n                    break;\n                case 'ok':\n                    if (Browser.isDevice && this.isFrameToolbar && parent.element.querySelector('.e-contextual-toolbar-wrapper') && !parent.element.querySelector('.e-contextual-toolbar-wrapper').classList.contains('e-hide')) {\n                        parent.element.querySelector('.e-contextual-toolbar-wrapper').classList.add('e-hide');\n                    }\n                    parent.okBtn(null, true);\n                    parent.drawingShape = null;\n                    this.refreshDropDownBtn(false);\n                    this.currentToolbar = 'main';\n                    parent.isStraightening = false;\n                    parent.notify('draw', { prop: 'resetTempObjColl' });\n                    parent.notify('draw', { prop: 'resetTempPointColl' });\n                    break;\n                case 'crop':\n                    parent.notify('transform', { prop: 'disableZoomOutBtn', value: { isZoomOut: true } });\n                    if (Browser.isDevice) {\n                        this.updateContextualToolbar('color', 'straighten');\n                    }\n                    break;\n                case 'reset':\n                    parent.reset();\n                    this.imageHeight = null;\n                    this.imageWidth = null;\n                    parent.aspectHeight = null;\n                    parent.aspectWidth = null;\n                    this.isAspectRatio = true;\n                    this.currentToolbar = 'main';\n                    break;\n                case 'undo':\n                    parent.noPushUndo = false;\n                    if (parent.togglePen || parent.drawingShape) {\n                        parent.okBtn();\n                        parent.drawingShape = null;\n                    }\n                    parent.notify('undo-redo', { prop: 'call-undo' });\n                    break;\n                case 'redo':\n                    parent.noPushUndo = false;\n                    if (parent.togglePen || parent.drawingShape) {\n                        parent.okBtn();\n                        parent.drawingShape = null;\n                    }\n                    parent.notify('undo-redo', { prop: 'call-redo' });\n                    break;\n                case 'aspectratio':\n                    if (!parent.isCircleCrop && (isNullOrUndefined(parent.currSelectionPoint)) ||\n                        (parent.currSelectionPoint && parent.currSelectionPoint.shape !== 'crop-circle')) {\n                        if (getComponent(aspectRatioWidth, 'numerictextbox').value) {\n                            parent.aspectWidth = getComponent(aspectRatioWidth, 'numerictextbox').value;\n                            parent.aspectHeight = getComponent(aspectRatioHeight, 'numerictextbox').value;\n                            parent.notify('transform', { prop: 'resize', value: { width: parent.aspectWidth, height: null, isAspectRatio: true } });\n                        }\n                        else if (getComponent(aspectRatioHeight, 'numerictextbox').value) {\n                            parent.aspectWidth = parseFloat(getComponent(aspectRatioWidth, 'numerictextbox').placeholder);\n                            parent.aspectHeight = getComponent(aspectRatioHeight, 'numerictextbox').value;\n                            parent.notify('transform', { prop: 'resize', value: { width: parent.aspectWidth, height: parent.aspectHeight, isAspectRatio: true } });\n                        }\n                        parent.resizeSrc = { startX: parent.img.srcLeft, startY: parent.img.srcTop, width: parent.img.srcWidth,\n                            height: parent.img.srcHeight };\n                        this.refreshToolbar('resize');\n                    }\n                    break;\n                case 'nonaspectratio':\n                    if (getComponent(aspectRatioWidth, 'numerictextbox').value ||\n                        getComponent(aspectRatioHeight, 'numerictextbox').value) {\n                        parent.aspectWidth = getComponent(aspectRatioWidth, 'numerictextbox').value ?\n                            getComponent(aspectRatioWidth, 'numerictextbox').value :\n                            parseFloat(getComponent(aspectRatioWidth, 'numerictextbox').placeholder);\n                        parent.aspectHeight = getComponent(aspectRatioHeight, 'numerictextbox').value ?\n                            getComponent(aspectRatioHeight, 'numerictextbox').value :\n                            parseFloat(getComponent(aspectRatioHeight, 'numerictextbox').placeholder);\n                        parent.notify('transform', { prop: 'resize', value: { width: parent.aspectWidth, height: parent.aspectHeight, isAspectRatio: false } });\n                    }\n                    parent.resizeSrc = { startX: parent.img.srcLeft, startY: parent.img.srcTop, width: parent.img.srcWidth,\n                        height: parent.img.srcHeight };\n                    this.refreshToolbar('resize');\n                    break;\n                case 'resize':\n                    if (parent.currObjType.isFiltered || parent.currObjType.isRedact) {\n                        parent.okBtn();\n                    }\n                    this.resizeClick();\n                    break;\n                case 'adjustment':\n                    if (!isDisabledAdjustment) {\n                        if (parent.currObjType.isFiltered || parent.currObjType.isRedact) {\n                            parent.okBtn();\n                        }\n                        this.refreshToolbar('adjustment');\n                        parent.setTempFilterProperties();\n                        parent.notify('draw', { prop: 'updateFinetune' });\n                        parent.notify('filter', { prop: 'setTempAdjVal' });\n                        this.openSlider('brightness');\n                    }\n                    break;\n                case 'brightness':\n                case 'contrast':\n                case 'hue':\n                case 'saturation':\n                case 'opacity':\n                case 'blur':\n                case 'exposure':\n                    this.openSlider(type);\n                    break;\n                case 'filter':\n                    if (!isDisabledFilter) {\n                        showSpinner(parent.element);\n                        this.refreshToolbar('filter');\n                        parent.setTempFilterProperties();\n                        hideSpinner(parent.element);\n                    }\n                    break;\n                case 'default':\n                case 'chrome':\n                case 'cold':\n                case 'warm':\n                case 'grayscale':\n                case 'blackandwhite':\n                case 'sepia':\n                case 'invert':\n                case 'sharpen':\n                    parent.currObjType.isFiltered = true;\n                    parent.notify('filter', { prop: 'applyImageFilter', value: { option: type } });\n                    break;\n                case 'upload':\n                    if (isFilterFinetune) {\n                        parent.element.querySelector('.e-contextual-toolbar-wrapper').classList.remove('e-hide');\n                    }\n                    break;\n                case 'bold':\n                    parent.notify('selection', { prop: 'setInitialTextEdit', value: { bool: false } });\n                    if (parent.activeObj.textSettings.bold && parent.activeObj.textSettings.italic) {\n                        parent.notify('shape', { prop: 'applyFontStyle', onPropertyChange: false,\n                            value: { item: 'italic' } });\n                    }\n                    else if (parent.activeObj.textSettings.bold && !parent.activeObj.textSettings.italic) {\n                        parent.notify('shape', { prop: 'applyFontStyle', onPropertyChange: false,\n                            value: { item: 'default' } });\n                    }\n                    else if (!parent.activeObj.textSettings.bold && parent.activeObj.textSettings.italic) {\n                        parent.notify('shape', { prop: 'applyFontStyle', onPropertyChange: false,\n                            value: { item: 'bolditalic' } });\n                    }\n                    else if (!parent.activeObj.textSettings.bold && !parent.activeObj.textSettings.italic) {\n                        parent.notify('shape', { prop: 'applyFontStyle', onPropertyChange: false,\n                            value: { item: 'bold' } });\n                    }\n                    if (parent.element.querySelector('#' + id + '_bold').classList.contains('e-selected-btn')) {\n                        parent.element.querySelector('#' + id + '_bold').classList.remove('e-selected-btn');\n                    }\n                    else {\n                        parent.element.querySelector('#' + id + '_bold').classList.add('e-selected-btn');\n                    }\n                    if (parent.activeObj.activePoint.width !== 0 || parent.activeObj.activePoint.height !== 0) {\n                        parent.notify('undo-redo', { prop: 'updateUndoRedoStack', onPropertyChange: false });\n                    }\n                    break;\n                case 'italic':\n                    parent.notify('selection', { prop: 'setInitialTextEdit', value: { bool: false } });\n                    if (parent.activeObj.textSettings.bold && parent.activeObj.textSettings.italic) {\n                        parent.notify('shape', { prop: 'applyFontStyle', onPropertyChange: false,\n                            value: { item: 'bold' } });\n                    }\n                    else if (parent.activeObj.textSettings.bold && !parent.activeObj.textSettings.italic) {\n                        parent.notify('shape', { prop: 'applyFontStyle', onPropertyChange: false,\n                            value: { item: 'bolditalic' } });\n                    }\n                    else if (!parent.activeObj.textSettings.bold && parent.activeObj.textSettings.italic) {\n                        parent.notify('shape', { prop: 'applyFontStyle', onPropertyChange: false,\n                            value: { item: 'default' } });\n                    }\n                    else if (!parent.activeObj.textSettings.bold && !parent.activeObj.textSettings.italic) {\n                        parent.notify('shape', { prop: 'applyFontStyle', onPropertyChange: false,\n                            value: { item: 'italic' } });\n                    }\n                    if (parent.element.querySelector('#' + id + '_italic').classList.contains('e-selected-btn')) {\n                        parent.element.querySelector('#' + id + '_italic').classList.remove('e-selected-btn');\n                    }\n                    else {\n                        parent.element.querySelector('#' + id + '_italic').classList.add('e-selected-btn');\n                    }\n                    if (parent.activeObj.activePoint.width !== 0 || parent.activeObj.activePoint.height !== 0) {\n                        parent.notify('undo-redo', { prop: 'updateUndoRedoStack', onPropertyChange: false });\n                    }\n                    break;\n                case 'croptransform':\n                    this.performCropTransformClick();\n                    break;\n                case 'rotateleft':\n                case 'rotateright':\n                case 'horizontalflip':\n                case 'verticalflip':\n                    parent.transformSelect(type);\n                    this.updateRedactObj();\n                    if (type === 'rotateleft' || type === 'rotateright') {\n                        parent.notify('draw', { prop: 'resetStraightenDestPoints' });\n                        parent.notify('draw', { prop: 'setDestForStraighten' });\n                    }\n                    parent.notify('transform', { prop: 'disableZoomOutBtn', value: { isZoomOut: true } });\n                    if (Browser.isDevice) {\n                        this.updateContextualToolbar('color', 'straighten');\n                    }\n                    actionType = type === 'rotateleft' || type === 'rotateright' ?\n                        'rotate' : 'flip';\n                    actionArgs = { action: actionType, actionEventArgs: parent.editCompleteArgs };\n                    parent.triggerEditCompleteEvent(actionArgs);\n                    break;\n                case 'save':\n                    parent.noPushUndo = false;\n                    parent.okBtn();\n                    parent.drawingShape = null;\n                    this.saveDialogPopup();\n                    break;\n                case 'transparency':\n                    this.updateContextualToolbar('transparency', 'transparency');\n                    break;\n                case 'frame':\n                    this.frameToolbarClick();\n                    break;\n                case 'none':\n                case 'mat':\n                case 'bevel':\n                case 'line':\n                case 'inset':\n                case 'hook':\n                    this.unselectFrameBtn();\n                    if (parent.element.querySelector('#' + id + '_' + type)) {\n                        parent.element.querySelector('#' + id + '_' + type).classList.add('e-selected-btn');\n                    }\n                    parent.frameObj.type = type;\n                    parent.frameObj.size = 20;\n                    parent.frameObj.inset = 20;\n                    parent.frameObj.radius = 0;\n                    parent.frameObj.amount = 1;\n                    if (type === 'inset') {\n                        parent.frameObj.offset = 60;\n                    }\n                    else {\n                        parent.frameObj.offset = 20;\n                    }\n                    this.refreshToolbar('frame');\n                    parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: null, isPreventClearRect: null, isFrame: true } });\n                    parent.isFrameBtnClick = true;\n                    parent.curFrameObjEvent = { previousFrameSetting: parent.tempFrameObj, currentFrameSetting: parent.frameObj };\n                    parent.notify('draw', { prop: 'triggerFrameChange', value: { prevFrameSettings: parent.tempFrameObj, obj: { frameChangeEventArgs: null } } });\n                    break;\n                case 'redact':\n                    parent.currObjType.isRedact = true;\n                    parent.drawingShape = 'redact';\n                    if (isNullOrUndefined(parent.activeObj.redactBlur)) {\n                        parent.activeObj.redactBlur = 20;\n                    }\n                    if (isNullOrUndefined(parent.activeObj.redactPixelate)) {\n                        parent.activeObj.redactPixelate = 20;\n                    }\n                    parent.notify('selection', { prop: 'annotate', value: { shape: 'redact' } });\n                    this.refreshToolbar('redact');\n                    this.redactSlider(parent.activeObj.redactType);\n                    break;\n                case 'pixelate':\n                    parent.currObjType.isRedact = true;\n                    parent.drawingShape = 'redact';\n                    parent.notify('selection', { prop: 'annotate', value: { shape: 'redact' } });\n                    if (parent.activeObj.redactType === 'blur') {\n                        this.updateRedactType('pixelate');\n                    }\n                    parent.notify('shape', { prop: 'setRedactType', onPropertyChange: false,\n                        value: { redactType: 'pixelate' } });\n                    if (parent.activeObj.redactType === 'pixelate') {\n                        var pixelateBtn = parent.element.querySelector('#' + id + '_' + 'pixelate');\n                        var redactBlurBtn = parent.element.querySelector('#' + id + '_' + 'redactBlur');\n                        if (pixelateBtn) {\n                            pixelateBtn.classList.add('e-selected-btn');\n                        }\n                        if (redactBlurBtn && redactBlurBtn.classList.contains('e-selected-btn')) {\n                            redactBlurBtn.classList.remove('e-selected-btn');\n                        }\n                    }\n                    else {\n                        var redactBlurBtn = parent.element.querySelector('#' + id + '_' + 'redactBlur');\n                        if (redactBlurBtn) {\n                            redactBlurBtn.classList.add('e-selected-btn');\n                        }\n                    }\n                    this.redactSlider(parent.activeObj.redactType);\n                    if (parent.activeObj.activePoint.width !== 0 || parent.activeObj.activePoint.height !== 0) {\n                        parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                            value: { operation: 'shapeTransform', previousObj: null, previousObjColl: null,\n                                previousPointColl: null, previousSelPointColl: null,\n                                previousCropObj: null, previousText: null,\n                                currentText: null, previousFilter: null, isCircleCrop: null } });\n                    }\n                    break;\n                case 'redactblur':\n                    parent.currObjType.isRedact = true;\n                    parent.drawingShape = 'redact';\n                    parent.notify('selection', { prop: 'annotate', value: { shape: 'redact' } });\n                    parent.notify('shape', { prop: 'setRedactType', onPropertyChange: false,\n                        value: { redactType: 'blur' } });\n                    if (parent.activeObj.redactType === 'pixelate') {\n                        this.updateRedactType('blur');\n                    }\n                    parent.notify('shape', { prop: 'setRedactType', onPropertyChange: false, value: { redactType: 'blur' } });\n                    if (parent.activeObj.redactType === 'blur') {\n                        var redactBlurBtn = parent.element.querySelector('#' + id + '_' + 'redactBlur');\n                        var pixelateBtn = parent.element.querySelector('#' + id + '_' + 'pixelate');\n                        if (redactBlurBtn) {\n                            redactBlurBtn.classList.add('e-selected-btn');\n                        }\n                        if (pixelateBtn && pixelateBtn.classList.contains('e-selected-btn')) {\n                            pixelateBtn.classList.remove('e-selected-btn');\n                        }\n                    }\n                    else {\n                        var pixelateBtn = parent.element.querySelector('#' + id + '_' + 'pixelate');\n                        if (pixelateBtn) {\n                            pixelateBtn.classList.add('e-selected-btn');\n                        }\n                    }\n                    this.redactSlider(parent.activeObj.redactType);\n                    if (parent.activeObj.activePoint.width !== 0 || parent.activeObj.activePoint.height !== 0) {\n                        parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                            value: { operation: 'shapeTransform', previousObj: null, previousObjColl: null,\n                                previousPointColl: null, previousSelPointColl: null,\n                                previousCropObj: null, previousText: null,\n                                currentText: null, previousFilter: null, isCircleCrop: null } });\n                    }\n                    break;\n            }\n        }\n    };\n    ToolbarModule.prototype.updateRedactType = function (value) {\n        var parent = this.parent;\n        parent.activeObj.redactType = value;\n        parent.notify('shape', { prop: 'setRedactType', value: { type: value } });\n        this.parent.objColl.push(parent.activeObj);\n        parent.notify('selection', { prop: 'redrawShape', value: { obj: parent.objColl[parent.objColl.length - 1] } });\n    };\n    ToolbarModule.prototype.frameToolbarClick = function () {\n        var parent = this.parent;\n        var id = parent.element.id;\n        var frame = document.querySelector('#' + id + '_frame');\n        var zoom;\n        var frameObj;\n        var tempFrameObj;\n        parent.notify('draw', { prop: 'updateCropSelection', onPropertyChange: false });\n        if (parent.currObjType.isFiltered || parent.currObjType.isRedact) {\n            parent.okBtn();\n        }\n        if (frame && !frame.classList.contains('e-overlay')) {\n            zoom = parent.transform.zoomFactor;\n            parent.frameDestPoints = extend({}, parent.img, {}, true);\n            if (isNullOrUndefined(parent.cxtTbarHeight)) {\n                frameObj = extend({}, parent.frameObj, {}, true);\n                tempFrameObj = extend({}, parent.tempFrameObj, {}, true);\n                this.callFrameToolbar();\n                parent.frameObj.type = 'mat';\n                this.callFrameToolbar();\n                parent.cxtTbarHeight = parent.element.querySelector('#' + id + '_customizeWrapper').scrollHeight;\n                parent.frameObj = frameObj;\n                parent.tempFrameObj = tempFrameObj;\n            }\n            this.zoomToFrameRange();\n            parent.tempFrameZoomLevel = zoom;\n            if (Browser.isDevice) {\n                parent.img.destTop -= (parent.cxtTbarHeight / 2);\n            }\n            else {\n                parent.img.destTop += (parent.cxtTbarHeight / 2);\n            }\n            this.callFrameToolbar();\n            parent.notify('draw', { prop: 'triggerFrameChange', value: { prevFrameSettings: parent.frameObj, obj: { frameChangeEventArgs: null } } });\n        }\n    };\n    ToolbarModule.prototype.zoomToFrameRange = function () {\n        var parent = this.parent;\n        this.isFrameToolbar = false;\n        parent.notify('transform', { prop: 'resetZoom', onPropertyChange: false });\n        var isSmaller = true;\n        while (isSmaller) {\n            if (this.toolbarHeight + parent.img.destTop >= (this.toolbarHeight + parent.cxtTbarHeight)) {\n                isSmaller = false;\n                break;\n            }\n            parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                value: { zoomFactor: -.1, zoomPoint: null, isResize: true } });\n        }\n        this.isFrameToolbar = true;\n    };\n    ToolbarModule.prototype.resizeClick = function () {\n        var parent = this.parent;\n        parent.notify('draw', { prop: 'updateCropSelection', onPropertyChange: false });\n        parent.upperCanvas.style.cursor = 'default';\n        parent.notify('transform', { prop: 'updateResize', value: { bool: false } });\n        if (this.isAspectRatio) {\n            this.isAspectRatio = false;\n        }\n        else {\n            this.isAspectRatio = true;\n        }\n        parent.isResize = true;\n        this.refreshToolbar('resize');\n    };\n    ToolbarModule.prototype.callFrameToolbar = function () {\n        var parent = this.parent;\n        extend(parent.tempFrameObj, parent.frameObj);\n        var undoRedoObj = { appliedUndoRedoColl: [] };\n        parent.notify('undo-redo', { prop: 'getAppliedUndoRedoColl', value: { obj: undoRedoObj } });\n        if (undoRedoObj['appliedUndoRedoColl']['length'] === 0) {\n            var object = { currObj: {} };\n            parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n            parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false, value: {\n                    operation: 'frame', previousObj: object['currObj'], previousObjColl: object['currObj']['objColl'],\n                    previousPointColl: object['currObj']['pointColl'], previousSelPointColl: object['currObj']['selPointColl'],\n                    previousCropObj: extend({}, parent.cropObj, {}, true), previousText: null, currentText: null,\n                    previousFilter: null, isCircleCrop: null\n                } });\n        }\n        this.refreshToolbar('frame');\n    };\n    ToolbarModule.prototype.contextualToolbarClicked = function (args) {\n        var parent = this.parent;\n        var selEle = parent.element.querySelector('.e-contextual-toolbar-wrapper .e-toolbar-item.e-selected');\n        if (selEle) {\n            selEle.classList.remove('e-selected');\n        }\n        var type = args.item.id.replace(parent.element.id, '').split('_')[1];\n        var imageFiltering = { filter: parent.toPascalCase(type), cancel: false };\n        parent.trigger('imageFiltering', imageFiltering);\n        parent.editCompleteArgs = imageFiltering;\n        if (imageFiltering.cancel) {\n            return;\n        }\n        document.getElementById(args.item.id + 'Canvas').parentElement.parentElement.classList.add('e-selected');\n        parent.currObjType.isFiltered = true;\n        parent.notify('filter', { prop: 'applyImageFilter', value: { option: type.toLowerCase() } });\n        parent.notify('draw', { prop: 'redrawDownScale' });\n        parent.currentFilter = args.item.id;\n        this.enableDisableTbrBtn();\n        parent.isFilterCanvasClick = true;\n        parent.curFilterObjEvent = imageFiltering;\n    };\n    ToolbarModule.prototype.refreshShapeDrawing = function () {\n        var parent = this.parent;\n        var object = { shape: '' };\n        parent.notify('selection', { prop: 'getCurrentDrawingShape', onPropertyChange: false, value: { obj: object } });\n        if (object['shape'] !== '') {\n            parent.notify('selection', { prop: 'setCurrentDrawingShape', onPropertyChange: false, value: { value: '' } });\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            this.refreshToolbar('main', false);\n        }\n    };\n    ToolbarModule.prototype.zoomInBtnClickHandler = function (e) {\n        if (e) {\n            var parent_1 = this.parent;\n            if ((parent_1.zoomSettings.zoomTrigger & ZoomTrigger.Toolbar) === ZoomTrigger.Toolbar) {\n                parent_1.noPushUndo = false;\n                if (parent_1.currObjType.isFiltered) {\n                    parent_1.okBtn();\n                }\n                var drawingShape = parent_1.drawingShape;\n                if (parent_1.drawingShape) {\n                    var id = parent_1.activeObj.currIndex;\n                    parent_1.noPushUndo = true;\n                    parent_1.okBtn();\n                    parent_1.noPushUndo = false;\n                    parent_1.drawingShape = null;\n                    if (id) {\n                        parent_1.selectShape(id);\n                    }\n                }\n                this.refreshShapeDrawing();\n                if (Browser.isDevice && e.type === 'touchstart') {\n                    if (!e.returnValue) {\n                        return;\n                    }\n                    e.preventDefault();\n                }\n                var zoomIn = document.querySelector('#' + parent_1.element.id + '_zoomIn');\n                EventHandler.trigger(zoomIn, 'click');\n                var obj = { bool: false };\n                parent_1.notify('selection', { prop: 'getFreehandDrawEditing', onPropertyChange: false, value: { obj: obj } });\n                if (obj['bool']) {\n                    parent_1.notify('freehand-draw', { prop: 'applyFhd', onPropertyChange: false });\n                    this.destroyQuickAccessToolbar();\n                }\n                parent_1.isZoomBtnClick = true;\n                this.applyPreviewFilter();\n                parent_1.currObjType.isFiltered = false;\n                parent_1.currObjType.isRedact = false;\n                if (parent_1.togglePen) {\n                    parent_1.currObjType.isZoomed = true;\n                    parent_1.freeHandDraw(false);\n                    parent_1.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n                }\n                parent_1.notify('draw', { prop: 'resetCurrentSelectionPoint' });\n                parent_1.drawingShape = drawingShape;\n                parent_1.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                    value: { zoomFactor: .1, zoomPoint: null, isResize: null } });\n                parent_1.notify('draw', { prop: 'redrawDownScale' });\n                if (parent_1.isCropTab || parent_1.activeObj.shape) {\n                    parent_1.notify('draw', { prop: 'setStraightenActObj', value: { activeObj: null } });\n                    parent_1.notify('freehand-draw', { prop: 'resetStraightenPoint' });\n                }\n                if (parent_1.isStraightening) {\n                    parent_1.notify('draw', { prop: 'resetStraightenDestPoints' });\n                    parent_1.notify('draw', { prop: 'setDestForStraighten' });\n                }\n                var actionArgs = { action: 'zoom-in',\n                    actionEventArgs: parent_1.editCompleteArgs };\n                parent_1.triggerEditCompleteEvent(actionArgs);\n                if (Browser.isDevice) {\n                    zoomIn.focus();\n                }\n            }\n        }\n    };\n    ToolbarModule.prototype.zoomOutBtnClickHandler = function (e) {\n        if (e) {\n            var parent_2 = this.parent;\n            if ((parent_2.zoomSettings.zoomTrigger & ZoomTrigger.Toolbar) === ZoomTrigger.Toolbar) {\n                parent_2.noPushUndo = false;\n                if (parent_2.currObjType.isFiltered) {\n                    parent_2.okBtn();\n                }\n                var drawingShape = parent_2.drawingShape;\n                if (parent_2.drawingShape) {\n                    var id = parent_2.activeObj.currIndex;\n                    parent_2.noPushUndo = true;\n                    parent_2.okBtn();\n                    parent_2.noPushUndo = false;\n                    parent_2.drawingShape = null;\n                    if (id) {\n                        parent_2.selectShape(id);\n                    }\n                }\n                this.refreshShapeDrawing();\n                if (Browser.isDevice && e.type === 'touchstart') {\n                    if (!e.returnValue) {\n                        return;\n                    }\n                    e.preventDefault();\n                }\n                var zoomOut = document.querySelector('#' + parent_2.element.id + '_zoomOut');\n                EventHandler.trigger(zoomOut, 'click');\n                var obj = { bool: false };\n                parent_2.notify('selection', { prop: 'getFreehandDrawEditing', onPropertyChange: false, value: { obj: obj } });\n                if (obj['bool']) {\n                    parent_2.notify('freehand-draw', { prop: 'applyFhd', onPropertyChange: false });\n                    this.destroyQuickAccessToolbar();\n                }\n                parent_2.isZoomBtnClick = true;\n                this.applyPreviewFilter();\n                parent_2.currObjType.isFiltered = false;\n                parent_2.currObjType.isRedact = false;\n                if (parent_2.togglePen) {\n                    parent_2.currObjType.isZoomed = true;\n                    parent_2.freeHandDraw(false);\n                    parent_2.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n                }\n                parent_2.notify('draw', { prop: 'resetCurrentSelectionPoint' });\n                parent_2.drawingShape = drawingShape;\n                parent_2.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                    value: { zoomFactor: -.1, zoomPoint: null, isResize: null } });\n                parent_2.notify('draw', { prop: 'redrawDownScale' });\n                if (parent_2.isCropTab || parent_2.activeObj.shape) {\n                    parent_2.notify('draw', { prop: 'setStraightenActObj', value: { activeObj: null } });\n                    parent_2.notify('freehand-draw', { prop: 'resetStraightenPoint' });\n                }\n                if (parent_2.isStraightening) {\n                    parent_2.notify('draw', { prop: 'resetStraightenDestPoints' });\n                    parent_2.notify('draw', { prop: 'setDestForStraighten' });\n                }\n                var actionArgs = { action: 'zoom-out',\n                    actionEventArgs: parent_2.editCompleteArgs };\n                parent_2.triggerEditCompleteEvent(actionArgs);\n                if (Browser.isDevice) {\n                    zoomOut.focus();\n                }\n            }\n        }\n    };\n    ToolbarModule.prototype.zoomInBtnMouseDownHandler = function (e) {\n        e.preventDefault();\n        this.zoomBtnHold = setInterval(this.zoomInBtnClickHandler.bind(this), 250);\n    };\n    ToolbarModule.prototype.zoomOutBtnMouseDownHandler = function (e) {\n        e.preventDefault();\n        this.zoomBtnHold = setInterval(this.zoomOutBtnClickHandler.bind(this), 250);\n    };\n    ToolbarModule.prototype.zoomBtnMouseUpHandler = function () {\n        clearInterval(this.zoomBtnHold);\n        this.zoomBtnHold = 0;\n    };\n    ToolbarModule.prototype.closeContextualToolbar = function () {\n        var parent = this.parent;\n        var id = parent.element.id;\n        var isContextualToolbar = false;\n        var straightenObj = { bool: parent.isStraightening };\n        if (!Browser.isDevice || (Browser.isDevice && !straightenObj['bool'])) {\n            if ((parent.element.querySelector('#' + id + '_contextualToolbar') &&\n                !parent.element.querySelector('#' + id + '_contextualToolbar').parentElement.classList.contains('e-hide')) ||\n                (parent.element.querySelector('#' + id + '_headWrapper')\n                    && !parent.element.querySelector('#' + id + '_headWrapper').parentElement.classList.contains('e-hide'))) {\n                parent.element.querySelector('.e-contextual-toolbar-wrapper').classList.add('e-hide');\n                parent.okBtn();\n                this.refreshMainToolbar();\n                isContextualToolbar = true;\n            }\n        }\n        return isContextualToolbar;\n    };\n    ToolbarModule.prototype.destroyQuickAccessToolbar = function () {\n        var parent = this.parent;\n        var id = parent.element.id;\n        var quickToolbar = document.getElementById(id + '_quickAccessToolbar');\n        if (quickToolbar && quickToolbar.classList.contains('e-control')) {\n            getComponent(quickToolbar, 'toolbar').destroy();\n        }\n        var qatArea = document.getElementById(id + '_quickAccessToolbarArea');\n        if (qatArea) {\n            qatArea.style.display = 'none';\n        }\n    };\n    ToolbarModule.prototype.renderSlider = function (type, isSelect) {\n        var parent = this.parent;\n        var id = parent.element.id;\n        var canvasWrapper = document.querySelector('#' + id + '_contextualToolbarArea');\n        var hdrWrapper = document.querySelector('#' + id + '_headWrapper');\n        var labelWrapper = document.querySelector('#' + id + '_labelWrapper');\n        if (hdrWrapper) {\n            hdrWrapper.remove();\n            labelWrapper.remove();\n        }\n        hdrWrapper = canvasWrapper.appendChild(parent.createElement('div', {\n            id: id + '_headWrapper',\n            styles: 'position: relative'\n        }));\n        if (type === 'transparency') {\n            labelWrapper = hdrWrapper.appendChild(parent.createElement('label', {\n                id: id + '_labelWrapper',\n                className: 'e-ie-finetune-slider-label',\n                styles: Browser.isDevice ? 'position: absolute; top: 31%; left: calc(50% - 150px); font-size: 15px; text-transform: capitalize; font-weight: 400;'\n                    : 'position: absolute; top: 31%; left: calc(50% - 220px); font-size: 15px; text-transform: capitalize; font-weight: 400;'\n            }));\n        }\n        else {\n            labelWrapper = hdrWrapper.appendChild(parent.createElement('label', {\n                id: id + '_labelWrapper',\n                className: 'e-ie-finetune-slider-label',\n                styles: Browser.isDevice ? ('position: absolute; top: 31%; left: calc(50% - 160px); font-size: 15px; text-transform: capitalize; font-weight: 400;')\n                    : 'position: absolute; top: 25%; left: calc(50% - 226px); font-size: 15px; text-transform: capitalize; font-weight: 400;'\n            }));\n        }\n        labelWrapper.textContent = this.l10n.getConstant(parent.toPascalCase(type === 'transparency' ? 'opacity' : type));\n        var sliderWrapper = hdrWrapper.appendChild(parent.createElement('div', {\n            id: id + '_sliderWrapper',\n            className: 'e-ie-finetune-slider-wrap',\n            styles: 'position: absolute'\n        }));\n        var value = parent.getCurrAdjustmentValue(type);\n        if (isSelect && type === 'straighten' && Browser.isDevice) {\n            value = parent.cropObj.straighten;\n        }\n        var min;\n        var max;\n        var slider;\n        if (type === 'brightness' || type === 'contrast' || type === 'saturation' || type === 'exposure') {\n            if (parent.finetuneSettings) {\n                if (type === 'brightness' && parent.finetuneSettings.brightness) {\n                    min = parent.finetuneSettings.brightness.min;\n                    max = parent.finetuneSettings.brightness.max;\n                }\n                else if (type === 'contrast' && parent.finetuneSettings.contrast) {\n                    min = parent.finetuneSettings.contrast.min;\n                    max = parent.finetuneSettings.contrast.max;\n                }\n                else if (type === 'saturation' && parent.finetuneSettings.saturation) {\n                    min = parent.finetuneSettings.saturation.min;\n                    max = parent.finetuneSettings.saturation.max;\n                }\n                else if (type === 'exposure' && parent.finetuneSettings.exposure) {\n                    min = parent.finetuneSettings.exposure.min;\n                    max = parent.finetuneSettings.exposure.max;\n                }\n                else {\n                    min = -100;\n                    max = 100;\n                }\n            }\n            else {\n                min = -100;\n                max = 100;\n            }\n            slider = this.createSlider(min, max, value, type);\n        }\n        else if (type === 'hue' || type === 'blur' || type === 'opacity') {\n            if (parent.finetuneSettings) {\n                if (type === 'hue' && parent.finetuneSettings.hue) {\n                    min = parent.finetuneSettings.hue.min;\n                    max = parent.finetuneSettings.hue.max;\n                }\n                else if (type === 'blur' && parent.finetuneSettings.blur) {\n                    min = parent.finetuneSettings.blur.min;\n                    max = parent.finetuneSettings.blur.max;\n                }\n                else if (type === 'opacity' && parent.finetuneSettings.opacity) {\n                    min = parent.finetuneSettings.opacity.min;\n                    max = parent.finetuneSettings.opacity.max;\n                }\n                else {\n                    min = 0;\n                    max = 100;\n                }\n            }\n            else {\n                min = 0;\n                max = 100;\n            }\n            slider = this.createSlider(min, max, value, type);\n        }\n        else if (type === 'transparency') {\n            min = 0;\n            max = 100;\n            slider = this.createSlider(min, max, value, type);\n        }\n        else if (type === 'straighten') {\n            min = -45;\n            max = 45;\n            slider = this.createSlider(min, max, value, type);\n        }\n        slider.appendTo('#' + id + '_sliderWrapper');\n        sliderWrapper.style.left = (parseFloat(canvasWrapper.style.width) - parseFloat(slider.width)) / 2 + 'px';\n        if (type === 'straighten' && Browser.isDevice) {\n            var sLabelWrapper = hdrWrapper.appendChild(parent.createElement('label', {\n                id: id + '_sLabelWrapper',\n                className: 'e-ie-straighten-value-span e-ie-finetune-value-span',\n                styles: 'position: absolute; top: 31%; margin-left: 20px; font-size: 15px; text-transform: capitalize; font-weight: 400;'\n            }));\n            sLabelWrapper.innerHTML = parent.transform.straighten.toString() + '&#176';\n            sliderWrapper.parentElement.classList.add('e-straighten-slider');\n        }\n        if (type !== 'straighten') {\n            hdrWrapper.appendChild(parent.createElement('label', {\n                id: id + '_finetuneSpan',\n                className: 'e-ie-finetune-value-span',\n                styles: Browser.isDevice ? ('position: absolute; top: 25%; margin-left: 20px; font-size: 15px; text-transform: capitalize; font-weight: 400;') :\n                    'position: absolute; top: 25%; left: calc(50% + 190px); font-size: 15px; text-transform: capitalize; font-weight: 400;'\n            }));\n            sliderWrapper.parentElement.classList.add('e-finetune-slider');\n            if (type === 'transparency' && Browser.isDevice) {\n                sliderWrapper.parentElement.classList.add('e-ie-device-transparency-slider');\n            }\n            this.updateFinetuneSpan(type);\n        }\n    };\n    ToolbarModule.prototype.createSlider = function (min, max, value, type) {\n        var _this = this;\n        var parent = this.parent;\n        var step = type === 'straighten' ? 3 : 1;\n        return new Slider({\n            value: value, type: 'MinRange', min: min, max: max,\n            step: step, width: Browser.isDevice ? '180px' : (type === 'straighten' ? '200px' : '300px'),\n            cssClass: 'e-slider',\n            change: function (args) {\n                parent.notify('selection', { prop: 'setSliderActive', onPropertyChange: false, value: { bool: true } });\n                if (type === 'transparency') {\n                    if (parent.activeObj.shape) {\n                        if (isNullOrUndefined(parent.activeObj.imageRatio)) {\n                            parent.notify('shape', { prop: 'updImgRatioForActObj', onPropertyChange: false });\n                        }\n                        parent.notify('shape', { prop: 'pushActItemIntoObj' });\n                        var prevCropObj = extend({}, parent.cropObj, {}, true);\n                        var object = { currObj: {} };\n                        parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n                        var prevObj = object['currObj'];\n                        prevObj.objColl = extend([], parent.objColl, [], true);\n                        prevObj.pointColl = extend([], parent.pointColl, [], true);\n                        prevObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n                        var selPointCollObj = { selPointColl: null };\n                        parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n                            value: { obj: selPointCollObj } });\n                        prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n                        parent.objColl.pop();\n                        parent.activeObj.opacity = args.value / 100;\n                        _this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                        parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate' } });\n                        parent.objColl.push(parent.activeObj);\n                        parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                            value: { operation: 'shapeTransform', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                                previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                                previousCropObj: prevCropObj, previousText: null,\n                                currentText: null, previousFilter: null, isCircleCrop: null } });\n                        parent.notify('selection', { prop: 'redrawShape', value: { obj: parent.objColl[parent.objColl.length - 1] } });\n                        _this.updateFinetuneSpan(type);\n                    }\n                }\n                else if (type === 'straighten') {\n                    parent.setStraighten(args.value);\n                }\n                else {\n                    if (parent.transform.zoomFactor && parent.transform.zoomFactor < 0) {\n                        parent.isFinetuning = true;\n                    }\n                    parent.notify('selection', { prop: 'setSliding', value: { bool: true } });\n                    parent.setCurrAdjustmentValue(type, args.value);\n                    _this.updateFinetuneSpan(type);\n                    _this.enableDisableTbrBtn();\n                    parent.isFinetuning = false;\n                }\n            },\n            changed: function () {\n                if (type !== 'transparency' && type !== 'straighten') {\n                    parent.notify('selection', { prop: 'setSliding', value: { bool: false } });\n                    parent.notify('draw', { prop: 'redrawDownScale' });\n                }\n                parent.notify('selection', { prop: 'setSliderActive', onPropertyChange: false, value: { bool: false } });\n                if (type === 'transparency') {\n                    setTimeout(function () {\n                        parent.notify('undo-redo', { prop: 'updateUndoRedoStack', onPropertyChange: false });\n                        parent.element.querySelector('#' + parent.element.id + '_transparency').click();\n                    }, 50);\n                }\n            }\n        });\n    };\n    ToolbarModule.prototype.updateFinetuneSpan = function (type) {\n        var parent = this.parent;\n        var ftValPan = parent.element.querySelector('.e-ie-finetune-value-span');\n        if (ftValPan) {\n            var adjObj = { adjustmentLevel: null };\n            parent.notify('filter', { prop: 'getAdjustmentLevel', onPropertyChange: false, value: { obj: adjObj } });\n            ftValPan.innerHTML = Math.round(adjObj['adjustmentLevel'][type]).toString();\n        }\n    };\n    ToolbarModule.prototype.applyPreviewFilter = function () {\n        var parent = this.parent;\n        if (document.querySelector('#' + parent.element.id + '_sliderWrapper') ||\n            parent.currObjType.isFiltered) {\n            parent.initialAdjustmentValue = this.lowerContext.filter;\n            parent.canvasFilter = this.lowerContext.filter;\n            parent.currObjType.isFiltered = false;\n        }\n    };\n    ToolbarModule.prototype.unselectBtn = function () {\n        var parent = this.parent;\n        var id = parent.element.id;\n        var selectors = [\n            '#' + id + '_brightness',\n            '#' + id + '_contrast',\n            '#' + id + '_hue',\n            '#' + id + '_saturation',\n            '#' + id + '_opacity',\n            '#' + id + '_blur',\n            '#' + id + '_exposure'\n        ];\n        for (var _i = 0, selectors_1 = selectors; _i < selectors_1.length; _i++) {\n            var selector = selectors_1[_i];\n            var element = document.querySelector(selector);\n            if (element && element.classList.contains('e-selected-btn')) {\n                element.classList.remove('e-selected-btn');\n                break;\n            }\n        }\n    };\n    ToolbarModule.prototype.openSlider = function (type) {\n        this.unselectBtn();\n        this.parent.currObjType.isFiltered = true;\n        this.refreshToolbar('color', null, null, null, type);\n        document.getElementById(this.parent.element.id + '_' + type).classList.add('e-selected-btn');\n    };\n    ToolbarModule.prototype.refreshSlider = function () {\n        var id = this.parent.element.id;\n        var sliderWrapper = document.querySelector('#' + id + '_sliderWrapper');\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var slider = document.querySelector('.e-slider');\n        var hdrWrapper = document.querySelector('#' + id + '_headWrapper');\n        if (hdrWrapper) {\n            hdrWrapper.style.display = 'none';\n        }\n        if (sliderWrapper && slider) {\n            slider.ej2_instances[0].destroy();\n            sliderWrapper.remove();\n        }\n    };\n    ToolbarModule.prototype.unselectFrameBtn = function () {\n        var parent = this.parent;\n        var id = parent.element.id;\n        var selectors = [\n            '#' + id + '_none',\n            '#' + id + '_mat',\n            '#' + id + '_line',\n            '#' + id + '_inset',\n            '#' + id + '_bevel',\n            '#' + id + '_hook'\n        ];\n        for (var _i = 0, selectors_2 = selectors; _i < selectors_2.length; _i++) {\n            var selector = selectors_2[_i];\n            var element = document.querySelector(selector);\n            if (element.classList.contains('e-selected-btn')) {\n                element.classList.remove('e-selected-btn');\n                break;\n            }\n        }\n    };\n    ToolbarModule.prototype.updateToolbarItems = function () {\n        var parent = this.parent;\n        var id = parent.element.id;\n        if (!parent.isImageLoaded) {\n            return;\n        }\n        if (this.isToolbar()) {\n            var selFillElem = parent.element.querySelector('.e-fill.e-template .e-dropdownbtn-preview');\n            var selStrokeElem = parent.element.querySelector('.e-stroke.e-template .e-dropdownbtn-preview');\n            var selTextStrokeElem = parent.element.querySelector('.e-text-font-color.e-template .e-dropdownbtn-preview');\n            var selStrokeTextColorElem = parent.element.querySelector('.e-stroke-text-font-color.e-template .e-dropdownbtn-preview');\n            var selTextBGElem = parent.element.querySelector('.e-text-background-color.e-template .e-dropdownbtn-preview');\n            var selPenStrokeElem = parent.element.querySelector('.e-pen-stroke-color.e-template .e-dropdownbtn-preview');\n            var strokeWidthElem = parent.element.querySelector('.e-shape-stroke-width');\n            var rectangleRadiusElem = parent.element.querySelector('.e-shape-rectangle-radius');\n            var fontFamilyElem = parent.element.querySelector('.e-text-font-family');\n            var fontSizeElem = parent.element.querySelector('.e-text-font-size');\n            var boldBtn = parent.element.querySelector('#' + id + '_bold');\n            var italicBtn = parent.element.querySelector('#' + id + '_italic');\n            if (parent.activeObj.strokeSettings && parent.activeObj.textSettings) {\n                if (isNullOrUndefined(parent.activeObj.strokeSettings.strokeWidth)) {\n                    parent.activeObj.strokeSettings.strokeWidth = 2;\n                }\n                if (isNullOrUndefined(parent.activeObj.strokeSettings.outlineWidth)) {\n                    parent.activeObj.strokeSettings.outlineWidth = 2;\n                }\n                if (selFillElem) {\n                    var value = parent.activeObj.strokeSettings.fillColor;\n                    if (parent.activeObj.strokeSettings.fillColor === '') {\n                        selFillElem.classList.add('e-nocolor-item');\n                    }\n                    else {\n                        selFillElem.classList.remove('e-nocolor-item');\n                        selFillElem.style.background = value;\n                    }\n                    if (document.querySelector('#' + id + '_shape_fill')) {\n                        getComponent(id + '_shape_fill', 'colorpicker').value = value;\n                    }\n                }\n                if (selStrokeElem) {\n                    var value = parent.activeObj.strokeSettings.strokeColor;\n                    selStrokeElem.style.background = value;\n                    if (document.querySelector('#' + id + '_shape_stroke')) {\n                        getComponent(id + '_shape_stroke', 'colorpicker').value = value;\n                    }\n                }\n                if (selTextStrokeElem) {\n                    var value = parent.activeObj.strokeSettings.strokeColor;\n                    selTextStrokeElem.style.background = value;\n                    if (document.querySelector('#' + id + '_text_font')) {\n                        getComponent(id + '_text_font', 'colorpicker').value = value;\n                    }\n                }\n                if (selStrokeTextColorElem) {\n                    var value = parent.activeObj.strokeSettings.outlineColor;\n                    if (!/^#([0-9A-Fa-f]{3}|[0-9A-Fa-f]{6}|[0-9A-Fa-f]{8})$|^[a-zA-Z]+$/.test(parent.activeObj.strokeSettings.outlineColor)) {\n                        selStrokeTextColorElem.classList.add('e-nocolor-item');\n                    }\n                    else {\n                        selStrokeTextColorElem.classList.remove('e-nocolor-item');\n                        selStrokeTextColorElem.style.background = value;\n                    }\n                    if (document.querySelector('#' + id + '_stroke_text')) {\n                        getComponent(id + '_stroke_text', 'colorpicker').value = value;\n                    }\n                }\n                if (selTextBGElem) {\n                    var value = parent.activeObj.strokeSettings.fillColor;\n                    if (parent.activeObj.strokeSettings.fillColor === '' || parent.activeObj.strokeSettings.fillColor === 'transparent') {\n                        selTextBGElem.classList.add('e-nocolor-item');\n                    }\n                    else {\n                        selTextBGElem.classList.remove('e-nocolor-item');\n                        selTextBGElem.style.background = value;\n                    }\n                    if (document.querySelector('#' + id + '_text_bgColor')) {\n                        getComponent(id + '_text_bgColor', 'colorpicker').value = value;\n                    }\n                }\n                if (selPenStrokeElem) {\n                    var value = parent.activeObj.strokeSettings.strokeColor;\n                    selPenStrokeElem.style.background = value;\n                    if (document.querySelector('#' + id + '_pen_stroke')) {\n                        getComponent(id + '_pen_stroke', 'colorpicker').value = value;\n                    }\n                    var obj = { penOpacity: 1 };\n                    parent.notify('freehand-draw', { prop: 'getPenOpacity', onPropertyChange: false, value: { obj: obj } });\n                }\n                if (fontFamilyElem) {\n                    if (Browser.isDevice) {\n                        fontFamilyElem.setAttribute('style', 'font-family:' + parent.activeObj.textSettings.fontFamily.toLowerCase());\n                    }\n                    else {\n                        fontFamilyElem.textContent = parent.activeObj.textSettings.fontFamily;\n                    }\n                }\n                if (fontSizeElem) {\n                    for (var i = 0; i < parent.fontSizeColl.length; i++) {\n                        if (parseInt(parent.fontSizeColl[i].text, 10) >= Math.round(parent.activeObj.textSettings.fontSize)) {\n                            fontSizeElem.textContent = (i + 1).toString();\n                            break;\n                        }\n                    }\n                }\n                if (boldBtn) {\n                    if (parent.activeObj.textSettings.bold) {\n                        boldBtn.classList.add('e-selected-btn');\n                    }\n                    else {\n                        boldBtn.classList.remove('e-selected-btn');\n                    }\n                }\n                if (italicBtn) {\n                    if (parent.activeObj.textSettings.italic) {\n                        italicBtn.classList.add('e-selected-btn');\n                    }\n                    else {\n                        italicBtn.classList.remove('e-selected-btn');\n                    }\n                }\n                if (strokeWidthElem) {\n                    var width = parent.activeObj.shape === 'text' ? parent.activeObj.strokeSettings.outlineWidth : parent.activeObj.strokeSettings.strokeWidth;\n                    var strokeWidth = Math.round(width).toString();\n                    strokeWidthElem.textContent = this.getStrokeWidth(strokeWidth);\n                }\n                if (rectangleRadiusElem) {\n                    var rectRadius = Math.round((parent.activeObj.strokeSettings.radius)).toString();\n                    rectangleRadiusElem.textContent = this.getRectRadius(rectRadius);\n                }\n            }\n        }\n    };\n    ToolbarModule.prototype.getStrokeWidth = function (text) {\n        var strokeWidth;\n        var currentWidth = parseInt(text, 10) / 2;\n        switch (currentWidth) {\n            case 0:\n                strokeWidth = this.l10n.getConstant('NoOutline');\n                break;\n            case 1:\n                strokeWidth = this.l10n.getConstant('XSmall');\n                break;\n            case 2:\n                strokeWidth = this.l10n.getConstant('Small');\n                break;\n            case 3:\n                strokeWidth = this.l10n.getConstant('Medium');\n                break;\n            case 4:\n                strokeWidth = this.l10n.getConstant('Large');\n                break;\n            case 5:\n                strokeWidth = this.l10n.getConstant('XLarge');\n                break;\n        }\n        return strokeWidth;\n    };\n    ToolbarModule.prototype.getRectRadius = function (text) {\n        var rectRadius;\n        var currentWidth = parseInt(text, 10) / 2;\n        switch (currentWidth) {\n            case 0:\n                rectRadius = this.l10n.getConstant('0');\n                break;\n            case 1:\n                rectRadius = this.l10n.getConstant('20');\n                break;\n            case 2:\n                rectRadius = this.l10n.getConstant('40');\n                break;\n            case 3:\n                rectRadius = this.l10n.getConstant('60');\n                break;\n            case 4:\n                rectRadius = this.l10n.getConstant('80');\n                break;\n            case 5:\n                rectRadius = this.l10n.getConstant('100');\n                break;\n        }\n        return rectRadius;\n    };\n    ToolbarModule.prototype.cancelPan = function () {\n        var parent = this.parent;\n        parent.notify('shape', { prop: 'applyActObj', onPropertyChange: false, value: { isMouseDown: true } });\n        var panBtn = parent.element.querySelector('.e-img-pan .e-btn');\n        if (panBtn) {\n            panBtn.classList.remove('e-selected-btn');\n        }\n        parent.pan(false);\n    };\n    ToolbarModule.prototype.refreshMainToolbar = function () {\n        if (this.currToolbar !== 'main') {\n            this.refreshToolbar('main');\n        }\n    };\n    ToolbarModule.prototype.destroySubComponents = function () {\n        var parent = this.parent;\n        var inputElement = parent.element.querySelectorAll('input.e-control');\n        var btnElement = parent.element.querySelectorAll('button.e-control');\n        for (var i = 0, len = inputElement.length; i < len; i++) {\n            if (inputElement[i].classList.contains('e-color-picker')) {\n                getComponent(inputElement[i], 'color-picker').destroy();\n                detach(select('input#' + inputElement[i].id, parent.element));\n            }\n        }\n        for (var i = 0, len = btnElement.length; i < len; i++) {\n            if (btnElement[i].classList.contains('e-dropdown-btn')) {\n                getComponent(btnElement[i], 'dropdown-btn').destroy();\n                detach(select('button#' + btnElement[i].id, parent.element));\n            }\n            else if (btnElement[i].classList.contains('e-btn')) {\n                getComponent(btnElement[i], 'btn').destroy();\n                detach(select('button#' + btnElement[i].id, parent.element));\n            }\n        }\n    };\n    ToolbarModule.prototype.setInitialShapeSettings = function (args) {\n        var parent = this.parent;\n        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        parent.currObjType.shape = args.item.id;\n        parent.activeObj.shape = parent.currObjType.shape.toLowerCase();\n        parent.currObjType.isDragging = parent.currObjType.isCustomCrop = false;\n        parent.activeObj.shapeDegree = parent.transform.degree;\n        parent.activeObj.shapeFlip = parent.transform.currFlipState;\n        parent.activeObj.textFlip = parent.transform.currFlipState;\n        parent.activeObj.flipObjColl = [];\n        var orderObj = { order: null };\n        parent.notify('shape', { prop: 'getNewOrder', onPropertyChange: false, value: { obj: orderObj } });\n        parent.activeObj.order = orderObj['order'];\n    };\n    ToolbarModule.prototype.isToolbarString = function (items) {\n        var isString = false;\n        for (var i = 0; i < items.length; i++) {\n            if (typeof (items[i]) === 'string') {\n                isString = true;\n                break;\n            }\n        }\n        return isString;\n    };\n    ToolbarModule.prototype.excludeItems = function (items) {\n        var indexArr = [];\n        for (var i = 0; i < items.length; i++) {\n            var index = this.getIndex(items[i]);\n            if (index !== -1) {\n                indexArr.push(index);\n            }\n        }\n        var negativeIndexArr = [];\n        for (var i = 0; i < this.defToolbarItems.length; i++) {\n            if (this.defToolbarItems[i].align === 'Center' && !this.isSameIndex(indexArr, i) &&\n                this.defToolbarItems[i].id !== this.parent.element.id + '_' + 'annotation') {\n                negativeIndexArr.push(i);\n            }\n        }\n        for (var i = negativeIndexArr.length - 1; i >= 0; i--) {\n            this.defToolbarItems.splice(negativeIndexArr[i], 1);\n        }\n    };\n    ToolbarModule.prototype.isSameIndex = function (indexArr, index) {\n        for (var i = 0; i < indexArr.length; i++) {\n            if (indexArr[i] === index) {\n                return true;\n            }\n        }\n        return false;\n    };\n    ToolbarModule.prototype.getIndex = function (item) {\n        var index = -1;\n        var isFontColor = false;\n        if (item === 'rotateLeft') {\n            item = 'rotLeft';\n        }\n        if (item === 'rotateRight') {\n            item = 'rotRight';\n        }\n        if (item === 'horizontalFlip') {\n            item = 'hflip';\n        }\n        if (item === 'verticalFlip') {\n            item = 'vflip';\n        }\n        if (item === 'arrowStart') {\n            item = 'start';\n        }\n        if (item === 'arrowEnd') {\n            item = 'end';\n        }\n        if (item === 'fontColor') {\n            item = 'strokeColor';\n            isFontColor = true;\n        }\n        for (var i = 0; i < this.defToolbarItems.length; i++) {\n            var id = this.defToolbarItems[i].id;\n            if (id && id.toLowerCase().indexOf(item.toLowerCase()) !== -1) {\n                index = i;\n                break;\n            }\n        }\n        if (isFontColor) {\n            item = 'fontColor';\n        }\n        return index;\n    };\n    ToolbarModule.prototype.getModuleName = function () {\n        return 'toolbar-module';\n    };\n    ToolbarModule.prototype.redactSlider = function (type) {\n        var parent = this.parent;\n        var id = parent.element.id;\n        var toolbarArea = parent.element.querySelector('#' + id + '_toolbarArea');\n        var contextualToolbarArea = parent.element.querySelector('#' + id + '_contextualToolbarArea');\n        if (!contextualToolbarArea) {\n            return;\n        }\n        contextualToolbarArea.classList.remove('e-hide');\n        contextualToolbarArea.style.left = toolbarArea.offsetLeft + 'px';\n        var canvasWrapper = document.querySelector('#' + id + '_contextualToolbarArea');\n        var hdrWrapper = document.querySelector('#' + id + '_headWrapper');\n        var labelWrapper = document.querySelector('#' + id + '_labelWrapper');\n        var ctxTbar = document.querySelector('#' + id + '_contextualToolbar');\n        if (hdrWrapper) {\n            hdrWrapper.remove();\n            labelWrapper.remove();\n        }\n        if (ctxTbar) {\n            ctxTbar.remove();\n            this.createContextualToolbar();\n        }\n        hdrWrapper = canvasWrapper.appendChild(parent.createElement('div', {\n            id: id + '_headWrapper',\n            styles: 'position: relative'\n        }));\n        labelWrapper = hdrWrapper.appendChild(parent.createElement('label', {\n            id: id + '_labelWrapper',\n            className: 'e-ie-finetune-slider-label',\n            styles: Browser.isDevice ? ('position: absolute; top: 31%; left: calc(50% - 160px); font-size: 15px; text-transform: capitalize; font-weight: 400;')\n                : 'position: absolute; top: 25%; left: calc(50% - 226px); font-size: 15px; text-transform: capitalize; font-weight: 400;'\n        }));\n        var text = type === 'blur' ? this.l10n.getConstant('Blur') : this.l10n.getConstant('PixelSize');\n        labelWrapper.textContent = text;\n        var sliderWrapper = hdrWrapper.appendChild(parent.createElement('div', {\n            id: id + '_sliderWrapper',\n            className: 'e-ie-finetune-slider-wrap',\n            styles: 'position: absolute'\n        }));\n        hdrWrapper.appendChild(parent.createElement('label', {\n            id: id + '_redactSpan',\n            className: 'e-ie-redact-value-span',\n            styles: Browser.isDevice ? ('position: absolute; top: 30%; margin-left: 20px; font-size: 15px; text-transform: capitalize; font-weight: 400;') :\n                'position: absolute; top: 30%; left: calc(50% + 190px); font-size: 15px; text-transform: capitalize; font-weight: 400;'\n        }));\n        sliderWrapper.parentElement.classList.add('e-finetune-slider');\n        var value = parent.activeObj.redactType === 'blur' ? parent.activeObj.redactBlur :\n            parent.activeObj.redactPixelate;\n        var redactSlider = new Slider({\n            tooltip: { placement: 'Before', isVisible: true, showOn: 'Focus' },\n            min: 10, max: 100, step: 1, value: value,\n            type: 'MinRange',\n            width: Browser.isDevice ? '130px' : '300px',\n            created: function () {\n                parent.element.querySelector('.e-ie-redact-value-span').innerText = value.toString();\n            },\n            change: function (args) {\n                parent.element.querySelector('.e-ie-redact-value-span').innerText = args.value.toString();\n                if (parent.activeObj.redactType === 'blur') {\n                    parent.activeObj.redactBlur = parent.tempRedactBlur = args.value;\n                }\n                else if (parent.activeObj.redactType === 'pixelate') {\n                    parent.activeObj.redactPixelate = parent.tempRedactPixel = args.value;\n                }\n                parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: parent.activeObj, isCropRatio: null,\n                        points: null, isPreventDrag: true, saveContext: null, isPreventSelection: true } });\n            },\n            changed: function () {\n                setTimeout(function () {\n                    parent.notify('undo-redo', { prop: 'updateUndoRedoStack', onPropertyChange: false });\n                }, 50);\n            }\n        });\n        redactSlider.appendTo('#' + id + '_sliderWrapper');\n        if (Browser.isDevice) {\n            var cHt = contextualToolbarArea.offsetHeight + 1;\n            var cusWrapper = parent.element.querySelector('#' + id + '_customizeWrapper');\n            if (this.isFrameToolbar && cusWrapper) {\n                cHt = cusWrapper.offsetHeight + 2;\n            }\n            var ht = parent.element.querySelector('#' + id + '_canvasWrapper').offsetHeight;\n            contextualToolbarArea.style.top = this.toolbarHeight + 1 + ht - cHt + 'px';\n        }\n    };\n    return ToolbarModule;\n}());\nexport { ToolbarModule };\n"],"names":["Crop","parent","this","croppedDegree","cropDestPoints","startX","startY","width","height","tempFlipPanPoint","x","y","isPreventScaling","isInitCrop","isTransformCrop","addEventListener","prototype","destroy","isDestroyed","removeEventListener","on","cropping","off","args","updateCropPvtVar","prop","cropCircle","value","setCurrSelPoints","updateRotatePan","crop","calcRatio","getCurrFlipState","prevCropCurrObj","isNullOrUndefined","adjustStraightenForShapes","resizeWrapper","resetZoom","revertTransform","reset","getModuleName","lowerCanvas","lowerContext","getContext","upperCanvas","upperContext","cropImg","isRotateCrop","isNullCrop","resizeIcon","element","querySelector","id","actPoint","activeObj","activePoint","img","isRotated","i","len","rotateFlipColl","length","currentValue","notify","onPropertyChange","transform","degree","updateCropObj","point","destLeft","destTop","destWidth","destHeight","rotateCrop","currFlipState","flipCrop","tempZoomFactor","zoomFactor","ratio","currSelectionPoint","extend","obj","isImgShape","maxDimension","clearRect","srcLeft","srcTop","srcWidth","srcHeight","clientWidth","clientHeight","temp","filter","cropObjColl","straighten","cropFreehandDrawColl","shapeColl","ctx","shape","pen","isPreventApply","context","isCircleCrop","currObjType","isCustomCrop","pan","defaultZoomFactor","type","isInitialRotated","center","_i","_a","objColl","indexOf","rotatedAngle","_b","angle","diffX","diffY","cosAngle","Math","cos","sinAngle","sin","diffXUpdated","diffYUpdated","endX","endY","afterCropActions","object","currObj","cropObj","flipState","push","tempCurrSelObj","preventSelObj","bool","coll","panToSelRangle","canvas","pop","straightenBaseImageCanvas","isMouseWheel","isIntersect","count","zoomPoint","isResize","isRotate","direction","toPascalCase","toString","updateFlipState","shapeFlip","pointColl","freehandCounter","isUndoRedo","setProperties","zoomSettings","previousZoomValue","isReverseFlip","panPoint","totalPannedPoint","tempCurrFlipState","flipColl","tempFlipColl","panX","panY","setTransform","isPreventDestination","isPreventCircleCrop","isRotateZoom","imageRatio","size","shapeDegree","abs","textSettings","fontRatio","fontSize","cropPointCollection","n","ratioX","ratioY","points","l","resetAnnotations","isSetDimension","allowDownScale","destPoint","isCropTab","baseImgCanvas","currSelPoint","totalPannedInternalPoint","cropPointColl","straightenObj","straightenPoint","destPoints","selPointColl","cropSelPointColl","actObj","xDiff","yDiff","currentPannedPoint","cropZoom","isContextualToolbar","isApplyBtn","isCropping","isZooming","cType","document","innerHTML","isReverse","pannedPoint","totalPannedClientPoint","isSave","isFlip","globalCompositeOperation","beginPath","centerX","centerY","radius","arc","PI","closePath","fill","restore","isActiveObj","getCurrCropState","panRegion","disabled","isImageLoaded","isCropToolbar","isUndoAction","transitionArgs","cancel","startPoint","endPoint","preventScaling","trigger","editCompleteArgs","cropEvent","splitWords","split","horTopLine","isCrop","prevCropObj","prevObj","aspectWidth","aspectHeight","Browser","isDevice","updateUndoRedoColl","aspectIcon","nonAspectIcon","currSelPtObj","prevCurrSelectionPoint","operation","previousObj","previousObjColl","previousPointColl","previousSelPointColl","previousCropObj","previousText","currentText","previousFilter","elem","ctxToolbar","style","position","isStraightening","update","adjustmentValue","canvasFilter","dimension","widthRatio","heightRatio","panObj","collection","isRotateFlipCollection","region","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","step","next","e","rejected","result","done","then","apply","__generator","body","verb","v","op","f","TypeError","_","t","call","label","ops","trys","g","sent","throw","return","Symbol","iterator","Draw","isInitialLoading","fileName","isErrorImage","isShapeTextInserted","tempStrokeSettings","strokeColor","fillColor","strokeWidth","outlineColor","outlineWidth","tempTextSettings","text","fontFamily","bold","italic","underline","tempAdjValue","tempFilter","tempUndoRedoStep","tempFreehandCounter","tempCurrFhdIndex","isCancelAction","rotatedFlipCropSel","zoomCrop","isImageEdited","isFileChanged","isNewPath","isResizeSelect","arrowDimension","bar","arrow","arrowSolid","circle","square","origDim","isImageApply","imgCanvasPoints","isCropSelect","isDownScale","preventStraightening","tempObjColl","tempPointColl","imageBackgroundColor","allowRedactStraighten","draw","updatePrivateVariables","drawObject","updateActiveObject","clearOuterCanvas","setDestPoints","updateCurrTransState","currTransState","renderImage","drawImgToCanvas","updateCanvas","performCancel","updateFlipPan","select","callUpdateCurrTransState","resetPanPoints","setClientTransDim","redrawImgWithObj","setCurrentObj","performPointZoom","open","getInitialLoaded","fileSelect","fileType","initZoomValue","prevActObj","moveToSelectionRange","applyFrame","drawImage","downScaleImgCanvas","downScale","resetFrameZoom","triggerFrameChange","zoomToSel","straightenActObj","updateImgCanvasPoints","isLinesIntersect","setDestForStraighten","tempStraightenDestPoints","straightenDestPoints","straightenInitZoom","checkPointPosition","updateCropSelection","updateCropSelObj","redrawDownScale","updateFinetune","isSelOutsideImg","showDialogPopup","tempStrokeWidth","default","inMemoryContext","inMemoryCanvas","imageData","getImageData","putImageData","frameObj","isCropRatio","isPreventDrag","saveContext","isPreventSelection","canvasDraw","toLowerCase","setDragLimit","drawCropRatio","strokeSettings","obj_1","isText","obj_2","keyHistory","fillStyle","fillRect","rotateContext","drawOuterSelection","drawShapeObj","undefined","drawCornerCircles","_c","translateX","translateY","rotationAngle","translate","rotate","preventShapeDragOut","min","max","updateWidthHeight","drawCustomSelection","parseInt","imgWidth","imgHeight","updatePoints","diff","adjToCenter","enlargeToImg","adjToStraighten","arr","tempActPoint","isMouseMove","horCircleWidth","verCircleHeight","horBottomLine","verLeftLine","verRightLine","topLeftCircle","topCenterCircle","topRightCircle","centerLeftCircle","centerRightCircle","bottomLeftCircle","bottomCenterCircle","bottomRightCircle","rotationCirclePoint","isCropCircle","lineWidth","tempObj","strokeStyle","themeColl","theme","moveTo","lineTo","stroke","selectionSettings","showCircle","drawRotationArcLine","drawCenterCircles","rotationCircleLine","drawArrowHead","isStartHead","start","end","arrowCircleSolid","arrowCircle","arrowBar","arrowSquareStart","arrowSquareEnd","currentShape","shapeType","horLineWidth","verLineHeight","selectionWidth","selectionHeight","tempFillStyle","drawSquareLines","drawRedact","isRedact","ellipse","shapeCircle","shapeLine","triangleDirection","isShapeDrawing","nextPoint","shapeText","shapeImage","drawSelection","rect","isHorizontalflip","isVerticalflip","flipObjColl","flipStr","isTempCanvas","baseRadius","adjustedRadius","isSafari","drawRoundedRect","roundRect","rectRadius","arcTo","horTopInnerLine","horBottomInnerLine","verLeftInnerLine","verRightInnerLine","tempWidth","save","clip","x1","y1","x2","y2","tempLineWidth","manipulateSaveCtx","strWidth","dx","dy","atan2","isStartArrow","isEndArrow","isEndCircleOrSquare","isStartCircleOrSquare","isStartArrowSolid","isEndArrowSolid","isStartSquare","isEndCircle","isStartSquareSolid","isEndCircleSolid","strokeRect","squareStartIntersectX1","squareStartIntersectY1","endCircleIntersectX1","endCircleIntersectY1","squareEndIntersectX1","squareEndIntersectY1","startCircleIntersectX1","startCircleIntersectY1","circleRadius","a","intersect","b","c","t2","sqrt","intersectionX1","intersectionY1","isStartCircleSolid","imageCanvas","dimObj","imageElement","imgPoint","globalAlpha","opacity","rotateImage","rows","lineHeight","tempFill","yPoint","baseWidth","test","floor","textStyle","font","rotateText","strokeText","fillText","updateActPoint","tempActiveObj","tempDegree","scale","textFlipDegree","left","top","isRotatePan","isStraighten","isPreventDimension","setTransformColl","isPreventClearRect","isFrame","isMouseDown","imageOnLoad","src","_this","proxy","baseImg","onload","imgSrc","isCropped","isSameDimension","isImageUpdated","hideSpinner","updateBaseImgCanvas","fileOpened","isValidImage","isUndoZoom","display","eventargs","isOkBtn","isMainToolbar","action","actionEventArgs","triggerEditCompleteEvent","onerror","errorLoading","defaultZoom","srcPoints","isBrightAdjust","frame","straightenZoom","adjustmentLevel","brightness","contrast","hue","saturation","blur","exposure","transparency","sharpen","bw","currentFilter","setAttribute","zoom","isOk","tempFrameZoomLevel","cancelCropSelection","currentObj","isFinalCancel","noPushUndo","JSON","stringify","tempFrameObj","textArea","drawingShape","enableShapeDrawing","isFiltered","cancelItems","togglePan","isFinetuneBtnClick","initialAdjustmentValue","isBrightnessAdjusted","bevelFilter","obj_3","tempAdjustmentLevel","cursor","classList","add","isDisabled","isMaskImage","actionArgs","isCropSelection","ascpectIcon","shapes","currentToolbar","aspectRatioElement","blrAspRatElem","contains","obj1","obj2","togglePen","cancelPen","cancelText","cancelShape","cancelSelection","tempPointsColl","isFreehandDrawCustomized","isCancel","currIndex","appliedUndoRedoColl","appliedColl","currentObjColl","iLen","currObjColl","j","jLen","undoRedoObj","undoRedoStep","isDragging","tempStraighten","selPointCollObj","currentPointColl","currentSelPointColl","currentCropObj","tempSelectionObj","isPrevent","cropZoomFactor","drawNewSelection","cropShape","updateSelectionInsert","shapeSettingsObj","getSelectionType","selectionChangingArgs","previousSelectionSettings","currentSelectionSettings","destLeft_1","destTop_1","destWidth_1","destHeight_1","lowerCanvasWidth_1","lowerCanvasHeight_1","activePoint_1","destLeft_2","destTop_2","destWidth_2","destHeight_2","lowerCanvasWidth_2","lowerCanvasHeight_2","activePoint_2","_d","lowerCanvasWidth","lowerCanvasHeight","adjActObj","tempTogglePen","widthObj","penStrokeWidth","isCircleCropped","isObj","color","bgColor","drawCropSelectionImage","isDefaultZoom","isAfterCropAction","clearContext","okBtn","zoomValue","panToPoint","drawZoomPanImage","adjustPanning","isActObj","panToSel","destLeft_3","destTop_3","destWidth_3","destHeight_3","forEach","prevStraightenedDegree","setStraighten","openNewImage","showSpinner","toolbar","defToolbarItems","getElementById","openURL","getFileExtensionFromURL","getImageSizeFromURL","imageSizeMB","toDataURL","imageUrl","callback","response","contentLength","ex_1","fetch","method","headers","get","console","log","message","dlgBtnClick","export","applyDialogOption","dlgCloseBtnClick","checkToolbarTemplate","inputElem","getComponent","headerObj","key","contentObj","yesObj","noObj","Dialog","header","closeOnEscape","content","target","isModal","animationSettings","effect","close","bind","buttons","click","buttonModel","iconCss","isPrimary","appendTo","restoreOldImage","data","dropArea","url","lastDotIndex","lastIndexOf","slice","inputElement","filesData","fileData","files","rawFile","fileExtension","name","fileExtensionArray","window","URL","createObjectURL","isChangesSaved","toolbarTemplate","maxZoomFactor","isSelectionBiggerThanCanvas","isSelectionOutsideCanvas","isBigger","isOutside","toolbarHeight","isImgAnnotation","isHFlip","isVFlip","tempCanvas","createElement","attrs","isHorImageFlip","isVerImageFlip","isFinetuning","widthSource","heightSource","round","halfWidthRatio","ceil","halfHeightRatio","img2","createImageData","data2","weight","weights","alphaWeights","r","stopY","w0","stopX","w","xPos","drawImgToCtx","preventImg","getFrameColor","gradientColor","gradient","createLinearGradient","addColorStop","inset","offset","amount","border","newWidth","newHeight","valueForty","valueFifty","bevelObj","quadraticCurveTo","arcY2","lineY","arcX2","lineX","arcX1","lineX2","arcY1","lineY2","setLineDash","prevFrameSettings","frameChange","previousFrameSetting","currentFrameSetting","borderRadius","frameLineStyle","lineCount","setFrameObj","currFrameSettings","isToolbar","pow","performDummyZoom","setZoomPan","calcStraightenedPoints","isDestPointSmall","isSmall","this_1","left_1","top_1","width_1","height_1","selectionObj","getImagePoints","p1","p2","p3","p4","imgPoints_1","isTopIntersect_1","doIntersect","isRightIntersect_1","isBottomIntersect_1","isLeftIntersect_1","imgPoints","isTopIntersect","isRightIntersect","isBottomIntersect","isLeftIntersect","isTopLeftInsideRect","isInsideRect","isTopRightInsideRect","isBottomRightInsideRect","isBottomLeftInsideRect","calcTriangleArea","x3","y3","x4","y4","area1","area2","area3","area4","areaRectangle","dim","getRotatedCanvasDim","baseImgCanvasWidth","baseImgCanvasHeight","baseImgWidth","baseImgHeight","radians","d","point1","initiation","point2","point3","point4","onSegment","isInside","isSaveCtx","redactImage","offscreenCanvas","offscreenCtx","imageWidth","imageHeight","tempRatio","tempCtx","straightenCanvas","straightenCtx","newP1","newP2","newP3","tempHeight","rotatedWidth","rotatedHeight","redactType","pixelSize","redactPixelate","blur_1","redactBlur","imageSmoothingEnabled","Export","updatePvtVar","exportImg","exportToCanvas","updateSaveContext","imageQuality","drawAnnotation","imgQuality","imageName","beforeSave","beforeSaveEvent","observableSaveArgs","lowerCaseType","toSVGImg","toBlobFn","saved","maxWidth","maxHeight","dataUrl","svg","createElementNS","setAttributeNS","appendChild","svgDataUrl","btoa","downloadImg","imagetype","toBlob","blob","blobUrl","tempCropObj","tempContextFilter","parseFloat","join","tempContext","exportTransformedImage","updateFrame","nonRedact","item","redact","concat","order","drawShape","drawPen","indexObj","index","found","splice","temp_1","indexBool","bgObj","isAnnotation","href","download","documentElement","parentNode","removeChild","flip","exportRotate","exportFlip","setMaxDim","flipHorizontal","flipVertical","Filter","tempAdjVal","tempFilVal","finetuneImage","setFilter","updateFinetunes","setAdjustment","initFilter","setCurrAdjValue","updateAdj","getCurrentObj","applyFilter","getDefaultFilter","fs","finetuneSettings","property","defaultValue","setFilterAdj","isPreview","values","getFilterValue","saturate","bright","saturatePercent","saturatePercentage","getSaturationFilterValue","getDefaultCurrentFilter","setTempFilterValue","tempSplitWords","prevFilter","valueArr","setFilterValue","setSaturationFilterValue","finetuneOption","curFinetuneObjEvent","finetune","dummyObj","tempFlipPanPointObj","zoomObj","imageSource","getValFromPercentage","percentage","val","getValFromLength","parseFilterString","filterString","filterArray","map","match","grayscale","hueRotate","invert","sepia","blurRadius","blurredData","Uint8ClampedArray","nx","ny","factor","length_1","length_2","length_3","gray","rotation","cosA","sinA","matrix","length_4","length_5","lumR","lumG","lumB","shiftW","pos","length_6","FreehandDrawing","fhdObj","lastWidth","lastVelocity","time","pointX","pointY","isFreehandDrawing","freehandDownPoint","isFreehandPointMoved","pointCounter","currFHDIdx","selPoints","dummyPoints","tempFHDStyles","straightenPointAngle","isMasking","updateFhdPvtVar","hoverFhd","freehandDownHandler","freehandUpHandler","isFHDIdx","deleteFhd","freehandRedraw","selectFhd","applyFhd","cancelFhd","updateFHDCurPts","rotateFhdColl","flipFHDColl","panFHDColl","updateFHDColl","zoomFHDColl","applyPenDraw","freeHandDraw","getSqPtFD","fhdHovIdx","updateCropPtsForSel","fhdSelID","fhdSelIdx","setCenterSelPoints","prevStraightenObj","triggerShapeChanging","idx","controlPoint1","controlPoint2","minStrokeWidth","maxStrokeWidth","startDraw","calcCurveCP","Date","getTime","clientX","clientY","touches","EventHandler","freehandMoveHandler","shapeSettings","ShapeType","FreehandDraw","shapeChangingArgs","previousShapeSettings","currentShapeSettings","getBoundingClientRect","remove","processPoint","changedTouches","fhCnt","mouseDown","lastPoint","isLastPointTooClose","distanceTo","unshift","p0","shift","dx1","dy1","dx2","dy2","m1","m2","l1","l2","dxm","dym","k","cm","tx","ty","tempVelocity","pointVelocity","drawCurve","startWidth","endWidth","t1","t3","u1","u2","u3","widthValue","bezierLength","drawSteps","drawArc","pointX1","pointY1","pointX2","pointY2","pointX3","pointY3","bezierPoint","cp1","cp2","sPoints","selectedPoint","isSelected","isUndoRedoStack","isId","tempSelPointColl","zoomX","zoomY","lowercaseValue","pointsHorizontalFlip","pointsVerticalFlip","isIndex","getAttribute","discard","selectMaskImage","Selection","diffPoint","oldPoint","isTouch","isObjSelected","isFhdPoint","dragPoint","isShapeInserted","triangle","triangleRatio","isFirstMove","startTouches","tempTouches","currMousePoint","cursorTargetId","isPreventDragging","dragElement","textRow","mouseDownPoint","previousPoint","zoomType","isInitialTextEdited","dragCanvas","isFhdCustomized","touchEndPoint","isFhdEditing","currentDrawingShape","initialPrevObj","touchTime","resizedElement","isImageClarity","isPinching","isSliding","isSliderActive","arrowShape","ArrowheadType","None","SolidArrow","isTouchDblClick","isMouseUp","mouseWheel","selection","setCursor","updateActivePoint","updateCursorStyles","setTextSelection","setActivePoint","clearSelection","calcShapeRatio","performTabAction","setDragDirection","setTimeout","redrawShape","setTextBoxStylesToActObj","mouseDownEventHandler","mouseMoveEventHandler","mouseUpEventHandler","canvasMouseDownHandler","canvasMouseMoveHandler","canvasMouseUpHandler","touchStartHandler","keyDownEventHandler","handleScroll","textKeyDown","deleteItem","updatePrevShapeSettings","panDown","adjustActObjForLineArrow","findTarget","getCurrentFlipState","setDragWidth","setDragHeight","getTransRotationPoint","adjustNEPoints","adjustRotationPoints","getResizeDirection","unwireEvent","updPtCollForShpRot","findImageRatio","getNumTextValue","upgradeImageQuality","triggerShapeChange","applyTransformToImg","findTargetObj","getArrowType","updateNWPoints","updateNPoints","updateNEPoints","updateWPoints","updateEPoints","updateSWPoints","updateSPoints","updateSEPoints","drawMaskCircle","isValueUpdated","getDistance","timer","pathAdjustedIndex","allowUndoRedoPush","applyCurrShape","isKBDNavigation","selMouseUpEvent","getMouseCursor","isApply","frameObject","setCursorForActObj","highestOrder","getHighestOrder","tempShapeColl","isShape","setCursorForFreehandDrawing","setCursorFromObj","isBreak","maskCanvas","setCursorForLineArrow","setCursorForPath","cursorColl","setCursorForRotatedObject","isMove","horTP","horTopLinePointColl","horTP1","verLP","verLeftLinePointColl","verRP","verRightLinePointColl","horBP","horBottomLinePointColl","horBP1","rotCP","rotationCirclePointColl","horTP0","horBP0","getRectanglePoints","horTP_1","horBP_1","verLP_1","verRP_1","adjustCursorStylesForRotatedState","cursorMap","nw-resize","n-resize","ne-resize","w-resize","e-resize","sw-resize","s-resize","se-resize","getResizeElement","resizeMappings","positiveDegree","resizeMappings_1","startDegree","endDegree","resizeElement","isEntered","ptc","freehandSelectedIndex","pt","z1","z2","z3","z4","preventResizing","isShapeDragOut","shapeResizingArgs","allowShapeOverflow","allowOutofBound","shapeMovingArgs","isTextArea","isMouseOutsideImg","cropResize","rotatedDegree","tempEndX","tempEndY","getSquarePointForPath","allowPreventing","path","isObjOutsideImg","selectionResizingArgs","isPreventShaping","eventType","preventDragOut","limitDrag","isStart","isLimiting","wrapperWidth","wrapperHeight","preventDraggingInvertly","preventTextDraggingInvertly","preventInverseResize","getScaleRatio","newScale","gcd","divisor","revertResizing","performSEResize","resizeImg","revertCustomSelection","performNWResize","isCustomSelection","endY1","endX1","revertPoints","adjustNWPoints","top_2","top_3","adjustSWPoints","adjustSEPoints","isTextBox","width_2","measureText","rectangle","cx","cy","rotatedC","rotatePoints","newCenter","newBottomRight","newTopLeft","rotatedD","newBottomLeft","newTopRight","rotatedB","rotatedA","setResizedValue","getResizedElement","resizeMappings_2","isLine","updateCursorStylesForLineArrow","updateCursorStylesForPath","textWidth","textHeight","selectInfo","currentTarget","isPan","isGrabbing","imageEditorClickEventArgs","setXYPoints","clickEvent","tempCursor","performEnterAction","isShapeTouch","object_1","isFreehandDraw","isFreehandDrawTouch","isShapeClick","applyObj","isLineArrow","x_1","y_1","cursor_2","tempHoveredIndex","isPenEdit","qbArea","shapeChangedArgs","isPenDraw","cursor_1","canvasCursor","preventDefault","bbox","targetTouches","pageX","offsetLeft","pageY","offsetTop","firstFingerX","firstFingerY","secondFingerX","secondFingerY","zoomTrigger","ZoomTrigger","Pinch","calculateScale","isZoomBtnClick","isZoomOut","parentElement","closest","stopImmediatePropagation","activeObjShape","dummyClick","srcElement","elemId","id_1","prevCropObj_1","applyCurrActObj","splitWords_1","isCropSelection_1","freehandDrawSelectedId","isInitialLine","isAdjusted","setRatio","getCurrentIndex","setTimer","rgbToHex","offsetX","offsetY","tempPanMoveObj","tempPanMove","panMove","panMoveObj","ctrlKey","allowUndoRedo","Commands","isIcon","focusRatioBtn","isAspectRatio","aspectRatioHeight","aspectRatioWidth","placeholder","upload","isKeyBoardCrop","focus","isInsideCanvas","stopPropagation","MouseWheel","wheelDelta","String","fromCharCode","which","scrollHeight","resetCrop","presetRatio","originalWidth","originalHeight","standardSize","scaleWidth","getScale","snippetArray","scaleHeight","snippetArray1","originalValue","prevIndex","cursor_3","cursor_4","shapeEvent","endTouches","startDistance","clearTimeout","smallPoint","largePoint","shapeIDObj","backgroundColor","textShadow","trim","fontWeight","fontStyle","hexR","padLeft","hexG","hexB","hexA","isNaN","Number","padChar","updateFreehandDrawColorChange","object_2","tempFreeHandDrawEditingStyles","radiusX","radiusY","arrowHead","arrowTail","none","circleSolid","squareSolid","rectX","rectY","rectWidth","rectHeight","rectAngle","angleRad","localX","localY","rotatedX","rotatedY","halfWidth","halfHeight","widthElement","heightElement","heightString","replace","widthString","isValue","Shape","preventFrameAnnotation","initShapePvtProps","uploader","drawEllipse","drawLine","drawArrow","drawPath","drawRectangle","drawText","redrawActObj","updateShapeChangeEventArgs","updSelChangeEventArgs","iterateObjColl","updImgRatioForActObj","redrawObj","redrawText","renderTextArea","setTextBoxWidth","findTextTarget","updateFontStyles","applyFontStyle","updateFontRatio","updateFontSize","pushActItemIntoObj","clearActObj","refreshActiveObj","applyActObj","fileChanged","getShapeSetting","getShapeSettings","getRedactSettings","isPointsInRange","alignRotateFlipColl","selectShape","deleteShape","getMaxText","getLinePoints","setPointCollForShapeRotation","setTextBoxPos","setTextBoxPoints","alignTextAreaIntoCanvas","initializeTextShape","stopPathDrawing","updateArrowRatio","getSquarePointForRotatedShape","updateObj","straightenShapes","straightenShapePoints","straightenPath","straightenFHD","getTextBoxPosition","setFlipState","getNewShapeId","updateZOrder","getSmallestIndex","isIndexInObjColl","drawAnnotations","updateShapeColl","getNewOrder","getLowestOrder","shapeImg","crossorigin","initializeShape","arrowStart","arrowEnd","drawShapeText","setDimension","arrowType","Arrow","Circle","SolidCircle","Square","SolidSquare","Bar","lineDraw","RedactType","Blur","setCenterPoints","setPointCollForLineAndArrow","initShapeProps","isPublicMethod","textFlip","prevObjColl","isInitialText","getFontSizes","fontSizeColl","drawShapeTextEvent","fontSizeInd","findIndex","drawShapeImageEvent","isSelect","addLetter","onLoadImgShape","updateTextFromTextArea","renderWidth","renderHeight","shapeId","letter","widthColl","smallestIndex","updatePathRatio","zoomObjColl","preventApply","len_1","updateArrowSize","len_2","straightenPoints","fLen","updateCurrentActiveObjPoint","currActObjIndex","flipLineArrowObj","rotateObjColl","rotateLineArrowObj","prevPoint","lineArrowHorizontalFlip","lineArrowVerticalFlip","currPoint","getRotDegOfShape","transformTextArea","zOrderElem","dupElem","removeElem","editTextElem","shadowColor","shadows","adjustedOutlineWidth","overflow","setTextBoxHeight","tempLeft","tempTop","center_1","width1","height1","width2","whiteSpace","textOverflow","textAreaWidth","letterWidth","textAreaLeft","textAreaTop","noRedact","selectedText","updateImgCanvas","resizeImage","aspectRatio","aspectRatioArray","selectionStart","finish","selectionEnd","substring","panObjColl","len_3","len_4","updateFontStyle","getTextAreaWidth","updateObjColl","dimensions_1","dimensions_2","tempBold","tempItalic","tempRedactBlur","tempRedactPixel","letters","transformOrigin","getRedactObjDetails","redactDetails","blurIntensity","getObjDetails","shapeDetails","arrowObj","getFreehandDrawDetails","obj_4","shapeDetailsColl","RedactDetailsColl","inRange","popForDefaultTransformedState","popForDefaultFlipState","popForDefaultRotateState","rotateRight","rotateleft","horizontal","vertical","isHorizontal","isVertical","isNextHorizontal","isNextVertical","isNextToNextHorizontal","isNextToNextVertical","isNextToNextToNextHorizontal","curr","obj_5","obj_6","maxi","maxStr","maxText","m","getSlope","getIntercept","lesserY","i_1","prev","lesserX","i_2","isSameAxis","slope","reverse","reArrangeObjColl","reUpdateShapeColl","reorderRedact","isOrdered","tempOrder","tempSelPointCollObj","isPrevented","isPenId","tempObjCollIndex","i_3","i_4","i_5","Transform","disablePan","isReverseRotate","prevZoomValue","cropDimension","isPreventSelect","preventDownScale","resizedImgAngle","initTransformPvtVar","flipImage","setDestPointsForFlipState","zoomAction","disableZoomOutBtn","rotatedFlip","drawPannedImage","drawPannImage","performTransformation","updateTransform","rotatePan","setCurrPanRegion","calcMaxDimension","currDestPoint","resizeCrop","updateResize","resize","straightenImage","zoomBtnHold","transCurrObj","previousDegree","currentDegree","rotateEvent","prevEventObjPoint","prevEventSelectionPoint","drawRotatedImage","rotateDegree","updateCurrSelectionPoint","previousDirection","flipEvent","lowercaseDirection","selObj","updateFlipColl","toLocaleLowerCase","dir","verticalFlip","horizontalFlip","lastFourItems","minZoomFactor","powerOften","zoomEventArgs","previousZoomFactor","currentZoomFactor","zoomEvent","zoomFact","drawZoomImgToCanvas","panObj_1","isAdd","rotateZoom","panObj_2","clearInterval","zoomOut","autoEnablePan","setZoomDimension","zmFactor","maxDestLeft","maxDestTop","panEventArgs","panEvent","isPanMethod","isObjCreated","updatePanPoints","tempFlipState","Direction","Horizontal","Vertical","rotatePanActiveObj","initialDestLeft","initialDestTop","intPan","limitPan","getCurrentZoomFactor","absValue","freehandObj","cxtTbarHeight","ctToolbar","ctWrapper","hdWrapper","canvasWrapper","offsetWidth","ctxTbarArea","offsetHeight","toolbar_1","refreshOverflow","canvasMaxWidth","canvasMaxHeight","cxtTbar","widthScale","heightScale","cssMaxWidth","cssMaxHeight","tempActObj","tempDestLeft","tempDestTop","temp1","minimum","resizeSrc","nearestNumber","smallestDifference","minimum_1","num","difference","prevResizeCurrObj","tempwidth","tempheight","tempZoom","sx","sy","currObject","resizeEventArgs","previousWidth","previousHeight","resizeEventHandler","aspectRatioWidthValue","UndoRedo","undoRedoColl","tempUndoRedoColl","isPreventing","undoRedo","initializeUrPvtProp","updateUrc","refreshUrc","updateCurrUrc","callUndo","callRedo","undo","redo","updateUrObj","updateUndoRedo","undoDefault","updateUndoRedoStack","tempCurrSelPoint","refreshToolbar","appliedURColl","prevTransform","getZeroZoomObjPointValue","adjObj","triggerActionCompletedEvent","lastObj","lastPrevObj","chrome","cold","warm","deleteObj","deleteFreehandDrawing","shapeInsert","shapeTransform","freehanddrawCustomized","getUndoRedoAction","imageRotate","freehanddraw","textAreaCustomization","imageHFlip","imageVFlip","updateImage","refreshToolbarActions","applyCurrentChanges","updateFreehandDraw","updateFreehandDrawCustomized","updateDelete","updateTextAreaCustomization","updateText","imageFlip","updateCropTransformItems","tempCircleCrop","endUndoRedo","updateTextBox","allowActiveObj","isUndo","isInitialLoaded","frameDestPoints","oper","cropDimensionObj","getZeroZoomObjColl","getZeroZoomPointColl","tempArrowObj","applyImgTranform","isUpdated","enableTextEditing","__extends","extendStatics","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","create","__decorate","decorators","desc","arguments","getOwnPropertyDescriptor","Reflect","decorate","defineProperty","FinetuneSettings","_super","Property","ChildProperty","ZoomSettings","SelectionSettings","FontFamily","ImageEditor","options","isZoomed","isFilterCanvasClick","isFrameBtnClick","tempToolbarHeight","tempToolbar","ImageEditor_1","Inject","ToolbarModule","requiredModules","modules","member","preRender","getUniqueID","navigator","userAgent","initializeThemeColl","render","isAngular","originalElement","clonedElement","cloneNode","replaceChild","setValue","initialize","getPersistData","addOnPersist","onPropertyChanged","newProperties","oldProperties","keys","cssClass","removeClass","addClass","wireEvent","locale","showQuickAccessToolbar","Toolbar","className","toolbarTemplateFn","quickAccessToolbarTemplate","quickAccessToolbarTemplateFn","removeAttribute","saveDialog","createCanvas","createDropUploader","quickAccessToolbar","createSpinner","initializeZoomSettings","Uploader","getElementsByClassName","allowedExtensions","multiple","selected","event","errType","dataTransfer","okObj","supportObj","andObj","keyUpEventHandler","windowResizeHandler","isIos","info","screen","orientation","screenOrientation","boxSizing","dragObj","dropObj","browseObj","dropAreaElement","dropIconElement","dropContentElement","textContent","minDropContentElem","dropAnchorElement","minDropAnchorElem","dropInfoElement","dropUploader","adjustToScreen","notifyResetForAllModules","module","allowShape","applyShapes","includeAnnotations","getData","updateColl","resetChanges","imageSettings","initialZoomValue","qtArea","updateImageTransformColl","freehandDraw","isEllipse","editCompleted","isArrow","isPath","isRectangle","isImage","updateShape","setting","tempFontSize","getRedacts","selectRedact","deleteRedact","updateRedact","option","applyImageFilter","filterOption","getImageDimension","isResized","drawFrame","frameType","frameChangeEventArgs","FrameLineStyle","Solid","isStraightened","cloneShape","isPreventUndoRedo","getImageFilter","canUndo","getUndoRedoColl","canRedo","undoRedoIndex","closeOverlayTbar","isEnabled","orderObj","bringToFront","updateShapeOrder","bringForward","sendToBack","sendBackward","clearImage","btoolbar","enableDisableToolbar","disable","prevObj_1","resetToolbar","tempDestPoints","tempSel","tempTransform","template","templateID","toolbarArea","toolbarFn","templateParser","isReact","templateColl","nodeType","qatFn","querySelectorAll","templateCompiler","compile","error","getTextFromId","1","2","3","4","5","6","7","8","getFinetuneOption","ImageFinetuneOption","Brightness","Contrast","Hue","Saturation","Opacity","Exposure","setPenStroke","setInitialZoomState","str","strArr","charAt","toUpperCase","items","isFinalApply","isResizeOkBtn","blrNAspRatElem","objt","selElem","sliderWrap","children","isCroppedEvent","previousElementSibling","getObjFromId","setTempFilterProperties","cropSelectedState","tempAdjustmentValue","getCurrentCanvasData","tempFrame","setCurrAdjustmentValue","finetuneValueChanging","typeToSelectionType","CropCustom","CropSquare","CropCircle","Crop3:2","Crop4:3","Crop5:4","Crop7:5","Crop16:9","Crop2:3","Crop3:4","Crop4:5","Crop5:7","Crop9:16","updateArrow","isObjPushed","collLength","updateFontFamily","itemText","text_1","text_2","updateFontColor","updateStrokeTextColor","updatePenStrokeWidth","updatePenStrokeColor","indexObj_1","updateStrokeWidth","updateStrokeColor","updateFillColor","isPreventURC","duplicateImage","pascalToSplitWords","splitStr","word","getCurrAdjustmentValue","penOpacity","transformSelect","isTransform","stValPan","straightenEventArgs","performStraighten","getStraightenFlipState","minX","maxX","minY","maxY","shapeObj","curFlip","Bootstrap5","primaryColor","secondaryColor","Bootstrap5Dark","Tailwind","TailwindDark","Fluent","FluentDark","Bootstrap4","Bootstrap","BootstrapDark","Material","MaterialDark","Fabric","FabricDark","Highcontrast","Material3","Material3Dark","Fluent2","Fluent2Dark","Fluent2Highcontrast","Bootstrap5.3","Bootstrap5.3Dark","Complex","Event","NotifyPropertyChanges","Component","FileType","Theme","ImageEditorCommand","ImageFilterOption","FrameType","currToolbar","preventZoomBtn","selFhdColor","preventEnableDisableUr","isFrameToolbar","presetColors","custom","isSlider","currentQuality","initLocale","defaultLocale","ZoomIn","ZoomOut","Undo","Redo","Annotation","Finetune","Sharpen","Default","Chrome","Cold","Warm","Grayscale","BlackAndWhite","Sepia","Invert","Text","Pen","Reset","Save","Select","RotateLeft","RotateRight","HorizontalFlip","VerticalFlip","OK","Cancel","FillColor","StrokeColor","StrokeWidth","FontStyle","FontSize","FontColor","Pan","Move","Load","Custom","Ellipse","Rectangle","Line","Path","Bold","Italic","BoldItalic","XSmall","Small","Medium","Large","XLarge","ABC","Browse","Duplicate","Remove","EditText","Start","End","ArrowSolid","CircleSolid","SquareSolid","CropAndTransform","CropSelection","Image","Transparency","Height","Width","AspectRatio","W","H","DragText","DropText","BrowseText","SupportText","Frame","Mat","Bevel","Inset","Hook","Color","Size","Offset","Radius","Amount","Resize","0","20","40","60","80","100","Border","Dashed","Dotted","GradientColor","ConfirmDialogHeader","ConfirmDialogContent","AlertDialogHeader","AlertDialogContent","Yes","No","ImageErrorDialogHeader","ImageErrorDialogContent","Straighten","NoOutline","DlgOK","SaveAs","ImageName","Format","Quality","Download","Close","ImageSize","QualityInfo","Good","Great","Highest","BringForward","SendBackward","SendToBack","BringToFront","ZOrder","Redact","Pixelate","BorderRadius","TextOutlineColor","TextOutlineWidth","PixelSize","And","l10n","L10n","createToolbar","createContextualToolbar","updateToolbarItems","renderQAT","enableDisableTbrBtn","initMainToolbar","createBottomToolbar","refreshMainToolbar","createQuickAccessToolbar","destroyQuickAccessToolbar","zoomBtnMouseUpHandler","refreshDropDownBtn","closeContextualToolbar","destroyBottomToolbar","destroyTopToolbar","destroySubComponents","setLocale","getPenStroke","performDefTbrClick","refreshSlider","refreshShapeDrawing","getConstant","initResizeToolbar","resizeClick","frameToolbarClick","performCropTransformClick","duplicateShape","editText","initialSize","widthPress","heightPress","widthAspectRatio","heightAspectRatio","toolbarItems","align","tooltipText","uploadItems","bToolbar","created","toolbarType","clicked","defToolbarClicked","createLeftToolbarControls","mToolbar","toolabr","toolbar_2","toolbarElem","initBottomToolbar","toolbar_3","isApplyOption","leftItem","getLeftToolbarItem","rightItem","getRightToolbarItem","mainItem","getMainToolbarItem","zoomItem","getZoomToolbarItem","toolbarObj","renderAnnotationBtn","wireZoomBtnEvents","renderCropBtn","renderTransformBtn","visible","prefixIcon","tempToolbarItems","processToolbar","tabIndex","updateContextualToolbar","contextualToolbarArea","toolbar_6","initFilterToolbarItem","initFrameToolbarItem","renderSlider","cHt","cusWrapper","ht","insertBefore","getCropTextContent","processSubToolbar","zoomIn","zoomInBtnMouseDownHandler","zoomInBtnClickHandler","zoomOutBtnMouseDownHandler","zoomOutBtnClickHandler","keyCode","icon","widthNumeric","heightNumeric","getResizeToolbarItem","spanWidth","NumericTextBox","htmlAttributes","maxLength","showSpinButton","format","spanHeight","wireResizeBtnEvents","uploadDiv","uploadElem","getElementsByTagName","uploadBtnElem","title","onchange","filesTypes","triggerTbarClickEvent","originalEvent","isCustomized","defItems","toolbarId","enableDisableCloneBtn","getCurrentShapeIcon","drpDownBtn","DropDownButton","currentFreehandDrawIndex","penStrokeWidthObj","tempCurrentFreehandDrawIndex","setInitialShapeSettings","isDummyTextClick","duplicateElement","removeElement","editTextElement","zOrderElement","renderStraightenSlider","slider","createSlider","sliderHandle","shapeString","cancelPan","cropSelect","saveDialogPopup","quality","dialogContent","dialogImgContent","dialogRightContent","imageNameDiv","formatNameDiv","tabindex","qualityNameDiv","qualityDiv","qualityOptionDiv","buttonGroup","input","htmlFor","dialog","beforeOpen","onBeforeopen","saveDialogClosed","hide","TextBox","imageNameLabel","qualityContainer","qualityBtnGrp","qualityBtnIcon","qualitySliderValue","fileObj","Button","ddbElem","spanElem_1","drpDownBtn_1","activeBtn","updateImageSize","checked","qualityBtnClickHandler","compressionValues","qualitySlider","qualityOption","qualitySliderValueDiv","qualitySliderValueSpan","sliderObj","Slider","tooltip","placement","isVisible","showOn","changed","fileSize","megabytes","toFixed","compressedImage_1","revokeObjectURL","rawByteSize","fileSize_1","getCropTransformToolbarItem","straightenSpan","getShapesToolbarItem","initCropTransformToolbar","classToContentMap","e-custom","e-circle","e-square","e-custom-a","e-custom-b","e-custom-c","e-custom-d","e-custom-e","e-custom-f","e-custom-g","e-custom-h","e-custom-i","e-custom-j","shapeIcons","line","image","crop-custom","crop-circle","crop-square","crop-3:2","crop-4:3","crop-5:4","crop-7:5","crop-16:9","crop-2:3","crop-3:4","crop-4:5","crop-5:7","crop-9:16","initShapesToolbarItem","isToolbarString","excludeItems","createRectangleRadius","createShapeColor","createShapeBtn","createZOrderBtn","some","createStartBtn","createEndBtn","strokeWidthItems","strokeWidthBtn","spanElem_2","drpDownBtn_2","parentElem","childNodes","beforeModeSwitch","inst","popupLeft","offsetParent","mode","showButtons","dataBind","fillColor_1","ColorPicker","modeSwitcher","noColor","inline","beforeTileRender","change","rgba","fillDDB_1","toggle","onModeSwitch","beforeClose","parenElem","innerWidth","getValue","strokeColor_1","strokeDDB_1","background","spanElem_3","drpDownBtn_3","zOrderItems","drpDownBtn_4","spanElem","idToValue","strokeEndBtn","getTextToolbarItem","getFontFamilyItems","initTextToolbarItem","createTextColor","createStrokeTextColor","createBackgroundColor","createTextBtn","fontColor_1","strokeDDB_2","backgroundColor_1","strokeDDB_3","fontColor_2","strokeDDB_4","fontNameBtn","spanElem_4","fontFamilyBtn_1","createPopupOnClick","beforeItemRender","fontSizeBtnElem","fontSizeSpanElem_1","fontSizes","fontSizeBtn_1","toolbarElement","bottomToolbar","toolbar_13","initPenToolbarItem","initAdjustmentToolbarItem","frameElem","redactBlurElement","pixelateElement","redactSlider","updateKBDNavigation","updateRedactObj","tbarInitialBtn_1","tbar","tbarInitialChild","tempElem","defaultFilter_1","getAdjustmentToolbarItem","getFrameToolbarItem","getFilterToolbarItem","getPenToolbarItem","createPenColor","createPenBtn","presentVal","penColor","hex","strokeDDB_5","spanElem_5","drpDownBtn_5","valueToTextContent","frameWrapper","styles","createFrameColor","createFrameSize","createFrameRadius","createFrameInset","createFrameOffset","createFrameAmount","createFrameBorder","createFrameGradientColor","fillDDB","curFrameObjEvent","contextualToolbarClicked","createCanvasFilter","hdrWrapper","filterElem","drawDashedLine","updateFilterCanvas","selector","getQuickAccessToolbarItem","orgToolbarItems","quickAccessToolbarClicked","wrapperElement","annotation","adjustment","pathObject","right","object1","duplicateObj","isFilterFinetune","isDisabledFilter","isDisabledAdjustment","panBtn","openSlider","unselectFrameBtn","updateRedactType","pixelateBtn","redactBlurBtn","callFrameToolbar","zoomToFrameRange","isSmaller","selEle","imageFiltering","curFilterObjEvent","parent_1","returnValue","applyPreviewFilter","parent_2","setInterval","quickToolbar","qatArea","labelWrapper","sliderWrapper","updateFinetuneSpan","ftValPan","unselectBtn","selectors_1","ej2_instances","selectors_2","selFillElem","selStrokeElem","selTextStrokeElem","selStrokeTextColorElem","selTextBGElem","selPenStrokeElem","strokeWidthElem","rectangleRadiusElem","fontFamilyElem","fontSizeElem","boldBtn","italicBtn","getStrokeWidth","getRectRadius","btnElement","detach","isString","indexArr","getIndex","negativeIndexArr","isSameIndex","isFontColor","ctxTbar","innerText"],"mappings":"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"}